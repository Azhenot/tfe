


















































Model selection and hypothesis testing for large-scale network models with
overlapping groups

Tiago P. Peixoto∗
Institut für Theoretische Physik, Universität Bremen, Hochschulring 18, D-28359 Bremen, Germany

The effort to understand network systems in increasing detail has resulted in a diversity of methods
designed to extract their large-scale structure from data. Unfortunately, many of these methods
yield diverging descriptions of the same network, making both the comparison and understanding
of their results a difficult challenge. A possible solution to this outstanding issue is to shift the
focus away from ad hoc methods and move towards more principled approaches based on statistical
inference of generative models. As a result, we face instead the more well-defined task of selecting
between competing generative processes, which can be done under a unified probabilistic framework.
Here, we consider the comparison between a variety of generative models including features such as
degree correction, where nodes with arbitrary degrees can belong to the same group, and community
overlap, where nodes are allowed to belong to more than one group. Because such model variants
possess an increasing number of parameters, they become prone to overfitting. In this work, we
present a method of model selection based on the minimum description length criterion and posterior
odds ratios that is capable of fully accounting for the increased degrees of freedom of the larger
models, and selects the best one according to the statistical evidence available in the data. In
applying this method to many empirical unweighted networks from different fields, we observe that
community overlap is very often not supported by statistical evidence and is selected as a better
model only for a minority of them. On the other hand, we find that degree correction tends to be
almost universally favored by the available data, implying that intrinsic node proprieties (as opposed
to group properties) are often an essential ingredient of network formation.

I. INTRODUCTION

Many networks possess nontrivial large-scale struc-
tures such as communities [1, 2], core-peripheries [3, 4],
bipartitions [5] and hierarchies [6, 7]. These structures
presumedly reflect the organizational principles behind
network formation. Furthermore, their detection can be
used to predict missing links [6, 8] or detect spurious
ones [8], as well as determine the robustness of the system
to failure or intentional damage [9], the outcome of the
spread of epidemics [10] and functional classification [11],
among many other applications. The detail with which
such modular features are both represented and detected
reflects directly on the quality of these tasks. However,
the methods of uncovering such structures in empirical
data so far proposed are very different in their suitability
to the aforementioned tasks. Many authors have con-
structed algorithms which attempt to divide the network
into groups according to some metric devised specifically
for this purpose. Examples of this include modular-
ity [12], betweenness [13], link similarity [14], clique per-
colation [15], encoding of random walks [16], and many
more [2]. Unfortunately, many of these methods will re-
sult in diverging descriptions for the same network. Fur-
thermore, the information they obtained cannot be easily
used to generalize the data, and make predictions [6, 8].
Alternatively, other authors have focused on constructing
generative models that encode the large-scale structure
as parameters, which can then be inferred from empir-

∗ tiago@itp.uni-bremen.de

ical data (e.g. [17–20]). These methods not only rep-
resent a more principled and rigorous stance, but they
can also demonstrably overcome inherent limitations of
more ad hoc methods [7]. Furthermore, they can be
used to generalize the data, and make predictions [6, 8].
Both approaches, however, suffer from a common funda-
mental problem, namely the difficulty in deciding which
detection method or generative model provides a more
appropriate description of a given network. This issue
tends to escalate as more elaborate models and methods
are developed, including features such as degree correc-
tion [19], community overlap [14, 15, 18, 20], hierarchi-
cal structure [6, 7, 21], self-similarity [22, 23], bipartite-
ness [5], edge and node correlates [24, 25], social tiers [26],
multilayer structure [27], temporal information [28], to
name only a few. Although such developments are es-
sential, they should be made with care, since increas-
ing the complexity of the network description may lead
to artificial results caused by overfitting. While this is
a well-understood phenomenon when dealing with inde-
pendent data or time series, open problems remain when
the empirical data are a network, for which many com-
mon assumptions no longer hold and the usual methods
perform very poorly [29]. This problem is significantly
exacerbated when methods are used which make no at-
tempt to assess the statistical significance of the results.
Unfortunately, most methods that are not based on gen-
erative models fall into this class. Although for certain
specially constructed examples some direct connections
between statistical inference and ad hoc methods can be
made [30, 31], and in the case of some spectral methods
a much deeper connection seems to exist [32, 33], they
still inherently lack the capacity to reliably distinguish

ar
X

iv
:1

40
9.

30
59

v4
  [

ph
ys

ic
s.

da
ta

-a
n]

  2
6 

M
ar

 2
01

5

mailto:tiago@itp.uni-bremen.de


2

signal from noise. Furthermore — what is perhaps even
more important — these different methods cannot easily
be compared to each other. For example, suppose that
for the same network a nonoverlapping partition is found
by compressing random walks, another overlapping parti-
tion is obtained with clique percolation, and yet another
with a local method based on link similarity (all of which
are methods not based on generative models). Most of
the time, these three partitions will be very different,
and yet there is no obvious way to decide which one is
a more faithful representation of the network. Although
methods such as network benchmarks [34–36] and per-
turbation analysis [37] have been developed in order to
alleviate this issue, they have only limited applicability to
the larger problem. Namely, network benchmarks cannot
be used when an appropriate representation of an empir-
ical network is not known, and if one wants to decide,
for instance, if the network possesses overlapping groups
or not. In a similar vein, perturbation analysis provides
information about the significance of results originating
from a single algorithm, which cannot be directly used
to compare two very different ones.

On the other hand, the situation is different if one fo-
cuses on generative models alone. Since in this context
the same problem is posed in a probabilistic framework,
comparison between models is possible, even if the mod-
els are very different. And since models can be designed
to accommodate arbitrary topological features, we lose
no explanatory power when comparing to the ad hoc ap-
proaches. We show in this work that this central issue
can be tackled in a consistent and principled manner by
performing model selection based on statistical evidence.
In particular, we employ the minimum description length
principle (MDL) [38, 39], which seeks to minimize the to-
tal information necessary to describe the observed data
as well as the model parameters. This can be equiva-
lently formulated as the maximization of a Bayesian pos-
terior likelihood which includes noninformative priors on
the parameters, from which a posterior odds ratio be-
tween different hypotheses can be computed, yielding a
degree of confidence for a model to be rejected in favor
of another. We focus on the stochastic block model as
the underlying generative model, as well as variants that
include degree correction and mixed memberships. We
show that with these models MDL can be used to pro-
duce a very efficient algorithm that scales well for very
large networks and with an arbitrarily large number of
groups. Furthermore, we employ the method to a wide
variety of empirical network data sets, and we show that
community overlaps are seldom selected as the most ap-
propriate model. This casts doubt on the claimed per-
vasiveness of group overlaps [14, 15], obtained predom-
inantly with nonstatistical methods, which should per-
haps be interpreted as an artifact of using methods with
more degrees of freedom, instead of an underlying prop-
erty of many systems — at least as long as there is a lack
of corroborating evidence supporting the overlap (such
as, potentially, edge weights [25, 40] or multilayer struc-

ture [27], which we do not consider here). On the other
hand, we find that degree correction tends to be selected
for a significant majority of systems, implying that indi-
vidual node “fitness” that is not uniformly inherited by
group membership is a fundamental aspect of network
formation.

This paper is divided as follows. In Sec. II we present
the generative models considered, and in Sec. III we de-
scribe the model selection procedure based on MDL. In
Sec. IV we present the results for a variety of empirical
networks. In Sec. V we analyze the general identifiability
limits of the overlapping models, and in Sec. VI we de-
scribe in detail the inference algorithm used. In Sec. VII
we finalize with a discussion.

II. GENERATIVE MODELS FOR NETWORK
STRUCTURE

A generative model is one which attributes to each
possible graph G a probability P (G|{θ}) for it to be
observed, conditioned on some set of parameters {θ}.
Here we will be restricted to discrete uniform models,
where specific choices of {θ} prohibit some graphs from
occurring, but those which are allowed to occur have
the same probability. For these models we can write
P (G|{θ}) = 1/Ω({θ}) = e−S(G|{θ}), with Ω({θ}) being
the total number of possible graphs compatible with a
given choice of parameters, and S(G|{θ}) = ln Ω({θ})
is the entropy of this constrained ensemble [41, 42]. In
order to infer the parameters {θ} via maximum likeli-
hood, we need to maximize P (G|{θ}), or equivalently,
minimize S(G|{θ}). This approach, however, cannot be
used if the order of the model is unknown, i.e. the num-
ber of degrees of freedom in the parameter set {θ}, since
choices with higher order will almost always increase
P (G|{θ}), resulting in overfitting. For the same reason,
maximum likelihood cannot be used to distinguish be-
tween models belonging to different classes, since mod-
els with larger degrees of freedom will inherently lead to
larger likelihoods. In order to avoid overfitting, one needs
to maximize instead the Bayesian posterior probability
P ({θ}|G) = P (G|{θ})P ({θ})/P (G), with P (G) being
a normalizing constant. The prior probability P ({θ}),
which encodes our a priori knowledge of the param-
eters (if any) should inherently become smaller if the
number of degrees of freedom increases. We will also
be restricted to discrete parameters with uniform prior
probabilities, so that P ({θ}) = e−L({θ}), with L({θ}) be-
ing the entropy of the ensemble of possible parameter
choices. We can thus write the total posterior likelihood
as P ({θ}|G) = e−Σ/P (G), with Σ = L({θ}) + S(G|{θ}).
The value Σ is the description length of the data [38, 39],
i.e. the total amount of information required to describe
the observed data conditioned on a set of parameters as
well as the parameter set itself [43]. Hence, if we maxi-
mize P ({θ}|G) we are automatically finding the parame-
ter choice that compresses the data most, since it will also



3

minimize its description length Σ. Because of this, there
is no difference between specifying probabilistic models
for both G and {θ}, or encoding schemes that quantify
the amount of information necessary to describe both.
In the following, we will make use of both terminologies
interchangeably, whenever most appropriate.

A. Overlapping model without degree correction

The main feature we want to consider in our generative
model is the existence of well-defined groups of nodes,
which are connected to other groups with arbitrary prob-
abilities, such that nodes belonging to the same group
play a similar role in the large-scale network structure.
We also want to include the possibility of nodes belonging
to more than one group, and in so doing inherit the topo-
logical properties of all groups to which they belong. In
order to implement this, we consider a simple variation of
the stochastic block model [17, 44–46] with N nodes and
E edges, where the nodes can belong to different groups.
Hence, to each node i we attribute a binary mixture vec-
tor~bi with B entries, where a given entry bri ∈ {0, 1} spec-
ifies whether or not the node belongs to block r ∈ [1, B].
In addition to this overlapping partition, we simply define
the edge-count matrix {ers}, which specifies how many
edges are placed between nodes belonging to blocks r
and s (or twice that number for r = s, for convenience
of notation), where we have

∑
rs ers = 2E. This sim-

ple definition allows one to generate a broad variety of
overlapping patterns, which are not confined to purely as-
sortative structures, and the nonoverlapping model can
be recovered as a special case, simply by putting each
node in a single group.

The likelihood of observing a given graph with
the above constraints is simply P (G|{~bi}, {ers}) =
1/Ω({~bi}, {ers}), where Ω({~bi}, {ers}) is the number of
possible graphs, and St = ln Ω({~bi}, {ers}) is the associ-
ated ensemble entropy. In this construction, the existence
of multiple edges is allowed. However, the placement of
multiple edges between nodes of blocks r and s should
occur with a probability proportional to O(ers/nrns),
where nr is the number of nodes which belong to block
r, i.e. nr =

∑
i b
r
i (note that

∑
r nr ≥ N). Since here

we are predominantly interested in the sparse situation
where ers ∼ O(N/B2) and nr ∼ O(N/B), the proba-
bility of observing parallel edges will decay as O(1/N),
and hence can be neglected in the large network limit.
Making use of this simplification, we may approximately
count all possible graphs generated by the parameters
{~bi}, {ers} as the number of graphs where each distinct
membership of a single node is considered to be a dif-
ferent node with a single membership. This corresponds
to an augmented graph generated via a nonoverlapping
block model with N ′ =

∑
r nr nodes, where N

′ ≥ N , but

with the same matrix {ers}, for which the entropy is [42]

St ' E −
1

2

∑
rs

ers ln

(
ers
nrns

)
, (1)

where nrns � ers was assumed. Under this formulation,
we recover trivially the single-membership case simply
by assigning each node to a single group, since Eq. 1
remains the same in that special case. It is possible to
remove the approximation that no parallel edges occur,
by defining the model somewhat differently, as in shown
in Appendix B 1, in which case the Eq. 1 holds exactly
as long as no parallel edges are observed.

Like its nonoverlapping counterpart, the block model
without degree correction assumes that nodes belonging
to the same group will receive approximately the same
number of edges of that type. Hence, when applied to
empirical data, the modules discovered will also tend to
have this property. This means that if the graph pos-
sesses large degree variability, the groups inferred will
tend to correspond to different degree classes [19]. On a
similar vein, if a node belongs to more than one group,
it will also tend to have a total degree that is larger
than nodes that belong to either group alone, since it
will receive edges of each type in an independent fashion.
In other words, the group intersections are expected to
be strictly denser than the nonoverlapping portions of
each group. Note that, in this respect, this model differs
from other popular ones, such as the mixed membership
stochastic block model (MMSBM) [18], where the den-
sity at the intersections is the weighted average of the
groups (see Appendix B 1).

B. Overlapping model with degree correction

In the preceding model, nodes that belong to the same
group mixture receive, on average, the same number of
connections. This means that the group membership is
the only factor regulating the propensity of a given node
to receive links. An alternative possibility, formulated
by Karrer et al [19], is to consider that the nodes have
individual propensities to connect themselves, which are
not necessarily correlated with their group memberships.
Therefore, in this “degree-corrected” model, nodes of the
same group are allowed to possess very different degrees.
It has been demonstrated in Ref. [19] that this model
yields more intuitive partitions for many empirical net-
works, suggesting that these intrinsic propensities may
be a better model for these systems. In an analogous
manner, a multiple membership version of the stochastic
block model with degree correction can be defined. This
can be achieved simply by specifying, in addition to the
overlapping partition {~bi}, the number of half-edges in-
cident on a given node i which belong to group r, i.e.
kri . The combined labeled degree of a node i is denoted
~ki = {kri }. Given this labeled degree sequence, one can
simply use the same edge count matrix {ers} as before



4

to generate the graph. If we again make the assumption
that the occurrence of parallel edges can be neglected, the
total number of graphs fulfilling these constraints is ap-
proximately equal to the nonoverlapping ensemble where
each set of half-edges incident on any given node i that
belongs to the same group r is considered as an individ-
ual node with degree kri , for which the ensemble entropy
is [42]

Sd ' −E −
1

2

∑
rs

ers ln

(
ers
eres

)
−
∑
ir

ln kri !, (2)

where ers(
〈
k2
〉
r
− 〈k〉r)(

〈
k2
〉
s
− 〈k〉s)/〈k〉

2
r〈k〉

2
s � nrns

has been assumed. Similarly to the non-degree-corrected
case, it is possible to remove the approximation that no
parallel edges occur, by using a “Poisson” version of the
model, as is shown in Appendix B 2. Under this formula-
tion, it can be shown that this model is equivalent to the
one proposed by Ball et al [20], although here we keep
track of the individual labels on the half-edges as latent
variables, instead of their probabilities.

Since we incorporate the labeled degree sequence as
model parameters, nodes that belong to the same group
can have arbitrary degrees. Furthermore, since the same
applies to nodes that belong simultaneously to more
than one group, the overlaps between groups are nei-
ther preferably dense nor sparse; it all depends on the
parameters {~ki}.

III. MODEL SELECTION

As discussed previously, in order to perform model se-
lection, it is necessary to include the information needed
to describe the model parameters, in addition to the data.
The parameters which need to be described are the over-
lapping partition {~bi}, the edge counts {ers}, and in the
case of the degree-corrected model we also need to the
describe the labeled degree sequence {~ki}.

When choosing an encoding for the parameters (via a
particular generative process) we need to avoid redun-
dancy, and describe them as parsimoniously as possible,
while at the same time averting biases by being nonin-
formative. In the following, we systematically employ
two-level Bayesian hierarchies, where discrete prior dis-
tributions are parametrized via generic counts, which are
themselves sampled from uniform nonparametric hyper-
priors.

A. Overlapping partition, {~bi}

In order to specify the partition {~bi}, we assume that
all different 2B − 1 mixtures are not necessarily equally
likely, and furthermore the sizes di =

∑
r b
r
i of the mix-

tures are also not a priori assumed to follow any specific
distribution. More specifically, we consider the mixtures

to be the outcome of a generative process with two steps.
We first generate the local mixture sizes {di}, from a non-
parametric distribution. Then, given the mixture sizes,
we generate the actual mixtures {~bi} for each correspond-
ing subset of the nodes, again using a nonparametric dis-
tribution, conditioned on the mixture size size.

The mixture sizes {di} are sampled uniformly from
the distribution with fixed counts {nd}, where nd is the
number of nodes with a mixture of size di = d, with a
likelihood

P ({di}|{nd}) =
∏
d nd!

N !
. (3)

For the counts {nd} we assume a flat prior P ({nd}) =
1/
((
D
N

))
, where D is the maximum value of d, and the

denominator is the total number of different choices of
{nd}, with

((
n
m

))
=
(
n+m−1

m

)
being the total number of

m-combinations with repetitions from a set of size n.
Then, for all nd nodes with the same value of di = d,

we sample a sequence of {~bi}d from a distribution with
support |~bi|1 ≡

∑
r b
r
i = d and with fixed counts {n~b}d,

where n~b is the number of nodes belonging to a specific
mixture ~bi = ~b of size d,

P ({~bi}d|{n~b}d) =
∏
|~b|1=d n~b!

nd!
. (4)

For the counts themselves, we again assume a flat prior
P ({n~b}d|nd) = 1/

((
(Bd)
nd

))
, where the denominator enu-

merates the total number of {n~b} counts with |~b|1 = d.
The full posterior for the overlapping partition then

becomes

P ({~bi}) =

[∏
d

P ({~bi}d|{n~b}d)P ({n~b}d|nd)

]
×

P ({di}|{nd})P ({nd}), (5)

which corresponds to a description length Lp =
− lnP ({~bi}),

Lp = ln
((
D
N

))
+
∑
d

ln
((

(Bd)
nd

))
+ lnN !−

∑
~b

lnn~b!. (6)

Although it is possible to encode the partition in dif-
ferent ways (e.g. by sampling the membership to each
group independently [47]), this choice makes no assump-
tions regarding the types of overlaps that are more likely
to occur, either according to the number of groups to
which a node may belong, or the actual combination of
groups — it is all left to be learned from data. In particu-
lar, it is not a priori assumed that if many nodes belong
to two specific groups then the overlap between these
same groups will also contain many nodes. As desired,
if the observed partition deviates from this pattern, this
will be used to compress it further. Only if the observed



5

partition falls squarely into this pattern will further com-
pression be impossible, and we would have an overhead
describing it using Eq. 6, when compared to an encoding
that expects it a priori. However, one can also see that
in the limit n~b � 1, as the first two terms in Eq. 6 grow
asymptotically only with lnN and lnnd, respectively, the
whole description length becomes Lp ' NH({n~b/N}),
where H({px}) is the entropy of the distribution {px},
which is the optimal limit. Hence if we have a prior
that better matches the observed overlap, the difference
in description length compared to Eq. 6 will disappear
asymptotically for large systems. Another advantage of
this encoding is that it incurs no overhead when there
are no overlaps at all (i.e. D = 1), and in this case, the
description length is identical to the nonoverlapping case,

Lp(D = 1) = ln
((
B
N

))
+ lnN !−

∑
r

lnnr!, (7)

as defined in Ref. [7].

B. Labeled degree sequence, {~ki}

For the degree-corrected model, we need to describe
the labeled degree sequence {~ki}. We need to do so in a
way which is compatible with the partition {~bi} described
so far, and with the edge counts {ers}, which will restrict
the average degrees of each type.

In order to fully utilize the partition {~bi}, we describe
for each distinct value of ~bi = ~b its individual degree se-
quence {~ki}~b = {~ki|~bi = ~b}, via the counts n

~b
~k
, i.e. the

number of nodes with mixture ~bi = ~b which possess la-
beled degree ~ki = ~k. We do so in order to preserve the
lack of preference for patterns involving the degrees in the
overlaps between groups. Since the model itself is agnos-
tic with respect to the density of the overlaps, not only
does this choice remain consistent with this indifference,
but also any existing pattern in the degree sequence in
the overlaps will be used to construct a shorter descrip-
tion.

In addition, we must also consider the total number of
half-edges of a given type r incident on a partition~b, er~b =∑
~k krn

~b
~k
, where kr is the element of ~k corresponding to

group r, which must be compatible with the edge counts
{ers} via er =

∑
s ers =

∑
~b e

r
~b
.

An overview of the generative process is as follows:
We first consider the er half-edges of each type r and
the nonempty (n~b > 0) mixtures ~b which contain the
same group r. We then distribute the labeled half-edges
among these mixtures, obtaining the total number of la-
beled edges incident on each mixture, {er~b}. This place-
ment constrains the average degree of each type inside
each mixture. Finally, given {er~b}, we sample the actual
labeled degree sequence on the nodes of each mixture.

We begin by first distributing all er half-edges of type
r among all mr bins corresponding to each nonempty

mixture ~b that contains the label r, i.e. mr =
∑
~b br[n~b >

0]. The total number of such partitions is simply
((
mr
er

))
,

and hence the likelihood for {er~b} becomes

P ({er~b}|{ers}, {
~bi}) =

((
mr
er

))−1
. (8)

Given {er~b}, we need to distribute the labeled half-edges
inside each partition to obtain each degree sequence. If
we sample uniformly from all possible degree sequences
fulfilling all necessary constraints, we have a likelihood
for the degree sequence inside a mixture ~b given by

P
(1)
~b

({~ki}~b|{e
r
~b
}, {~bi}) =

∏
r

((
n~b
er~b

))−1
, (9)

where
((
n
e

))
is the total number of (unlabeled) degree se-

quences with a total of e half-edges incident on n nodes.
The corresponding description length would then be

L(1)~b =
∑
r

ln

((
n~b
er~b

))
. (10)

However, most degree sequences sampled this way will
result in nodes with very similar degrees. Since we want
to profit from degree variability, it is better to condition
the description on the degree counts {n~b~k}, i.e. how many
nodes with mixture ~bi = ~b possess labeled degree ~ki = ~k.
This alternative distribution is given by

P
(2)
~b

({~ki}~b|{n
~b
~k
}, {~bi}) =

∏
~k n

~b
~k
!

n~b!
. (11)

For the degree counts themselves, we choose a uniform
prior P ({n~b~k}|{e

r
~b
}, {~bi}) = 1/Ξ~b, where Ξ~b is the enu-

meration of all possible {n~b~k} counts that fulfill the con-
straints

∑
~k n

~b
~k

= n~b and
∑
~k krn

~b
~k

= er~b . Unfortu-
nately, this enumeration cannot be done easily in closed
form. However, the maximum entropy ensemble where
these constraints are enforced on average is analytically
tractable, and as we show in Appendix C, can be well
approximated by Ξ~b =

∏
r∈~b Ξ

r
~b
, where

ln Ξr~b ' 2
√
ζ(2)er~b

, (12)

and ζ(x) is the Riemann zeta function. The alternative
description length becomes therefore

L(2)~b =
∑
r∈~b

ln Ξr~b + lnn~b!−
∑
~k

lnn
~b
~k
!. (13)

This approximation with “soft” constraints should be-
come asymptotically exact as the number of nodes be-
comes large, but otherwise will deviate from the actual



6

entropy. On the other hand, if the number of nodes is
very small, describing the degree sequence via Eq. 13 may
not provide a shorter description, even if computed ex-
actly. In this situation, Eq. 10 may actually provide a
shorter description of the degree sequence. We therefore
compute both Eq. 10 and Eq. 13 and choose whichever
is shorter. Putting it all together, the complete posterior
for the whole labeled degree sequence is

P ({~ki}|{ers}, {~bi}) =

∏
~b

P~b({~ki}~b|{e
r
~b
}, {~bi})

×
P ({er~b}|{ers}, {

~bi}), (14)

with P~b({~ki}~b|{e
r
~b
}, {~bi}) being the largest

choice between P (1)~b ({
~ki}~b|{e

r
~b
}, {~bi}) and

P
(2)
~b

({~ki}~b|{n
~b
~k
})P ({n~b~k}|{e

r
~b
}, {bi}). Therefore, the

description length for the labeled degree sequence
Lκ = − lnP ({~ki}|{ers}, {bi}) becomes

Lκ =
∑
r

ln
((
mr
er

))
+
∑
~b

min
(
L(1)~b ,L

(2)
~b

)
. (15)

In the limit n~b~k � 1, we have that Lκ '∑
~b n~bH({n

~b
~k
/n~b}), and hence the degree sequences in

each partition are described close to the optimum limit.
For the nonoverlapping case with D = 1, the descrip-

tion length simplifies to

Lκ =
∑
r

min
(
L(1)r ,L(2)r

)
, (16)

with

L(1)r = ln
((
nr
er

))
, (17)

L(2)r = ln Ξr + lnnr!−
∑
k

lnnrk!, (18)

and ln Ξr ' 2
√
ζ(2)er. For nr � 1 we obtain Lκ '∑

r nrH({nrk/nr}). This approximation was used a pri-
ori in Ref. [7], but Eq. 16 is a more complete description
length of the nonoverlapping degree sequence, and its use
should be preferred. Hence, like the description length of
the overlapping partition, the encoding above offers no
overhead when the partition is nonoverlapping.

C. Edge counts, {ers}

The final piece that needs to be described is the ma-
trix of edge counts {ers}. We may view this set as
an adjacency matrix of a multigraph with B nodes and
E =

∑
rs ers/2 edges. The total number of such matri-

ces is Ω(B,E) =
((

(B2)
E

))
, and if we assume that they

are all equally likely, we have P ({ers}) = 1/Ω(B,E) and
ln Ω(B,E) can be used as the description length [48].
There are, however, two problems with this approach.
First, this uniform distribution is unlikely to be valid,
since most observed networks still possess structure at
the block level. Second, this assumption leads to a limit
in the detection of small groups, with a maximum de-
tectable number of groups scaling as Bmax ∼

√
N [48].

Similarly to what we did for the node partition and the
degree sequence, this can be solved by considering a gen-
erative model for the edge counts themselves, with its
own set of hyperparameters. Since they correspond to
a multigraph, a natural choice is the stochastic block
model itself, which has its own set of edge counts, that
can themselves be modeled by another stochastic block
model with fewer nodes, and so on, recursively, until one
has a model only one node and one group at the top. This
nested stochastic block model was proposed in Ref. [7],
where it has been shown to reduce the resolution limit to
Bmax ∼ N/ logN , making it often significantly less rele-
vant in practice. Furthermore, since the number of levels
and the topology at each level is obtained by minimizing
the overall description length, it corresponds to a fully
nonparametric way of inferring the multilevel structure
of networks. As shown in Ref. [7], if we denote the ob-
served network to be at the level l = 0 of the hierarchy,
then the total description length is

Σ = St/c +
L∑
l=1

Sm({elrs}, {nlr}) + Ll−1t , (19)

with {elrs}, {nlr} describing the block model at level l,
where

Sm =
∑
r>s

ln
((
nrns
ers

))
+
∑
r

ln
((

((nr2 ))
err/2

))
(20)

is the entropy of the corresponding multigraph ensemble
and

Llt = ln
((

Bl
Bl−1

))
+ lnBl−1!−

∑
r

lnnlr!. (21)

is the description length of the node partition at level
l > 0. For the level l = 0 we have L0t = Lp given by
Eq. 6, or L0t = Lp + Lκ for the degree-corrected model.

Note that here we use the single-membership non-
degree-corrected model in the upper layers. This method
could be modified to include arbitrary mixtures of degree
correction and multiple membership, but we stick with
this formulation for simplicity.

D. Significance levels

By minimizing the description length Σ, we select the
model that is most favored given the evidence in the data.
But in some situations, one is not merely interested in a
binary answer regarding which of two model choices is



7

best, but instead, one would like to be able to rule out
alternative models with some degree of confidence. In
this case, a level of significance can be obtained by per-
forming a Bayesian hypothesis test based on the ratio of
posterior likelihoods. In this context, there are different
hypotheses which can be tested. For instance, one could
ask whether the entire class of non-degree-corrected over-
lapping models (NDCO) is favored in comparison to the
class of nonoverlapping degree-corrected models (DC).
This can be done by computing the posterior distribu-
tion for each model class H ∈ {NDCO,DC},

P (H|G) =
∑
θ P (G|θ,H)P (θ)P (H)

P (G)
, (22)

where θ is shorthand for the entire set of model pa-
rameters [i.e. θ = ({~bi}, {ers}) for H = NDCO, and
θ = ({bi}, {ers}, {ki}) for H = DC], with P (H) being
the prior belief we have supporting a given hypothesis,
and P (G) is a normalizing constant. The standard way
in Bayesian statistics to evaluate the relative evidence
supporting (or rejecting) hypothesis H1 over H2 is via
the posterior odds ratio [49]

Λ =
P (H1|G)
P (H2|G)

=

∑
θ P (G|θ,H1)P (θ)∑
θ P (G|θ,H2)P (θ)

P (H1)
P (H2)

. (23)

However, there are two issues with this approach. First,
computing the sum over all parameter choices is in-
tractable in this context, since it involves summing over
all possible overlapping or nonoverlapping partitions.
Second, and more importantly, this might not be the an-
swer which is more relevant. If one obtains two model
parametrizations by minimizing the description length
as described in the previous section, with the two re-
sults belonging to different model classes, one would be
more interested in selecting or rejecting between these
two particular choices, not necessarily the overall class
to which they belong. Although the description length
itself already provides a means to select the best alter-
native, one would be interested in obtaining a confidence
level for this particular decision. This is a different sort
of hypothesis test than the one above, but which can be
performed analogously. Since the result of the minimiza-
tion of the description length is the (possibly overlapping)
partition of the network, our hypothesis is a combination
of the model class which we were using, and the partic-
ular partition that was found. The posterior probability
attributed to this hypothesis is therefore

P ({~bi},H|G) =
P (G|{~bi},H)P ({~bi}|H)P (H)

P (G)
, (24)

where again P (G) is a normalization constant. The
marginal likelihood P (G|{~bi},H) is obtained by summing
over the remaining model parameters. In the case of the
overlapping degree-corrected model (H = DCO) they are
the {ers} matrix and the labeled degree sequence {~ki}

(which is omitted for the non-degree-corrected model,
H = NDCO),

P (G|{~bi},DC) =
∑

{e′rs},{~k′i}

P (G|{~bi}, {e′rs}, {~k′i})×

P ({e′rs})P ({~k′i})

= P (G|{~bi}, {ers}, {~ki})P ({ers})P ({~ki}),
(25)

where the sum trivially contains only one term, since
for the same graph G and partition {~bi}, there is only
one possible choice for the {ers} matrix and degree se-
quence {~ki} with nonzero probability, which is a conve-
nient feature of the microcanonical model formulation
considered here [the same holds for H = NDC, i.e.
P (G|{~bi},NDC) = P (G|{~bi}, {ers})P ({ers})]. Now if
we want to compare two competing partitions {~bi}a and
{~bi}b, this can be done again via the posterior odds ratio
Λ,

Λ =
P ({~bi}a,Ha|G)
P ({~bi}b,Hb|G)

(26)

=
P (G|{~bi}a,Ha)P ({~bi}a|Ha)P (Ha)
P (G|{~bi}b,Hb)P ({~bi}b|Hb)P (Hb)

(27)

= exp (−∆Σ) , (28)

with ∆Σ = Σa − Σb being the difference in the de-
scription length, and in Eq. 28 it was assumed that
P (Ha) = P (Hb) = 1/2, corresponding to a lack of a
priori preference for either model variant (which, in fact,
makes Λ identical to the Bayes factor [50]). This is a
simple result, which enables us to use the difference
in the description length directly in the computation
of confidence levels. Being a ratio of probabilities, the
value of Λ has a straightforward interpretation: For a
value of Λ = 1, both models explain the data equally
well, and for values of Λ < 1 model a is rejected in favor
of b with a confidence increasing as Λ diminishes. In
order to simplify its interpretation, the values of Λ are
usually divided into regions corresponding to a subjec-
tive assessment of the evidence strength. A common
classification is as follows [50]: Values of Λ in the intervals
{[1, 1/3], [1/3, 1/10], [1/10, 1/30], [1/30, 1/100], [1/100, 0]}
are considered to be very weak, substantial, strong,
very strong and decisive evidence supporting model b,
respectively. In the following, when comparing different
models, we will always put the preferred model in the
denominator of Eq. 27, such that Λ ≤ 1.

Using the posterior odds ratio Λ is more practical than
some alternative model selection approaches, such as like-
lihood ratios. As has been recently shown [29], the like-
lihood distribution for the stochastic block model does
not follow a χ2-distribution asymptotically for sparse
networks, and hence the calculation of a p-value must
be done via an empirical computation of the likelihood



8

10−8
10−4

100

Λ

2 3 4 5 6 7 8

B

10−100
10−75
10−50
10−25

100

Λ

DC,D > 1

DC,D = 1

NDC,D > 1

NDC,D = 1

B = 5,
non-degree-corrected,
overlapping, Λ = 1

B = 4,
non-degree-corrected,

overlapping, Λ ' 2× 10−4,

10−4
10−2

100

Λ

5 6 7 8 9 10 11

B

10−50
10−37
10−24
10−11

Λ

DC,D > 1

DC,D = 1

NDC,D > 1

NDC,D = 1

B = 10,
non-degree-corrected,
nonoverlapping, Λ = 1

B = 9,
non-degree-corrected,

nonoverlapping, Λ ' 0.36

Figure 1. Left: Values for posterior odds ratio Λ for the network of co-appearances of characters in the novel “Les Misérables”,
for all model variations (D > 1 indicates an overlapping model, “DC” a degree-corrected model and “NDC” a non-degree-
corrected one). The models with the best and second-best fits are shown at the bottom. Right: Same as in the left, but for
the American college football network.

distribution which is computationally costly, and pro-
hibitively so for very large networks. In contrast, com-
puting Λ can be done easily, and it properly accounts for
the increased complexity of models with larger parame-
ters, and protects against overfitting. However, it should
be emphasized that these different model selection ap-
proaches are designed to answer similar, but not iden-
tical questions. Therefore the most appropriate method
should be the one that more closely matches the ques-
tions raised.

IV. EMPIRICAL NETWORKS

The method outlined in the previous section allows
one to determine the best model from the various avail-
able choices. Here we analyze some empirical examples,
and determine the most appropriate model, and examine
the consequences of the balance struck between model
complexity and quality of fit. We start with two small
networks, the co-appearance of characters in the Victor
Hugo novel “Les Misérables” [54], and a network of Amer-
ican college football games [13, 55]. For both networks,
we obtain the best partition according all model varia-

tions and for a different number of groups B, and we com-
pute the value of Λ relative to the best model, as shown
in Fig. 1. For the “Les Misérables” network, the best
fit is a non-degree-corrected overlapping model that puts
the most central characters in more than one group. All
other partitions for different values of B and model types
result in values significantly below the plausibility line of
Λ = 10−2, indicating that the overlapping model offers a
better explanation for the data with a large degree of con-
fidence. In particular, it offers a better description than
the nonoverlapping model with degree correction. For
the football network, on the other hand, the preferred
model is nonoverlapping and without degree correction
with B = 10, which matches very well the assumed cor-
rect partition into 10 conferences. The groups are rela-
tively homogeneous, with most nodes having similar de-
grees, such that degree correction becomes an extra bur-
den, with very little added explanatory power. For this
network, however, there are alternative fits with values
of Λ within the plausibility region, which means that the
communities are not very strongly defined, and they ad-
mit alternative partitions with B = 9 and B = 8 groups
which cannot be confidently discarded given the evidence
in the data.

Degree correction tends to become a better choice for



9

B = 7, overlapping, degree-corrected, Λ = 1 B = 12, nonoverlapping, degree-corrected, log10 Λ ' −747

Figure 2. The network of political blogs by Adamic et al [51]. The left panel shows the best model with an overlapping partition,
and the right shows the best nonoverlapping one. Nodes with a blue halo belong to the Republican faction, as determined in
Ref. [51]. For the visualization, the hierarchical edge-bundles algorithm [52] was used.

larger data sets, which display stronger degree variabil-
ity. One example of this is the network of political blogs
obtained by Adamic et al [51]. For this network, the best
model is a degree-corrected, overlapping partition into
B = 7 groups, shown in Fig. 2. Compared to this parti-
tion, the best alternative model without overlap divides
the network into B = 12 groups1, but has a posterior
odds ratio significantly below the plausibility region. It
should be observed that the nonoverlapping version cap-
tures well the segregation into two groups (Republicans
and Democrats) at the topmost level of the hierarchy.
The overlapping version, on the other hand, tends to clas-
sify half-edges belonging to different camps into different
groups, which is compatible with the accepted division,
but the upper layers of the hierarchy do not reflect this,
and prefers to merge together groups that belong to dif-
ferent factions, but that have otherwise similar roles in
the topology.

Overlapping partitions, however, do not always provide
better descriptions, even in situations where it might be
considered more intuitive. One of the contexts where
overlapping communities are often considered to be bet-
ter explanations is in social networks, where different so-
cial circles could be represented as different groups (e.g.

1 In Ref. [7] using the same nonoverlapping model, a value of B =
15 was found. This is due the difference in the description length
for the degree sequence, where here we use a more complete
estimation than in Ref. [7], which results in this slight difference.

family, co-workers, friends, etc.), and one could belong
to more than one of these groups. This is illustrated well
by so-called “ego networks,” where one examines only the
immediate neighbors of a node, and their mutual connec-
tions. One such network, extracted from the Facebook
online social network [53], is shown in Fig. 3. The com-
mon interpretation of networks such as these is shown on
the right in Fig. 3, and corresponds to a partition of the
central “ego” node so that it belongs to all of the different
circles. Under this interpretation, the ego node is only
special in the sense that it belongs to all groups, but in-
side each group it is just a common member. However,
among all model variants, the best fit turns out to be
the one where the ego node is put separately in its own
group, as shown in the left in Fig. 3. In this example it is
easy to see why this is the case: If we observe the degree
distribution inside each group for the network on the left,
we see that there is no strong degree variation. On the
right, as the ego is included in each group, it becomes sys-
tematically the most connected node. This is simply by
construction, since the ego must connect to every other
node. The only situation where the ego would not stand
out inside each group, would be if the communities were
cliques. Hence, since the ego is not a typical member
of any group, it is simpler to classify it separately in its
own group, which is selected by the method as a being a
more plausible hypothesis. Note that degree correction
is not selected as the most plausible solution, since it is
burdened with the individual description of every degree
in the network, which is fairly uniform with the excep-



10

0 8 16 24

k

0
1
2
3
4

n
k

0 3 6

k

0

2

4

n
k

0 3 6 9

k

0

1

2

3

n
k

4 8 12

k

0

1

2

3

n
k

0 8 16 24

k

0
1
2
3
4

n
k

0 5 10 15 20

k

0

2

4

6

n
k

3 6 9

k

0

1

2

3

n
k

4 8 12 16

k

0

1

2

3

n
k

B = 5, overlapping,
non-degree-corrected, Λ = 1

B = 4, overlapping,
non-degree-corrected,

Λ ' 0.053

Figure 3. Ego network of Facebook contacts [53]. Left: The
best model fit across all model variations, which puts the ego
node in its own group. Right: The alternative hypothesis
where the node is split in several groups. Below each network
are shown the degree distributions inside each group. The
arrow marks the degree of the ego node.

tion of the ego. One can imagine a different situation
where there would be other very well connected nodes
inside each group, so that the ego could be described as
a common member of each group, but this not observed
in any other network obtained in Ref. [53]. Naturally,
if one considers the complete network, of which the ego
neighbourhood is only a small part, the situation may
change, since there may be members of each group to
which the ego does not have a direct connection.

When performing model selection for larger net-
works, it is often the case that the overlapping mod-
els are not chosen. In table I are shown the results
for many empirical networks belonging to different do-
mains. For the majority of cases, the nonoverlapping
degree-corrected models are selected. The are, how-
ever, many exceptions which include two social net-
works (Gowalla and Brightkite [61]), the global air-
port network of openflights.com, the neuronal net-
work of C. elegans [62], the political blog network al-
ready mentioned, the arXiv co-authorship networks [63]
[in the fields of general relativity and quantum cos-
mology (gr-qc), high-energy physics (hep-th), condensed
matter (cond-mat), and astronomy (astro-ph)], co-
authorship in network science [64], and the network
of genes implicated in diseases [66], for which some
version of the overlapping model is chosen. Inter-
estingly, for the arXiv co-authorship network in high-
energy physics/phenomenology (hep-ph) a nonoverlap-
ping model is selected instead. For only one of the
remaining four arXiv networks (astro-ph), the degree-

No. N 〈k〉 log10 ΛDCO log10 ΛDC log10 ΛNDCO log10 ΛNDC B 〈d〉 Σ/E
1 34 4.6 −2.1 −2.1 — 0 2 1 4
2 62 5.1 −4.6 −1.4 — 0 2 1 4.8
3 77 6.6 −17 −7.7 0 −7.3 5 1.1 4
4 105 8.4 −12 −2.8 −6.6 0 5 1 4.4
5 115 10.7 −79 −27 — 0 10 1 4.3
6 297 15.9 0 −61 −2.0× 102 −2.1× 102 5 1.8 5.1
7 379 4.8 −47 −6.6 0 −8.9 20 1.1 6.2
8 903 15.0 −3.8× 102 −3.7× 102 0 −3.7× 102 60 1.2 3.1
9 1, 278 2.8 −8.1 0 −1.5× 102 −89 2 1 7.4
10 1, 490 25.6 0 −5.2× 102 −2.3× 103 −2.3× 103 7 1.8 4.4
11 1, 536 3.8 −2.5× 102 0 −65 −62 38 1 6.7
12 1, 622 11.2 −4.3× 102 0 −12 −82 48 1 3.3
13 1, 756 4.5 −43 0 −4.0× 102 −2.8× 102 7 1 5.9
14 2, 018 2.9 −9.2 0 −2.9× 102 −2.1× 102 2 1 8.5
15 4, 039 43.7 −1.5× 103 0 −8.1× 102 −9.5× 102 158 1 3.2
16 4, 941 2.7 −2.2× 102 0 −21 −25 25 1 11
17 7, 663 17.8 0 −1.1× 104 −5.3× 103 −1.6× 104 85 1 3.2
18 7, 663 5.3 −1.8× 103 0 −9.3× 102 −7.3× 102 63 1 5
19 8, 298 25.0 −9.1× 103 0 −1.4× 104 −1.4× 104 34 1 5.4
20 9, 617 7.7 −4.2× 103 0 −2.3× 103 −2.5× 103 34 1 9.3
21 26, 197 2.2 −2.4× 103 −1.2× 103 0 −2.7× 103 363 1.3 4.5
22 36, 692 20.0 −4.1× 104 0 −8.5× 104 −2.8× 104 1812 1 5.5
23 39, 796 15.2 −6.1× 104 0 −8.8× 104 −4.5× 104 1323 1 6.3
24 52, 104 15.3 −1.5× 105 0 −3.7× 104 −4.0× 104 172 1 6.4
25 58, 228 14.7 0 −5.8× 104 −1.8× 105 −1.4× 105 1995 3.2 7.3
26 65, 888 305.2 −4.4× 104 0 −4.6× 105 −4.6× 105 384 1 4.1
27 68, 746 1.5 −4.8× 103 −1.4× 103 0 −7.0× 103 719 1.4 6.4
28 75, 888 13.4 −1.1× 105 0 −8.2× 104 −9.0× 104 143 1 8.9
29 89, 209 5.3 −1.0× 104 0 −9.7× 103 −1.1× 104 848 1 3.2
30 108, 300 3.5 −3.3× 103 −5.2× 103 0 −2.4× 104 1660 1.8 5.7
31 133, 280 5.9 0 −4.4× 103 −7.4× 104 −3.8× 104 1944 5.3 4.4
32 196, 591 19.3 0 −1.9× 105 −7.1× 105 −6.6× 105 6856 3.7 7.8
33 265, 214 3.2 −1.4× 104 0 −9.2× 104 −8.5× 104 549 1 8.6
34 273, 957 16.8 −5.4× 105 0 −4.6× 104 −7.2× 104 727 1 5.8
35 281, 904 16.4 −1.2× 106 0 −2.8× 105 −1.5× 105 6655 1 4.3
36 317, 080 6.6 −1.7× 105 0 −3.9× 105 −4.2× 105 8766 1 11
37 325, 729 9.2 −5.8× 105 0 −1.1× 106 −2.3× 105 4293 1 5.8
38 325, 729 9.2 −5.6× 105 0 −1.2× 106 −2.5× 105 3995 1 5.8
39 334, 863 5.5 −3.3× 105 0 −3.6× 105 −3.4× 104 9118 1 11
40 372, 787 9.7 −1.0× 106 0 −1.3× 105 −1.4× 105 965 1 11
41 463, 347 20.3 −6.4× 105 0 −1.8× 106 −1.5× 106 9276 1 9.3
42 1, 134, 890 5.3 — 0 −4.5× 105 −4.9× 105 264 1 13
1 Karate Club [56] 22 Enron emails [57, 58]
2 Dolphins [59] 23 PGP [60] (directed)
3 Les Misérables [54] 24 Internet AS (Caida)a (directed)
4 Political Booksb 25 Brightkite social network [61]
5 American football [13, 55] 26 netflix-pruned-smaller-u
6 C. elegans Neurons [62] (directed) 27 arXiv Co-Authors (hep-th) [63]
7 Coauthorships in network science [64] 28 Epinions.com trust network [65] (directed)
8 Disease Genes [66] 29 arXiv Co-Authors (hep-ph) [63]
9 Yeast protein interactions (CCSB-YI11) [67] 30 arXiv Co-Authors (cond-mat) [63]
10 Political Blogs [51] (directed) 31 arXiv Co-Authors (astro-ph) [63]
11 Yeast protein interactions (LC) [68] 32 Gowalla social network [61]
12 Yeast protein interactions (Combined AP/MS) [69] 33 EU email [63] (directed)
13 E. coli gene regulation [70] (directed) 34 Flickr [71]
14 Yeast protein interactions (Y2H union) [67] 35 Web graph of stanford.edu. [72] (directed)
15 Facebook egos [53] 36 DBLP collaboration [73]
16 Power Grid [62] 37 Web graph of nd.edu. [72] (directed)
17 Airport routes c (directed) 38 WWW [74] (directed)
18 Airport routes 39 Amazon product network [73]
19 Wikipedia Votes [75, 76] (directed) 40 IMDB film-actord [48]
20 Human protein interactions (HPRD r9) [77] 41 APS citationse (directed)
21 arXiv Co-Authors (gr-qc) [63] 42 Youtube social network [73]

a Retrieved from http://www.caida.org.
b V. Krebs, retrieved
from http://www-personal.umich.edu/~mejn/netdata/

c Retrieved from http://openflights.org/
d Retrieved from http://www.imdb.com/interfaces.
e Retrieved from http://publish.aps.org/dataset.

Table I. Comparison of different models for many empiri-
cal networks. The columns at the top table correspond to
the dataset number (with the name given at the bottom
table), the number of nodes N , the average degree 〈k〉 =
2E/N , the posterior odds ratios relative to the best model
for the degree-corrected overlapping (ΛDCO), the degree-
corrected nonoverlapping (ΛDC), non-degree-corrected over-
lapping (ΛNDCO) and non-degree-corrected nonoverlapping
(ΛNDC) models. Missing entries correspond to situations
where the best overlapping partition turns out to be nonover-
lapping. The last three columns show some parameters of
the best model: The number of groups B, the average mix-
ture size 〈d〉, and the description length per edge (in bits per
edge).

openflights.com
stanford.edu
nd.edu
http://www.caida.org
http://www-personal.umich.edu/~mejn/netdata/
http://openflights.org/
http://www.imdb.com/interfaces
http://publish.aps.org/dataset


11

corrected version of the overlapping model is selected,
whereas for the other three the non-degree-corrected ver-
sion is preferred. Hence, for co-authorship networks the
model selection procedure seems to correspond to the
intuition that they are composed predominantly of over-
lapping groups [15].

We take the arXiv cond-mat network as a representa-
tive example of the differences between the inferred mod-
els. As can be seen in Fig. 4, although the degree distri-
bution is very broad, the inferred labeled degree distribu-
tion is narrower, meaning that many large-degree nodes
can be well explained as having a smaller degree of any
single type, but belonging simultaneously to many groups
(in the specific context of this network, prolific authors
tend to be the ones which belong to many different types
of collaborations). The distribution of mixture sizes nd
has almost always a maximum at d = 1, meaning that
most nodes belong to one group, but with a tail which is
comparatively broad (this seems to be a general feature
which is observed in the majority of networks analyzed).
The distribution of group sizes can be very different, de-
pending on which model is used. nonoverlapping mod-
els without degree correction tend to find groups which
are strongly correlated with degrees [19], and hence lead
to a broad distribution of group sizes when the degree
distribution is also broad. On the other hand, both de-
gree correction and group overlap tend to change the dis-
tribution considerably. In the literature there are often
claims of community sizes following power-law distribu-
tions [21, 78–80] with figures similar to the lower left
panel of Fig. 5. Regardless to the validity of this hy-
pothesis for the various methods used in the literature,
this is certainly not the case for the overlapping model as
shown in the lower right panel of the same figure. Indeed,
for most networks analyzed, the model which best fits the
data (which tends to be degree-corrected and nonoverlap-
ping) shows no vestige of group sizes following a scale-free
distribution. Some further examples of this are shown
in Fig. 5, where characteristic size scales can be clearly
identified.

V. MODEL IDENTIFIABILITY:
OVERLAPPING VS. NONOVERLAPPING

A central issue when selecting between nonoverlap-
ping and overlapping models is to decide when a group
of nodes should belong simultaneously to two or more
groups, of if these nodes should be better represented by
a single membership to a different unique group. The
choice is not always immediately obvious, since we can
always generate very similar networks with either model.
If we generate a network with the overlapping model,
but treat it as if it were generated by the nonoverlapping
model, with each distinct mixture ~b corresponding to a
separate nonoverlapping group, the associated entropy

100 101 102 103

k

10−6
10−5
10−4
10−3
10−2
10−1

100

p
k

Non-overlapping

Overlapping

100 101

d

10−4
10−3
10−2
10−1

100

n
d
/N

100 101

nr

10−4

10−3

10−2

10−1

p
n
r

100 101 102

nr

10−4

10−3

10−2

10−1

p
n
r

Figure 4. Statistical properties of the best model inferred
for the network of arXiv co-authors in the field of condensed
matter (cond-mat). Top left: Degree distribution of the orig-
inal network and of the overlapping model (where the labeled
degree sequence {~ki} is flattened into a single histogram for
all labeled degrees {kri }). Top right: Distribution of mix-
ture sizes, nd. Bottom left: Distribution of group sizes for
the best-fitting nonoverlapping, non-degree-corrected model.
Bottom right: Distribution of group sizes for the best-fitting
overlapping, non-degree-corrected model.

100 101 102

nr

10−5
10−4
10−3
10−2
10−1

p
n
r

100 101 102

nr

10−4

10−3

10−2

p
n
r

100 101 102

nr

10−5
10−4
10−3
10−2
10−1

p
n
r

100 101 102

nr

10−5
10−4
10−3
10−2

p
n
r

Figure 5. Distribution of group sizes for the best fitting non-
degree-corrected nonoverlapping model (left) and the degree-
corrected nonoverlapping model (right), for the PGP [60]
(top) and DBLP collaboration [73] (bottom) networks. In
both cases the degree-corrected model provides a better fit,
as shown in table I.

will be

S ′t ' E −
1

2

∑
~b1~b2

e~b1~b2 ln

(
e~b1~b2
n~b1n~b2

)
, (29)

where

e~b1~b2 =
∑
rs

br1b
s
2

ers
nrns

n~b1n~b2 (30)



12

is the expected number of edges between mixtures ~b1 and
~b2. By exchanging the sums and using Jensen’s inequality
we observe directly that

S ′t ≤ E −
1

2

∑
rs

ers ln

(
ers
nrns

)
, (31)

with the right-hand side being the entropy of original
overlapping model St, and with the equality holding only
if the original model happens to be nonoverlapping to
begin with. Thus, the nonoverlapping model will invari-
ably possess a lower entropy. Nevertheless, the overlap-
ping hypothesis may still be preferred if the number of
groups B is sufficiently smaller than the number of indi-
vidual ~b mixtures, so that the total description length is
shorter. It should be observed, however, that since one
model is contained inside the other, the difference in the
description length can be interpreted simply as the differ-
ence in the prior probabilities for the model parameters.
As the amount of available data increases, the effect of
the priors should “wash out”, and the description length
should be increasingly dominated by the model entropy
alone. In these cases one should expect the nonover-
lapping model to be preferred, regardless of the specific
model which was used to generate the data. However,
differently from models that generate independent data
points, the “amount of available data” for network mod-
els is a finer issue. In the case of the stochastic block
model it involves the simultaneous scaling of the number
of edges E, the number of nodes N and the number of
groups B.

As a case example, here we consider a simple over-
lapping assortative model, with ers = 2E[δrsc/B + (1 −
δrs)(1 − c)/B(B − 1)], with c ∈ [0, 1] controlling the de-
gree of assortativity. The mixtures are parameterized
as n~b = C

∏
r µ

br , with C being a normalization con-
stant, and µ ∈ [0, 1] controlling the degree of overlap.
For µ → 0 we obtain asymptotically a nonoverlapping
partition with nr = N/B, and for µ = 1 all mixtures
~b have the same size. We compare the difference in de-
scription length between this model and its equivalent
parametrization with each mixture as a separate group.
As can be seen in Fig. 6, for any given value of c, there
is a value of µ above which the nonoverlapping model is
preferred. In this parameter region, the group intersec-
tions are sufficiently well populated with nodes, so that
their representation as individual groups is chosen. For
values of µ below this value, the intersections are sig-
nificantly smaller than the nonoverlapping portion. In
this case, the data are better explained as larger groups
of almost nonoverlapping nodes, with few nodes at the
intersections. The boundary separating the two regions
recedes upwards as the number of groups B is increased,
meaning that a larger number of distinct intersections
can compensate for a smaller number of nonoverlapping
nodes. It should also be pointed out that the boundaries
move downwards as the number of nodes and edges is
increased, such that the average degree in the network

0.95 0.96 0.97 0.98 0.99 1.00

c

0.05

0.10

0.15

0.20

µ

(a)

(b)
(c)
(d)

(e)

(f)

(a) B = 2, c = 0.99,
µ = 0.025

(c) B = 3, c = 0.98,
µ = 0.06

(e) B = 4, c = 0.97,
µ = 0.12

(b) B = 3, c = 0.99,
µ = 0.05

(d) B = 7, c = 0.98,
µ = 0.08

(f) B = 15, c = 0.97,
µ = 0.15

Figure 6. Top: Parameter regions for the model considered
in the main text, with N = 103 and 〈k〉 = 2E/N = 20. Each
curve corresponds to one value of B and separates a region
above where the nonoverlapping model is preferred from a
region below where the overlapping model is chosen. Bot-
tom: Networks and their preferred partitions, corresponding
to parameter values indicated in the top panel.

remains the same (not shown), so it is not only the rela-
tive sizes of the intersections that are the relevant proper-
ties, but also their absolute sizes. The same occurs if the
average degree increases and everything else remains con-
stant. Hence, in the limit of sufficient data, either with
the number of nodes inside each group and intersections
becoming sufficiently large, or with each part becoming
sufficiently dense, the nonoverlapping model is the one
which will be selected. For empirical networks, this may
not be the most representative scaling scenario, since the
most appropriate number of groups and degree of over-
lap may in fact follow any arbitrary scaling, and hence
the overlapping model may still be selected, even for very
large or very dense networks. Nevertheless, this example
seems to suggest that the nonoverlapping model is gen-
eral enough to accommodate structures generated by the
overlapping model in these limiting cases, and may serve



13

as a partial explanation to why the overlapping model
is seldom selected in the empirical systems analyzed in
Sec. IV.

VI. INFERENCE ALGORITHM

The inference procedure consists in finding the labeling
of the half-edges of the graph such that the description
length is minimized. Such global optimization problems
are often NP-hard, and require heuristics to be solvable in
practical time. One possibility is to use the Markov chain
Monte Carlo (MCMC) method, which consists in mod-
ifying the block membership of each half-edge in a ran-
dom fashion, and accepting or rejecting each move with
a probability given as a function of the description length
difference ∆Σ. By choosing the acceptance probabilities
in the appropriate manner, i.e. by enforcing ergodicity
and detailed balance, one can guarantee that the label-
ings will be sampled with the correct probability after a
sufficiently long equilibration time is reached. However,
naive formulations of the Markov chain will lead to very
long equilibration times, which become unpractical for
large networks. Here we adapt the algorithm developed
in Ref. [81] for the nonoverlapping case which implements
a fast Markov chain. It consists in the move proposal of
each half-edge incident on node i of type r to type s with
a probability given by

p(r → s|t) = ets + �
et + �B

, (32)

where t is the block labeling the half-edge opposing a
randomly chosen half-edge incident to the same node as
the half-edge being moved, and � ≥ 0 is a free param-
eter. Eq. 32 means that we attempt to guess the label
of a given half-edge by inspecting the group membership
the neighbors of the node to which it belongs, and us-
ing the currently inferred model parameters to choose
the most likely group to which it should be moved. It
should be emphasized that this move proposal does not
result in a preference for either assortative or dissorta-
tive networks, since it depends only on the matrix {ers}
currently inferred. For any choice of � > 0, this move pro-
posal preserves ergodicity, but not detailed balance. This
last characteristic can be enforced via the Metropolis-
Hastings criterion [82, 83] by accepting each move with
a probability a given by

a = min

{
e−β∆Σ

∑
t p
i
tp(s→ r|t)∑

t p
i
tp(r → s|t)

, 1

}
, (33)

where pit is the fraction of opposing half-edges of node i
which belong to block t, and p(s → r|t) is computed af-
ter the proposed r → s move (i.e. with the new values of
etr), whereas p(r → s|t) is computed before. The param-
eter β in Eq. 33 is an inverse temperature, which can be
used to sample partitions according to their description
length (β = 1) or to find the ground state (β →∞). As

B = 2E B = 15

B = 4 B = 4, planted

Figure 7. Typical outcome of the greedy multilevel agglomer-
ative algorithm described in the text, for a network sampled
from the overlapping model with B = 4. The different panels
show the progression of the algorithm from B = 2E to B = 4.
The panel on the lower right shows the planted partition used
to generate the network.

explained in Ref. [81], this move proposal as well as the
computation of a can be done efficiently, with minimal
book-keeping, so that a sweep of the network (where each
half-edge move is attempted once) is done in time O(E),
independent of the number of groups B. This is true
even in the overlapping case, since updating Eqs. 1, 2, 6
and 15 after each half-edge move can be done in time
O(1).

As discussed in Ref. [81], although the MCMC method
above succeeds in equilibrating faster than a naive
Markov chain, it still suffers from a strong dependence
on how close one starts from the global minimum. Usu-
ally, starting from a random partition of the half-edges
leads to metastable states where the Markov chain seems
to have equilibrated, but in fact the network structure
has only been partially discovered, and will move from
such configurations only after a very long time. This
problem is common to many inference procedures based
on local moves such as expectation maximization [20] and
belief propagation [84, 85]. In Ref. [81] a multilevel ag-
glomerative heuristic was proposed, which significantly
alleviates this problem. It consists in equilibrating the
chain for a larger number of groups, and then merging
the groups using the same algorithm used for the block
membership moves. This method, however, cannot be
used unmodified in the overlapping case, since the strict
merging of groups will not properly explore the landscape



14

of possible overlapping partitions. We therefore modify
the approach as follows. Before groups are merged, the
half-edges belonging to each one of them are split into
subgroups corresponding to the different group member-
ships at the opposing sides. These subgroups are then
treated as separate groups, and are merged together until
the desired number of groups is achieved. All the details
of the algorithm beyond this modification are performed
exactly as described in Ref. [81]. Since this algorithm
usually does a good job in finding a partition very close to
the final one, it also tends to perform very well when the
algorithm is turned into a greedy heuristic, by starting
with B = 2E and each half-edge in its own group, and by
making β →∞. An example of a typical outcome of the
greedy algorithm is shown in Fig. 7. The greedy version
is very fast, with an overall complexity of O(E ln2E),
which makes it usable for very large networks. Note that
this complexity is independent on the number of groups,
B. This is a strong contrast to other methods proposed
for the same problem, such as the stochastic optimiza-
tion algorithm of Gopalan et al [86], and the expecta-
tion maximization algorithm of Ball et al [20], both of
which have a complexity of O(EB) per sweep, although
they only consider strictly assortative models, and ap-
plying the same techniques to the more general models
considered here would lead to an O(EB2) complexity,
similar to belief propagation algorithms for nonoverlap-
ping models [29, 85]. Although these approaches can be
very efficient if the number of groups is very small, they
quickly become prohibitive if the most appropriate num-
ber of groups scales as some function of the system size
(which seems to be generally the case when model se-
lection is applied, see table I and Ref. [7]), which is not
an issue with the algorithm described above. It should
also be noted that none of the other algorithms men-
tioned [20, 29, 85, 86] is designed to overcome metastable
solutions, like the multilevel approach presented here.

For most networks analyzed in this work, the fast
heuristic version of the algorithm was used, together with
the algorithm described in Ref. [7] to infer the upper lay-
ers of the hierarchy (which includes the determination of
the number of groups B at the lowest level, in addition
to the entire hierarchy, in a nonparametric fashion)2.

VII. CONCLUSION

We presented a method of inferring overlapping and
degree-corrected versions of the stochastic block model
based on the minimum description length principle
(MDL) that avoids overfitting and allows for the compar-
ison between model classes. Based on a Bayesian inter-
pretation of MDL, we derived a posterior odds ratio test

2 A complete implementation of the algorithm is freely available
as part of the graph-tool library [87] at http://graph-tool.
skewed.de.

that yields a degree of confidence with which models can
be selected or discarded. In applying this method to a va-
riety of empirical networks, we obtained that for the ma-
jority of them the nonoverlapping degree-corrected model
variant is the one that best fits the data.

The relative success of the degree-corrected model im-
plies that intrinsic node propensities are an important
aspect of the network formation of many systems, which
are not sufficiently well described by the sole division
into node classes. We note, however, that there are ex-
ceptions to this, as there are a few networks that do
not show enough statistical evidence to justify the ad-
ditional parameters of the degree-corrected model. In
these networks, the groups themselves seem to be the
leading descriptors of the network structure, with the
degree sequence itself providing little additional explana-
tory power.

Although overlapping structures are often considered
to be more intuitive explanations for some networks, we
showed that in many representative cases the nonover-
lapping model can accommodate the same structure
while providing a more parsimonious description of the
data. This contradicts results obtained with nonsta-
tistical methods [14, 15], which claimed that many or
even most networks are better described by overlapping
groups. We believe that this conclusion is most likely
a result of overfitting: Since there are more overlapping
structures than nonoverlapping ones, it is easier to find
them in the data. We expect this fact to bear on tasks
that require high-quality fits, such as the prediction of
missing or spurious links [6, 8], or other generalizations
of the data.

The models considered in this work generate unlabeled
networks, without any other properties associated with
the nodes or edges. However, it is often the case that
either the nodes or edges have weights [25, 40, 88] or
are of different types [24, 27], or have temporal informa-
tion [28]. This sort of additional data may corroborate
the evidence supporting the generation via a specific type
of model (e.g. with overlaps) and tip the scale towards
it. Therefore, the results presented in this paper should
not be interpreted as a statement on the suitability the
abstract notion of overlapping structures in general, only
of the specific formulations considered. However, the ap-
proach presented here is generalizable to these other cases
as well, by augmenting the model to generate covariates
associated with the edges and nodes [25]. Furthermore,
one should be able to perform a similar comparison with
models which belong to very different classes, such as
latent space [89] models, or others.

Appendix A: Directed graphs

The same approach of the main text can be carried
over to directed graphs with no difficulties. In this case
the edge counts are in general asymmetric, ers 6= esr,
which leads to the entropy for the non-degree-corrected

http://graph-tool.skewed.de
http://graph-tool.skewed.de


15

model [42]

St ' E −
∑
rs

ers ln

(
ers
nrns

)
. (A1)

For the degree-corrected case, there are two degree se-
quences for the labeled out- and in-degrees, {k+ri } and
{k−ri }, respectively. Applying the same argument as for
the undirected case, the entropy becomes [42]

Sd ' −E−
∑
rs

ers ln

(
ers

e+r e
−
s

)
−
∑
ir

ln k+
r
i !−

∑
ir

ln k−
r
i !,

(A2)
where e+r =

∑
s ers and e

−
r =

∑
s esr.

The description length for the overlapping partition is
identical to the undirected case, with Lp given by Eq. 6.
For the labeled degree sequence, we have instead

Lκ =
∑
r

ln
((
mr
e+r

))
+ ln

((
mr
e−r

))
+
∑
~b

min
(
L(1)~b ,L

(2)
~b

)
.

(A3)
with

L(1)~b =
∑
r

ln

((
n~b
e+r~b

))
+ ln

((
n~b
e−r~b

))
. (A4)

and

L(2)~b =
∑
r

br

(
ln Ξr~b

+ + ln Ξr~b
−
)

+ lnn~b!−
∑
~k

lnn
~b
~k+,~k−

!,

(A5)
where ln Ξr~b

+ and ln Ξr~b
− are computed as in Eq. 12

but using e+r~b =
∑
~k+,~k− k

+
r n

~b
~k+,~k−

and er~b
− =∑

~k+,~k− k
−
r n

~b
~k+,~k−

, respectively, which give the total

number of out- and in-edges incident on the mixture ~b.
In the previous equations the counts n~b~k+,~k− refer to the
joint distribution of labeled in- and out-degrees, so that
each vector ~k+/− describes the in- and out-degrees la-
beled according to degree membership, i.e. ~k+i = {k+

r
i }

and ~k−i = {k−
r
i }.

Appendix B: Poisson Models

1. Non-degree-corrected

This approximation of the formulation with “hard”
constraints of the multiple membership model discussed
in the main text is closely related to a Poisson variant of
the model with “soft” constraints, where each half-edge
of the graph is labeled with a latent variable specifying
which group memberships were responsible for its exis-
tence, and the number of edges of type (r, s) between
nodes i and j, Arsij , is independently sampled according
to a Poisson distribution (similar to Refs. [19, 20]), so the

likelihood becomes

P (G|{~bi}, {prs}) =
∏
i>j

∏
r≥s

p
Arsij
rs e

−prsbri bsj/Arsij !, (B1)

where prs is the average number of edges of type (r, s)
between nodes that belong to each group. The log-
likelihood can be written as

lnP =
1

2

∑
rs

ers ln prs − nrnsprs −
∑
i>j

∑
r≥s

lnArsij !. (B2)

Maximizing lnP w.r.t. prs, we obtain p̂rs = ers/nrns,
and hence

ln P̂ = −E+ 1
2

∑
rs

ers ln

(
ers
nrns

)
−
∑
i>j

∑
r≥s

lnArsij !. (B3)

For simple graphs with Arsij ∈ {0, 1}, the last term in
the above equation is equal to zero, and we have that
the approximation of the likelihood of the model with
“hard” constraints in the sparse case is identical to the ex-
act maximum likelihood of the Poisson model with “soft”
constraints.

This model is similar to the popular mixed membership
stochastic block model (MMSBM) [18]; however it differs
in the important aspect that it generates strictly denser
overlaps. In the MMSBM, the existence of an edge Aij
is sampled from a Bernoulli distribution with parameter
λij =

∑
rs θ

r
i θ
s
jprs, where θri is the probability that node

i belongs to group r, such that
∑
r θ

r
i = 1, and prs ∈ [0, 1]

is the probability that two nodes belonging to groups r
and s are connected. Although for sparse graphs the
differences between Poisson and Bernoulli models tend
to disappear, with this parametrization the density of
the overlaps is mixed with normalized weights. More
specifically, for a node i which belongs simultaneously
to groups r and s, its expected degree is equal to the
weighted average of the unmixed degrees, 〈k〉i = θri 〈k〉r+
θsi 〈k〉s, where 〈k〉r =

∑
s prs

∑
i θ
s
i is the expected degree

of a node that belongs only to group r. Thus, in the
MMSBM the nodes in the mixture have an intermediate
density between the sparser and the denser groups. In
contrast, in the model considered in the main text, as well
as the Poisson model above, we have simply 〈k〉i = 〈k〉r+
〈k〉s, and therefore the overlaps are always strictly denser
than the pure groups. In this respect, it is equivalent to
other formulations of the MMSBM, see e.g. Refs. [90, 91].

2. Degree-corrected

A connection to a version of the model with “soft” con-
straints can also be made. We may consider each la-
beled entry Arsij in the adjacency matrix to be Poisson
distributed with an average given by θri θsjλrs,

P (G|{~bi}, {λrs}, {θr}) =
∏
i>j

∏
r≥s

(θri θ
s
jλrs)

Arsij e−θ
r
i θ

s
jλrs/Arsij !,

(B4)



16

where Arsij is the number of edges of type (r, s) between
nodes i and j, and θri is the propensity with which a
node receives an edge of type r. The log-likelihood can
be written as

lnP =
1

2

∑
rs

ers lnλrs +
∑
ir

kri ln θ
r
i −

∑
r≥s

λrs
∑
i>j

θri θ
s
j

−
∑
i>j

∑
r≥s

lnArsij !. (B5)

Maximizing lnP w.r.t. {λrs} and {θri }, we obtain λ̂rs =
ers/eres and θ̂ri = kri , and hence

ln P̂ = −E + 1
2

∑
rs

ers ln

(
ers
eres

)
+
∑
ir

kri ln k
r
i

−
∑
i>j

∑
r≥s

lnArsij !. (B6)

Again, for simple graphs with Arsij ∈ {0, 1}, the last term
in the above equation is equal to zero; however even in
that case the likelihood is not identical to the version with
“hard” constraints considered above, as is the case for the
single membership version as well [42]. Both likelihoods
only become the same in the limit kri � 1 such that
ln kri ! ' kri ln kri − kri . Nevertheless, for the purpose of
this paper, the differences between these models can be
overlooked.

There is a direct connection between this model and
the one proposed by Ball et al [20]. In the not strictly
assortative version of their model, the number of edges
Aij is distributed according to a Poisson with average
λij =

∑
rs η

r
i η
s
jωrs, where ηri is the propensity with which

node i receives edges of type r and ωrs regulates the
number of edges across groups. The total likelihood of
that model is

P (G|{~bi}, {ωrs}, {ηr}) =
∏
i>j

λ
Aij
ij e

−λij/Aij !. (B7)

Since the sum of independent Poisson random variables
is also distributed according to a Poisson, if we gener-
ate a graph with the model of Eq. B4 and observe only
the total unlabeled edge counts Aij =

∑
rsA

rs
ij , they are

distributed exactly like Eq. B7, for the same choice of
parameters θri = ηri and λrs = ωrs. Hence, the model
of the main text is an equivalent formulation of the one
in Ref. [20] where one keeps track of the latent variables
specifying the exact type of each half-edge, instead of
their marginal probability. This has the advantage that
the maximum likelihood estimates for the model param-
eters λrs and θri can be obtained directly by differentia-
tion, and do not require iterations of an EM algorithm
as in Ref. [20]. On the other hand we are left with the
determination of labels in the half-edges, which is done
with the method already described in Sec. VI.

Appendix C: Maximum-entropy ensemble of counts
with constrained average

Suppose we want to compute the number of all possi-
ble non-negative integer counts {nk}, subject to a nor-
malization constraint

∑∞
k=0 nk = N and a fixed average∑∞

k=0 knk = E. This can be obtained approximately,
by relaxing the constraints so that they hold only on
average. The maximum entropy ensemble given these
constraints is the one with the probabilities P ({nk}) =
e−H({nk})/Z, with H({nk}) = λ

∑
k nk + µ

∑
k knk,

where λ and µ are the Lagrange multipliers that keep
the constraints in place. This ensemble is mathemati-
cally analogous to a simple Bose gas with energy levels
given by k. The partition function is given by

Z =
∑
{nk}

e−λ
∑

k nk−µ
∑

k knk =
∏
k

Zk, (C1)

with

Zk =
[
1− e−λ−µk

]−1
. (C2)

The average counts are given by 〈nk〉 = −∂ lnZk/∂λ =
[exp(λ+ µk)− 1]−1, and the parameters λ and µ are de-
termined via the imposed constraints,

∞∑
k=0

[exp(λ+ µk)− 1]−1 = N, (C3)

∞∑
k=0

k [exp(λ+ µk)− 1]−1 = E. (C4)

Further analytical progress can be made by replacing the
sums with integrals, and using the polylogarithm func-
tion and its connection with the Bose–Einstein distribu-
tion, Lis(z) = Γ(s)−1

∫∞
0

ts−1

et/z−1dt,∫ ∞
0

dk [exp(λ+ µk)− 1]−1 = Li1(e
−λ)
µ

= N, (C5)∫ ∞
0

dkk [exp(λ+ µk)− 1]−1 = Li2(e
−λ)

µ2
= E. (C6)

Eq. C5 can be inverted as e−λ = 1 − exp(−N/µ), but
Eq. C6 cannot be solved for λ in closed form. However,
by assuming a sufficiently “high temperature” regime
where µ ∼ O(1), we have that the fugacity simplifies
in the thermodynamic limit, e−λ → 1 for N � 1,
and hence we obtain µ '

√
Li2(1)/E. Using Eqs. C5

and C6, we can write the entropy of the ensemble ln Ξ =
−
∑
k [∂ lnZk/∂λ+ ∂ lnZk/∂µ+ lnZk], as

ln Ξ = λN + 2µE, (C7)

and for the regime e−λ → 1, we have

ln Ξ ' 2
√
ζ(2)E, (C8)



17

where the identity Li2(1) = ζ(2) was used, with ζ(x)
being the Riemann zeta function. Although Eq. C8 be-
comes asymptotically exact in the thermodynamic limit
with E ∼ N and N � 1, the exact solution can also
be obtained with arbitrary precision simply by iterat-
ing Eqs. C5 and C6 as λ̂(t + 1) = 1 − exp(−N/µ(t)),
µ(t+1) =

√
E/Li2(λ̂(t)), where λ̂ ≡ e−λ, with the start-

ing points λ̂(0) = 1, µ(0) =
√

Li2(1)/E, until sufficient
convergence is reached, and the results are substituted
in Eq. C7. (We actually use this more precise procedure
when computing Eq. 13 in the main text, throughout the
analysis.)

[1] M. E. J. Newman, “Communities, modules and large-
scale structure in networks,” Nat Phys 8, 25–31 (2011).

[2] Santo Fortunato, “Community detection in graphs,”
Physics Reports 486, 75–174 (2010).

[3] Petter Holme, “Core-periphery organization of complex
networks,” Physical Review E 72, 046111 (2005).

[4] M. Puck Rombach, Mason A. Porter, James H. Fowler,
and Peter J. Mucha, “Core-periphery structure in net-
works,” arXiv:1202.2684 (2012).

[5] Daniel B. Larremore, Aaron Clauset, and Abigail Z. Ja-
cobs, “Efficiently inferring community structure in bipar-
tite networks,” Physical Review E 90, 012805 (2014).

[6] Aaron Clauset, Cristopher Moore, and M. E. J. New-
man, “Hierarchical structure and the prediction of miss-
ing links in networks,” Nature 453, 98–101 (2008).

[7] Tiago P. Peixoto, “Hierarchical block structures and
high-resolution model selection in large networks,” Phys-
ical Review X 4, 011047 (2014).

[8] Roger Guimerà and Marta Sales-Pardo, “Missing and
spurious interactions and the reconstruction of complex
networks,” Proceedings of the National Academy of Sci-
ences 106, 22073 –22078 (2009).

[9] Sergey V. Buldyrev, Roni Parshani, Gerald Paul, H. Eu-
gene Stanley, and Shlomo Havlin, “Catastrophic cas-
cade of failures in interdependent networks,” Nature 464,
1025–1028 (2010).

[10] Andrea Apolloni, Chiara Poletto, José J. Ramasco, Pablo
Jensen, and Vittoria Colizza, “Metapopulation epidemic
models with heterogeneous mixing and travel behaviour,”
Theoretical Biology and Medical Modelling 11, 3 (2014).

[11] Roger Guimerà and Luís A. Nunes Amaral, “Functional
cartography of complex metabolic networks,” Nature
433, 895–900 (2005).

[12] M. E. J. Newman, “Modularity and community structure
in networks,” Proceedings of the National Academy of
Sciences 103, 8577–8582 (2006).

[13] M. Girvan and M. E. J. Newman, “Community structure
in social and biological networks,” Proceedings of the Na-
tional Academy of Sciences 99, 7821 –7826 (2002).

[14] Yong-Yeol Ahn, James P. Bagrow, and Sune Lehmann,
“Link communities reveal multiscale complexity in net-
works,” Nature 466, 761–764 (2010).

[15] Gergely Palla, Imre Derényi, Illés Farkas, and Tamás
Vicsek, “Uncovering the overlapping community struc-
ture of complex networks in nature and society,” Nature
435, 814–818 (2005).

[16] Martin Rosvall and Carl T. Bergstrom, “Maps of random
walks on complex networks reveal community structure,”
Proceedings of the National Academy of Sciences 105,
1118–1123 (2008).

[17] Paul W. Holland, Kathryn Blackmond Laskey, and
Samuel Leinhardt, “Stochastic blockmodels: First steps,”
Social Networks 5, 109–137 (1983).

[18] Edoardo M. Airoldi, David M. Blei, Stephen E. Fien-
berg, and Eric P. Xing, “Mixed membership stochastic
blockmodels,” J. Mach. Learn. Res. 9, 1981–2014 (2008).

[19] Brian Karrer and M. E. J. Newman, “Stochastic block-
models and community structure in networks,” Physical
Review E 83, 016107 (2011).

[20] Brian Ball, Brian Karrer, and M. E. J. Newman, “Ef-
ficient and principled method for detecting communities
in networks,” Physical Review E 84, 036103 (2011).

[21] Andrea Lancichinetti, Santo Fortunato, and János
Kertész, “Detecting the overlapping and hierarchical
community structure in complex networks,” New Jour-
nal of Physics 11, 033015 (2009).

[22] Gergely Palla, László Lovász, and Tamás Vicsek, “Mul-
tifractal network generator,” Proceedings of the National
Academy of Sciences 107, 7640 –7645 (2010).

[23] Jure Leskovec, Deepayan Chakrabarti, Jon Kleinberg,
Christos Faloutsos, and Zoubin Ghahramani, “Kronecker
graphs: An approach to modeling networks,” J. Mach.
Learn. Res. 11, 985–1042 (2010).

[24] Mahendra Mariadassou, Stéphane Robin, and Corinne
Vacher, “Uncovering latent structure in valued graphs:
A variational approach,” The Annals of Applied Statis-
tics 4, 715–742 (2010), mathematical Reviews number
(MathSciNet): MR2758646.

[25] Christopher Aicher, Abigail Z. Jacobs, and Aaron
Clauset, “Learning latent block structure in weighted net-
works,” Journal of Complex Networks , cnu026 (2014).

[26] Brian Ball and M.e.j. Newman, “Friendship networks and
social status,” Network Science 1, 16–30 (2013).

[27] Mikko Kivelä, Alex Arenas, Marc Barthelemy, James P.
Gleeson, Yamir Moreno, and Mason A. Porter, “Multi-
layer networks,” Journal of Complex Networks 2, 203–271
(2014).

[28] Wenjie Fu, Le Song, and Eric P. Xing, “Dynamic mixed
membership blockmodel for evolving networks,” in Pro-
ceedings of the 26th Annual International Conference on
Machine Learning , ICML ’09 (ACM, New York, NY,
USA, 2009) pp. 329–336.

[29] Xiaoran Yan, Cosma Shalizi, Jacob E. Jensen, Flo-
rent Krzakala, Cristopher Moore, Lenka Zdeborová, Pan
Zhang, and Yaojia Zhu, “Model selection for degree-
corrected block models,” Journal of Statistical Mechan-
ics: Theory and Experiment 2014, P05007 (2014).

[30] M. E. J. Newman, “Community detection and graph par-
titioning,” EPL (Europhysics Letters) 103, 28003 (2013).

[31] M. E. J. Newman, “Spectral methods for community de-
tection and graph partitioning,” Physical Review E 88,

http://dx.doi.org/10.1038/nphys2162
http://dx.doi.org/16/j.physrep.2009.11.002
http://dx.doi.org/ 10.1103/PhysRevE.72.046111
http://arxiv.org/abs/1202.2684
http://dx.doi.org/10.1103/PhysRevE.90.012805
http://dx.doi.org/10.1038/nature06830
http://dx.doi.org/10.1103/PhysRevX.4.011047
http://dx.doi.org/10.1103/PhysRevX.4.011047
http://dx.doi.org/10.1073/pnas.0908366106
http://dx.doi.org/10.1073/pnas.0908366106
http://dx.doi.org/10.1038/nature08932
http://dx.doi.org/10.1038/nature08932
http://dx.doi.org/ 10.1186/1742-4682-11-3
http://dx.doi.org/10.1038/nature03288
http://dx.doi.org/10.1038/nature03288
http://dx.doi.org/10.1073/pnas.0601602103
http://dx.doi.org/10.1073/pnas.0601602103
http://dx.doi.org/ 10.1073/pnas.122653799
http://dx.doi.org/ 10.1073/pnas.122653799
http://dx.doi.org/10.1038/nature09182
http://dx.doi.org/10.1038/nature03607
http://dx.doi.org/10.1038/nature03607
http://dx.doi.org/10.1073/pnas.0706851105
http://dx.doi.org/10.1073/pnas.0706851105
http://dx.doi.org/ 16/0378-8733(83)90021-7
http://dl.acm.org/citation.cfm?id=1390681.1442798
http://dx.doi.org/ 10.1103/PhysRevE.83.016107
http://dx.doi.org/ 10.1103/PhysRevE.83.016107
http://dx.doi.org/ 10.1103/PhysRevE.84.036103
http://dx.doi.org/ 10.1088/1367-2630/11/3/033015
http://dx.doi.org/ 10.1088/1367-2630/11/3/033015
http://dx.doi.org/10.1073/pnas.0912983107
http://dx.doi.org/10.1073/pnas.0912983107
http://dl.acm.org/citation.cfm?id=1756006.1756039
http://dl.acm.org/citation.cfm?id=1756006.1756039
http://dx.doi.org/10.1214/10-AOAS361
http://dx.doi.org/10.1214/10-AOAS361
http://dx.doi.org/10.1093/comnet/cnu026
http://dx.doi.org/10.1017/nws.2012.4
http://dx.doi.org/10.1093/comnet/cnu016
http://dx.doi.org/10.1093/comnet/cnu016
http://dx.doi.org/10.1145/1553374.1553416
http://dx.doi.org/10.1145/1553374.1553416
http://dx.doi.org/10.1145/1553374.1553416
http://dx.doi.org/ 10.1088/1742-5468/2014/05/P05007
http://dx.doi.org/ 10.1088/1742-5468/2014/05/P05007
http://dx.doi.org/10.1209/0295-5075/103/28003
http://dx.doi.org/10.1103/PhysRevE.88.042822


18

042822 (2013).
[32] Raj Rao Nadakuditi and M. E. J. Newman, “Graph spec-

tra and the detectability of community structure in net-
works,” Physical Review Letters 108, 188701 (2012).

[33] Florent Krzakala, Cristopher Moore, Elchanan Mossel,
Joe Neeman, Allan Sly, Lenka Zdeborová, and Pan
Zhang, “Spectral redemption in clustering sparse net-
works,” Proceedings of the National Academy of Sciences
, 201312486 (2013).

[34] Andrea Lancichinetti, Santo Fortunato, and Filippo
Radicchi, “Benchmark graphs for testing community
detection algorithms,” Physical Review E 78, 046110
(2008).

[35] Andrea Lancichinetti and Santo Fortunato, “Benchmarks
for testing community detection algorithms on directed
and weighted graphs with overlapping communities,”
Physical Review E 80, 016118 (2009).

[36] Andrea Lancichinetti and Santo Fortunato, “Community
detection algorithms: A comparative analysis,” Physical
Review E 80, 056117 (2009).

[37] Brian Karrer, Elizaveta Levina, and M. E. J New-
man, “Robustness of community structure in networks,”
0709.2108 (2007).

[38] Peter D. Grünwald, The Minimum Description Length
Principle (The MIT Press, 2007).

[39] Jorma Rissanen, Information and Complexity in Statis-
tical Modeling, 1st ed. (Springer, 2010).

[40] Martin Rosvall, Alcides V. Esquivel, Andrea Lanci-
chinetti, Jevin D. West, and Renaud Lambiotte, “Mem-
ory in network flows and its effects on spreading dynam-
ics and community detection,” Nature Communications
5 (2014), 10.1038/ncomms5630.

[41] Ginestra Bianconi, “Entropy of network ensembles,”
Physical Review E 79, 036114 (2009).

[42] Tiago P. Peixoto, “Entropy of stochastic blockmodel en-
sembles,” Physical Review E 85, 056122 (2012).

[43] Martin Rosvall and Carl T. Bergstrom, “An information-
theoretic framework for resolving community structure
in complex networks,” Proceedings of the National
Academy of Sciences 104, 7327–7331 (2007).

[44] Stephen E. Fienberg, Michael M. Meyer, and Stanley S.
Wasserman, “Statistical analysis of multiple sociometric
relations,” Journal of the American Statistical Associa-
tion 80, 51–67 (1985).

[45] Katherine Faust and Stanley Wasserman, “Blockmodels:
Interpretation and evaluation,” Social Networks 14, 5–61
(1992).

[46] Carolyn J. Anderson, Stanley Wasserman, and Kather-
ine Faust, “Building stochastic blockmodels,” Social Net-
works 14, 137–161 (1992).

[47] Pierre Latouche, Etienne Birmelé, and Christophe Am-
broise, “Model selection in overlapping stochastic block
models,” Electronic Journal of Statistics 8, 762–794
(2014).

[48] Tiago P. Peixoto, “Parsimonious module inference in
large networks,” Physical Review Letters 110, 148701
(2013).

[49] E. T. Jaynes, Probability Theory: The Logic of Science,
edited by G. Larry Bretthorst (Cambridge University
Press, Cambridge, UK ; New York, NY, 2003).

[50] Sir Harold Jeffreys, The Theory of Probability (Oxford
University Press, 1998).

[51] Lada A. Adamic and Natalie Glance, “The political blo-
gosphere and the 2004 u.s. election: divided they blog,”

in Proceedings of the 3rd international workshop on Link
discovery , LinkKDD ’05 (ACM, New York, NY, USA,
2005) pp. 36–43.

[52] D. Holten, “Hierarchical edge bundles: Visualization of
adjacency relations in hierarchical data,” IEEE Transac-
tions on Visualization and Computer Graphics 12, 741–
748 (2006).

[53] Julian Mcauley and Jure Leskovec, “Discovering social
circles in ego networks,” ACM Trans. Knowl. Discov.
Data 8, 4:1–4:28 (2014).

[54] Donald E. Knuth, The Stanford GraphBase: A Platform
for Combinatorial Computing, 1st ed. (Addison-Wesley
Professional, New York, N.Y. : Reading, Mass, 1993).

[55] T S Evans, “American college football network files,”
FigShare (2012), 10.6084/m9.figshare.93179.

[56] Wayne W. Zachary, “An information flow model for con-
flict and fission in small groups,” Journal of Anthropo-
logical Research 33, 452–473 (1977).

[57] Jure Leskovec, Kevin J. Lang, Anirban Dasgupta, and
Michael W. Mahoney, “Community structure in large
networks: Natural cluster sizes and the absence of large
well-defined clusters,” arXiv:0810.1355 (2008).

[58] Bryan Klimt and Yiming Yang, “Introducing the enron
corpus.” in CEAS (2004).

[59] David Lusseau, Karsten Schneider, Oliver J. Boisseau,
Patti Haase, Elisabeth Slooten, and Steve M. Dawson,
“The bottlenose dolphin community of doubtful sound
features a large proportion of long-lasting associations,”
Behavioral Ecology and Sociobiology 54, 396–405 (2003).

[60] Oliver Richters and Tiago P. Peixoto, “Trust transitivity
in social networks,” PLoS ONE 6, e18384 (2011).

[61] Eunjoon Cho, Seth A. Myers, and Jure Leskovec,
“Friendship and mobility: user movement in location-
based social networks,” in Proceedings of the 17th ACM
SIGKDD international conference on Knowledge discov-
ery and data mining , KDD ’11 (ACM, New York, NY,
USA, 2011) pp. 1082–1090.

[62] D. J. Watts and S. H. Strogatz, “Collective dynamics of
’small-world’ networks,” Nature 393, 409–10 (1998).

[63] Jure Leskovec, Jon Kleinberg, and Christos Falout-
sos, “Graph evolution: Densification and shrinking di-
ameters,” ACM Trans. Knowl. Discov. Data 1 (2007),
10.1145/1217299.1217301.

[64] M. E. J. Newman, “Finding community structure in net-
works using the eigenvectors of matrices,” Physical Re-
view E 74, 036104 (2006).

[65] Matthew Richardson, Rakesh Agrawal, and Pedro
Domingos, “Trust management for the semantic web,” in
The Semantic Web - ISWC 2003 , Lecture Notes in Com-
puter Science No. 2870, edited by Dieter Fensel, Katia
Sycara, and John Mylopoulos (Springer Berlin Heidel-
berg, 2003) pp. 351–368.

[66] K. I. Goh, M. E. Cusick, D. Valle, B. Childs, M. Vidal,
and A. L. Barabási, “The human disease network,” Pro-
ceedings of the National Academy of Sciences 104, 8685
(2007).

[67] Haiyuan Yu, Pascal Braun, Muhammed A. Yıldırım,
Irma Lemmens, Kavitha Venkatesan, Julie Sahalie,
Tomoko Hirozane-Kishikawa, Fana Gebreab, Na Li, Nico-
las Simonis, Tong Hao, Jean-François Rual, Amélie Dri-
cot, Alexei Vazquez, Ryan R. Murray, Christophe Simon,
Leah Tardivo, Stanley Tam, Nenad Svrzikapa, Changyu
Fan, Anne-Sophie de Smet, Adriana Motyl, Michael E.
Hudson, Juyong Park, Xiaofeng Xin, Michael E. Cusick,

http://dx.doi.org/10.1103/PhysRevE.88.042822
http://dx.doi.org/ 10.1103/PhysRevLett.108.188701
http://dx.doi.org/10.1073/pnas.1312486110
http://dx.doi.org/10.1073/pnas.1312486110
http://dx.doi.org/ 10.1103/PhysRevE.78.046110
http://dx.doi.org/ 10.1103/PhysRevE.78.046110
http://dx.doi.org/10.1103/PhysRevE.80.016118
http://dx.doi.org/ 10.1103/PhysRevE.80.056117
http://dx.doi.org/ 10.1103/PhysRevE.80.056117
http://arxiv.org/abs/0709.2108
http://dx.doi.org/10.1038/ncomms5630
http://dx.doi.org/10.1038/ncomms5630
http://dx.doi.org/ 10.1103/PhysRevE.79.036114
http://dx.doi.org/ 10.1103/PhysRevE.85.056122
http://dx.doi.org/10.1073/pnas.0611034104
http://dx.doi.org/10.1073/pnas.0611034104
http://dx.doi.org/ 10.2307/2288040
http://dx.doi.org/ 10.2307/2288040
http://dx.doi.org/ 16/0378-8733(92)90013-W
http://dx.doi.org/ 16/0378-8733(92)90013-W
http://dx.doi.org/ 16/0378-8733(92)90017-2
http://dx.doi.org/ 16/0378-8733(92)90017-2
http://dx.doi.org/10.1214/14-EJS903
http://dx.doi.org/10.1214/14-EJS903
http://dx.doi.org/ 10.1103/PhysRevLett.110.148701
http://dx.doi.org/ 10.1103/PhysRevLett.110.148701
http://dx.doi.org/10.1145/1134271.1134277
http://dx.doi.org/10.1145/1134271.1134277
http://dx.doi.org/10.1109/TVCG.2006.147
http://dx.doi.org/10.1109/TVCG.2006.147
http://dx.doi.org/10.1109/TVCG.2006.147
http://dx.doi.org/10.1145/2556612
http://dx.doi.org/10.1145/2556612
http://dx.doi.org/10.6084/m9.figshare.93179
http://www.jstor.org/stable/3629752
http://www.jstor.org/stable/3629752
http://arxiv.org/abs/0810.1355
http://bklimt.com/papers/2004_klimt_ceas.pdf
http://dx.doi.org/ 10.1007/s00265-003-0651-y
http://dx.doi.org/ 10.1371/journal.pone.0018384
http://dx.doi.org/ 10.1145/2020408.2020579
http://dx.doi.org/ 10.1145/2020408.2020579
http://dx.doi.org/ 10.1145/2020408.2020579
http://dx.doi.org/ 10.1145/1217299.1217301
http://dx.doi.org/ 10.1145/1217299.1217301
http://dx.doi.org/10.1103/PhysRevE.74.036104
http://dx.doi.org/10.1103/PhysRevE.74.036104
http://link.springer.com/chapter/10.1007/978-3-540-39718-2_23
http://www.pnas.org/content/104/21/8685.short
http://www.pnas.org/content/104/21/8685.short
http://www.pnas.org/content/104/21/8685.short


19

Troy Moore, Charlie Boone, Michael Snyder, Frederick P.
Roth, Albert-László Barabási, Jan Tavernier, David E.
Hill, and Marc Vidal, “High-quality binary protein in-
teraction map of the yeast interactome network,” Science
322, 104–110 (2008).

[68] Teresa Reguly, Ashton Breitkreutz, Lorrie Boucher,
Bobby-Joe Breitkreutz, Gary C. Hon, Chad L. Myers,
Ainslie Parsons, Helena Friesen, Rose Oughtred, Amy
Tong, Chris Stark, Yuen Ho, David Botstein, Brenda An-
drews, Charles Boone, Olga G. Troyanskya, Trey Ideker,
Kara Dolinski, Nizar N. Batada, and Mike Tyers, “Com-
prehensive curation and analysis of global interaction net-
works in saccharomyces cerevisiae,” Journal of Biology 5,
11 (2006).

[69] Sean R. Collins, Patrick Kemmeren, Xue-Chu Zhao,
Jack F. Greenblatt, Forrest Spencer, Frank C. P. Hol-
stege, Jonathan S. Weissman, and Nevan J. Krogan,
“Toward a comprehensive atlas of the physical interac-
tome of saccharomyces cerevisiae,” Molecular & cellular
proteomics: MCP 6, 439–450 (2007).

[70] Heladia Salgado, Martin Peralta-Gil, Socorro Gama-
Castro, Alberto Santos-Zavaleta, Luis Muñiz-Rascado,
Jair S. García-Sotelo, Verena Weiss, Hilda Solano-Lira,
Irma Martínez-Flores, Alejandra Medina-Rivera, Ger-
ardo Salgado-Osorio, Shirley Alquicira-Hernández, Kevin
Alquicira-Hernández, Alejandra López-Fuentes, Liliana
Porrón-Sotelo, Araceli M. Huerta, César Bonavides-
Martínez, Yalbi I. Balderas-Martínez, Lucia Pannier,
Maricela Olvera, Aurora Labastida, Verónica Jiménez-
Jacinto, Leticia Vega-Alvarado, Victor Del Moral-
Chávez, Alfredo Hernández-Alvarez, Enrique Morett,
and Julio Collado-Vides, “RegulonDB v8.0: omics
data sets, evolutionary conservation, regulatory phrases,
cross-validated gold standards and more,” Nucleic Acids
Research 41, D203–213 (2013).

[71] Julian McAuley and Jure Leskovec, “Image labeling on a
network: Using social-network metadata for image clas-
sification,” in Computer Vision – ECCV 2012 , Lecture
Notes in Computer Science No. 7575, edited by Andrew
Fitzgibbon, Svetlana Lazebnik, Pietro Perona, Yoichi
Sato, and Cordelia Schmid (Springer Berlin Heidelberg,
2012) pp. 828–841.

[72] Jure Leskovec, Kevin J. Lang, Anirban Dasgupta, and
Michael W. Mahoney, “Community structure in large
networks: Natural cluster sizes and the absence of large
well-defined clusters,” Internet Mathematics 6, 29–123
(2009).

[73] Jaewon Yang and Jure Leskovec, “Defining and evalu-
ating network communities based on ground-truth,” in
Proceedings of the ACM SIGKDD Workshop on Mining
Data Semantics, MDS ’12 (ACM, New York, NY, USA,
2012) pp. 3:1–3:8.

[74] Réka Albert, Hawoong Jeong, and Albert-László
Barabási, “Internet: Diameter of the world-wide web,”
Nature 401, 130–131 (1999).

[75] Jure Leskovec, Daniel Huttenlocher, and Jon Kleinberg,
“Signed networks in social media,” in Proceedings of the
SIGCHI Conference on Human Factors in Computing
Systems, CHI ’10 (ACM, New York, NY, USA, 2010)
pp. 1361–1370.

[76] Jure Leskovec, Daniel Huttenlocher, and Jon Kleinberg,
“Predicting positive and negative links in online social
networks,” in Proceedings of the 19th International Con-
ference on World Wide Web, WWW ’10 (ACM, New

York, NY, USA, 2010) pp. 641–650.
[77] T. S. Keshava Prasad, Renu Goel, Kumaran Kan-

dasamy, Shivakumar Keerthikumar, Sameer Kumar,
Suresh Mathivanan, Deepthi Telikicherla, Rajesh Raju,
Beema Shafreen, Abhilash Venugopal, Lavanya Balakr-
ishnan, Arivusudar Marimuthu, Sutopa Banerjee, Devi S.
Somanathan, Aimy Sebastian, Sandhya Rani, Somak
Ray, C. J. Harrys Kishore, Sashi Kanth, Mukhtar
Ahmed, Manoj K. Kashyap, Riaz Mohmood, Y. L. Ra-
machandra, V. Krishna, B. Abdul Rahiman, Sujatha Mo-
han, Prathibha Ranganathan, Subhashri Ramabadran,
Raghothama Chaerkady, and Akhilesh Pandey, “Human
protein reference database—2009 update,” Nucleic Acids
Research 37, D767–D772 (2009).

[78] M. E. J. Newman, “Fast algorithm for detecting com-
munity structure in networks,” Physical Review E 69,
066133 (2004).

[79] Aaron Clauset, M. E. J. Newman, and Cristopher
Moore, “Finding community structure in very large net-
works,” Physical Review E 70, 066111 (2004).

[80] A. Arenas, L. Danon, A. Díaz-Guilera, P. M. Gleiser, and
R. Guimerá, “Community analysis in social networks,”
The European Physical Journal B - Condensed Matter
and Complex Systems 38, 373–380 (2004).

[81] Tiago P. Peixoto, “Efficient monte carlo and greedy
heuristic for the inference of stochastic block models,”
Physical Review E 89, 012804 (2014).

[82] Nicholas Metropolis, Arianna W. Rosenbluth, Mar-
shall N. Rosenbluth, Augusta H. Teller, and Edward
Teller, “Equation of state calculations by fast computing
machines,” The Journal of Chemical Physics 21, 1087
(1953).

[83] W. K. Hastings, “Monte carlo sampling methods using
markov chains and their applications,” Biometrika 57,
97 –109 (1970).

[84] Aurelien Decelle, Florent Krzakala, Cristopher Moore,
and Lenka Zdeborová, “Inference and phase transitions
in the detection of modules in sparse networks,” Physical
Review Letters 107, 065701 (2011).

[85] Aurelien Decelle, Florent Krzakala, Cristopher Moore,
and Lenka Zdeborová, “Asymptotic analysis of the
stochastic block model for modular networks and its al-
gorithmic applications,” Physical Review E 84, 066106
(2011).

[86] Prem K. Gopalan and David M. Blei, “Efficient discov-
ery of overlapping communities in massive networks,”
Proceedings of the National Academy of Sciences 110,
14534–14539 (2013).

[87] Tiago P. Peixoto, “The graph-tool python library,”
figshare (2014), 10.6084/m9.figshare.1164194.

[88] Alcides Viamontes Esquivel and Martin Rosvall, “Com-
pression of flow can reveal overlapping-module organiza-
tion in networks,” Physical Review X 1, 021025 (2011).

[89] Peter D Hoff, Adrian E Raftery, and Mark S Hand-
cock, “Latent space approaches to social network analy-
sis,” Journal of the American Statistical Association 97,
1090–1098 (2002).

[90] Juuso Parkkinen, Janne Sinkkonen, Adam Gyenge,
and Samuel Kaski, “A block model suitable for sparse
graphs,” in Proceedings of the 7th International Work-
shop on Mining and Learning with Graphs (MLG 2009),
Leuven (2009).

[91] Jaewon Yang and J. Leskovec, “Community-affiliation
graph model for overlapping network community detec-

http://dx.doi.org/10.1126/science.1158684
http://dx.doi.org/10.1126/science.1158684
http://dx.doi.org/10.1186/jbiol36
http://dx.doi.org/10.1186/jbiol36
http://dx.doi.org/10.1074/mcp.M600381-MCP200
http://dx.doi.org/10.1074/mcp.M600381-MCP200
http://dx.doi.org/ 10.1093/nar/gks1201
http://dx.doi.org/ 10.1093/nar/gks1201
http://link.springer.com/chapter/10.1007/978-3-642-33765-9_59
http://www.tandfonline.com/doi/abs/10.1080/15427951.2009.10129177
http://www.tandfonline.com/doi/abs/10.1080/15427951.2009.10129177
http://dx.doi.org/ 10.1145/2350190.2350193
http://dx.doi.org/ 10.1145/2350190.2350193
http://dx.doi.org/10.1038/43601
http://dx.doi.org/10.1145/1753326.1753532
http://dx.doi.org/10.1145/1753326.1753532
http://dx.doi.org/10.1145/1753326.1753532
http://dx.doi.org/10.1145/1772690.1772756
http://dx.doi.org/10.1145/1772690.1772756
http://dx.doi.org/10.1093/nar/gkn892
http://dx.doi.org/10.1093/nar/gkn892
http://dx.doi.org/10.1103/PhysRevE.69.066133
http://dx.doi.org/10.1103/PhysRevE.69.066133
http://dx.doi.org/ 10.1103/PhysRevE.70.066111
http://dx.doi.org/10.1140/epjb/e2004-00130-1
http://dx.doi.org/10.1140/epjb/e2004-00130-1
http://dx.doi.org/10.1103/PhysRevE.89.012804
http://dx.doi.org/10.1063/1.1699114
http://dx.doi.org/10.1063/1.1699114
http://dx.doi.org/10.1093/biomet/57.1.97
http://dx.doi.org/10.1093/biomet/57.1.97
http://dx.doi.org/10.1103/PhysRevLett.107.065701
http://dx.doi.org/10.1103/PhysRevLett.107.065701
http://dx.doi.org/10.1103/PhysRevE.84.066106
http://dx.doi.org/10.1103/PhysRevE.84.066106
http://dx.doi.org/10.1073/pnas.1221839110
http://dx.doi.org/10.1073/pnas.1221839110
http://dx.doi.org/ 10.6084/m9.figshare.1164194
http://dx.doi.org/10.1103/PhysRevX.1.021025
http://dx.doi.org/ 10.1198/016214502388618906
http://dx.doi.org/ 10.1198/016214502388618906
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf


20

tion,” in 2012 IEEE 12th International Conference on
Data Mining (ICDM) (2012) pp. 1170–1175.

http://dx.doi.org/10.1109/ICDM.2012.139
http://dx.doi.org/10.1109/ICDM.2012.139

	Model selection and hypothesis testing for large-scale network models with overlapping groups
	Abstract
	I Introduction
	II Generative models for network structure
	A Overlapping model without degree correction
	B Overlapping model with degree correction

	III Model Selection
	A Overlapping partition, {i}
	B Labeled degree sequence, {i}
	C Edge counts, {ers}
	D Significance levels

	IV Empirical networks
	V Model identifiability: Overlapping vs. nonoverlapping
	VI Inference algorithm
	VII Conclusion
	A Directed graphs
	B Poisson Models
	1 Non-degree-corrected
	2 Degree-corrected

	C Maximum-entropy ensemble of counts with constrained average
	 References



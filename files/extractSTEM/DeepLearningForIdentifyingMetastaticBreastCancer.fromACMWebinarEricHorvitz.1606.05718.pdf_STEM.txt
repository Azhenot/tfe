


















































deep learn for identifi metastat breast cancer 

dayong wang aditya khosla? rishab gargeya humayun irshad andrew H beck 
beth israel deaco medic center, harvard medic school 

?csail, massachusett institut of technolog 
{dwang5,hirshad,abeck2}@bidmc.harvard.edu khosla@csail.mit.edu 

rishab.gargeya@gmail.com 

abstract 

the intern symposium on biomed imag 
(isbi) held a grand challeng to evalu comput 
system for the autom detect of metastat breast 
cancer in whole slide imag of sentinel lymph node biop- 
sies. our team won both competit in the grand chal- 
lenge, obtain an area under the receiv oper curv 
(auc) of 0.925 for the task of whole slide imag classifica- 
tion and a score of 0.7051 for the tumor local task. 
A pathologist independ review the same images, ob- 
tain a whole slide imag classif auc of 0.966 and 
a tumor local score of 0.733. combin our deep 
learn system’ predict with the human pathologist’ 
diagnosi increas the pathologist’ auc to 0.995, rep- 
resent an approxim 85 percent reduct in human 
error rate. these result demonstr the power of use 
deep learn to produc signific improv in the 
accuraci of patholog diagnoses. 

1. introduct 
the medic specialti of patholog be task with pro- 

vide definit diseas diagnosi to guid patient treat- 
ment and manag decis [4]. standardized, accu- 
rate and reproduc patholog diagnosi be essenti 
for advanc precis medicine. sinc the mid-19th cen- 
tury, the primari tool use by pathologist to make diag- 
nose have be the microscop [1]. limit of the quali- 
tativ visual analysi of microscop imag includ lack of 
standardization, diagnost errors, and the signific cog- 
nitiv load requir to manual evalu million of cell 
across hundr of slide in a typic pathologist’ workday 
[15, 17, 7]. consequently, over the past sever decad 
there have be increas interest in develop computa- 
tional method to assist in the analysi of microscop im- 
age in patholog [9, 8]. 

from octob 2015 to april 2016, the intern 
symposium on biomed imag (isbi) held the came- 

lyon grand challeng 2016 (camelyon16) to identifi top- 
perform comput imag analysi system for the 
task of automat detect metastat breast cancer in 
digit whole slide imag (wsis) of sentinel lymph node 
biopsies1. the evalu of breast sentinel lymph node be 
an import compon of the american joint committe 
on cancer’ tnm breast cancer stag system, in which 
patient with a sentinel lymph node posit for metastat 
cancer will receiv a high patholog tnm stage than pa- 
tient neg for sentinel lymph node metastasi [6], fre- 
quentli result in more aggress clinic management, 
includ axillari lymph node dissect [13, 14]. 

the manual patholog review of sentinel lymph node 
be time-consum and laborious, particularli in case in 
which the lymph node be neg for cancer or contain 
onli small focu of metastat cancer. mani center have 
implement test of sentinel lymph node with immuno- 
histochemistri for pancytokeratin [5], which be protein 
express on breast cancer cell and not normal present 
in lymph nodes, to improv the sensit of cancer metas- 
tasi detection. however, limit of pancytokeratin im- 
munohiostochemistri test of sentinel lymph node in- 
clude: increas cost, increas time for slide preparation, 
and increas number of slide requir for patholog 
review. further, even with immunohistochemistry-stain 
slides, the identif of small cancer metastasi can be 
tediou and inaccurate. 

computer-assist imag analysi system have be de- 
velop to aid in the detect of small metastat focu 
from pancytokeratin-stain immunohistochemistri slide 
of sentinel lymph node [22]; however, these system be 
not use clinically. thus, the develop of effect and 
cost effici method for sentinel lymph node evalu 
remain an activ area of research [11], a there would be 
valu to a high-perform system that could increas accu- 
raci and reduc cognit load at low cost. 

here, we present a deep learning-bas approach for the 
identif of cancer metastasi from whole slide im- 

1http://camelyon16.grand-challenge.org/ 

1 

ar 
X 

iv 
:1 

60 
6. 

05 
71 

8v 
1 

[ 
q- 

bi 
o. 

Q 
M 

] 
1 

8 
Ju 

n 
20 

16 

http://camelyon16.grand-challenge.org/ 
lphilipp 
zone de text 
AI and deep learn a a complementari tool for human expertis = human enhanc and not a human replacer!!! 

see eric horvitz webinar 



age of breast sentinel lymph nodes. our approach us 
million of train patch to train a deep convolut 
neural network to make patch-level predict to discrim- 
inat tumor-patch from normal-patches. We then aggre- 
gate the patch-level predict to creat tumor probabl 
heatmap and perform post-process over these heatmap 
to make predict for the slide-bas classif task 
and the tumor-loc task. our system won both com- 
petit at the camelyon grand challeng 2016, with per- 
formanc approach human level accuracy. finally, com- 
bine the predict of our deep learn system with a 
pathologist’ interpret produc a signific reduc- 
tion in the pathologist’ error rate. 

2. dataset and evalu metric 
In thi section, we describ the camelyon16 dataset pro- 

vide by the organ of the competit and the evalua- 
tion metric use to rank the participants. 

2.1. camelyon16 dataset 

the camelyon16 dataset consist of a total of 400 whole 
slide imag (wsis) split into 270 for train and 130 for 
testing. both split contain sampl from two institut 
(radbound umc and umc utrecht) with specif detail 
provid in tabl 1. 

tabl 1: number of slide in the camelyon16 dataset. 

institut train train testcanc normal 
radboud umc 90 70 80 
umc utrecht 70 40 50 

total 160 110 130 

the ground truth data for the train slide consist of 
a pathologist’ delin of region of metastat cancer 
on wsi of sentinel lymph nodes. the data be provid in 
two formats: xml file contain vertex of the annot 
contour of the locat of cancer metastasi and wsi bi- 
nari mask indic the locat of the cancer metastasis. 

2.2. evalu metric 

submiss to the competit be evalu on the 
follow two metrics: 

• slide-bas evaluation: for thi metric, team be 
judg on perform at discrimin between 
slide contain metastasi and normal slides. com- 
petit particip submit a probabl for each 
test slide indic it predict likelihood of contain- 
ing cancer. the competit organ measur the 
particip perform use the area under the re- 
ceiver oper (auc) score. 

• lesion-bas evaluation: for thi metric, partic- 
ipant submit a probabl and a correspond 
(x, y) locat for each predict cancer lesion within 
the wsi. the competit organ measur partic- 
ipant perform a the averag sensit for detect- 
ing all true cancer lesion in a wsi across 6 fals pos- 
itiv rates: 14 , 

1 
2 , 1, 2, 4, and 8 fals posit per wsi. 

3. method 
In thi section, we describ our approach to cancer 

metastasi detection. 

3.1. imag pre-process 

(a) (b) 

figur 1: visual of tissu region detect dure im- 
age pre-process (describ in section 3.1). detect tis- 
sue region be highlight with the green curves. 

To reduc comput time and to focu our analysi 
on region of the slide most like to contain cancer metas- 
tasis, we first identifi tissu within the wsi and exclud 
background white space. To achiev this, we adopt a thresh- 
old base segment method to automat detect the 
background region. In particular, we first transfer the orig- 
inal imag from the rgb color space to the hsv color 
space, then the optim threshold valu in each channel be 
comput use the otsu algorithm [16], and the final mask 
imag be gener by combin the mask from H and 
S channels. the detect result be visual in fig. 1, 
where the tissu region be highlight use green curves. 
accord to the detect results, the averag percentag 
of background region per wsi be approxim 82%. 

3.2. cancer metastasi detect framework 

our cancer metastasi detect framework consist of a 
patch-bas classif stage and a heatmap-bas post- 
process stage, a depict in fig. 2. 

dure model training, the patch-bas classif 
stage take a input whole slide imag and the ground 
truth imag annotation, indic the locat of region 
of each wsi contain metastat cancer. We randomli 



train 

test 

whole slide imag 

sampl 

sampl 

train data 

no 
rm 

al 
tu 

m 
or 

deep model 

p(tumor) 

whole slide imag 
overlap imag 

patch tumor prob. map 

1.0 

0.0 

0.5 

figur 2: the framework of cancer metastasi detection. 

extract million of small posit and neg patch from 
the set of train wsis. If the small patch be locat in 
a tumor region, it be a tumor / posit patch and label 
with 1, otherwise, it be a normal / neg patch and label 
with 0. follow select of posit and neg train 
examples, we train a supervis classif model to dis- 
crimin between these two class of patches, and we em- 
bed all the predict result into a heatmap image. In the 
heatmap-bas post-process stage, we use the tumor 
probabl heatmap to comput the slide-bas evalu 
and lesion-bas evalu score for each wsi. 

3.3. patch-bas classif stage 

dure training, thi stage us a input 256x256 pixel 
patch from posit and neg region of the wsi 
and train a classif model to discrimin between 
the posit and neg patches. We evalu the per- 
formanc of four well-known deep learn network ar- 
chitectur for thi classif task: googlenet [20], 
alexnet [12], vgg16 [19] and a face orient deep net- 
work [21], a show in tabl 2. the two deeper network 
(googlenet and vgg16) achiev the best patch-bas 
classif performance. In our framework, we adopt 
googlenet a our deep network structur sinc it be gen- 
eral faster and more stabl than vgg16. the network 
structur of googlenet consist of 27 layer in total and 

more than 6 million parameters. 

tabl 2: evalu of variou deep model 

patch classif accuraci 
googlenet [20] 98.4% 
alexnet [12] 92.1% 
vgg16 [19] 97.9% 
facenet [21] 96.8% 

In our experiments, we evalu a rang of magnifica- 
tion levels, includ 40×, 20× and 10×, and we obtain 
the best perform with 40× magnification. We use 
onli the 40× magnif in the experiment result re- 
port for the camelyon competition. 

after gener tumor-prob heatmap use 
googlenet across the entir train dataset, we note that 
a signific proport of error be due to fals posit 
classif from histolog mimic of cancer. To improv 
model perform on these regions, we extract addit 
train exampl from these difficult neg region and 
retrain the model with a train set enrich for these hard 
neg patches. 

We present one of our result in fig. 3. given a whole 
slide imag (fig. 3 (a)) and a deep learn base patch clas- 
sific model, we gener the correspond tumor re- 
gion heatmap (fig. 3 (b)), which highlight the tumor area. 



(a) tumor slide (b) heatmap (c) heatmap overlaid on slide 

figur 3: visual of tumor region detection. 

3.4. post-process of tumor heatmap to comput 
slide-bas and lesion-bas probabl 

after complet of the patch-bas classif stage, 
we gener a tumor probabl heatmap for each wsi. On 
these heatmaps, each pixel contain a valu between 0 and 
1, indic the probabl that the pixel contain tumor. 
We now perform post-process to comput slide-bas 
and lesion-bas score for each heatmap. 

3.4.1 slide-bas classif 

for the slide-bas classif task, the post-process 
take a input a heatmap for each wsi and produc a out- 
put a singl probabl of tumor for the entir wsi. given 
a heatmap, we extract 28 geometr and morpholog 
featur from each heatmap, includ the percentag of tu- 
mor region over the whole tissu region, the area ratio be- 
tween tumor region and the minimum surround convex 
region, the averag predict values, and the long axi 
of the tumor region. We comput these featur over tu- 
mor probabl heatmap across all train cases, and we 
build a random forest classifi to discrimin the wsi 
with metastasi from the neg wsis. On the test cases, 
our slide-bas classif method achiev an auc of 
0.925, make it the top-perform system for the slide- 
base classif task in the camelyon grand challenge. 

3.4.2 lesion-bas detect 

for the lesion-bas detect post-processing, we aim to 
identifi all cancer lesion within each wsi with few fals 
positives. To achiev this, we first train a deep model (d-i) 
use our initi train dataset describ above. We then 
train a second deep model (d-ii) with a train set that be 
enrich for tumor-adjac neg regions. thi model 
(d-ii) produc few fals posit than d-i but have re- 
duce sensitivity. In our framework, we first threshold the 

heatmap produc from d-i at 0.90, which creat a binari 
heatmap. We then identifi connect compon within 
the tumor binari mask, and we use the central point a the 
tumor locat for each connect component. To estim 
the probabl of tumor at each of these (x, y) locations, we 
take the averag of the tumor probabl predict gener- 
ate by d-i and d-ii across each connect component. the 
score metric for camelyon16 be defin a the averag 
sensit at 6 predefin fals posit rates: 1/4, 1/2, 1, 2, 
4, and 8 fp per whole slide image. our system achiev 
a score of 0.7051, which be the high score in the com- 
petit and be 22 percent high than the second-rank 
score (0.5761). 

4. experiment result 
4.1. evalu result from camelyon16 

In thi section, we briefli present the evalu result 
gener by the camelyon16 organizers, which be also 
avail on the websit 2. 

there be two kind evalu in camelyon16: slide- 
base evalu and lesion-bas evaluation. We won 
both of these two challeng tasks. 
slide-bas evaluation: the merit of the algorithm 
be assess for discrimin between slide contain 
metastasi and normal slides. receiv oper character- 
istic (roc) analysi at the slide level be perform and 
the measur use for compar the algorithm be area un- 
der the roc curv (auc). our submit result be gener- 
ate base on the algorithm in section 3.4.1. As show in 
fig. 4, the auc be 0.9250. notic that our algorithm per- 
form much good than the second best method when the 
fals posit rate (fpr) be low. 
lesion-bas evaluation: for the lesion-bas evalua- 
tion, free-respons receiv oper characterist (froc) 
curv be used. the froc curv be defin a the plot of 

2http://camelyon16.grand-challenge.org/results/ 

http://camelyon16.grand-challenge.org/results/ 


figur 4: receiv oper characterist (roc) curv of 
slide-bas classif 

sensit versu the averag number of false-posit per 
image. our submit result be gener base on the al- 
gorithm in section 3.4.2. As show in fig. 5, we can make 
two observations: first, the pathologist do not make ani 
fals posit predictions; second, when the averag number 
of fals posit be larg than 2, which indic that there 
will be two fals posit alert in each slide on average, our 
perform (in term of sensitivity) even outperform the 
pathologist. 

figur 5: free-respons receiv oper characterist 
(froc) curv of the lesion-bas detection. 

4.2. combin deep learn system with a hu- 
man pathologist 

To evalu the top-rank deep learn system 
against a human pathologist, the camelyon16 organ 
have a pathologist examin the test imag use in the com- 

petition. for the slide-bas classif task,th human 
pathologist achiev an auc of 0.9664, reflect a 3.4 per- 
cent error rate. when the predict of our deep learn 
system be combin with the predict of the human 
pathologist, the auc be rais to 0.9948 reflect a drop 
in the error rate to 0.52 percent. 

5. discuss 
here we present a deep learning-bas system for the 

autom detect of metastat cancer from whole slide 
imag of sentinel lymph nodes. key aspect of our sys- 
tem include: enrich of the train set with patch 
from region of normal lymph node that the system be 
initi mis-classifi a cancer; use of a state-of-the- 
art deep learn model architecture; and care design of 
post-process method for the slide-bas classif 
and lesion-bas detect tasks. 

historically, approach to histopatholog imag anal- 
ysi in digit patholog have focu primarili on low- 
level imag analysi task (e.g., color normalization, nu- 
clear segmentation, and featur extraction), follow by 
construct of classif model use classic ma- 
chine learn methods, including: regression, support vec- 
tor machines, and random forests. typically, these algo- 
rithm take a input rel small set of imag featur 
(on the order of tens) [9, 10]. build on thi framework, 
approach have be develop for the autom extrac- 
tion of moder high dimension set of imag featur 
(on the order of thousands) from histopatholog imag 
follow by the construct of rel simple, linear 
classif model use method design for dimen- 
sional reduction, such a spars regress [2]. 

sinc 2012, deep learning-bas approach have con- 
sistent show best-in-class perform in major com- 
puter vision competitions, such a the imagenet larg 
scale visual recognit competit (ilsvrc) [18]. 
deep learning-bas approach have also recent show 
promis for applic in pathology. A team from the re- 
search group of juergen schmidhub use a deep learning- 
base approach to win the icpr 2012 and miccai 2013 
challeng focu on algorithm develop for mitot 
figur detection[3]. In contrast to the type of machin 
learn approach histor use in digit pathology, 
in deep learning-bas approach there tend to be no dis- 
crete human-direct step for object detection, object seg- 
mentation, and featur extraction. instead, the deep learn- 
ing algorithm take a input onli the imag and the imag 
label (e.g., 1 or 0) and learn a veri high-dimension and 
complex set of model paramet with supervis come 
onli from the imag labels. 

our win approach in the camelyon grand challeng 
2016 util a 27-layer deep network architectur and ob- 
tain near human-level classif perform on the 



test data set. importantly, the error make by our deep 
learn system be not strongli correl with the error 
make by a human pathologist. thus, although the patholo- 
gist alon be current superior to our deep learn system 
alone, combin deep learn with the pathologist pro- 
duce a major reduct in pathologist error rate, reduc 
it from over 3 percent to less than 1 percent. more generally, 
these result suggest that integr deep learning-bas 
approach into the work-flow of the diagnost pathologist 
could drive improv in the reproducibility, accuraci 
and clinic valu of patholog diagnoses. 

6. acknowledg 
We thank all the camelyon grand challeng 2016 or- 

ganiz with special acknowledg to lead coordin 
babak ehteshami bejnordi. AK and ahb be co-found 
of pathai, inc. 

refer 
[1] E. H. ackerknecht et al. rudolf virchow: doctor, statesman, 

anthropologist. rudolf virchow: doctor, statesman, anthro- 
pologist., 1953. 1 

[2] A. H. beck, A. R. sangoi, S. leung, R. J. marinelli, T. O. 
nielsen, M. J. van de vijver, R. B. west, M. van de rijn, and 
D. koller. systemat analysi of breast cancer morpholog 
uncov stromal featur associ with survival. scienc 
translat medicine, 3(108):108ra113–108ra113, 2011. 5 

[3] D. C. cireşan, A. giusti, L. M. gambardella, and J. schmid- 
huber. mitosi detect in breast cancer histolog imag 
with deep neural networks. In medic imag comput 
and computer-assist intervention–miccai 2013, page 
411–418. springer, 2013. 5 

[4] R. S. cotran, V. kumar, T. collins, and S. L. robbins. rob- 
bin patholog basi of disease. 1999. 1 

[5] B. J. czerniecki, A. M. scheff, L. S. callans, F. R. 
spitz, I. bedrosian, E. F. conant, S. G. orel, J. berlin, 
C. helsabeck, D. L. fraker, et al. immunohistochemistri 
with pancytokeratin improv the sensit of sentinel 
lymph node biopsi in patient with breast carcinoma. can- 
cer, 85(5):1098–1103, 1999. 1 

[6] S. B. edg and C. C. compton. the american joint com- 
mitte on cancer: the 7th edit of the ajcc cancer stag 
manual and the futur of tnm. annal of surgic oncology, 
17(6):1471–1474, 2010. 1 

[7] J. G. elmore, G. M. longton, P. A. carney, B. M. geller, 
T. onega, A. N. tosteson, H. D. nelson, M. S. pepe, K. H. 
allison, S. J. schnitt, et al. diagnost concord among 
pathologist interpret breast biopsi specimens. jama, 
313(11):1122–1132, 2015. 1 

[8] F. ghaznavi, A. evans, A. madabhushi, and M. feldman. 
digit imag in pathology: whole-slid imag and be- 
yond. annual review of pathology: mechan of disease, 
8:331–359, 2013. 1 

[9] M. N. gurcan, L. E. boucheron, A. can, A. madabhushi, 
N. M. rajpoot, and B. yener. histopatholog imag anal- 

ysis: a review. biomed engineering, ieee review in, 
2:147–171, 2009. 1, 5 

[10] H. irshad, A. veillard, L. roux, and D. racoceanu. method 
for nucleu detection, segmentation, and classif in digi- 
tal histopathology: A reviewcurr statu and futur poten- 
tial. biomed engineering, ieee review in, 7:97–114, 
2014. 5 

[11] S. jaffer and I. J. bleiweiss. evolut of sentinel lymph 
node biopsi in breast cancer, in and out of vogue? advanc 
in anatom pathology, 21(6):433–442, 2014. 1 

[12] A. krizhevsky, I. sutskever, and G. E. hinton. imagenet 
classif with deep convolut neural networks. In 
F. pereira, C. J. C. burges, L. bottou, and K. Q. weinberger, 
editors, advanc in neural inform process system 
25, page 1097–1105. curran associates, inc., 2012. 3 

[13] G. H. lyman, A. E. giuliano, M. R. somerfield, A. B. ben- 
son, D. C. bodurka, H. J. burstein, A. J. cochran, H. S. 
cody, S. B. edge, S. galper, et al. american societi of clini- 
cal oncolog guidelin recommend for sentinel lymph 
node biopsi in early-stag breast cancer. journal of clinic 
oncology, 23(30):7703–7720, 2005. 1 

[14] G. H. lyman, S. temin, S. B. edge, L. A. newman, R. R. 
turner, D. L. weaver, A. B. benson, L. D. bosserman, H. J. 
burstein, H. cody, et al. sentinel lymph node biopsi for 
patient with early-stag breast cancer: american societi of 
clinic oncolog clinic practic guidelin update. journal 
of clinic oncology, 32(13):1365–1383, 2014. 1 

[15] R. E. nakhleh. error reduct in surgic pathology. 
archiv of patholog & laboratori medicine, 130(5):630– 
632, 2006. 1 

[16] N. otsu. A threshold select method from gray-level 
histograms. ieee transact on systems, man and cy- 
bernetics, 9(1):62–66, 1979. 2 

[17] S. S. raab, D. M. grzybicki, J. E. janosky, R. J. zarbo, F. A. 
meier, C. jensen, and S. J. geyer. clinic impact and fre- 
quenci of anatom patholog error in cancer diagnoses. 
cancer, 104(10):2205–2213, 2005. 1 

[18] O. russakovsky, J. deng, H. su, J. krause, S. satheesh, 
S. ma, Z. huang, A. karpathy, A. khosla, M. bernstein, 
et al. imagenet larg scale visual recognit challenge. 
intern journal of comput vision, 115(3):211–252, 
2015. 5 

[19] K. simonyan and A. zisserman. veri deep convolu- 
tional network for large-scal imag recognition. corr, 
abs/1409.1556, 2014. 3 

[20] C. szegedy, W. liu, Y. jia, P. sermanet, S. reed, 
D. anguelov, D. erhan, V. vanhoucke, and A. rabinovich. 
go deeper with convolutions. In cvpr 2015, 2015. 3 

[21] D. wang, C. otto, and A. K. jain. face search at scale: 80 
million gallery. 2015. 3 

[22] D. L. weaver, D. N. krag, E. A. manna, T. ashikaga, 
S. P. harlow, and K. D. bauer. comparison of pathologist- 
detect and autom computer-assist imag analysi 
detect sentinel lymph node micrometastas in breast can- 
cer. modern pathology, 16(11):1159–1163, 2003. 1 





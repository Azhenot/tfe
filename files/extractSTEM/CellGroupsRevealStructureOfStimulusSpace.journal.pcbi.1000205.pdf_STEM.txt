




































pcbi.1000205 1..13 


cell group reveal structur of stimulu space 
carina curto1.¤, vladimir itskov2.* 

1 center for molecular and behavior neuroscience, rutgers, the state univers of new jersey, newark, new jersey, unit state of america, 2 center for theoret 

neuroscience, columbia university, new york, new york, unit state of america 

abstract 

An import task of the brain be to repres the outsid world. It be unclear how the brain may do this, however, a it can 
onli reli on neural respons and have no independ access to extern stimulu in order to ‘‘decode’’ what those respons 
mean. We investig what can be learn about a space of stimulu use onli the action potenti (spikes) of cell with 
stereotyped—but unknown—recept fields. use hippocamp place cell a a model system, we show that one can (1) 
extract global featur of the environ and (2) construct an accur represent of space, up to an overal scale 
factor, that can be use to track the animal’ position. unlik previou approach to reconstruct posit from place cell 
activity, thi inform be deriv without know place field or ani other function relat neural respons to 
position. We find that simpli know which group of cell fire togeth reveal a surpris amount of structur in the 
underli stimulu space; thi may enabl the brain to construct it own intern representations. 

citation: curto C, itskov V (2008) cell group reveal structur of stimulu space. plo comput biol 4(10): e1000205. doi:10.1371/journal.pcbi.1000205 

editor: karl J. friston, univers colleg london, unit kingdom 

receiv juli 16, 2008; accept septemb 15, 2008; publish octob 31, 2008 

copyright: � 2008 curto, itskov. thi be an open-access articl distribut under the term of the creativ common attribut license, which permit 
unrestrict use, distribution, and reproduct in ani medium, provid the origin author and sourc be credited. 

funding: thi work be support by the swartz foundat and nation scienc foundat grant dms0818227. 

compet interests: the author have declar that no compet interest exist. 

* e-mail: vladimir@neurotheory.columbia.edu 

¤ current address: courant institut of mathemat sciences, new york university, new york, new york, unit state of america 

. these author contribut equal to thi work. 

introduct 

stimulu reconstruction, a implement by the scientist, 

typic involv three steps: (i) character the space of 

relev stimuli; (ii) construct function relat stimulu to 

neuron responses; and (iii) use these functions, togeth with 

new neuron activity, in order to ‘‘decode’’ new stimulu [1–11]. 

for example, in the case of hippocamp place cells, the ‘space of 

stimuli’ may be the animal’ current spatial environment; for everi 

place cell one comput a place field, i.e., a function that assign a 

fire rate to each posit in space. place fields, togeth with 

place cell activity, can then be use to infer the animal’ posit 

[2,4,7]. notably, the scientist reli on a priori assumpt about 

the natur of the relev stimulu space in (i), and us independ 

measur of previous observ stimulu in order to construct the 

function in (ii). while these function (or ‘‘neural codes’’) come in 

a varieti of forms, such a recept fields, tune curves, spike- 

trigger averages, adapt filter and condit probabl 

distribut [1–11], they all requir use independ observa- 

tion of prior stimulu for their construction. 

presumably, the brain also us neuron spike activ to 

reconstruct the stimulus. the brain, however, do not have access 

to independ stimulu measurements; neuron activ alon 

must repres the extern world. how do the brain do it? 

while much effort have be devot to develop biolog 

plausibl method to implement the ‘‘decoding’’ of step (iii) 

[1,3,6,10,11], it be gener assum that the structur of stimulu 

space (step (i)) and the function (such a recept field or tune 

curves) of step (ii) be both present and easili avail to 

downstream structur in the brain. although it be possibl that 

recept field be imprint in synapt weights, tune 

throughout develop and learning, thi stori be complic 

by the observ that recept field in some brain areas— 

particularli in hippocampus—undergo rapid context-depend 

remap [2,12–19]. thi lead natur to the question: can 

anyth be infer about a stimulu from spike alone? 

We address thi question in the context of hippocamp place 

cells. In rodents, spatial inform be reflect in the activ of 

place cells, i.e., pyramid cell in area ca1 and ca3 of dorsal 

hippocampu that fire in a restrict area of the spatial 

environment—th place field—and be mostli silent outsid 

[20,21]. We will use the term place field to refer both to the 
function and to the region in space where the fire rate be 

significantli abov baseline. place field remap, and a place cell 

can altern between multipl stabl place field a an anim be 

switch from one familiar environ to anoth [14,15]. 

although much work have go into tri to understand how 

place field be form [13,22–25], a differ and rather 

unexplor question be how the output of hippocamp place cell 

(without access to correspond place fields) might be use by 
downstream structur in order to reconstruct posit and the 

underli space. 

At first glance, it be not obviou that anyth at all may be 

learn about a particular environment—or the animal’ posit 

within it—us the spike activ of place cell alone. indeed, 

previou approach to reconstruct posit from place cell 

activ have all requir know the correspond place field 

[2,4,7]. furthermore, the valu of instantan fire rate [2,4] 

and the precis time of spike with respect to the theta rhythm 

[7] have be used, togeth with place fields, in order to improv 

position-estim precis beyond the place field diameter. It 

have also be suggest that other cell types, such a head direct 

cells, play a vital role in deciph posit inform [22]. 

becaus place field exhibit complex dynam and place cell do 

plo comput biolog | www.ploscompbiol.org 1 octob 2008 | volum 4 | issu 10 | e1000205 



more than just cod for place [26–30], it be import to 

identify—at least in theory—minim aspect of neural activ 

that yield suffici inform for construct of an accur 

represent of space. 

In thi work we show that a great deal of inform about a 

physic environ can be obtain use onli veri coars 

featur of popul spike activity. We defin a ‘cell group’ a a 

collect of cell that collect fire significantli abov baselin 

within a broad (,250 ms) tempor window; we do not call them 
‘cell assemblies’ to avoid confus with differ timescal and 

degre of sensori control impli by thi term [31–34]. We find 

that the simpl knowledg of which group of hippocamp place 

cell fire togeth be enough to (1) extract global topolog 

featur of the environment, and (2) reconstruct an accur 

geometr represent of physic space within which the 

animal’ posit can be faith tracked. thi be make possibl 

by use standard tool from algebra topolog and graph theory; 

neither place fields, nor precis spike timing, nor ani prior 

independ measur of posit be needed. 

result 

cell group reveal place field intersect inform 
although the brain may be unabl to establish direct 

relationship (such a place fields) between neural respons and 

extern stimuli, it can in principl compar neural respons to 

each other. moreover, relationship between neural respons 

reflect relationship between stimuli, and henc reveal structur of 

the outsid world. 

In rat hippocampus, the theta-oscil (6–10 hz) provid a 

natur timescal for organ popul activity. cell that fire 

within a few theta-cycl of each other be veri like to have 

overlap place fields. We defin a cell group a a group of place 

cell that collect fire within a two theta-cycl (250 ms) time 

window (figur 1a). note that thi enabl u to ignor finer spike 

time effect modul by the phase of the theta oscillation, such 

a phase precess [7,31,35–37]. each place cell typic belong 

to multipl cell group (figur 1b), and the activ of a give 

cell group be induc by the anim pass through the 

intersect of correspond place fields. cell group thu yield 

place field intersect inform (i.e., they reveal which subset of 

place field overlap), even when the place field themselv be 

unknown (figur 1c). 

We first show that thi intersect inform can be patch 

togeth to reveal global topolog featur of the environment. 

the method for extract global topolog featur do not 

requir a metric. On the other hand, by think of each cell 

group a defin a specif locat in space, we can use 

intersect inform to construct a metric that provid 

rel distanc between cell groups. thi yield a geometr 

represent of the extern physic space, obtain without 

know place fields. We find that thi intern represent be 

quit faith to the geometri of the environment. In either case, 

we need onli make some basic assumpt about place fields. We 

assum that place field exist and be stable, have similar sizes, be 

omni-directional, and have fire field that be convex. these 

assumpt be gener satisfi for place field of dorsal 

hippocamp place cell record from a freeli forag rat in a 

familiar open field environ (see methods). We also explicitli 

test the import of the assumpt that place field have similar 

sizes, and find that our result be in fact fairli robust to substanti 

variabl in place-field sizes. finally, we test our method with 

multipeak place fields, and find that our algorithm can toler 

a realist percentag of cell have multipl fire fields, so long 

a the compon field be suffici separ and convex. 

figur 1. collect of cell group uniqu determin the 
topolog of the environment. (a) sampl raster for the popul 
activ of five place cell in two differ environments. cell group be 
obtain by identifi subset of cell that co-fir within a coars time 
window (color rectangles). (b) two exampl of five-cel configura- 
tion (simplici complexes) depict collect of cell group 
obtain from the sampl raster in (a). An edg repres a cell 
group with two cell and a shade triangl indic a cell group with 
three cells; color correspond to cell group in (a). (c) cell that co-fir 
have overlap place fields. each cell group in (a), (b) correspond to 
a particular intersect of place fields, denot with match color. 
the place field intersect pattern fulli determin the topolog of a 
space cover by convex place fields. the first configur in (b) 
forc an arrang of place field with a hole in the middl (left); the 
second forc a space with no hole (right). 
doi:10.1371/journal.pcbi.1000205.g001 

author summari 

We construct our understand of the world sole from 
neuron activ gener in our brains. how do we do 
this? mani studi have investig how neural activ be 
relat to outsid stimuli, and map of these relationship 
(often call recept fields) be routin comput from 
data collect in neurosci experiments. yet how the 
brain can understand the mean of thi activity, without 
the dictionari provid by these maps, remain a mystery. 
We tackl thi fundament question in the context of 
hippocamp place cells—i.e., neuron in rodent hippo- 
campu whose activ be strongli correl to the 
animal’ posit in space. We find that the structur of 
stimulu space can be reveal by exploit relationship 
between group of cofir neuron in respons to 
differ stimuli. We provid a ‘proof of principle’ by 
demonstr construct how the topolog of space 
and the animal’ posit in an environ can be 
deriv pure from the action potenti fire by 
hippocamp place cells. In thi way, the brain may be 
abl to build up structur represent of stimulu 
space that be then use to repres extern stimuli. 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 2 octob 2008 | volum 4 | issu 10 | e1000205 



global topolog featur 
what may be thought of a a ‘space of stimuli’ at one level of 

process may constitut an individu stimulu at another: global 

featur of the ‘space of positions’ becom properti of individu 

environ that can be use to distinguish between them. often 

time an animal’ physic space have ‘‘holes’’—i.e., region in the 

interior of the environ where the anim be unabl to go. for 

example, a rat may be confin to a platform with one or more 

hole in the middle; similarly, there may be larg object insid the 

environ (such a trees) provid obstruct to the animal’ 

path. In either case, we call the region inaccess to the anim a 

hole. 

hole be exampl of (non-metric) topolog features, becaus 

they be preserv under continu deform of the space. two 

environ be say to be topolog equival (homeomorphic) if 
one can be continu deform into the other, and vice versa. 

homolog group [38] (see text s1) be topolog invari that can 
be use to distinguish topolog inequival spaces. In particular, 

the dimens of the first homolog group H1 count the number of 

holes. higher order homolog group (h2, h3, …) count higher- 

dimension ‘‘holes,’’ and thu place constraint on the minimum 

dimension of the space; they be all expect to vanish for flat, 

two-dimension environments. 

topolog featur can Be extract from cell group 
from spike train for a popul of place cells, we obtain a 

collect of cell group (figur 1a; see also methods). the 

correspond intersect inform can be use to comput 

homolog group of the underli environment—even though 

the place field themselv be unknown. intuitively, thi work 

becaus there be a uniqu configur of place field (up to 

continu deformation) consist with a give pattern of 

intersect (figur 1B and 1c). inspir by a deep theorem in 

algebra topolog [38] (see text s1), we have devis a procedur 

to comput homolog group from the collect of cell group 

activ in a give environment. thi theorem have also be use in 

the context of sensor network [39], and the potenti util of 

similar method in the case of hippocamp place cell be 

independ observ in [40]. our algorithm, describ in detail 

in the methods, involv construct a simplici complex 

(figur 1b) from place field intersect information, and 

comput it homolog groups. If the cell group obtain from 

spike train data exactli reflect the correct place field intersect 

information, the theorem guarante that the homolog of the 

simplici complex be equal to the homolog of the underli 

space. however, give the stochast natur of place cell firing, 

there be alway the possibl that we may miss cell group 

correspond to real intersections, and mistakenli detect cell 

group correspond to non-exist place field intersections. 

In order to verifi that thi procedur yield accur result within 

physiolog realist parameters, we test it use simul data 

with vari degre of noise. random-walk trajectori be 

gener in five differ flat, two-dimension environments, each 

of side length L (typic l,1 m), with N = 0,1,…,4 hole (figur 
s1). In each of 300 trials, each of the five environ be cover 

by 70 single-peak place field with vari radiu (0.1–0.15 L) and 
randomly-chosen center (figur 2a). place cell fire be gener 

accord to a simpl model (see methods). differ level of nois 

be introduc by remov a certain percentag of randomly- 

select spike from each spike train (for everi cell) and reassign 

them to occur at random times, so that they fall outsid the place 

field (see methods). 

for each trial, the first five homolog group (h0,…,h4) be 

computed. A trial be deem to be ‘correct’ if and onli if all 

homolog group match the topolog of the underli space, 

and ‘incorrect’ if at least one homolog group do not match. 

although the correct environ could be identifi use onli 

the first homolog group h1, we requir the other homolog 

group to also match in order to ensur consist of the overal 

topolog (i.e., thi be not a multiple-choic framework where 

each trial be assign the ‘most likely’ of the five environments; 

note that ‘chanc level’ here be close to 0%). for low level of noise, 

we found near 100% accuraci in all environ (figur 2b). 

one might worri that if a cell ever spike outsid of it place field, 

it will activ a cell group that do not correspond to a true 

intersect of place fields, render the topolog comput 

complet inaccurate. remarkably, the percentag of correct trial 

remain veri high for nois level up to 5%; even with 10% of each 

cell’ spike occur outsid the correspond place field, more 

than half of all trial continu to be correct (figur 2b). thi be 

becaus the threshold of fire rate in order to obtain cell group 

(see methods) render the procedur quit robust to nois in the spike 

trains. note that although the trajectori of the rat be itself litter with 

small hole (figur 2a), the procedur onli detect actual (rel 

large) hole in the environ and be quit insensit to hole that 

be veri small compar to the size of place fields. 

As a further test, we construct addit ‘shuffled’ data set 

by pool togeth spike activ from cell in differ 

environments. We found that each and everi ‘shuffled’ trial have 

nonzero high homolog groups, suggest higher-dimension 

spaces. thi indic that popul activ in the shuffl data 

set be not gener from realistic, two-dimension environ- 

ments, and suggest that a downstream structur receiv 

hippocamp output could detect pattern of activ that be 

inconsist with a spatial interpretation. 

figur 2. accuraci of extract topolog features. (a) sampl 
trajectori (green) in environ with one and zero holes. gray 
circl depict place field use to simul data for one trial. (b) for each 
environment, and for each level of add noise, the percentag of 
correct trial be comput from 300 trial (each have a differ set 
of randomly-gener place fields). A trial be consid ‘correct’ if all 
five comput homolog group match the topolog of the 
environment, and ‘incorrect’ if at least one homolog group do not 
match. 
doi:10.1371/journal.pcbi.1000205.g002 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 3 octob 2008 | volum 4 | issu 10 | e1000205 



An intern represent of space can Be built from 
cell group 

A give cell group becom activ when the anim cross a 

specif locat in space, give by the intersect of the 

correspond place fields. It be thu natur that, from the brain’ 

point of view, a locat in space be itself defin by a cell group 

(figur 3A and 3b). the collect of all activ cell group thu 

yield a collect of points, which can be thought of a ‘‘build 

blocks’’ for an internal, discret represent of space. A set of 

unrel points, however, do not constitut a space, one must 

know the relationship between point (which pair be close, and 

which be far away). fortunately, there be a natur way to 

determin when two cell group be ‘‘close’’ to each other, base 

on the number of place cell they have in common. 

We say that two cell group be neighbor if they differ by just one 

place cell. By join neighbor point with edges, one obtain a 

graph (figur 3c) that be construct pure from cell groups, 

without ani explicit knowledg of place fields. In general, 

neighbor cell group with a veri high percentag of overlap 

cell will repres point that be closer in space than neighbor 

with small overlap. We defin a dissimilar index mk on neighbor 
cell group a the averag rel distanc between the center of 

adjac region with overlap degre k, assum place field of 

equal radiu (see methods). In principle, mk should be deriv 
from basic geometry, a it depend onli on gener and 

unchang properti of physic space. We estim mk 
empir by comput the averag distanc between the 

center of adjac intersect region for 30 randomly-gener 

set of place field cover the environment, and normal the 

index by fix the larg valu m1 = 1 (see methods). We found 
that for kv ncell 

p2 
, the index be well approxim by the formula 

mk&1{p 
ffiffiffiffiffiffiffiffi 
k{1 
ncell 

q 
, where ncell be the number of place cell activ in 

the environ (see figur s2). We assum such an index can be 

‘‘hard-wired’’ in the brain, a it have no inform about ani 

particular arrang of place field or ani particular environ- 

ment. although we estim mk assum all place field have 
ident size, we use exactli the same formula for mk in everi 
reconstruction, regardless of the distribut of place field size we 

consider. 

the dissimilar index can be use to assign weight to each 

edg in the graph. A path be a sequenc of edg connect two 
vertex (cell groups) in the graph; the length of a particular path be 

give by sum the weight along it edges. the distanc 

between ani two cell group in the graph can then be defin a 

the length of a shortest path between those point (figur 3d; see 

also methods). In thi manner one obtain a natur metric on cell 
groups. We call thi graph, with cell group a it vertex and 

edg between neighbors, togeth with the metric, the intern 
represent of the extern space. 

intern represent accur reflect extern 
geometri 

In order to test how well the intern represent conform to 

the geometri of the extern space, we use simul popul 

spike activ from a two-dimension squar box environ 

(see methods) with differ number of place cells. for each 

number of place cell cover the environment, we randomli 

gener data set for 60 trials, each trial have differ place 

field of radiu chosen uniformli at random from the interv [0.1 

l,0.125 l], with randomly-chosen centers. the place field size 
be chosen to conform to the 20–25 cm rang of averag 

diamet typic observ for place cell in dorsal hippocampu 

for a rat explor an open field environ of scale l,1 m 
[41,42]. for each simul data set, we construct an intern 

represent a outlin above. 

To ass the accuraci of the intern representations, we first 

comput pairwis distanc between point on a fine grid 

span the l6l environ and compar them with the 
correspond pairwis distanc of their imag in the intern 

represent (figur s3). We defin the pairwis error for an 
individu trial (have a fix number of place cells) a the mean 

error in pairwis distanc when comput use the intern 

represent (see methods). We found that the averag pairwis 

error across trial have a minimum valu of 0.036 L for 90 cell 
(figur 4a), or less than 1/3 the averag place field radius; thi 

indic that rel distanc between point in the intern 

represent be accur to within a ball of approxim 1/9 

the median place field area. To check robust of thi procedur 

in the case of great place field variability, we repeat thi 

analysi for a seri of gamma-funct distribut of place field 

radiu (figur 4b). We found that perform decreas slowli for 

distribut with increas standard deviat up to ,0.035, 
and rapidli deterior for distribut with standard deviat 

great than 0.05 (figur 4c). 

As a further test that the full geometry—and not just pairwis 

distances—i accur reflect in the intern representation, we 

use multi-dimension scale (mds) [43] to emb each graph 

into a two-dimension euclidean space, in a way that best 

preserv the rel distanc between pair of point (i.e., to best 

preserv the metric on cell groups). next, we ‘‘aligned’’ the 

coordin of the emb intern space properli so a to best 

match the particular coordin use to repres the extern 

space (figur s4; see also methods). point in the extern space 

could then be map into the emb intern space by 

identifi correspond cell group (see methods). 

figur 3. construct of a metric on cell groups. (a) exampl 
spike train from five place cells. each time bin (columns) repres 
two theta cycles. (b) place field intersect pattern deriv from cell 
group in (a). shade region correspond to cell group insid 
rectangl of the same color in (a). (c) the pattern of intersect 
can be repres by a graph, with vertex (black squares) for each 
cell group, and edg connect neighbor (cell group that differ by 
one cell only). A trajectori (green) be infer from the exampl data, by 
‘‘connect the dots’’ to match the sequenc of cell group in (a). (d) 
weight be assign to edg of the graph use the dissimilar index 
mk, where k be the number of common cell between neighbors. the 
distanc between ani two vertex in the graph be obtain by 
sum the weight along a shortest path (blue). 
doi:10.1371/journal.pcbi.1000205.g003 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 4 octob 2008 | volum 4 | issu 10 | e1000205 



visually, the qualiti of an intern represent can be judg 

by map a coars grid of vertic and horizont line from the 

extern space into the emb intern space, and see how 

faith the geometr structur be preserved. We found that the 

full metric geometri (includ angl and rel distances) of the 

intern represent close mirror that of the extern space 

(figur 5a). In particular, the squar shape of the box and the 

rectilinear structur of the grid be faith reproduced. We 

quantifi the accuraci of a give intern represent by 

comput the mismatch between the two spaces; thi measur 
comput the averag error, a a fraction of box side length L, 
obtain by map a fine grid of point from the origin space 

into the align emb intern space (see methods). quit 

similarli to the pairwis error, we found that the averag 

mismatch decreas with increas number of cells, get a 

low a 3% for 120–140 cell (figur 5b). 

multipeak place field 
until now we have assum that place field be convex; while 

thi be usual the case, multipeak place field be often observed. 

In open field environ of size l,1 m, a small percentag (5– 
10%) of place cell have two disconnect fire fields, each of 

which look like a convex, single-peak place field [21,44]. We 

will refer to these neuron a ‘‘multipeak place cells,’’ and to the 

connect compon of the place field simpli a ‘‘fields.’’ At 

first glance, the presenc of multipeak place cell pose a 

potenti limit to our study. the algebra topolog theorem 

no longer holds, suggest that the algorithm we have thu far 

use for extract topolog featur be like to fail. In the case 

of the geometr reconstruction, on the other hand, we do not 

necessarili expect multipeak place field to pose a problem, so 

long a the compon field be individu convex. In general, 

the danger with multipeak place field be that distant region of 

space may be identifi a be the same. In an ‘‘across-cell’’ 

cod scheme where each neuron repres a distinct locat in 

space, thi ambigu inde pose seriou problem [21]. when 

locat be repres by cell groups, however, thi difficulti be 

easili overcome. although the same cell may fire in two locat 

that be far from each other, cell group correspond to these 

distant region will gener be veri different, a other cell serv 

to disambigu position. becaus two cell group be consid 

neighbor onli in the case that they share a major of cell in 

common, pair of cell group with onli one or a few common 

place cell be guarante to repres distant posit in the 

intern representation. 

In order to test the perform of the geometr reconstruct in 

the case of multipeak place cells, we simul data a befor but 

includ small percentag (up to 11%) of multipeak place cell 

while keep the total number of fire field cover the 

environ constant. In these simulations, we also requir that 

the center of multipl field correspond to the same cell be 

suffici distant; thi be in order to enabl disambigu by 

other cell (see methods). for 140 fields, we found the perform 

to be veri good (figur 6). An exampl reconstruct space from 

data contain 10% multipeak place cell demonstr that the 

algorithm natur separ the doubl field (figur 6A and 6b; 

see also figur s5). In particular, both the mismatch (figur 6c) and 

pairwis error (figur s6c) remain approxim constant 

rang from 0% to 11% multipeak place cells. 

for data gener from onli 90 fields, however, a in 

figur 5a, perform steadili decreas with increas 

number of multipeak place cells, a measur by both pairwis 

error and mismatch (figur s6a and s6b). thi be becaus there 

be not enough place field to double-cov the environment, 

lead some region within doubl field to fail to be 

disambigu by the presenc of other place cells, and thu 

caus larg distort in the reconstruct space. In fact, thi be 

precis the problem that may caus the topolog algorithm to 

fail. when the environ be double-cov by place fields, 

figur 4. error in pairwis distanc comput from intern 
geometr represent of space. (a) for a fix number of place 
cells, the pairwis error be comput and averag over 60 trials. each 
data set be gener from a differ set of place fields, with 
randomli select center and radiu chosen uniformli at random from 
the interv [0.1,0.125] (shade gray region; thi correspond to place 
field diamet rang from 20–25 cm in a 1 m61 m environment). 
the dash horizont line correspond to the averag radiu of place 
fields. the averag pairwis error achiev a minimum of 0.036 (a a 
fraction of box side length L) for 90 cells, and then level off. thi 
indic that rel distanc between pair of point in the intern 
represent be accur to within an error that be less than 1/3 the 
averag radiu of place fields. (b) variou gamma-funct distribut 
for place field sizes, with fix mode = 0.1125 L and vari standard 
deviations. radii great than 0.5 L be not considered, a these 
correspond to place field diamet that exceed the side length of the 
box. dash line indic the uniform distribut use in (a). (c) mean 
pairwis error averag over 60 trial for ncell = 90 and for each of the 
distribut of place field radiu display in (b). dash line denot 
the place field radiu correspond to the peak of each distribution. 
error bar in both (a) and (c) repres standard deviat across trials. 
doi:10.1371/journal.pcbi.1000205.g004 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 5 octob 2008 | volum 4 | issu 10 | e1000205 



however, place cell with multipl field can be detect pure 

from the graph of neighborhood relationship on cell group 

(construct a in figur 3c). for each place cell, there be an 

induc subgraph whose vertex be the cell group contain 

that cell. each connect compon of thi subgraph correspond 

to a distinct field (figur s7). have detect addit field for 

multipeak place cells, we can then assign auxiliari ‘‘place cells’’ 

to substitut the origin cell label such that each connect 

compon correspond to a distinct cell. We then build the 

simplici complex and comput homolog group a before. 

regard the (unknown) place field a provid an open cover 

of the underli space, the add step of the topolog algorithm 

can be thought of a make the minim possibl refin [45] of 

the open cover such that the theorem again hold (see methods). 

We found that with thi modification, the topolog algorithm 

maintain veri good perform for the experiment observ 

rang of 5–10% multipeak place cell (figur 6d). 

discuss 

We have show that, in the case of hippocamp place cell 

activity, global topolog featur of a two-dimension environ- 

ment a well a an accur geometr reconstruct of physic 

space—includ the animal’ posit within it—can be infer 

from spike alone. In either case, one need onli assum that place 

field exist and have a stereotyp form; knowledg of actual place 

field or ani other prior independ measur of posit be 

not needed. thi provid a gener framework for build up 

stimulu space (or ‘cognit maps’ [46]) use onli neural activ 

from a rel homogen popul of neurons, such a 

dorsal hippocamp place cells. 

even after obtain a geometr represent of space, global 

topolog featur (if needed) must still be computed. although 

we may be abl to ‘‘see’’ topolog featur of the stimulu space 

by look at a two-dimension emb of the intern 

representation, thi do not mean no further comput be 

necessary; it mere reflect the fact that our visual system be abl to 

do the computation. moreover, global featur of a ‘space of 

stimuli’ at one level of process may becom properti of an 

individu (composite) stimulu at another. interestingly, although 

the comput of topolog featur also have cell group a it 

start point, it do not requir construct a geometr 

represent of space, and henc bypass the need for a metric. 

At first glance, our intern represent be perhap reminis- 

cent of the ‘cognit graph’ in [47,48], a it be also a graph 

construct to repres a physic environment. the ‘cognit 

graph,’ however, be envis a an actual neural (sub-) network 

realiz in the hippocampus, with an individu place cell for everi 

vertex and a synaps for everi edge. the metric be encod in 

synapt weight between place cells, and determin via an ltp 

learn rule. thi impli that geometr distort would result 

from a bia sampl of the environ by the animal’ 

trajectory. although each vertex in the ‘cognit graph’ be 

intend to repres the center of the correspond place field, it 

figur 5. accuraci of full geometri for intern represent of space. (a) the origin space (left) and a reconstruct from simul 
place cell activ (right). black dot correspond to cell groups. A coars grid (red and orang lines) in the origin space be map into the 
reconstruct space, to allow for visual comparison of the geometry. (b) the accuraci of a reconstruct space may be quantifi by comput the 
‘mismatch’ between point in the origin space and their imag in the reconstruct space, a a fraction of the box side length L. the mismatch 
decreas with increas number of cells. error bar correspond to standard deviat for averag mismatch across 60 trials. the dash horizont 
line correspond to the averag radiu of place fields, while the shade gray area correspond to the rang of place field radii. 
doi:10.1371/journal.pcbi.1000205.g005 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 6 octob 2008 | volum 4 | issu 10 | e1000205 



be alway the case that mani place cell be simultan activ at 

ani give locat in space, suggest that thi graph be not 

suitabl to repres specif posit give popul place cell 

activity. moreover, the exist of multipeak place cell 

present a seemingli insurmount challeng in thi and ani 

paradigm where place cell fire be presum to signal proxim to 

a singl place [21]. 

In contrast, our intern represent graph have a vertex for 

everi group of reliabl co-fir neurons, and be closer in spirit to 

hebb’ cell assembl [34] than to a liter neural network 

represent of space. sinc distanc between cell group result 

from the combinator of their overlaps, the fact that multipl 

cell co-fir in respons to a give stimulu be not a nuisanc but a 

necessari condit for infer the structur of the underli 

space. An essenti featur be that, unlik in the case of kohonen 

map [49], geometr relationship between extern stimulu be 

reveal even when neuron in the network have no a priori 

topograph structur (a in hippocampus). moreover, the 

result metric on cell group be insensit to a bia sampl 

of the environ or to the particular valu of synapt weight 

within the hippocampus, and do not depend on nearbi stimulu 

occur in tempor proxim to each other, a would be 

requir to infer stimulu space structur use spike train metric 

[50]. instead, we have use onli a veri coars aspect of popul 

spike activity—th set of all cell groups—whil fulli exploit 

the fact that co-fir cell have overlap recept fields. 

these result suggest that it may be possibl for map of the 

environ to be construct in downstream brain area pure 

from cell groups. If thi be the case, we would expect that geometr 

distort in the animal’ spatial percept would aris a a 

consequ of uneven place field coverag of an environment: 

the anim should overestim distanc in a region of high 

place field density, and underestim distanc in region with 

significantli low place field density. thi prediction, if confirm 

by experiment, would provid evid that onli cell group be 

use in construct intern represent of space. if, on the 

other hand, such perceptu distort be not observed, we can 

be almost certain that some other aspect of neural spike activ 

figur 6. accuraci of metric reconstruct and topolog comput with multipeak place cells. (a) the origin space, togeth 
with double-peak place field for three exampl simul place cell (blue, green and magenta). (b) A reconstruct space obtain from a data 
set where 10% of the place cell have double-peak place fields. black dot correspond to cell groups, a in figur 5a. cell group contain each 
of the three place cell with multipeak field display in (a) be show with correspond color. cell group contain each of the 13 
multipeak place cell in thi data set be show in figur s5. (c) for a fix total number of 140 field cover the environment, the mismatch 
remain nearli constant for increas percentag of multipeak place cells. error bar correspond to standard deviat for averag mismatch 
across 60 trials. (d) the extract of topolog featur also perform well on simul data includ up to 10% multipeak place cells. the 
percentag of correct trial be comput across 50 trial with 0%, 2.5%, 5%, 7.5%, and 10% of cell have double-peak place fields. As in 
figur 2b, a trial be consid ‘correct’ if and onli if all five comput homolog group match the topolog of the environment. 
doi:10.1371/journal.pcbi.1000205.g006 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 7 octob 2008 | volum 4 | issu 10 | e1000205 



contributes. interestingly, becaus in our simul we chose 

place field center uniformli at random from within the environ- 

ment, we consist have a low densiti of place field coverag 

near the boundaries. this, in fact, lead to great geometr 

distort near the boundari of our spatial reconstruct than 

in the interior. To compens for this, one might expect there to 

be a great number of place field near the boundari of an 

environment. such an effect has, in fact, be report 

experiment [51,52], and may be regard a a postdiction. 

We have consid environ that be flat and two- 

dimensional; however, it be easi to gener our procedur to 

stimulu space that be higher-dimension and/or curved. 

recent experi suggest that three-dimension hippocamp 

place field may be observ in fli bat [53]. the topolog 

algorithm can be use in exactli the same way to detect hole or 

obstacl in three-dimension environ from cell groups. the 

geometr reconstruct algorithm could also be use in exactli 

the same manner, the onli differ be that a differ 

dissimilar index mk, comput for three-dimension space, 
would need to be used. furthermore, we believ our approach 

could be gener to stimulu space reflect in other brain 

areas. the geometr method could prove use in discov 

new structur in stimulu space reflect in neocort areas, 

such a primari and high order sensori cortices. moreover, the 

brain appear to be particularli adept at identifi topolog 

properti of complex objects. for example, connect compo- 

nent and hole in a visual object or scene be often among the 

most salient features. A topolog approach, such a the one we 

have use here, could yield insight into understand how global 

featur of a visual object be extract from the activ of cell 

with spatial local recept fields. 

our notion of stimulu reconstruct be a signific departur 

from tradit ‘‘decoding’’ paradigms, a it do not requir 

directli relat neuron activ to extern stimulu (a in the 

comput of recept fields), or to activ in ani other area of 

the nervou system. moreover, while the comput of recept 

field begin with a priori assumpt about the natur of the 
stimulu space be represented, we recov the structur of the 

stimulu space itself from the structur of the induc pattern of 

neuron activity. the ident of a particular stimulus, then, 

emerg from a combin of modal (the locat and type of 

activ neurons) and the relationship of it correspond cell 

group to all other in an intern repres space. ani 

necessari assumpt about recept field may be regard a a 

kind of ‘‘univers grammar’’ [54] that render stimulu space 

reconstruct possible. 

recent it have be suggest that sequenti replay, a 

observ in hippocampu and neocortex [55–58], may be a 

mechan for consolid sequenc of cell that under spatial 

navig condit fire within larg time windows. the 

sequenc reflect group of cell that co-fir within the same theta 

cycl dure behavior, however, and it be unclear to what extent 

the precis order matter [59,60]. It be therefor plausibl that 

cell group may be commun to cortex dure replay 

events—on a compress timescale—en identif via 

coincid detection. thi may allow for build represent 

of space and comput topolog in cortex, a these comput 

requir knowledg of the full collect of cell groups. 

In summary, we have show that a surpris amount of 

inform about the structur of stimulu space can be obtain 

from the combinator of cell groups, extract from noisi 

popul spike data with a coars time window. although we 

be abl to demonstr the presenc of thi inform 

constructively, whether and how the brain us thi inform 

remain to be seen. our result suggest, nevertheless, that 

combinatori relationship between group of cell that fire 

togeth could reflect stimulu space structur insid the brain, and 

may perhap lead to a gener principl of how the brain 

construct represent of the outsid world. 

method 

here we describ how to comput homolog group and 

construct an intern represent of space from neural spike 

data. the start point for each method be the identif of cell 

groups. We begin, however, by outlin some basic assumpt 

about place field need for these procedur to work, and a 

descript of the simul data we use to test our approach. 

assumpt about place field 
(1) place field be omni-directional, a be typic in an open field 

environment, but not on a linear track [21,61]. (2) place field have 

be previous form and be stable. (3) the collect of place 

field correspond to observ cell cover the entir travers 

environment. (4) the holes/obstacl be larg than the diamet 

of place fields. (5) each (connected) compon field of a singl or 

multipeak place field be convex. (6) background activ be low 
compar to the fire insid the place fields. (7) place field be 

roughli circular and have similar sizes, a be typic in dorsal 

hippocampu [41,42]. 

although individu electrophysiolog record can onli 

simultan monitor a limit number of cells, it be almost 

certain that the hippocampu poss enough place cell for ani 

give environ such that the correspond place field cover 

the entir explor space mani time over [44]. the convex of 

compon field mean that a straight line segment connect 

ani two point in the field will itself be entir contain within 

the field. thi be consist with the observ that individu 

field tend to have circular or ellipt shape [21]. although these 

be reason assumpt about dorsal hippocamp place cells, 

they pose signific constraint on the qualiti and quantiti of cell 

in the recording. one may assume, however, that downstream 

structur in the brain receiv hippocamp output do have 
access to thi kind of data. We test our approach for construct 

intern represent and comput homolog group on 

simul data that satisfi these criteria. 

simul data 
each environ be an l6l box, with or without hole in the 

interior. all length unit be with respect to the side length L of the 
box (typic l,1 m). In order for the topolog and metric 
algorithm to work, we of cours need the anim to fulli explor 

the environment. In particular, the trajectori must be dens 

enough to sampl the major of cell groups. for the geometr 

reconstructions, thi be mere a matter of resolution, a sampl 

few cell group will lead to less precis geometr information. 

for the topolog computations, we need to ensur that the set of 

all cell group reveal the full low-ord intersect inform in 

order for the low-ord homolog group to be accurate. for 

accur comput of the nth homolog group hn, we need up 
to (n+1)-fold intersect to be detect via cell groups. If we 
be onli interest in the first homolog group H1 (thi be enough 

to detect holes/obstacl and distinguish between environments) 

we need onli guarante that pairwis intersect be accur 

reflected—i.e., the trajectori must pa through each pairwis 

intersect of place field at least once. however, becaus we 

comput homolog group up to h5, in order to check consist 

of the data with the interpret a a two-dimension 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 8 octob 2008 | volum 4 | issu 10 | e1000205 



environment, we have use denser trajectori in our simulations. 

thi would not be necessari if we be onli interest in H0 and 

h1. note that a high-ord cell group of n cells, signifi an n- 

fold intersection, impli all lower-ord intersections. 

for topolog features. for each of five environ 

(figur s1) we gener a smooth random-walk trajectory, with 

speed = 0.1 l/ (thi be 10 cm/ for a 1 m61 m box), which be 
constrain to ‘‘bounce’’ off boundari and stay within the 

environment. the total durat of each simul trajectori be 

50 minutes. for each of 300 trials, N = 70 place field be 

gener a disk of radiu 0.1 L to 0.15 L, with radiu and center 
chosen uniformli at random. In order to ensur place field 

cover the environment, center be chosen initi uniformli 

at random from uncov space. onc all space be covered, 

remain place field center be chosen at random from the 

entir box (figur s1). 

for each place cell in each trial, an averag fire rate be 

chosen uniformli at random from the interv 2–3 hz. A spike 

train be gener from the trajectori and correspond place 

field a an inhomogen poisson process with constant rate 

when the trajectori pass insid the place field, and zero outside, 

so that the overal fire rate be preserved. becaus we threshold 

the number of spike in each time bin to obtain cell groups, thi be 

equival to have somewhat larg non-const place field 

where the fire rate drop quickli below threshold outsid the 

specifi radius. noisi spike train be creat accord to the 

nois percentag r (0–10%) a follows. r% spike be delet 
from the spike train, and then add back to the spike train at 

random times, irrespect of posit along trajectory, so a to 

preserv overal fire rate. ‘shuffled’ data set be construct by 

randomli choos cell from each of the five environments, and 

pool them togeth to yield popul spike activ that do 

not come from a singl environment. 

for reconstruct of space. here we consid a squar 

box environ with no holes. place field be gener with 

radiu select uniformli at random from the interv [0.1 L, 0.125 

l]. thi be consist with the 20–25 cm averag place field 

diamet typic observ for dorsal hippocamp place cell in 

an environ of scale l,1 m [41,42]. In the simul for 
figur 4c, place field size be gener from gamma function 

distribut (shown in figur 4b) all have peak at 0.1125 L and 

have minim place field radiu of 0.05 L. the locat of the 
peak, the minimum place field size and the standard deviat 

uniqu determin each gamma distribution. averag fire rate 

be chosen uniformli at random from the interv 1–3 hz. the 

trajectory, locat of place fields, and the spike train for each 

place cell be gener a describ above. for each total 

number of cell (ncell = 40–140, increas by 5), we have 60 trials, 

each with differ randomli chosen place field and 

inhomogen poisson spike trains. 

simul with multipeak place fields. In simul 

with multipeak place fields, secondari field be randomly- 

gener for the popul of multipeak place cell with the 

condit that the center of the second field be a distanc great 

than 0.5 L away from the center of the first randomly-gener 

field. thi be to guarante that pair of field for double-peak 

cell be suffici well-separ to allow detect of separ 

field via cell group (see figur S5 and figur s7). A high 

densiti of coverag by place field would allow the distanc 

between multipl field of the same cell to be smaller, approach 

the minim separ requir for the field to be disconnected. 

the radiu for the compon field in double-peak place field 

be drawn independ from the same distribut of radiu 

use for single-peak place fields. all other aspect of the 

simul with multipeak place field be the same a for 

simul with onli single-peak place fields. 

identif of cell group 
We defin a cell group a a group of place cell that collect 

fire within a two theta-cycl (250 ms) time window. To determin 

the full set of cell group that becom activ a the anim 

travers the environment, we first bin popul spike train into 

2-theta-cycl time bins. A certain subset of cell fire in each time 

bin, and we use these subset to determin the cell groups. becaus 

there be some probabl that a give place cell will fire outsid it 

place field, we impos a threshold on fire rate in order to 

determin the group of cell that fire significantli abov baselin 

for each bin. each result cell group can then be assum to 

correspond to a particular intersect of place fields. 

We first divid popul activ into a set of popul 

vectors, i.e., vector in rncell with fire rate for each cell in a 
give time bin. In order not to miss ani cell group due to the 

arbitrari choic of where bin start and end, the bin time 

window be then shift to have a total of five differ start 

posit (eight for topology), equal space within two theta- 

cycles, so that each spike contribut to five popul vectors. all 

popul vector be pool and threshold a follows. for 

each cell, the fire rate in a particular popul vector be 

consid signific if it be at least 6 time the averag fire 

rate for that cell. each popul vector thu yield a cell group, 

consist of all cell fire significantli abov baselin in a 

particular time bin. the threshold be what render the topolog 

and reconstruct of space procedur fairli robust to nois in the 

spike trains. 

extract of topolog featur 
here we describ how to comput the homolog group of a 

give environ from the collect of all cell group that be 

activ in the environment. 

some mathemat preliminaries. We use a few standard 

mathemat object that be uncommon in the neurosci 

literature. here we give brief descript of these objects; see text 

S1 for rigor definitions. A simplici complex be a set of vertex 
and simplic (simplic be n-dimension triangles: points, line 
segments, triangles, tetrahedra, etc.). An abstract simplici complex be 
a set with a set of subset satisfi similar properti a simplices. 

We will use it a a combinatori object that keep track of 

intersect inform reveal by cell groups. roughli 

speaking, homolog group [38,45,62] count the number of ‘‘holes’’ 
of variou dimens in a give topolog space. the dimens 

bi of the homolog group Hi be call betti numbers. the 0 
th betti 

number b0 count the number of connect compon in a 
space, while b1 count the number of hole that can be border 
by a close 1-dimension contour. higher betti number bi, i.1, 
count the number of ‘‘holes’’ in high dimensions. there be 

mani definit of homolog group that can be show to be 

equival in most case of interest [38]. We use simplici homolog 
groups. simplici homolog group be defin for ani topolog 
space which can be subdivid into a simplici complex; they be 

also defin for abstract simplici complexes. In other words, the 

definit appli to the two-dimension spatial environ 

explor by the animal, a well a to the high-dimension abstract 

simplici complex we obtain from popul spike data. 

comput of homolog group from cell groups. the 

set of all cell group for a complet data set natur yield an 

abstract simplici complex. each cell be a vertex, and each group 

of n cell yield an (n – 1)-dimension face (figur 1b). A 1- 
dimension face be an edge, a 2-dimension face be a triangle, a 3- 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 9 octob 2008 | volum 4 | issu 10 | e1000205 



dimension face be a tetrahedron, and so on. assum place field 

be convex, a deep theorem in algebra topolog [38] impli that 
the homolog group of thi simplici complex be equal to the 

homolog group of the underli space (see text s1). We can 

thu distinguish between differ environ by comput 

their homolog group from popul spike data alone. for 

our two-dimension flat environments, b0 be alway 1 and high 
betti number (bi, i.1) all vanish. (if the anim be explor the 
entir surfac of a ball, however, we would expect b2 = 1.) the 1 

st 

betti number b1, on the other hand, be differ for each of the five 
environments, match the number of hole in each. 

To comput homolog group for the veri larg and high- 

dimension simplici complex defin by cell groups, we use an 

algorithm from comput algebra topolog implement for 

the gap softwar packag [63,64]. the algorithm reli 

exclus on standard linear algebra, and be thu in principl 

realiz by a simpl neural network. We comput the first five 

homolog group h0,…,h4, and declar a trial to be ‘correct’ 

when all betti number match what be expect for the 

environment: b0 = 1, b1 = number of holes, and bi = 0 for i.1. A 
trial be deem to be ‘incorrect’ if at least one of the five 

comput betti number do not match. 

‘‘refinement’’ step for multipeak place cells. In the 

previou analysis, the convex of place field be need such 

that the open cover (see text s1) associ to the set of all place 

field satisfi the properti necessari for the theorem to hold. If 

the data includ place cell have multipeak place fields, we 

need to assign an open set for each connect compon of the 

place field. fortunately, multipl field can easili be detect from 

the set of all cell groups, by identifi connect compon in 

the induc subgraph of neighborhood relationship between cell 

group (see figur s7). By assign a distinct open set for each 

compon of thi graph, we can then build the simplici complex 

and comput homolog group exactli a if each field 

correspond to a differ cell. the add step to the topolog 

algorithm can be thought of a make the minim possibl 

refin [45] of the open cover, defin by the (unknown) place 
fields, such that the theorem again holds. A refin of an open 
cover be a new cover such that each set in the new cover be fulli 

contain in an open set of the old one. In order to detect the 

connect compon of a graph defin via an adjac 

matrix, we use the standard dulmage-mendelsohn matrix 

decomposition, implement in the matlab routin ‘dmperm’. 

intern reconstruct of space 
here we describ the construct of an intern represent 

of the environ from the collect of all cell group that be 

activ in that environment. thi can be summar in two steps: 

(i) construct of a graph, contain a vertex for everi cell group 

and an edg between neighbor cell groups, and (ii) construct 

of a distanc matrix (or metric) contain distanc between ani 

two cell groups. In order to verifi that the intern represent 

be faith to the geometri of the extern space, we comput the 

averag error on pairwis distanc between point in the extern 

space a estim use the metric for the intern representation. 

To further valid that the full geometri be accur reflect in 

the intern representation, we use multidimension scale 

(mds) to emb the graph in two-dimension euclidean space in 

a way that best preserv the metric on cell groups. thi enabl 

comparison of the full geometri by visual inspect and by 

comput of the mismatch (see below). 

region repres by cell groups. each cell group 

defin a point, or small region in space contain in the 

intersect of the correspond place fields, but not in ani high 

order intersect (a thi would correspond to add addit 

cell to the cell group). mathematically, if ck#{1,…,ncells} denot a 
cell group with k cells, and uck be the intersect (a a subset of the 
environment) of the correspond place fields, then the region of 

space correspond to the cell group Ck be give by vck ~ 

uck { 
S 

ckz16ck 
uckz1 . for example, the color region in figur 1C 

and figur 3B all correspond to subset of the form vck . similarly, 
the black dot in figur 3C and 3d, each correspond to a cell 

group ck, repres region of space of the form vck , not pure 
intersect uck . 

dissimilar index. the distanc between ani two cell 

group be comput via a dissimilar index mk on neighbor (cell 
group that differ by just one cell). for each total number ncell of 

place cells, we estim mk empir by comput the averag 
distanc between the center of adjac intersect region vck 
and vckz1 for 30 randomly-gener set of place field have 
uniform radiu (r = 0.1) cover the environment. We normal 
the index by fix the larg valu m1 = 1. note that for each 
valu of ncells, mk depend onli on the order k of the small cell 
group. empir comput valu of mk for differ number of 
cell be show in figur s2a. In principle, mk should be deriv 
from basic geometry; we find that it be well approxim by the 

formula mk&1{p 

ffiffiffiffiffiffiffiffiffiffiffi 
k{1 

ncell 

r 
, for kv 

ncell 

p2 
(figur s2b). although 

thi formula be obtain assum all place field have exactli the 

same size, we have use the same formula for place field of 

vari radii, regardless of the particular distribut (uniform or 

gamma) be considered. 

distanc matrix (metric on cell groups). given a 

collect of cell groups, we obtain a distanc matrix (or metric) 

contain distanc between ani two cell group a follows. We 

first construct a graph whose vertex be cell groups, and whose 

edg be give by neighbor pair of cell group (figur 3c). To 

each edg between neighbor of degre k and k+1 we assign the 
weight mk (figur 3d). A path be a sequenc of edg connect two 
vertex in the graph; the length of a particular path be give by 

sum the weight along it edges. the distanc between ani 

two cell group (vertic in the graph) can then be defin a the 

length of a shortest path between those point (figur 3d). We use 

johnson’ ‘all shortest paths’ algorithm [65], implement for 

matlab in [66], to construct a distanc matrix with distanc 

between each pair of cell groups. note that thi yield a metric in the 

strict mathemat sense, a it be posit definite, reflexive, and 

satisfi the triangl inequality. finally, we add a 0–1% random 

nois jitter to the entri of the distanc matrix, to ensur that the 

md method we late use (below) do not encount ani 

degeneraci due to multipl entri of the matrix be exactli 

equal. 

map between spaces. point in the origin space be 

map into the intern represent a follows. assum place 

field cover the environment, ani point in the origin space lie in 

a particular intersect region vck , and be expect to activ the 
cell group ck, where k be the number of cell (equivalently, the 
order of intersection). We can thu identifi point in the origin 

space with the correspond cell group (vertices) in the intern 

representation. In case where the number of cell be not 

suffici to complet cover the environment, uncov point 

be map to the intern space use the near cell group. for 

a give point p in the environment, we denot the correspond 
cell group a c(p), regardless of the number of cell it contains. 

pairwis error. In order to quantit ass the qualiti 

of the intern representation, we compar distanc between 

pair of point (p,q) in the origin environ to the distanc 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 10 octob 2008 | volum 4 | issu 10 | e1000205 



between their correspond cell group c(p) and c(q) in the 

intern representation. for a give trial, we comput the pairwis 

error a the averag valu of ip2q|2d(c(p),c(q))|, where d be the 
(renormalized) construct metric on cell groups, and the averag 

be take over all pair of point (p,q) come from the grid show 

in figur s3. becaus the scale for the metric on cell group be 

set by the convent m1 = 1, we multipli the construct metric 
for the intern represent by an overal constant such that the 

mean pairwis distanc comput use d match the mean 

pairwis distanc in the extern environment; thi ensur that 

differ in overal scale would not contribut to the pairwis 

error. the averag pairwis error for 60 trials, a a function of the 

total number of place cells, be show in figur 4. 

embed intern representation. given a distanc 

matrix for a collect of points, and a specifi dimension, a 

non-metr md algorithm [43] arrang the point in euclidean 

space so a to best preserv the order of the distanc in the 

distanc matrix. (in other words, nearbi point will be map 

close togeth and far away point will be kept far away, though 

actual distanc may be distorted.) We use the matlab 

implement ‘mdscale.’ thi enabl u to visual ass how 

accur the intern represent reflect the full extern 

geometry, beyond just pairwis distanc between points. line 

and trajectori in the origin space can be map into the 

emb intern represent by ‘‘connect the dots’’ 

between the imag of their point (see figur 5a). 

comparison to origin space, alignment, and 

mismatch. the output of md be onli uniqu up to a 

euclidean transform (rotat and translation). moreover, 

the overal scale in our distanc matrix be arbitrary, a we 

normal our dissimilar index on neighbor such that onli 

rel distanc mattered. In order to compar the raw md 

output to the origin space we must therefor ‘‘align’’ the intern 

represent properly. We do thi by find the optim affin 

transform (rotation, translat and scaling) that minim 

the distanc between point in the origin space and their imag 

in the intern represent space. 

An affin transform be a transform of the form 

T x!~t 
x1 

x2 

� � 
~ 

a11 a12 

a21 a22 

� � 
x1 

x2 

� � 
z 

b1 

b2 

� � 

parameter by six number (a11,a12,a21,a22,b1,b2). thi amount 

to translat (2 parameters), rotat (1 parameter) and scale in 

two independ direct (3 parameters, the third be the angl 

between directions). We find an optim affin transform T 
relat the raw md output to the extern space by minim 

a function of six variabl 

f a11,a12,a21,a22,b1,b2ð Þ~ 
ðð 

T m x! 
� �� � 

{ x! 
�� ��d2 x!, 

where x! be a point in the extern space and m x! 
� � 

be it imag 

after map to the intern space. the doubl integr be take 

over the entir squar area of the extern environment, and be 

comput by sum over a grid of 1506150 points. the 
optim be perform use ‘fminsearch’ in matlab. the 

result optim transform be then use to align the raw md 

output to good match the coordin on the origin space. 

figur S4 show raw md output (left column) and correspond- 

ing align version (middl column). 

after alignment, we can evalu the qualiti of the represen- 

tation by comput it ‘‘mismatch’’ with the origin space. A fine 

grid of point (1506150) in the origin space be map to the 
align intern space, and the distanc T m x! 

� �� � 
{ x! 

�� �� 
between grid point and their imag be computed, a a fraction 

of the box side length L. the averag of all of these distanc be 
call the mismatch. 

note that the align procedure, which do requir the use of 
place field and independ posit information, be onli 

necessari for comput the mismatch—i.e., to quantifi how well 

the emb intern represent directli compar to the 

extern space. thi be becaus the particular coordin system 

we choos to parameter the intern and extern space be 

complet arbitrary, and must be shifted, scale and rotat to 

match. the brain do not need to perform either md or 

‘‘alignment’’; it need onli track posit with respect to it own, 

intern construct represent of space. 

support inform 

figur S1 five differ environ use in simulations. the 

trajectori (green) be gener use a smooth random walk. 

sampl place field for one trial per environ be depict a 

gray circles. the holes/obstruct can be see a white 

rectangl not cover by the trajectory. 

found at: doi:10.1371/journal.pcbi.1000205.s001 (7.10 MB eps) 

figur S2 An approxim formula for the index mk. (a) the 
dissimilar index mk on neighbor cell groups, for differ 
number of cells, comput empir (see methods). (b) compar- 

ison between empir comput mk (black traces) and the formula 

1{p 

ffiffiffiffiffiffiffiffiffiffiffi 
k{1 

ncell 

s 

(red traces) for variou valu of ncells. the valu of mk for the veri 
high occur k in each case be not displayed, a veri few such 
intersect occurred, render the empir estim unreliable. 

found at: doi:10.1371/journal.pcbi.1000205.s002 (1.06 MB eps) 

figur S3 two grid use for comput pairwis distances. We 

consid pairwis distanc between all possibl pair of point 

(p,q), where p be a point on a fine 1006100 grid (gray dots) and q be 
a point on a coars 464 grid (red dots) in the squar environment. 
(q be take from a coars grid to reduc the total number of pair 
from 108 to a more comput 1.6*105.) for each trial, the 

pairwis error be comput a the averag valu of 

ip2q|2d(c(p),c(q))|, where c(p) and c(q) denot cell group 
correspond to point p and q, respectively, and d be the 
construct metric on cell groups. thi provid a measur for the 

qualiti of an intern represent construct from cell groups. 

found at: doi:10.1371/journal.pcbi.1000205.s003 (3.69 MB eps) 

figur S4 intern space reconstruct for increas number 

of place cells. the origin environ (bottom right) with three 

sampl place fields. A coars grid (red and orang lines) be use for 

visual comparison with the reconstruct spaces, a in figur 5 

and 6. black and color dot correspond to cell groups, a in 

figur 3C and 3d, with color repres cell group contain 

the three sampl place cells. raw md output (left column) for 

the intern reconstruct of space have arbitrari scale and 

orientation; align version (middl column) can be use to 

comput the mismatch (see methods). mismatch improv with 

increas number of place cells. 

found at: doi:10.1371/journal.pcbi.1000205.s004 (4.97 MB eps) 

figur S5 cell group contain place cell with multipeak 

place fields. black dot correspond to cell group for the 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 11 octob 2008 | volum 4 | issu 10 | e1000205 



reconstruct space show in figur 6b. the reconstruct be 

obtain from the simul activ of 127 cells, 13 of which have 

multipeak place fields. for each of the 13 place cell with 

multipeak place fields, all cell group contain that place cell 

be plot in red (plot 1–13). cell group for a pair of single- 

peak place field be also show (plot 14, 15). 

found at: doi:10.1371/journal.pcbi.1000205.s005 (11.61 MB eps) 

figur S6 multipeak pairwis error and mismatch for coverag 

by 90 and 140 fields. the presenc of place cell with multipeak 

place field do not affect the perform of the metric 

reconstruct so long a the doubl field be themselv fulli 

cover by other place fields, in which case the correspond cell 

group be fulli disambigu by other cells. (a,b) for a total 

coverag by onli 90 field (includ doubl field for multipeak 

cells), both the pairwis error and mismatch have increas mean 

and varianc for increas percentag of multipeak cells. thi 

be becaus 90 randomly-loc field for the give rang of radiu 

(shade region, dash line indic mean place field radius) be 

not enough to double-cov the environment. (c,d) the 

environ be fulli double-cov with 140 fields. accordingly, 

there be no signific decreas in perform for increas 

percentag (up to 11%) of multipeak place fields. ((d) be the 

same a figur 6c.) 

found at: doi:10.1371/journal.pcbi.1000205.s006 (0.92 MB eps) 

figur S7 place cell with multipeak place field can be 

detect from cell groups. overlap circl (middle) illustr 

an exampl place field configur for an environ with no 

holes. cell 8 have a double-peak place field, consist of two 

disconnect region (shade gray areas). A graph, a in figur 3, 

can be construct from the correspondingli activ cell group 

(not shown). for each cell, there be an associ subgraph induc 

by restrict onli to cell group (vertices) that contain the give 

cell. the subgraph associ to cell 8 (left) have two connect 

components, indic that thi place cell have a place field with 

two disconnect fire fields. In contrast, the subgraph for cell 3 

(right) be connected, a be the subgraph for all other place cell 

(1–7) in thi exampl (not shown). note that identif of 

multipeak place field requir that they be entir cover by 

other fields, a be the case of cell 8. for thi reason, we must have 

enough cell to double-cov the environ by place field in 

order to guarante that we can identifi place cell with 

multipeak field and disambigu disconnect fields. 

found at: doi:10.1371/journal.pcbi.1000205.s007 (0.61 MB eps) 

text S1 supplementari text 

found at: doi:10.1371/journal.pcbi.1000205.s008 (0.11 MB pdf) 

acknowledg 

the author would like to thank larri abbott, taro toyoizumi, and xaq 

pitkow for help suggest on the manuscript and lai borg and 

cleidi haleah for logist support. 

author contribut 

conceiv and design the experiments: CC vi. perform the 

experiments: CC vi. analyz the data: CC vi. contribut reagents/ 

materials/analysi tools: CC vi. wrote the paper: CC vi. 

refer 

1. bialek W, riek F, de ruyter van steveninck rr, warland D (1991) read a 

neural code. scienc 252: 1854–1857. 

2. wilson ma, mcnaughton BL (1993) dynam of the hippocamp ensembl 
code for space. scienc 261: 1055–1058. 

3. seung hs, sompolinski H (1993) simpl model for read neuron 
popul codes. proc natl acad sci U S A 90: 10749–10753. 

4. brown en, frank lm, tang D, quirk mc, wilson MA (1998) A statist 

paradigm for neural spike train decod appli to posit predict from 
ensembl fire pattern of rat hippocamp place cells. J neurosci 18: 

7411–7425. 

5. riek F, warland D, steverninck R, bialek W (1999) spikes: explor the 

neural code. cambridg (massachusetts): mit press. 

6. denev S, latham pe, pouget A (1999) read popul codes: a neural 
implement of ideal observers. nat neurosci 2: 740–745. 

7. jensen O, lisman JE (2000) posit reconstruct from an ensembl of 

hippocamp place cells: contribut of theta phase coding. J neurophysiol 83: 
2602–2609. 

8. nirenberg S, latham PE (2003) decod neuron spike trains: how import 
be correlations? proc natl acad sci U S A 100: 7348–7353. 

9. eden ut, frank lm, barbieri R, solo V, brown EN (2004) dynam analysi of 

neural encod by point process adapt filtering. neural comput 16: 971–998. 

10. Ma wj, beck jm, latham pe, pouget A (2006) bayesian infer with 

probabilist popul codes. nat neurosci 9: 1432–1438. 

11. jazayeri M, movshon JA (2006) optim represent of sensori inform 
by neural populations. nat neurosci 9: 690–696. 

12. muller ru, kubi JL (1987) the effect of chang in the environ on the 

spatial fire of hippocamp complex-spik cells. J neurosci 7: 1951–1968. 

13. quirk gj, muller ru, kubi jl, ranck JB (1992) the posit fire 

properti of medial entorhin neurons: descript and comparison with 
hippocamp place cells. J neurosci 12: 1945–1963. 

14. lever C, will T, cacucci F, burgess N, o’keef J (2002) long-term plastic in 

hippocamp place-cel represent of environment geometry. natur 416: 
90–94. 

15. will tj, lever C, cacucci F, burgess N, o’keef J (2005) attractor dynam in 

the hippocamp represent of the local environment. scienc 308: 873–876. 

16. frank lm, stanley gb, brown EN (2004) hippocamp plastic across 

multipl day of exposur to novel environments. J neurosci 24: 7681–7689. 

17. fritz J, shamma S, elhilali M, klein D (2003) rapid task-rel plastic of 

spectrotempor recept field in primari auditori cortex. nat neurosci 6: 

1216–1223. 

18. womelsdorf T, anton-erxleben K, pieper F, treue S (2006) dynam shift of 

visual recept field in cortic area MT by spatial attention. nat neurosci 9: 

1156–1160. 

19. froemk rc, merzenich mm, schreiner CE (2007) A synapt memori trace 

for cortic recept field plasticity. natur 450: 425–429. 

20. o’keef J, dostrovski J (1971) the hippocampu a a spatial map. preliminari 

evid from unit activ in the freely-mov rat. brain re 34: 171–175. 

21. muller R (1996) A quarter of a centuri of place cells. neuron 17: 813–822. 

22. mcnaughton bl, battaglia fp, jensen O, moser ei, moser MB (2006) path 

integr and the neural basi of the ‘cognit map’. nat rev neurosci 7: 

663–678. 

23. blair ht, welday ac, zhang K (2007) scale-invari memori represent 

emerg from moir interfer between grid field that produc theta 

oscillations: a comput model. J neurosci 27: 3211–3229. 

24. brun vh, otnass mk, molden S, steffenach ha, witter mp, et al. (2002) place 

cell and place recognit maintain by direct entorhinal-hippocamp 

circuitry. scienc 296: 2243–2246. 

25. samsonovich A, mcnaughton BL (1997) path integr and cognit 

map in a continu attractor neural network model. J neurosci 17: 

5900–5920. 

26. wood er, dudchenko pa, eichenbaum H (1999) the global record of memori 

in hippocamp neuron activity. natur 397: 613–616. 

27. wood er, dudchenko pa, robitsek rj, eichenbaum H (2000) hippocamp 

neuron encod inform about differ type of memori episod occur 

in the same location. neuron 27: 623–633. 

28. young bj, fox gd, eichenbaum H (1994) correl of hippocamp complex- 

spike cell activ in rat perform a nonspati radial maze task. J neurosci 14: 

6553–6563. 

29. jackson J, redish AD (2007) network dynam of hippocamp cell-assembl 

resembl multipl spatial map within singl tasks. hippocampu 17: 1209–1229. 

30. johnson A, redish AD (2007) neural ensembl in ca3 transient encod path 

forward of the anim at a decis point. J neurosci 27: 12176–12189. 

31. dragoi G, buzsaki G (2006) tempor encod of place sequenc by 

hippocamp cell assemblies. neuron 50: 145–157. 

32. harri KD (2005) neural signatur of cell assembl organization. nat rev 

neurosci 6: 399–407. 

33. harri kd, csicsvari J, hiras H, dragoi G, buzsaki G (2003) organ of 

cell assembl in the hippocampus. natur 424: 552–556. 

34. hebb DO (1949) the organ of behavior. new york: wiley. 

35. geisler C, robb D, zugaro M, sirota A, buzsaki G (2007) hippocamp place 

cell assembl be speed-control oscillators. proc natl acad sci U S A 104: 

8149–8154. 

36. itskov V, pastalkova E, mizuseki K, buzsaki G, harri KD (2008) theta- 

mediat dynam of spatial inform in hippocampus. J neurosci 28: 

5959–5964. 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 12 octob 2008 | volum 4 | issu 10 | e1000205 



37. o’keef J, recc ML (1993) phase relationship between hippocamp place 

unit and the eeg theta rhythm. hippocampu 3: 317–330. 
38. hatcher A (2002) algebra topology. cambridge, uk: cambridg univers 

press. 

39. de silva V, ghrist R (2007) homolog sensor networks. not Am math soc 54: 
10–17. 

40. dabaghian Y, cohn ag, frank L (2007) topolog map from signals. in: 
proceed of the 15th acm intern symposium acm gis. new york: 

acm press. pp 392–395. 

41. jung mw, wiener si, mcnaughton BL (1994) comparison of spatial fire 
characterist of unit in dorsal and ventral hippocampu of the rat. J neurosci 

14: 7347–7356. 
42. maurer ap, vanrhoad sr, sutherland gr, lipa P, mcnaughton BL (2005) 

self-mot and the origin of differenti spatial scale along the septo-tempor 
axi of the hippocampus. hippocampu 15: 841–852. 

43. kruskal JB (1963) multidimension scale by optim good of fit to a 

nonmetr hypothesis. psychometrika 29: 1–27. 
44. muller ru, kubi jl, ranck JB Jr (1987) spatial fire pattern of hippocamp 

complex-spik cell in a fix environment. J neurosci 7: 1935–1950. 
45. bott R, Tu LW (1982) differenti form in algebra topology. new york: 

springer-verlag. 

46. o’keef J, nadel L (1978) the hippocampu a a cognit map. oxford, uk: 
oxford univers press. 

47. muller ru, stead M (1996) hippocamp place cell connect by hebbian 
synapsi can solv spatial problems. hippocampu 6: 709–719. 

48. muller ru, stead M, pach J (1996) the hippocampu a a cognit graph. 
J gen physiol 107: 663–694. 

49. kohonen T (2001) self-organ maps. new york: springer. 

50. victor JD (2005) spike train metrics. curr opin neurobiol 15: 585–592. 
51. hetherington pa, shapiro ML (1997) hippocamp place field be alter by 

the remov of singl visual cue in a distance-depend manner. behav 
neurosci 111: 20–34. 

52. andersen P, morri R, amar D, bliss T, o’keef J (2007) the hippocampu 

book. oxford, uk: oxford univers press. 
53. ulanovski N, moss CF (2007) hippocamp cellular and network activ in 

freeli move echoloc bats. nat neurosci 10: 224–233. 

54. chomski N (1957) syntact structures. gravenhage: mouton. 
55. louie K, wilson MA (2001) tempor structur replay of awak 

hippocamp ensembl activ dure rapid eye movement sleep. neuron 29: 
145–156. 

56. lee ak, wilson MA (2002) memori of sequenti experi in the 

hippocampu dure slow wave sleep. neuron 36: 1183–1194. 
57. foster dj, wilson MA (2006) revers replay of behaviour sequenc in 

hippocamp place cell dure the awak state. natur 440: 680–683. 
58. Ji D, wilson MA (2007) coordin memori replay in the visual cortex and 

hippocampu dure sleep. nat neurosci 10: 100–107. 
59. diba K, buzsaki G (2007) forward and revers hippocamp place-cel 

sequenc dure ripples. nat neurosci 10: 1241–1242. 

60. o’neil J, senior tj, allen K, huxter jr, csicsvari J (2008) reactiv of 
experience-depend cell assembl pattern in the hippocampus. nat neurosci 

11: 209–215. 
61. muller ru, bostock E, taub js, kubi JL (1994) On the direct fire 

properti of hippocamp place cells. J neurosci 14: 7235–7251. 

62. ewald G (1996) combinatori convex and algebra geometry. new york: 
springer. 

63. duma J, heckenbach F, saunder F, welker V (2004) simplici homology—a 
propos share packag for gap. http://www.cis.udel.edu/,dumas/ 
homology/. 

64. duma J, saunder B, villard G (2001) On effici spars integ matrix smith 

normal form computations. J symbol comput 32: 71–99. 

65. johnson DB (1977) effici algorithm for shortest path in spars networks. 
J acm 24: 1–13. 

66. gleich D (2007) matlabbgl. A matlab graph library. http://www.stanford. 
edu/,dgleich/programs/matlab_bgl. 

cell group reveal structur of stimulu space 

plo comput biolog | www.ploscompbiol.org 13 octob 2008 | volum 4 | issu 10 | e1000205 



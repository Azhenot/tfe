






































low-level attack in bitcoin wallet | springerlink 


low-level attack in bitcoin wallet 

abstract 

As with everi financi orient protocol, there have be a great interest in studying, verifying, attacking, identifi 
problems, and propos solut for bitcoin. within that scope, it be highli recommend that the key of user account be 
store offline. To that end, compani provid solut that rang from paper wallet to tamper-resist smart-cards, 
offer differ level of security. while incorpor expens hardwar for the wallet purpos be though to bring 
guarantees, it be often that the low-level implement introduc exploit back-doors. thi paper aim to bring to 
attent how the overlook low-level protocol that implement the hardwar wallet can be exploit to mount bitcoin 
attacks. To demonstr that, we analys the gener protocol behind L wallets, the onli eal5+ certifi against side 
channel analysi attack hardware. In thi work we conduct a throughout analysi on the ledger wallet commun 
protocol and show how to success attack it in practice. We address the lack of well-defin secur properti that 
bitcoin wallet should conform by articul a minim threat model against which ani hardwar wallet should defend. We 
further use that threat model to propos a lightweight fix that can be adopt by differ technologies. 

a.1 exampl commun trace 

As an example, we provid the trace that be gener for the follow transaction: 

A appendix 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

1 sur 6 26-01-18 à 19:13 



1. 

2. 

3. 

4. 

5. 

6. 

7. 

8. 

9. 

10. 

11. 

12. 

13. 

transact 

Id 

92d30a91b45d6ab528af12f3a9c0701e01f67348a257ed50362439a2ee8274e7 

input 

address 

1 113bivtvqk73eem1uyyn9ycrpvrxp6xevc 

2 15dpocdqpwxeup9ccf2nz9aq9jkp9u5vdz 

payment 

address 

1gocnq4q8btzacphqiglwk9vnppoq6lh8w 

payment 

amount 

0.00813844 

chang 

address 

1pmxm9ucagdbp5i3svqd3sfdkchfwthh4w 

We onli provid the trace of the command of fig. so a not to overwhelm. 

get_trusted_input: e042000009000000010100000001 

response: 9000 

get_trusted_input: e04280000400000000 

response: 32008ed5f038879105a5778cdacee02ca43f21bcbbd66cd647add3db69dd3222b9c3968 

d0000000078710d00000000009132801b579e659b 

get_wallet_public_key: e040000015058000002c8000000080000000000000000000000c 

response: 410441ec4b255d40010284f117d8105456a268cd9536ca5ca3d3016bf6d21902e5dc4bf 

9b224b5cb2379b5c2b4a47044862d42c6e5b14daf22939fec8023c83ac51922313133626956545651 

6b373345656d315559596e3959637250567278703678655663da55cec9398694400832d6af2426c05 

7addc73438efa016f6f9232735ee6b1a8 

get_wallet_public_key: e040000015058000002c80000000800000000000000100000012 

response: 41043f07a649a72651f10d5728b7f848ee879fb3b263ddd653b51b563a051f138fa3e35 

f5f6d794a2621fbf0493d6af5c2b300734086fa0ebbe411f11017b1989bdd22313544706f63645170 

775865557039436366324e7a394151396a4b7039553556645a9bf32153ef7f646d1d1991382932bc9 

15d671ddc3640ef8da3eb54877191e559 

untrusted_hash_transaction_input_start: e0440000050100000002 

response: 9000 

untrusted_hash_transaction_input_finalize: e0460200482231476f634e5134513842747a61 

6370485169474c576b39764e70706f71364c683857000000000000d6d800000000000045080580000 

02c80000000800000000000000100000013 

response: 4502d8d60000000000001976a914ad5a8ba5325b4b836c49b09797cbb83744a7a2f588a 

c146b0c00000000001976a914f9bebf6735e688877e409cd494ad820b344dd76e88ac03040405121 

47646f813e5dfd4fbc72e6698cc40a67a980bccbe7881c2e40ac6fec4fbcda20d980ec3a67445e48d 

ad870ee58d006745fdf953138be5fb0570e679f512c36 

untrusted_hash_sign: e04800001f058000002c8000000080000000000000000000000c04040606 

020000000001 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

2 sur 6 26-01-18 à 19:13 



14. 
response: 3044022033128d0d576487e2e0c5892c0915564a6a5f119e698c033262d660527943a16 

d022009caa037703d9a3dbf7eec4cecca08bf33b3b9a18ef929a810f8faf6ab0f1c7a01 

a.2 activ attack 

a.4: alter the wallet secur properties. the attack requir send the wrong pin three consecut time and 
then tamper the set_oper command. A sampl trace with the breakdown of the step and their correspond 

command be give in tabl ; we underlin the import piec of the exchange. 

attack a.4: trace of disabl the second factor authent dure 

setup 

b.1–b.2: transact attacks. the structur of untrusted_hash_transaction_input_fin is: 

command e046020048 

length of 

payment 

address 

22 

payment 

address 

314e3371757233596565334b664e74436a4677756e346f366f4c324478686747796f 

payment 

amount 

0000000000005305 

fee 0000000000001d60 

chang 

address bip32 

paramet 

058000002c800000008000000000000001000000 

second 

authent 

statu 

(true/false) 

02 

and the structur of the respons data that we be interest in is: 

p′ 

addrp 

amountp 

f eesp 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

3 sur 6 26-01-18 à 19:13 



payment 

amount 

03b1000000000000 

hash160 of f1253f0463e5877c5e8bb3f34e7abfb335023ee1 

chang c 0553000000000000 

hash160 

chang 

address 

e6e44d66125327341d6abb71e0702a4ea0537437 

depend on the attack we want to perform the correspond data part need to be altered. for example, to chang the 
payment address from 163wpeethjvfsufx1ubdpxk92ermqxqrga to 113bivtvqk73eem1uyyn9ycrpvrxp6xevc, we 

tamper the origin command: 

e04602004822 3136335750456554486a7646735566783155624450584b3932655 26d715851724741 

00000000000027100000000000001a9a058000002c80000000800000000000000100000000 to the command: 

e04602004822 3131336269565456516b373345656d315559596e395963725056 7278703678655663 

00000000000027100000000000001a9a058000002c80000000800000000000000100000000 

where we underlin the relev parts; similarli for the response. 

learn the secur card. the attack gain access to the keycard mappings, secfr, via the untrusted_hash_sign 

command, e.g., e04800001f058000002c8000000080000000000000000000000104 0f090a02 0000000001. 

amountp 

addrp 

addrc 

refer 
androulaki, e., karame, g.o., roeschlin, m., scherer, t., capkun, s.: evalu user privaci in bitcoin. in: sadeghi, 
a.-r. (ed.) FC 2013. lncs, vol. 7859, pp. 34–51. springer, heidelberg (2013). doi: 10.1007/978-3-642-39884-1_4 
(https://doi.org/10.1007/978-3-642-39884-1_4) 
crossref 
googl scholar 

bamert, t., decker, c., wattenhofer, r., welten, s.: bluewallet: the secur bitcoin wallet. in: mauw, s., jensen, c.d. 
(eds.) stm 2014. lncs, vol. 8743, pp. 65–80. springer, cham (2014). doi: 10.1007/978-3-319-11851-2_5 
(https://doi.org/10.1007/978-3-319-11851-2_5) 
googl scholar 

barber, s., boyen, x., shi, e., uzun, e.: bitter to good — how to make bitcoin a good currency. in: keromytis, a.d. 
(ed.) FC 2012. lncs, vol. 7397, pp. 399–414. springer, heidelberg (2012). doi: 10.1007/978-3-642-32946-3_29 
(https://doi.org/10.1007/978-3-642-32946-3_29) 
crossref 
googl scholar 

biham, e., shamir, a.: differenti fault analysi of secret key cryptosystems. in: kaliski, b.s. (ed.) crypto 1997. 
lncs, vol. 1294, pp. 513–525. springer, heidelberg (1997). doi: 10.1007/bfb0052259 (https://doi.org/10.1007 
/bfb0052259) 
crossref 
googl scholar 

bitcoin ewallet vanish from internet. http://www.tribbleagency.com/?p=8133 (http://www.tribbleagency.com 
/?p=8133) 

bitcoin protocol documentation. https://en.bitcoin.it/wiki/protocol%5fdocument (https://en.bitcoin.it 
/wiki/protocol%5fdocumentation) 

bitcoinmagazin (2013). https://bitcoinmagazine.com/articles/ozcoin-hacked-stolen-funds-seized-and-returned-by- 
strongcoin-1366822516 (https://bitcoinmagazine.com/articles/ozcoin-hacked-stolen-funds-seized-and-returned-by- 
strongcoin-1366822516) 

bozzato, c., focardi, r., palmarini, f., steel, g.: apdu-level attack in pkcs#11 devices. in: monrose, f., dacier, m., 

blanc, g., garcia-alfaro, J. (eds.) raid 2016. lncs, vol. 9854, pp. 97–117. springer, cham (2016). 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

4 sur 6 26-01-18 à 19:13 



doi: 10.1007/978-3-319-45719-2_5 (https://doi.org/10.1007/978-3-319-45719-2_5) 
crossref 
googl scholar 

datko, j., quartier, c., belyayev, k.: break bitcoin hardwar wallets. in: defcon (2017) 
googl scholar 

De kone gans, g., De ruiter, j.: the smartlog tool: analys and test smart card protocols. in: 2012 ieee 
fifth intern confer on softwar testing, verif and valid (icst), pp. 864–871 (2012) 
googl scholar 

decker, c., wattenhofer, r.: bitcoin transact malleabl and mtgox. in: kutyłowski, m., vaidya, J. (eds.) 
esor 2014. lncs, vol. 8713, pp. 313–326. springer, cham (2014). doi: 10.1007/978-3-319-11212-1_18 
(https://doi.org/10.1007/978-3-319-11212-1_18) 
googl scholar 

genkin, d., shamir, a., tromer, e.: rsa key extract via low-bandwidth acoust cryptanalysis. in: garay, j.a., 
gennaro, R. (eds.) crypto 2014. lncs, vol. 8616, pp. 444–461. springer, heidelberg (2014). 
doi: 10.1007/978-3-662-44371-2_25 (https://doi.org/10.1007/978-3-662-44371-2_25) 
crossref 
googl scholar 

gkaniatsou, a., mcneill, f., bundy, a., steel, g., focardi, r., bozzato, c.: get to know your card: reverse- 
engin the smart-card applic protocol data unit. in: proceed of the 31st annual comput secur 
applic conference, pp. 441–450 (2015) 
googl scholar 

hao, f., ryan, p.: j-pake: authent key exchang without pki. in: gavrilova, m.l., tan, c.j.k., moreno, e.d. 
(eds.) transact on comput scienc xi. lncs, vol. 6480, pp. 192–206. springer, heidelberg (2010). 
doi: 10.1007/978-3-642-17697-5_10 (https://doi.org/10.1007/978-3-642-17697-5_10) 
crossref 
googl scholar 

herrera-joancomartí, j.: research and challeng on bitcoin anonymity. in: garcia-alfaro, j., herrera-joancomartí, 
j., lupu, e., posegga, j., aldini, a., martinelli, f., suri, N. (eds.) dpm/qasa/setop -2014. lncs, vol. 8872, pp. 
3–16. springer, cham (2015). doi: 10.1007/978-3-319-17016-9_1 (https://doi.org/10.1007/978-3-319-17016-9_1) 
googl scholar 

higgins, S. (2015). http://www.coindesk.com/unconfirmed-report-5-million-bitstamp-bitcoin-exchang 
(http://www.coindesk.com/unconfirmed-report-5-million-bitstamp-bitcoin-exchange) 

hsiao, h.-c., lin, y.-h., studer, a., studer, c., wang, k.-h., kikuchi, h., perrig, a., sun, h.-m., yang, b.-y.: A studi 
of user-friendli hash comparison schemes. in: annual comput secur applic conference, acsac 2009, pp. 
105–114. ieee (2009) 
googl scholar 

huang, d.y., dharmdasani, h., meiklejohn, s., dave, v., grier, c., mccoy, d., savage, s., weaver, n., snoeren, a.c., 
levchenko, k.: botcoin: monet steal cycles. in: 21st annual network and distribut system secur 
symposium, ndss 2014, san diego, california, usa, 23–26 februari 2014 
googl scholar 

karame, g.o., androulaki, e., capkun, s.: double-spend fast payment in bitcoin. in: proceed of the 2012 
acm confer on comput and commun security, cc 2012, pp. 906–917 (2012) 
googl scholar 

kocher, p., jaffe, j., jun, b.: differenti power analysis. in: wiener, M. (ed.) crypto 1999. lncs, vol. 1666, pp. 
388–397. springer, heidelberg (1999). doi: 10.1007/3-540-48405-1_25 (https://doi.org/10.1007 
/3-540-48405-1_25) 
googl scholar 

kocher, p.c.: time attack on implement of diffie-hellman, rsa, dss, and other systems. in: koblitz, N. 
(ed.) crypto 1996. lncs, vol. 1109, pp. 104–113. springer, heidelberg (1996). doi: 10.1007/3-540-68697-5_9 
(https://doi.org/10.1007/3-540-68697-5_9) 
googl scholar 

lim, i.-k., kim, y.-h., lee, j.-g., lee, j.-p., nam-gung, h., lee, j.-k.: the analysi and countermeasur on secur 
breach of bitcoin. in: murgante, b., misra, s., rocha, a.m.a.c., torre, c., rocha, j.g., falcão, m.i., taniar, d., 
apduhan, b.o., gervasi, O. (eds.) iccsa 2014. lncs, vol. 8582, pp. 720–732. springer, cham (2014). 
doi: 10.1007/978-3-319-09147-1_52 (https://doi.org/10.1007/978-3-319-09147-1_52) 
googl scholar 

murdoch, s.j., drimer, s., anderson, r.j., bond, m.: chip and pin be broken. in: 31st ieee symposium on secur 
and privacy, s&p 2010, berleley/oakland, california, usa, 16–19 may 2010, pp. 433–446 (2010) 
googl scholar 

nakamoto, s.: bitcoin: a peer-to-p electron cash system. http://bitcoin.org/bitcoin.pdf (http://bitcoin.org 
/bitcoin.pdf) 

poulsen, k.: new malwar steal your bitcoin (2011). https://www.wired.com/2011/06/bitcoin-malwar 
(https://www.wired.com/2011/06/bitcoin-malware) 

rosenfeld, m.: analysi of hashrate-bas doubl spending. corr, abs/1402.2009 (2014) 
googl scholar 

the bitcoin wiki. https://en.bitcoin.it/wiki/wallet%5fencrypt (https://en.bitcoin.it/wiki/wallet%5fencryption) 

the bitcoin wiki (2014). https://en.bitcoin.it/wiki (https://en.bitcoin.it/wiki) 

turuani, m., voegtlin, t., rusinowitch, m.: autom verif of electrum wallet. in: clark, j., meiklejohn, s., 
ryan, p.y.a., wallach, d., brenner, m., rohloff, K. (eds.) FC 2016. lncs, vol. 9604, pp. 27–42. springer, heidelberg 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

5 sur 6 26-01-18 à 19:13 



© springer intern publish AG 2017 

(2016). doi: 10.1007/978-3-662-53357-4_3 (https://doi.org/10.1007/978-3-662-53357-4_3) 
crossref 
googl scholar 

uzun, e., karvonen, k., asokan, n.: usabl analysi of secur pair methods. in: dietrich, s., dhamija, R. (eds.) 
FC 2007. lncs, vol. 4886, pp. 307–324. springer, heidelberg (2007). doi: 10.1007/978-3-540-77366-5_29 
(https://doi.org/10.1007/978-3-540-77366-5_29) 
crossref 
googl scholar 

wuille, p.: deal with maellability. onlin specif for bip62 (2014) 
googl scholar 

wuille, p.: hierarch determinist wallets. onlin specif for bip32 (2017) 
googl scholar 

copyright inform 

about thi paper 

low-level attack in bitcoin wallet | springerlink https://link.springer.com/chapter/10.1007/978-3-319-69659-1_13 

6 sur 6 26-01-18 à 19:13 



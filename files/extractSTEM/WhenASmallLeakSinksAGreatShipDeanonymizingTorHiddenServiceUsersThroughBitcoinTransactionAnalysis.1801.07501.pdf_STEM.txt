




















































when A small leak sink A great ship: deanonym tor hidden servic user through bitcoin transact analysi 


when A small leak sink A great ship: deanonym tor 
hidden servic user through bitcoin transact analysi 

husam Al jawaheri 
qatar univers 
doha, qatar 

mashael Al sabah 
qatar univers 
doha, qatar 

yazan boshmaf 
qatar comput research institute, hbku 

doha, qatar 

aimen erbad 
qatar univers 
doha, qatar 

abstract 
with the rapid increas of threat on the internet, peopl be contin- 
uousli seek privaci and anonymity. servic such a bitcoin and 
tor be introduc to provid anonym for onlin transact 
and web browsing. due to it pseudonym model, bitcoin lack 
retroact oper security, which mean histor piec of 
inform could be use to identifi a certain user. We investig 
the feasibl of deanonym user of tor hidden servic who 
reli on bitcoin a a payment method by exploit public informa- 
tion leak from onlin social networks, the blockchain, and onion 
websites. this, for example, allow an adversari to link a user with 
@alic twitter address to a tor hidden servic with private.onion 
address by find at least one past transact in the blockchain 
that involv their publicli declar bitcoin addresses. 

To demonstr the feasibl of thi deanonym attack, 
we carri out a real-world experi simul a passive, lim- 
ite adversary. We crawl 1.5k hidden servic and collect 88 
uniqu bitcoin addresses. We then crawl 5B tweet and 1M bit- 
cointalk forum page and collect 4.2k and 41k uniqu bitcoin 
addresses, respectively. each user address be associ with an 
onlin ident along with it public profil information. By ana- 
lyze the transact in the blockchain, we be abl to link 125 
uniqu user to 20 tor hidden services, includ sensit ones, 
such a the pirat bay and silk road. We also analyz two case 
studi in detail to demonstr the implic of the result 
inform leakag on user anonymity. In particular, we confirm 
that bitcoin address should alway be consid exploitable, a 
they can be use to deanonym user retroactively. thi be espe- 
cialli import for tor hidden servic user who activ seek and 
expect privaci and anonymity. 

keyword 
bitcoin, tor hidden services, privacy, deanonymization, attack 

1 introduct 
anonym and privaci over the internet be becom more criti- 
cal than ever. for that, mani solut be be deploy to im- 
prove the anonym of user while make onlin transact or 
brows the web. the most famou of these solut be the de- 
central cryptocurr and tor anonym network. one of 
the earli exampl be the bitcoin network [29], which provid user 
with the abil to perform onlin transact "pseudonymously". 
due to it popularity, more than 100k merchant worldwid accept 

bitcoin payment [11]. one of the reason of bitcoin’ popular- 
iti be it presum anonymity. tor [14] be the most wide use 
anonym commun network with million of daili activ 
user [31]. In addit to client-sid privaci and anonymity, tor 
also enabl server-sid anonym through the design of hidden 
services. the goal of hidden servic be to safe enabl onlin free- 
dom, anticensorship, and end-to-end anonym and secur [12]. 
indeed, for those reasons, hidden servic be be oper by 
whistleblow websit such a wikileaks,1 search engin such 
a duckduckgo,2 and onlin social network such a facebook.3 
hidden servic have also becom a breed ground for dark web 
vendors, such a silk road [9] and agora [39], which offer illicit 
merchandis and servic [4, 27]. 

As discuss by vincent and johan [26], tor and bitcoin repre- 
sent the main compon need to achiev anonym onlin 
purchas with exhaust oper security. In thi context, op- 
erat secur be the process of protect individu piec of 
inform that could be use to identifi a user. unfortunately, bit- 
coin lack retroact oper secur due to it pseudonym 
model [29]. thi model have an import limit becaus of the 
linkabl of bitcoin transact that be store in the blockchain 
and their public availability. 

problem. due to potenti inform leakage, use bitcoin a a 
payment method be a seriou threat to the anonym of tor hidden 
servic and their users. yet, bitcoin be the most popular choic for 
these servic for accept donat or sell merchandis [4]. 
moor and rid [27] studi how hidden servic be use in prac- 
tice, and note that bitcoin be the domin choic for accept 
payment for these services. although multipl studi [15, 16, 25] 
demonstr that bitcoin transact be not a anonym a 
previous thought, bitcoin remain the most popular digit cur- 
renci on the dark web [8], and mani user still choos to use it 
despit it fals sens of anonymity. biryukov et al. [3] show that 
even if user use bitcoin over an anonym network such a tor, 
they be still vulner to deanonym andman-in-the-middl 
attack at the network level. while previou studi analyz the 
vulner that result from use bitcoin over tor [3], mostli 
at the network level, we provid the first studi that focu on 
the applic level, shed light on an exploit inform 

1https://wikileaks.com 
2https://duckduckgo.com 
3https://facebook.com 

1 

ar 
X 

iv 
:1 

80 
1. 

07 
50 

1v 
1 

[ 
c 

.C 
R 

] 
2 

3 
Ja 

n 
20 

18 

https://wikileaks.com 
https://duckduckgo.com 
https://facebook.com 


, , husam Al jawaheri, mashael Al sabah, yazan boshmaf, and aimen erbad 

leakag result from correl public profil of onlin social 
network user with bitcoin transact and onion websites. 

hidden servic user be one class of bitcoin userswhos anonym 
be particularli important. hidden servic oper and user be 
activ seek to maintain their anonymity. however, those user 
be under the risk of deanonym when they reveal their bit- 
coin addresses. By studi the transact associ with these 
addresses, a signific amount of inform can be leak and 
use to collect sensit inform about hidden servic and 
their customers, where a user can be link to a hidden service. 

In thi paper, we seek to understand the privaci risk associ 
with use bitcoin a a payment method by tor hidden services. 
that is, we show how use bitcoin leak public inform that 
can be exploit to deanonym tor hidden servic users. In par- 
ticular, we demonstr the feasibl of link a user with @alic 
social network profil to a tor hidden servic with private.onion 
address. We note that thi research have be care revis and 
approv by our institution’ irb board, and it do not put user at 
ani risk other than what they be current expos to (section 3.3). 
We also discu a number of countermeasur that be design to 
protect and improv user privaci and anonym (section 4.4). 

approach. By brows onion land page of variou hidden 
services, we observ that it be possibl to extract their payment bit- 
coin address from static html content. accordingly, we crawl 
1.5k hidden servic page and creat a dataset of 88 bitcoin ad- 
dress oper by those hidden services, includ two ransomwar 
addresses. We also crawl onlin social network for public bit- 
coin addresses, namely, twitter4 and the bitcointalk forum.5 out 
of 5B tweet and 1M forum pages, we creat two dataset of 4.1k 
and 41k bitcoin addresses, respectively. each address in these user 
dataset be associ with an onlin ident and it correspond 
public profil inform (section 3.4). 

use a cluster heurist propos by meiklejohn et al. [25], 
we perform a wallet-closur analysi that allow u to expand 
the collect bitcoin address per user. In other words, for each 
address in the collect user datasets, we identifi other address 
belong to the same user who own the address. thi closur anal- 
ysi approxim a user’ wallet, which be the set of address that 
be control by the user, and therebi increas the number of iden- 
tifi link between user and hidden services. one problem with 
closur analysi be that the closur can over-approxim the size of 
the wallet, a a consequ of mix [23] and coinjoin [40] ser- 
vices. therefore, we exclud closur that have common address 
from the analysis. thi ensur that user be not double-count 
and report result be lower-bound estimate, a each remain- 
ing closur repres a subset of a wallet whose address be 
control by a uniqu user (section 3.5). 

after wallet-closur analysis, we use the dataset to analyz 
the transact in the blockchain. In particular, we search for 
transact between user and hidden servic address in order 
to identifi link between them. thi enabl u to associ users, 
or onlin identities, with hidden servic and access their transac- 
tion history. To demonstr the impact of linking, we trace and 
describ two case studi show that bitcoin address can be 

4https://twitter.com 
5https://bitcointalk.org 

use to deanonym user retroactively, start from may, 2010. 
It be import to highlight that deanonym depend sole 
on inform leak from public data sources. finally, to gain 
insight into the econom activ of the link hidden services, 
we analyz the correspond transact history, focu on 
number of transactions, the amount of money be exchanged, 
and the lifetim of these hidden servic (section 3.6). 

results. with wallet-closur analysis, we be abl to expand 
the dataset from 45.2k bitcoin address to more than 19.1m, with 
an averag of 425 address per user. use transact analysis, 
we be abl to link 125 uniqu user to 20 tor sensit hidden 
services, such a wikileaks, silk road, and the pirat bay.6 the 
case studi unmask multipl user of the pirat bay hidden 
service, along with their person identifi inform (pii), 
such a name, gender, age, and location.7 We also found that user 
from multipl countri and differ age have link with the silk 
road address in our hidden servic dataset. one of the users, for 
example, be a teenag who have mani social network account 
show hi real identity. 

the econom activ analysi of the link hidden servic 
show that wikileak be the high receiv of payment in term 
of volume, with 25.6k transactions. In term of the amount of in- 
come payments, however, the silk road top the list with more 
than 29.6k bitcoin receiv on it address.8 We observ that the 
money flow in and out of hidden servic address be nearli the 
same. thi suggest that these servic do not keep their bitcoin on 
the address they use for receiv payments, but rather distribut 
the coin to other address instead. finally, from the last transac- 
tion date on the addresses, we found that onli eight out of the 20 
link hidden servic be inact in 2017. this, however, do not 
mean the inact servic stop make bitcoin transactions, a 
they might have use differ address that we do not know. 

contributions. thi paper show the implic of bitcoin’ 
pseudonym model, which lack retroact oper security, 
on tor hidden servic users. our contribut be the following: 

(1) A method that link onlin user ident with tor hid- 
den servic through bitcoin transact analysis. the 
method improv link result by use closur analysi 
techniqu and by significantli elimin the nois from 
mix and coinjoin services. 

(2) the first real-world experi that show the feasibil- 
iti of deanonym tor hidden servic user by exploit- 
ing inform leakag result from correl public 
data sources, namely, onlin social networks, the bitcoin 
blockchain, and tor hidden services. 

(3) An econom activ analysi of 20 hidden servic that 
be use by link users. thi includ statist on their 
transact volume, flow of money, and lifetime. 

2 background 
We now present the necessari background on bitcoin and tor. 

6https://thepiratebay.org 
7in accord with our irb board’ guidelines, we have remov the pii of these 
users, a the link hidden servic be consid illeg in their countries. 
8a of dec 2017, thi amount of bitcoin equal more than 580 million usd. 

2 

https://twitter.com 
https://bitcointalk.org 
https://thepiratebay.org 


deanonym tor hidden servic user through bitcoin transact analysi , , 

2.1 bitcoin 
bitcoin [29] be a decentr digit crypto-curr systemwhich 
elimin the need for a central bank author to manag the trans- 
fer of funds. the bitcoin network be maintain by a peer-to-p 
network of miner who valid transact without relay on 
trust. due to it popularity, more than 100k merchant worldwid 
accept bitcoin payment [11]. one of the reason of bitcoin’ popu- 
lariti be it presum anonymity. the ident of user in bitcoin 
be hidden use pseudonym which be use a address to per- 
form transactions. A bitcoin address be a 160-bit hash of a public key 
gener by a digit signatur algorithm. the set of public/priv 
key that be own by a user be call a wallet. privat key be 
use to sign input of transact a a proof of ownership. 

2.1.1 transactions. alic make a payment to bob by creat 
a new transaction. she us one or more bitcoin address that she 
control a inputs. she also includ the amount to be transferred, 
and choos bob’ address(es) a a transact output. To protect 
the transaction, she sign it use her privat key(s), and then 
broadcast it to the whole network. In order to verifi transactions, 
and be reward with new gener coins, miner collect the 
broadcast transactions, emb them in a well-defin data structur 
call a block, and then attempt to solv a hash comput 
puzzl involv the block. when the block be solved, it be attach 
to the blockchain, which be a hash-chain that maintain all solv 
blocks, and therebi all emb transact ever creat and 
verifi in the bitcoin network. 

the blockchain be publicli maintain and can be download 
over the internet, bitcoin’ origin client, or explor use cen- 
traliz servers, such a blockchain info.9 everi transact in 
the blockchain have a list of input and outputs, where each in- 
clude address that be use in the transact and the amount 
of coin spent in that transaction. transact download from 
blockchain info includ more information, such a the relay IP ad- 
dress and the transact timestamp that record the time at which 
the transact be made. 

2.1.2 anonymity. while transact in bitcoin be presum 
to be anonymous, linkabl between address be possibl due the 
natur of the blockchain [29]. for example, one can verifi if alic 
and bob have a transact between them. furthermore, if alic 
own multipl addresses, one may be abl to link them a belong 
to the same person. 

meiklejohn et al. [25] observ that two bitcoin addresses,a and 
B, belong to the same user if botha and B have be use a input 
for the same transaction, or B receives, a an output, the unspent 
chang of a transact where A be use a input. the author 
use thi observ to defin a heurist for map multipl 
address to an entiti repres a uniqu user. specifically, the 
heurist be base on the idea that sinc the privat key of the 
user be use to sign the input A and B, then both A and B be 
control by the same person. As the address or the underli 
public/priv key that be own by a user repres a wallet, 
the heurist tri to induc the wallet of a user give a subset 
of the address in the wallet. the author also defin a second 
heurist base on anoth observation. when an address be use 
9https://blockchain.info 

a an input in a transaction, all of it associ bitcoin have to 
be spent at once. If those coin exceed what the sender want to 
spend, then the sender have to refer two outputs, one to the 
receiv with the intend amount, and anoth for the change. the 
sender typic control the chang address within the transaction. 
both heurist repres wallet-closur techniqu that be use 
for bitcoin transact analysis. 

It be import to note that wallet-closur techniqu be noisi 
and can result in address that do not belong to the same user 
or wallet. one reason for thi be the use of mix [23] and coin- 
join [40] services. given a set of input address of multipl users, 
these servic gener a sequenc of transact that effect 
mix the coin to enhanc anonymity. In thi work, we modifi the 
first wallet-closur techniqu to handl bitcoin mix for transac- 
tion analysis, a describ in section 3.5. 

2.2 tor hidden servic 
tor [14] be the most wide use anonym commun net- 
work avail online. tor enabl server-sid anonym through 
the design of hidden services, also know a onion services. To 
achiev their anonym goal, a hidden servic client and oper 
establish a commun tunnel, know a a circuit, between each 
other over multipl intermedi routers. anonym be maintain 
a long a the intermedi router at the two end of the tunnel be 
not control by an adversari who can use time or traffic analysi 
to link the sourc to the destination. hidden servic have also 
be subject to activ attack in the wild [13, 24]. for these rea- 
sons, the tor project be activ work on address the secur 
weak of hidden servic [30]. 

To ensur transact anonymity, bitcoin have becom the most 
popular choic by tor hidden servic for accept donat or 
sell merchandis [4]. unfortunately, thi have contribut to the 
rise of illeg hidden services, such a silk road and agora, which 
offer illicit merchandis and servic [4, 9, 27, 39]. 

3 approach and experi 
while the goal of use bitcoin for tor hidden servic be to pro- 
vide transact and brows anonymity, we show that thi usag 
typic leak inform that can be use to deanonym hid- 
den servic users. In particular, the adversari can link users, who 
publicli share their bitcoin address on onlin social networks, 
with hidden services, which publicli share their bitcoin address 
on onion land pages. thi be achiev by inspect histor 
transact involv these two address in the blockchain. In 
do so, the adversari onli reli on data that be publicli available. 

3.1 overview 
To illustr the deanonym attack, let u consid alice, a 
privacy-savvi user who us tor, in the follow scenario: 

(1) alic us a browser and creat an onlin ident @alic 
with a public profil on social network public.com. 

(2) alic us @alic to make a public post ask for dona- 
tion on bitcoin address A. 

(3) alic receiv donat through a number of bitcoin trans- 
actions, where A be use a an output address. 

3 

https://blockchain.info 


, , husam Al jawaheri, mashael Al sabah, yazan boshmaf, and aimen erbad 

(4) alic us tor browser to visit hidden servic private.onion 
that have public bitcoin address P . 

(5) alic make a payment A → P to private.onion use A a 
an input address and P a an output address. 

while step 1–3 involv non-anonym web brows and pub- 
lic activities, alic have some expect of privaci and anonym 
in step 4–5, give that she be use tor and bitcoin. step 5, however, 
leak a piec of information, the transact A → P in particular, 
that can be use by an adversary, trudy, to link @alic to pri- 
vate.onion, a follows: 

(1) trudi crawl public.com on regular basis, store public 
user profil and posts. 

(2) trudi crawl hidden servic on regular basis, store ac- 
cessibl onion pages. 

(3) trudi par crawl data on regular basis, search for 
bitcoin addresses. 

(4) trudi par the blockchain on regular basis, search for 
transact between user and hidden servic addresses. 

(5) trudi find bitcoin address A on public.com, associ 
with onlin ident @alice. 

(6) trudi find bitcoin address P on private.onion. 
(7) trudi find transact A → P and accordingli link @al- 

ice to private.onion. 
unknown to alice, trudi can effect deanonym alice’ 

ident and link her to activ on private.onion use step 1–7. 
more importantly, thi attack vector be feasibl retroact in the 
future, start from the time of the transact A → P . 

3.2 adversari model 
We assum a passive, limit adversary. the adversari have access to 
or be capabl of collect bitcoin address of tor hidden servic 
and their users. thi attack do not need to control network 
resources, but can extract publicli access inform from on- 
line social networks, the blockchain, and onion pages. obtain 
bitcoin address of user can be either target or non-targeted, 
depend on the attack scenario. for the earli scenario, the adver- 
sari can use social engin or exploit contextu metadata. for 
example, if trudi know that alic book a ticket on expedia10 
at a certain time with a certain amount of coins, trudi can easili 
deduc alice’ bitcoin address from the blockchain. for the latter 
scenario, the adversari can crawl and pars public data sourc for 
bitcoin address and associ ident on a larg scale. 

We focu on the second, non-target attack scenario and show 
that an adversari can deanonym hidden servic user by corre- 
late public data from onlin social networks, the blockchain, and 
tor hidden services. 

3.3 ethic consider 
the deanonym present in thi work depend on correl 
public bitcoin address of user with the transact reveal 
by the blockchain. mani prior studi perform similar analysi 
base on crawl public bitcoin address [16, 25, 32]. while our 
studi narrow down thi analysi to the scope of hidden servic 
and their users, we stress that even the bitcoin address of hidden 

10https://www.expedia.com 

servic be readili avail on their onion land pages. We do 
not tri to obtain bitcoin address of hidden servic that requir 
authentication, payment, or exchang of emails. 

We believ the data collect and use herein be easili avail 
to adversaries. In thi research, in addit to the blockchain and 
onion land pages, we use data avail from two onlin so- 
cial networks, namely, twitter and the bitcointalk forum. A web 
search engine, such a google,11 or ani other organ that 
have access to a significantli larg amount of data could perform 
the analysi on a larg scale, and potenti exploit a significantli 
larg amount of leak inform about users. ignor the exis- 
tenc of the data, or the secur implic of use bitcoin a a 
payment method for hidden services, can leav both the user and 
the secur commun unawar of the involv privaci leaks. 

To thi end, we have consult and receiv the approv of our 
institution’ irb board to conduct our experiment. We would like 
to highlight that our research do not put user at ani addit 
risk, but rather expos the exist one. thi be import becaus 
onc user becom vulner to thi deanonym attack, a 
describ in section 3.1, they stay vulner even after they switch 
to a more secur payment method or stop use the service. As part 
of our person and institut code of ethics, we have reach 
out to vulner user in our dataset and inform them about 
thi threat and possibl remedies. We also post an anonym 
notic on bitcointalk forum.12 In section 4.4, we discu a number 
of countermeasur that be design to protect and improv user 
privaci and anonymity. 

3.4 data collect 
We now describ how we collect public bitcoin address and 
onlin ident of tor hidden servic and bitcoin users.13 

3.4.1 hidden services. tor hidden servic be not index by 
normal search engines, but can be found use index servic 
such a ahmia,14 which be access from the normal web. other 
search engin be avail but requir a tor browser in order to 
access them. these search engin be use to access the onion 
land pages, or the websites, of mani hidden services. typically, 
hidden servic publish their bitcoin address on their land 
page for receiv payments. these address can be collect 
by simpli download these page and search for bitcoin ad- 
dress use regular expressions. As a bitcoin address be a base-58 
encod identifi of 26–35 alphanumer characters, begin 
with the number 1 or 3, we use the follow regex: 

*[13][a-km-za-hj-np-z1-9]{25,34} 

with the goal of collect long-term hidden servic addresses, 
we start expand the dataset in mid 2015. over time, however, 
we found that few hidden servic publicli expos their bitcoin 
address on their onion pages, resort to onlin wallet or other 
crypto-currencies, possibl due to the increas awar of bit- 
coin’ privaci issu (section 4). therefore, our analysi focu 
on the time window when publish long-term bitcoin address 
be a common practice. We note that the deanonym attack 
11https://google.com 
12https://bitcointalk.org/index.php?topic=2602885 
13the result dataset be avail per request to interest researchers. 
14https://ahmia.fi 

4 

https://www.expedia.com 
https://google.com 
https://bitcointalk.org/index.php?topic=2602885 
https://ahmia.fi 


deanonym tor hidden servic user through bitcoin transact analysi , , 

date collect # address 

label (dd/mm/yyyy) # user origin expand 

hiddenservic 27/01/2016 88 88 – 
twitterus 30/12/2014 4,183 4,183 623,189 
forumus 26/10/2016 40,970 40,970 19,213,141 
tabl 1: dataset summari of collect bitcoin address 

be feasibl use histor data that be publicli avail sinc the 
incept of bitcoin in 2010 up until now. 

In our experiment, we first compil a list of onion address 
from ahmia. We then download the land page of more than 
1.5k hidden services. while our goal be to autom the process of 
collect bitcoin addresses, mani of the onion address list by 
ahmia be unavail or offlin when we ran the script on jan 
27, 2016. A simpl regex search on the land page allow u to 
extract a small number of bitcoin addresses, less than 20 addresses. 

furthermore, by brows variou hidden services, we be 
abl to extract more addresses. We also observ that mani ser- 
vice do not expos their bitcoin address on their land pages, 
and would requir user to attempt purchas item befor a bit- 
coin address be show to the user.15 In addition, we includ two 
know ransomwar address that be publish on the web and 
the blockchain.16 ransomwar be a malwar categori that limit the 
access of user to their file by encrypt them [19]. ransomwar 
requir victim to pay in order to get access to the decrypt keys. 
To remain anonymous, ransomwar requir victim to pay through 
the bitcoin network. ransomwar locker be know to use tor 
hidden servic a a place to hide their malici activ [20]. 

our autom and manual search result in a total of 105 
bitcoin addresses. We verifi that those address be activ 
by download their transactions. We remov all address that 
contain no transact or have veri low amount of bitcoins, 
less than 0.00001b, and be like to be inactive. thi result in 
88 uniqu bitcoin address which repres the hiddenservic 
dataset, a summar in tabl 1. 

while the number we end up with seem rel small com- 
par to the total number of hidden services, our goal here be to 
show the feasibl of link hidden servic to their user use 
onli public information. As describ in section 3.2, an adversari 
that have a wider access to resources, or activ interact with hid- 
den services, be expect to collect a significantli larg number of 
addresses. 

3.4.2 users. bitcoin user often post their address on onlin 
social network for differ purposes, such a receiv donations, 
offer services, or show that they be part of the community. 
public bitcoin address expos onlin could potenti put these 
user at the risk of transact histori trace and linkage. not 
onli do user reveal their public bitcoin addresses, but they also 
reveal person inform repres their onlin identities, 

15servic we manual visit offer varieti of differ content rang from dark 
market (e.g. drug, steal card, and arms) to servic such a wikileaks. 
16https://blockchain.info/address/1aeoihy23fbbn8qij5y6oajrhry1fb85uc 

such a contact information, gender, age, and location, depend 
on the social network used. 

bitcoin address and the associ onlin ident of user 
can be collect by crawl and pars their user profil or by 
use the nativ api provid by the social network itself. In our 
experiment, we collect the address and ident of user of 
two onlin social networks, specifically, twitter and the bitcointalk 
forum, a summar in tabl 1. We note that there be a one-on 
map between an address and it associ onlin identity. 

twitter. We use twitter decahos stream data [38] that we pre- 
viousli collect from dec 11, 2013 to dec 30, 2014. decahos pro- 
vide a 10% realtim random sampl of all public tweet through 
a stream connection. the reason we chose thi dataset be be- 
caus we want to find bitcoin address for twitter users, which 
coincid with our hidden services’ bitcoin addresses. recal that 
prior to 2016, it be more common for user and hidden servic 
to share their long-term addresses. overall, data collect result 
in 10tb of json-format file repres 5 billion tweets. In 
addit to it textual content, each tweet have the public profil 
inform of it author, which sometim contain the author’ 
bitcoin address. To extract tweet that contain bitcoin addresses, 
we scan the whole dataset and kept the tweet that match 
the regex describ in section 3.4.1, result in 509,173 tweets. 
next, we ran anoth pa on the match tweet to group them 
into uniqu bitcoin addresses. from 509,173 match tweets, we 
found 4,183 uniqu address and identities, where an address of 
an ident appear in 165 differ tweets, on average. We refer 
to thi list of address a the twitterus dataset. 

forum. bitcointalk be one of the most popular bitcoin forum 
with more than 900k user who exchang interests, technic ex- 
pertise, and experi in the develop of the bitcoin software. 
the forum also have sever differ section for coin mining, tech- 
nical support, and the economi of bitcoin. It be the first forum of 
it kind that discu topic relat to bitcoin and have reach 
it billionth post in jul, 2012. As of nov 2017, the forum contain 
around 2.5 billion posts. base on it popularity, we sought to use 
it a a resourc to extract public address of bitcoin users. 

In our experiment, we crawl and pars 900k user profil 
by retriev each profil page use it url, where each page 
be index by a uniqu user identifi that start from 1. overall, 
the crawl result in 22 GB of unpars user profil in html 
format. have the profil downloaded, we pars them search 
for bitcoin address use the regex describ in section 3.4.1, 
result in 40,970 uniqu address and identities. We refer to thi 
list of address a the forumus dataset. 

5 



, , husam Al jawaheri, mashael Al sabah, yazan boshmaf, and aimen erbad 

0 

0.2 

0.4 

0.6 

0.8 

1 

1 10 100 1000 10000 100000 

closur size 

befor 
after 

(a) twitterus 

0 

0.2 

0.4 

0.6 

0.8 

1 

1 10 100 1000 10000 100000 

closur size 

befor 
after 

(b) forumus 

figur 1: cdf of closur size befor and after clean 

3.5 wallet-closur analysi 
the goal of wallet-closur analysi be to expand the set of bitcoin 
address that be control by a user in order to establish a uniqu 
many-on map between address and an identity. increas 
the number of bitcoin address per user allow u to identifi more 
link between the user and hidden services. use the first wallet- 
closur heurist origin propos by meiklejohn et al. [25], we 
defin the closur of a bitcoin address a follows: If addressesa and 
B be in a closure, then there exist a transact where address 
A and B appear a inputs. the motiv for thi be that if two 
address appear in the same transact a inputs, then they be 
like to be control by the same user, sinc they be sign by the 
privat key of the owner who perform the transaction. however, 
thi heurist be noisi when user util mix servic or use 
coinjoin transactions, a the mix process result in closur that 
includ address belong to multipl identities. accordingly, one 
might end up with closur that have a larg number of address 
that be not mutual exclusive. In other words, there will be some 
bitcoin address that appear in multipl closures. 

mix servic be third parti servic that receiv coin from 
one user, mix the coin with those receiv from other users, 
and then send back the same amount of coins, albeit shuffl with 
differ address use a number of transactions, to the origin 
user. coinjoin, on the other hand, be a peer-to-p mix protocol 
that achiev a similar goal, but us a more sophist approach. 
these servic be use to improv the anonym of transact 
and reduc linkability. In order to elimin the effect of mix 
services, we perform the follow clean process: We find all 
closur that share at least one address and consequ merg 
them, after which we remov all closur that have be merged, 
end up with uniqu closur that have no intersect and be 
mutually-exclusive. while do so ensur that wallet-closur 
which belong tomultipl user be not doubl counted, it also mean 
that the result number of user that be link to hidden servic 
repres a lower-bound estim of the actual number of user 
that can be link and deanonymized. 

In our experiment, after appli wallet-closure, we be abl 
to expand the twitterus dataset by 619,006 addit address 

for 1,322 user out of the 4,183. the closur be more signific 
for the forumus dataset, where we be abl to add 18,508,012 
address for 22,843 user out of the 40,970. In total, for the two 
datasets, we end up with 19,172,171 address for 45,153 users, 
with an averag of 425 address per user repres the averag 
closur size. after wallet-closur cleaning, we end up with 3,640 
closur for the twitterus dataset, and 23,567 closur for the 
forumus dataset. these closur under-approxim user wallets, 
where each consist of at least one bitcoin address and be uniqu 
map to it owner who be a user with an onlin identity. We use 
these closur to link user to hidden servic in the next section. 

figur 1 show the closur size cdf for both datasets, befor 
and after the clean process. As illustr in the figure, there be 
a signific drop in the size of closur after cleaning; the median 
size decreas from 8 address to 4 for the twitterus dataset, 
and from 103 address to 5 for the forumus dataset. In fact, 
more than 90% of the user in both dataset have 6 address or less 
in their wallet after cleaning. the figur also suggest that a larg 
number of bitcointalk user util mix servic than twitter 
users, a show by the differ in their before/aft distributions. 

3.6 bitcoin transact analysi 
We now describ how we link user to hidden services, give two 
deanonym case studies, and analyz the econom activ 
of the link services. 

3.6.1 linking. In order to establish a link between a user wallet 
and a hidden service, we need to search the blockchain for a trans- 
action whose input be ani of the address in the wallet and whose 
output be a hidden servic address. 

In our experiment, we first download the whole blockchain 
use the bitcoin core client softwar [5], which be also respons 
for manag the client’ runtim and transactions. At the time of 
the analysis, the size of the blockchain be over 230gb and it take 
nearli two day to download and sync the blockchain on an averag 
internet connection. the bitcoin core client do not provid an 
easy, nativ way to access blockchain transactions. for that, one 
can use api built on top of bitcoin core, such a bitcor node [6], 

6 



deanonym tor hidden servic user through bitcoin transact analysi , , 

# link user volum flow of money (b) lifetim (dd/mm/yyyy) 

name twitterus forumus total (# txs) incom outgo first tx last tx # day 

wikileak 11 35 46 25,569 4,011.95 4,000.40 14/06/2011 24/07/2017 2,163 
silk road 4 18 22 979 29,675.86 29,658.80 02/10/2013 24/07/2017 1,321 
internet archiv 3 13 16 2,534 155.55 99.61 09/05/2013 24/07/2017 1,537 
snowden defens fund 3 8 11 1,642 201.88 198.38 10/08/2013 15/07/2017 1,370 
the pirat bay 3 7 10 1,192 76.80 76.78 29/05/2013 08/07/2017 1,151 
darkwallet mixer 9 1 10 1,084 109.97 92.75 16/04/2014 02/11/2016 932 
protonmail 1 7 8 2,850 143.17 68.78 17/06/2014 24/07/2017 1,498 
openstreetmap donat 0 5 5 440 24.01 24 13/05/2013 13/07/2017 1,522 
darknet mixer 1 2 3 22,110 306.16 341.48 21/01/2014 24/07/2017 1,645 
liberti hacker 0 2 2 85 2.79 2.79 10/04/2013 11/07/2017 1,553 
onion mail 1 0 1 226 84.92 84.92 15/09/2014 30/03/2015 196 
bitcoin fog 1 0 1 121 10.46 10.46 12/08/2014 09/01/2015 150 
bitmessag mail 0 1 1 106 2.78 1.37 28/04/2014 16/06/2017 1,145 
secur tor messag 0 1 1 105 12.5 12.5 02/01/2013 05/01/2016 1,098 
ransomwar 1 0 1 72 41.15 41.15 28/02/2014 15/08/2014 168 
bitcoin lotteri 0 1 1 33 0.22 0.22 28/02/2014 02/05/2015 428 
libertarian nut 0 1 1 23 0.31 0 28/02/2014 24/10/2015 603 

unknown1 1 1 2 42 8.32 8.31 23/06/2014 23/06/2017 1,096 
unknown2 1 0 1 132 4.19 4.18 22/06/2014 01/01/2015 193 
unknown3 0 1 1 39 7.95 7.94 01/05/2014 18/05/2017 1,113 

tabl 2: link hidden services. the three unknown servic belong to onion page that be take down befor we could 
manual identifi and valid their hidden servic provider. 

which extend bitcoin core and provid addit index for 
more advanc address queries, and insight api [7], which be a 
rest http and web socket api servic for bitcor node. 

use the insight api on top of bitcor node, we perform the 
link process after wallet-closur a follows: for each address 
in the hiddenservic dataset, we queri the blockchain for the 
transact histori of that address. thi queri return a set of 
transact in which the address appear a either an input or 
an output. We then issu the same queri for each address in the 
twitterus and forumus datasets. thi result in two set 
of transactions; one for hidden servic and one for users. finally, 
we cross-match the two set of transactions; if ani address of a 
user be found a an input in ani transact where a hidden ser- 
vice address appear a an output, then the user have a relationship 
with that hidden service, and thus, a link be established. for the 
twitterus dataset, we be abl to link uniqu 28 user to 14 hid- 
den servic use 167 transactions. similarly, for the forumus 
dataset, we be abl to link uniqu 97 user to 20 hidden servic 
use 115 transactions. some of these user be link to multi- 
ple hidden services, and a total of 20 uniqu hidden servic be 
link to user from the two datasets. As suggest by the results, 
although twitter user be small in number compar to bit- 
cointalk users, they be more activ and have a larg number of 
transact with hidden services. In fact, some of these user be 
“return customers,” a they have performedmultipl transact 
with the same hidden services. 

tabl 2 list the hidden servic sort by how mani user be 
link to them. the list be top by wikileaks, a servic that pub- 
lish secret inform provid by anonym sources, with 
46 link users. thi be follow by the silk road, a famou black 
market on the dark web, with transact from 22 user whose 
input coin have be seiz by the fbi. although the wallet ad- 
dress of silk road be seized, it be still receiv transact until 
recently. however, from our analysis, we observ that a number of 
transact be perform prior to the seizure. rank fifth, the 
pirat bay, which be know for infring IP and copyright law by 
facilit the distribut of protect digit content, be link 
to 10 users. other servic list in tabl 2 includ hack services, 
such a liberti hackers, mix services, such a darknet mixer, 
and variou secur mail providers, such a protonmail. 

3.6.2 deanonymization. As link user have associ onlin 
identities, they could be deanonym with differ level of cer- 
tainty, depend on how much person identifi inform 
they have share on their social network’ user profiles. We next 
focu on two case studi that illustr thi threat in more detail. 
It be import to note that we found a number of sensit detail 
about these user includ location, gender, age and email ad- 
dresses. however, due to ethic considerations, we onli disclos 
the inform that demonstr the privaci implic of thi 
type of analysis. 

the first case studi be of a pirat bay hidden servic user. the 
associ onlin ident indic that the user be a middl age 
man from sweden. thi user be particularli interest becaus the 
pirat bay websit be found by a swedish organ call 

7 



, , husam Al jawaheri, mashael Al sabah, yazan boshmaf, and aimen erbad 

piratbyrån. furthermore, the origin founder of the websit be 
found guilti in the swedish court for copyright infring [33]. 
sinc then, the websit have be chang it domain constantly, 
and eventu oper a a tor hidden service. therefore, the 
exist link between thi user and the pirat bay through recent 
transact could be incriminating. 

In the second case, we focu on the silk road hidden service. As 
show in tabl 2, there be 22 user that have a link to silk road 
through transact with seiz bitcoin addresses. these user 
be locat across the world in countri such a india, canada, 
and the usa. they includ 4 male and 6 femal of differ age 
that rang between 13 and 42 years. the 18 user from the foru- 
muser dataset be activ on bitcointalk between 2013 and 2015, 
while 3 of them be still activ in 2017. As for the 4 user from the 
twitterus dataset, they post an averag of 45 tweet in 2014. 
one particularli interest user be a young teenag from the usa. 
thi user have be a regist bitcointalk member sinc 2013, and 
have a transact with silk road in 2013, the takedown year, dure 
which he be even young than what hi current age show on hi 
profile. the associ profil also includ hi person website, 
which contain link to hi facebook, twitter, and youtub profiles. 

3.6.3 econom activity. In order to gain insight about the eco- 
nomic activ of the link hidden services, we analyz all of 
their transact in the blockchain. In our experiment, for each 
service, we collect inform about it number of transact 
(i.e., volume), the amount of coin the servic have receiv or sent 
(i.e., flow of money), and the timestamp of it first and last transac- 
tion (i.e., lifetime). the result be also summar in tabl 2. We 
refer the interest reader to appendix A for the econom activ 
analysi of the all hidden services, includ the unlink ones. 

volume. while the list of servic be small, our result indic 
that they have be involv in a rel larg number of transac- 
tions. for example, wikileak top the list with 25,569 transactions. 
the darknet mixer, on the other hand, have a volum of 22.1k trans- 
action that be great than the remain servic combined. one 
explan for thi popular be that user be actual awar of 
the possibl of linking, and tri to use mix servic in order to 
make traceabl more difficult and improv their anonymity. 

money flow. We calcul the total incom and outgo bit- 
coin for each hidden servic in order to determin how much 
money be actual flow in and out of their addresses. one inter- 
est observ be that almost the same amount of coin flow 
in and out of these addresses. thi indic that the money be 
be distribut to other addresses, and be not store on payment- 
receiv addresses. one explan for thi behavior be that by 
distribut fund to other addresses, a hidden servic can reduc 
coin traceability. also, hidden servic still need to distribut their 
revenu among owners, sellers, and other stakeholders. 

We also observ that multipl hidden servic have a revenu 
of more than 4K bitcoin and up to 29.6k, where one bitcoin be 
valu at 19.7 thousand usd a of dec, 2017. the silk road, for 
example, have receiv more than 580 million usd on it address. 

lifetime. track the econom activ of hidden servic over 
time allow u to estim their oper lifetime, at least a see 
from their associ addresses. from the transact histori of 

each hidden service, when filter by it bitcoin address, we defin 
the lifetim of the servic a the differ between the timestamp 
of the last and the first transact involv the address. thi 
allow u to estim the period of oper of each hidden service, 
and accordingly, determin if the servic be still active. 

As summar in tabl 2, hidden servic vari in their lifetime, 
rang from 2–6 year of operation. We note that the first transac- 
tion date do not impli that the servic begin it oper on that 
date; it indic the date on which the servic start receiv 
bitcoin payments. look at last transact dates, most of the 
hidden servic be still activ in 2017. 

4 discuss 
We now discu the deanonym attack, focu on it fea- 
sibil and implications. We also list the limit of thi work 
and highlight a number of exist countermeasur for improv 
privaci and anonymity. 

4.1 feasibl 
tor be expect to maintain it anonym guarante even with an 
active, local adversari who control a fraction of network resources, 
20% of the routers, for example. the goal of such an adversari be 
to link the sourc of a commun tunnel to it destination. In 
our setting, thi map to link a hidden servic user to a hidden 
servic operator. By observ both end of a circuit, even a passiv 
adversari can confirm a connect exist between alic and bob 
use time and traffic analysi [14]. If the adversari control onli 
a small fraction of the network, the chanc of such an end-to-end 
compromis be veri small. however, side-channel attack can be 
use to increas the success rate of deanonym attack [2]. 

the result in section 3.6 show that it be possibl to deanonym 
hidden servic user without the need to control network resourc 
nor inspect the traffic. As discuss in section 3.2, we consid a pas- 
sive, limit adversari that fall within the adversari model of tor, 
and focu on hidden servic that use bitcoin a a payment method. 
through a real-world experiment, we show that an adversari 
can link users, who publicli share their bitcoin address on onlin 
social networks, with hidden services, which publicli share their 
bitcoin address on onion land pages. thi be accomplish by 
inspect the transact involv these two address in the 
blockchain. 

while collect bitcoin address of hidden services, we found 
that mani servic start to hide their payment bitcoin address 
from onion land pages. one explan of thi trend be that 
hidden servic oper realiz that publicli share bitcoin ad- 
dress can leak inform which could be use for link and 
improv traceability. instead, these servic let user regist 
account on their websit and use them to perform transact 
without expos the address use to receiv bitcoins. the way 
thi work be a follows: If alic want to perform a transact 
with a hidden service, she start by creat a person account on 
the service. the hidden servic creat and control a new bitcoin 
address, from a new public/priv key pair, to which alic make 
a transact from her person bitcoin addresses. 

An active, more resourceful, local adversari can compil a larg 
set of hidden servic address by perform small transact 

8 



deanonym tor hidden servic user through bitcoin transact analysi , , 

with such servic in order to reveal their addresses. moreover, 
adversari can imperson a hidden servic and receiv payment 
on address they control. deanonym that exploit such tech- 
niqu have be practic in the wild by govern to uncov 
illeg hidden servic [10]. the adversari can also map collect 
bitcoin address to IP address in order to deanonym user at 
a more granular level [21]. 

In thi work, due to ethic concerns, we simul onli a passive, 
limit adversary. however, active, local adversari that be well- 
fund be like to exist in practice. We note that the success rate 
achiev by a passive, limit adversari repres a low bound 
of that of an active, local adversary. 

4.2 implic 
the main secur implic of our work be that a bitcoin ad- 
dress can be exploit to deanonym users. the experi we 
conduct can be extend to includ other onlin social network 
and inform sources. It be also like that an onlin identity, 
or a user account, on one social network have link to other net- 
work that provid addit piis. some user explicitli reveal 
their name, age, nationality, and other inform in their bio or 
through posts. thi repres a seriou threat to their anonymity, 
sinc the hidden servic they engag with might be associ 
with question transactions. the link process can also be 
use a a tool by third-parti to track users, perform surveillance, 
and audit financi transactions. 

due to these secur and privaci concerns, user have to fol- 
low simpl yet effect guidelin in order to protect themselves. 
first, user should never expos their bitcoin address along with 
their person identifi information. second, a discuss in 
satoshi’ white paper [29], a new address should be gener for 
each transact in order to reduc linkabl of transactions, re- 
gardless of whether the user be the sender or the receiv of the 
payment. thi be especi true for case where user expos a 
donat address on differ kind of onlin social networks. un- 
fortunately, a larg number of user do not follow thi practice, 
possibl due to poor usabl of bitcoin tools, unfamiliar of 
bitcoin internals, or relianc on third-parti wallet and exchang 
servic [22]. 

4.3 limit 
ourwork have twomain limitations. first, in our analysis, we assum 
that link a user, repres a an onlin identity, to a hidden 
servic be suffici to deanonym the user. however, thi be not 
alway true. user can alway creat fake onlin ident in order 
to hide their real ones. while do so improv their anonymity, 
onc the link be establish the adversari can perform onlin 
surveil to track down the user and uncov their true identi- 
ties. the second limit be relat to the use of mix services. 
while the wallet-closur clean process we use elimin the 
effect of mixing, it be aggress and can exclud user who do not 
use mix servic at all. accordingly, our result under estim 
the preval of the deanonym threat. 

It be import to mention that some of the link user through 
thi analysi be not concern about their transact anonym 
to servic such a internet archives. however, some user be 

unconsci about protect their privacy, and thi type of analysi 
can be use to incrimin these users. for example, servic such 
a the pirat bay be illeg in sweden, and therefore, establish 
a link through a transact with such a servic could potenti 
be use a an evid to accus the user of illeg activities. 

onemight argu that the number of deanonym user be small. 
however, in order to understand the signific of the results, it 
be use to put the number into perspective. accord to recent 
web statist [31, 36], the number of worldwid internet user be 
around 3.58 billion and the number of tor network user be about 3 
million, which be a superset of tor hidden servic users. thismean 
that 0.086% of internet user be tor network users, on average. 
the dataset we collect includ 45,153 twitter and bitcointalk 
users, out of which 0.277% of them be deanonymized. while thi 
percentag be larg than 0.086%, like due to bia sampling, it be 
still rel small, a expected. In other words, becaus we do not 
know how mani of the user in the dataset be tor hidden servic 
users, we should expect that onli a small percentag of them can 
be deanonymized. 

4.4 countermeasur 
there be two gener way to achiev improv anonym for 
user and hidden services. the first one be operational, and it focu 
on follow bitcoin best practices, a discuss in section 4.2. for 
those user who can be linked, the best cours of action for them 
be to clean their social network footprint, focu on remov 
pii that be publicli share or delet their link onlin identities, 
all together. the second way to improv anonym be technical, 
and it involv improv to the current bitcoin protocol or the 
introduct of new crypto-curr that be base on bitcoin’ 
blockchain technology. 

second gener anonym techniques, such a coinjoin, 
fair exchang [18], coinswap, and stealth address have be 
propos to be implement a extens or servic for bitcoin’ 
origin protocol. these be discuss in detail in [28]. furthermore, 
other altern coin base on differ modif to bitcoin 
protocol have be introduc to provid addit anonym 
for transact on the blockchain. the most promin of them 
beingmonero, which be base on crypto note v2.0 protocol [34] and 
zcash [35]. In fact, monero be alreadymak it way into the hidden 
servic of the dark web [37]. these new coin aim to deliv full 
anonym of transactions, and have their own advantag and 
disadvantag compar to bitcoin. 

5 relatedwork 
there be a number of studi that investig user anonym and 
privaci concern in bitcoin [15, 16, 25, 32]. fergal and martin [32] 
demonstr that use passiv analysi of publicly-avail bit- 
coin inform can lead to a seriou inform leakage. they 
construct two network repres transact and user from 
the blockchain. integr these network with off-network infor- 
mation, such a user profil from onlin social networks, and con- 
text discoveri and flow analysi techniques, it be possibl to studi 
the flow of bitcoin between address and investig thefts. fleder 
et al. [16], on the other hand, explor the level of anonym in the 
bitcoin network. the author annot the transact graph by 

9 



, , husam Al jawaheri, mashael Al sabah, yazan boshmaf, and aimen erbad 

link user pseudonym to onlin ident collect from onlin 
social networks. they also develop a graph-analysi framework 
to summar and cluster the activ of users. the analysi link 
ident of user to their transactions. these studi form the base 
for our approach, a we use some of their techniqu in our analysis. 
the differ in our studi be that we target a specif portion of 
bitcoin users, which be tor hidden servic users. We also studi the 
econom activ of link hidden services, which be import 
to understand the level of threat the user be expos to. 

dupont and squicciarini [15] propos a techniqu to determin 
a bitcoin user’ physic locat by examin user spend habit 
and link it to the user’ time zone. androulaki et al. [1] studi 
the privaci provis in bitcoin through a simul mimic 
the use of bitcoin a the digit currenc for daili transact in 
a typic univers setting. the studi show that behavior-bas 
cluster can unveil the profil of 40% of bitcoin user even if 
they be use recommend privaci measures. thi method can 
be use with our techniqu to increas the deanonym level 
from an onlin ident to a physic identity. 

A recent studi by harrigan and fretter [17] show the effective- 
ness of address cluster use the blockchain of bitcoin. these 
cluster be construct use differ heurist such a the one 
we use in our study. the author perform address cluster on 
the entir bitcoin’ blockchain and show that despit the exis- 
tenc of coinjoin and mix transactions, address cluster be still 
suitabl for blockchain analysi and re-identif attacks. the 
find present in their work strengthen our analysi result 
and further prof that our link to hidden servic be still valid 
until the current time. 

6 conclus 
We show that use bitcoin a a payment method for tor hidden ser- 
vice leak inform that can be use to deanonym their users. 
thi repres a seriou threat to these users, becaus they activ 
seek to maintain their anonym by use tor. the deanonymiza- 
tion be mainli due to the lack of retroact oper secur 
present in bitcoin’ pseudonym model. In particular, by inspect- 
ing histor transact in the blockchain, an adversari can link 
users, who publicli share their bitcoin address on onlin social 
networks, with hidden services, which publicli share their bitcoin 
address on their onion land pages. 

In a real-world experiment, we be abl to link mani user 
of twitter and the bitcointalk forum to variou hidden services, 
includ wikileaks, silk road, and the pirat bay. use informa- 
tion from their public user profiles, we be abl to show concret 
case studi where the anonym of the user be broken. our result 
have one immedi implication: bitcoin address should alway be 
assum compromis a they can be use to deanonym users. 

acknowledg 
We would like to thank hasan Al jawaheri, ryan riley, and jaideep 
srivastava for their help and feedback. the first author would like 
to thank qatar univers for a gener research assistantship. 

refer 
[1] elli androulaki, ghassan O. karame, marc roeschlin, tobia scherer, and srdjan 

capkun. 2013. evalu user privaci in bitcoin. springer berlin heidelberg, 

berlin, heidelberg, 34–51. 
[2] daniel arp, fabian yamaguchi, and konrad rieck. 2015. torben: A practic 

side-channel attack for deanonym tor communication. In proceed of the 
10th acm symposium on information, comput and commun security. 
acm, 597–602. 

[3] alex biryukov and ivan pustogarov. 2015. bitcoin over tor isn’t a good idea. In 
2015 ieee symposium on secur and privacy, SP 2015, san jose, ca, usa, may 
17-21, 2015. 122–134. 

[4] alex biryukov, ivan pustogarov, fabric thill, and ralf-philipp weinmann. 2014. 
content and popular analysi of tor hidden services. In 34th intern 
confer on distribut comput system workshop (icdc 2014 workshops), 
madrid, spain, june 30 - juli 3, 2014. 188–193. 

[5] bitcoin.org. n.d.. bitcoin core. (n.d.). https://bitcoin.org/en/bitcoin-core/ 
[6] bitpay. 2016. bitcor node. (oct 2016). https://github.com/bitpay/bitcore-nod 
[7] bitpay. 2016. insight-api. (jul 2016). https://github.com/bitpay/insight-api 
[8] michael del castillo. 2016. bitcoin remain most popular digit currenc on 

dark web. coindesk. (2016). 
[9] nicola christin. 2013. travel the silk road: A measur analysi of a 

larg anonym onlin marketplace. In proceed of the 22nd intern 
confer on world wide web. acm, 213–224. 

[10] amanda cochran. 2013. what be alleg silk road mastermind’ "fatal flaw"? 
find out how fbi track him down. (oct 2013). 

[11] anthoni cuthbertson. 2015. bitcoin now accept by 100,000 merchant world- 
wide. intern busi times. (2015). 

[12] roger dingledine. 2012. use tor hidden servic for good. the tor project. 
(2012). 

[13] roger dingledine. 2014. tor secur advisory: “relay early” traffic confirm 
attack. the tor project. (2014). 

[14] roger dingledine, nick mathewson, and paul syverson. 2004. tor: the second- 
gener onion router. In proceed of the 13th usenix secur symposium. 
303–320. 

[15] jule dupont and anna cinzia squicciarini. 2015. toward de-anonym 
bitcoin by map user location. In proceed of the 5th acm confer on 
data and applic secur and privaci (codaspi ’15). acm, new york, ny, 
usa, 139–141. https://doi.org/10.1145/2699026.2699128 

[16] michael fleder, michael S kester, and sudeep pillai. 2015. bitcoin transact 
graph analysis. arxiv (2015). 

[17] martin harrigan and christoph fretter. 2016. the unreason effec- 
tive of address clustering. In ubiquit intellig & computing, ad- 
vanc and trust computing, scalabl comput and communications, 
cloud and big data computing, internet of people, and smart world congress 
(uic/atc/scalcom/cbdcom/iop/smartworld), 2016 intl ieee conferences. ieee, 
368–373. 

[18] danushka jayasinghe, konstantino markantonakis, and keith mayes. 2014. 
optimist fair-exchang with anonym for bitcoin users. In e-busi engi- 
neer (icebe), 2014 ieee 11th intern confer on. ieee, 44–51. 

[19] amin kharraz, william robertson, david balzarotti, leyla bilge, and engin 
kirda. 2015. cut the gordian knot: A look under the hood of ransomwar 
attacks. In intern confer on detect of intrus and malware, and 
vulner assessment. springer, 3–24. 

[20] paul kimayong. 2016. new famili of ransom locker found, use tor hidden 
service. https://goo.gl/a8erio. (2016). 

[21] philip koshy, diana koshy, and patrick mcdaniel. 2014. An analysi of 
anonym in bitcoin use p2p network traffic. financi cryptographi 
and data secur lectur note in comput scienc (2014), 469–485. https: 
//doi.org/10.1007/978-3-662-45472-5_30 

[22] katharina krombholz, aljosha judmayer, matthia gusenbauer, and edgar 
weippl. 2016. the other side of the coin: user experi with bitcoin se- 
curiti and privacy. In intern confer on financi cryptographi and 
data security. springer, 555–580. 

[23] moserm. 2013. anonym of bitcoin transactions: An analysi of mix services. 
munster bitcoin confer (2013). 

[24] nick mathewson. 2014. some thought on hidden services. the tor project. 
(2014). 

[25] sarah meiklejohn, marjori pomarole, grant jordan, kiril levchenko, damon 
mccoy, geoffrey M. voelker, and stefan savage. 2013. A fist of bitcoins: 
character payment among men with No names. In proceed of the 2013 
confer on internet measur confer (imc ’13). acm, new york, ny, 
usa, 127–140. https://doi.org/10.1145/2504730.2504747 

[26] vincent van mieghem and johan pouwelse. 2015. anonym onlin purchas 
with exhaust oper security. corr abs/1505.07370 (2015). http://arxiv. 
org/abs/1505.07370 

[27] daniel moor and thoma rid. 2016. cryptopolitik and the darknet. surviv 
58, 1 (2016), 7–38. 

[28] malt möser and rainer böhme. 2017. anonym alone? measur bitcoin’ 
second-gener anonym techniques. In 2017 ieee european sympo- 
sium on secur and privaci workshop (euros&pw). 32–41. 

10 

https://bitcoin.org/en/bitcoin-core/ 
https://github.com/bitpay/bitcore-nod 
https://github.com/bitpay/insight-api 
https://doi.org/10.1145/2699026.2699128 
https://goo.gl/a8erio 
https://doi.org/10.1007/978-3-662-45472-5_30 
https://doi.org/10.1007/978-3-662-45472-5_30 
https://doi.org/10.1145/2504730.2504747 
http://arxiv.org/abs/1505.07370 
http://arxiv.org/abs/1505.07370 


deanonym tor hidden servic user through bitcoin transact analysi , , 

[29] satoshi nakamoto. 2008. bitcoin: A peer-to-p electron cash system. (2008). 
[30] the tor project. 2015. A hidden servic hackfest: the arlington accords. tor. 

(2015). 
[31] the tor project. 2017. tor metric portal. https://metrics.torproject.org. (2017). 
[32] fergal reid and martin harrigan. 2013. secur and privaci in social networks. 

springer new york, new york, ny, chapter An analysi of anonym in the 
bitcoin system, 197–223. https://doi.org/10.1007/978-1-4614-4139-7_10 

[33] mikael ricknäs. 2017. pirat bay appeal look set to start in september. 
http://www.pcworld.com/article/191304/article.html. (2017). 

[34] nicola van saberhagen. 2013. crypto note v 2.0. cryp to note (2013). 
[35] E. B. sasson, A. chiesa, C. garman, M. green, I. miers, E. tromer, and M. virza. 

2014. zerocash: decentr anonym payment from bitcoin. In 2014 ieee 
symposium on secur and privacy. 459–474. https://doi.org/10.1109/sp.2014.36 

[36] statista. 2017. number of internet user worldwid from 2005 
to 2017. (juli 2017). https://www.statista.com/statistics/273018/ 
number-of-internet-users-worldwid 

[37] kyle torpey. 2016. darknet custom are demand bitcoin al- 
tern monero. (august 2016). http://www.nasdaq.com/article/ 
darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 

[38] twitter. 2016. gnip decahose: real-tim trend detect and discovery. (2016). 
https://gnip.com/realtime/decahose/ 

[39] joe van buskirk, sundresan naicker, amanda roxburgh, raimondo bruno, and 
lucinda burns. 2016. who sell what? countri specif differ in substanc 
avail on the agora cryptomarket. intern journal of drug polici 35 
(2016), 16–23. 

[40] aaron van wirdum. 2016. coinjoin: combin bitcoin transact to obfus- 
cate trail and increas privacy. https://goo.gl/lwt5u1. (2016). 

A appendix 
In what follows, we present a high-level analysi of the econom ac- 
tiviti involv all hidden servic from the hiddenservic dataset. 

a.1 volum 
figur 2 show the cdf of the total volum from all services, a 
defin in section 3.6.3. We can see from the figur that 10% or less 
hidden servic have more than 1,000 transactions. thi compli 
with our previou result show that most of the transact 
from twitterus and forumus dataset be attribut to the 
top 4–5 hidden services, in term of volume. 

a.2 money flow 
the money flow in and out of hidden servic address be almost 
identical, so be the correspond money flow cdfs. figur 3 show 
the cdf of the total incom bitcoin receiv by all services. As 
the figur shows, onli the top 10% of hidden servic have receiv 
more than 100b. the distribut be rel skew due to the 
fact that the top-3 servic have significantli big revenue, with 
more than 4,000b. 

a.3 lifetim 
figur 4 show the percentag of hidden servic that be activ 
dure the period 2011–2017. As denot by the figure, most of these 
servic be activ dure the year 2014–2015, which be the same 
time frame we base our data collect period on. furthermore, a 
expected, the activ for their address be significantli low in 
the follow years. thi be most like due to the usag of onlin 
wallet or their migrat to other cryptocurrencies, a discuss 
in section 4. 

0 

0.2 

0.4 

0.6 

0.8 

1 

0 5 10 15 20 25 

volum (thousands) 

figur 2: number of transact of hidden servic 

0 

0.2 

0.4 

0.6 

0.8 

1 

0 5 10 15 20 25 30 

incom bitcoin (thousands) 

figur 3: money flow for hidden servic 

0% 

20% 

40% 

60% 

80% 

100% 

2011 2012 2013 2014 2015 2016 2017 

A 
ct 

iv 
e 

hi 
dd 

en 
s 

er 
vi 

ce 
s 

year 

figur 4: lifetim of hidden servic 

11 

https://doi.org/10.1007/978-1-4614-4139-7_10 
https://doi.org/10.1109/sp.2014.36 
https://www.statista.com/statistics/273018/number-of-internet-users-worldwid 
https://www.statista.com/statistics/273018/number-of-internet-users-worldwid 
http://www.nasdaq.com/article/darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 
http://www.nasdaq.com/article/darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 
https://gnip.com/realtime/decahose/ 

abstract 
1 introduct 
2 background 
2.1 bitcoin 
2.2 tor hidden servic 

3 approach and experi 
3.1 overview 
3.2 adversari model 
3.3 ethic consider 
3.4 data collect 
3.5 wallet-closur analysi 
3.6 bitcoin transact analysi 

4 discuss 
4.1 feasibl 
4.2 implic 
4.3 limit 
4.4 countermeasur 

5 relat work 
6 conclus 
refer 
A appendix 
a.1 volum 
a.2 money flow 
a.3 lifetim 



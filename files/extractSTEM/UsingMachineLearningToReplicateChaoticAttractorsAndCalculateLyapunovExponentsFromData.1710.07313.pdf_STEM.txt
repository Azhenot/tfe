














































ar 
X 

iv 
:1 

71 
0. 

07 
31 

3v 
1 

[ 
nl 

in 
.C 

D 
] 

1 
9 

O 
ct 

2 
01 

7 

use machin learn to replic chaotic attractor 

and calcul lyapunov expon from data. 

jaideep pathak,1, 2 zhixin lu,1, 3 brian R. hunt,3, 4 michel girvan,1, 2, 3, 5 and edward 

ott1, 2, 6 

1)institut for research in electron and appli physics, univers of maryland, 

colleg park, maryland 20742, usa 

2)depart of physics, univers of maryland, colleg park, maryland 20742, 

usa. 

3)institut for physic scienc and technology, univers of maryland, colleg park, 

maryland 20742, usa. 

4)depart of mathematics, univers of maryland, colleg park, maryland 20742, 

usa. 

5)london mathemat laboratory, 14 buckingham street, london wc2n 6df, 

unit kingdom. 

6)depart of electr and comput engineering, univers of maryland, 

maryland 20742, usa. 

(dated: 23 octob 2017) 

We use recent advanc in the machin learn area know a ‘reservoir comput- 
ing’ to formul a method for model-fre estim from data of the lyapunov 
expon of a chaotic process. the techniqu us a limit time seri of measure- 
ment a input to a high-dimension dynam system call a ‘reservoir’. after 
the reservoir’ respons to the data be recorded, linear regress be use to learn 
a larg set of parameters, call the ‘output weights’. the learn output weight 
be then use to form a modifi autonom reservoir design to be capabl of 
produc arbitrarili long time seri whose ergod properti approxim those 
of the input signal. when successful, we say that the autonom reservoir repro- 
duce the attractor’ ‘climate’. sinc the reservoir equat and output weight be 
known, we can comput deriv need to determin the lyapunov expon 
of the autonom reservoir, which we then use a estim of the lyapunov expo- 
nent for the origin input gener system. We illustr the effect of our 
techniqu with two examples, the lorenz system, and the kuramoto-sivashinski 
(ks) equation. In particular, we use the lorenz system to show that achiev cli- 
mate reproduct may requir tune of the reservoir parameters. for the case of 
the KS equation, we note that a the system’ spatial size be increased, the number 
of lyapunov expon increases, thu yield a challeng test of our method, 
which we find the method success passes. 

there have be notabl recent advanc in machin learn that have proven 

use for task rang from speech recognition1,2 to play of the game Go at 

a level surpass the best humans3. In thi paper, we build a machin learn 

model of a chaotic dynam system use the neural comput framework 

know a reservoir computing4. We show that such a model can be use to de- 

duce the most import quantifi of the system’ chaotic behavior, namely, 

it lyapunov exponents, use onli limit time seri measur of the 

system. We envis that such artifici intellig base model could be 

use to accur captur the complex dynam of mani geophysical, ecolog- 

ical, biolog or econom system that be often difficult to model from first 

principles. 

http://arxiv.org/abs/1710.07313v1 


2 

I. introduct 

We consid the frequent occur situat in which limit durat time seri data 
from some dynam process be available, but a first-principles-bas model of how that data 
be produc be either unavail or too inaccur to be useful. thus, if one be interest 
in diagnos ergod properti of the underli process produc the data, one be 
restrict to do so base onli on the data itself. We call such a method “model-free.” 
model-fre analysi of dynam time seri be a long-stand subject of studi in nonlinear 
dynamics5–7. perhap the most wide-spread approach us delay-coordin embedding5–13. 
In thi article, we discu a veri promising, entir differ approach to model-fre analysi 
of dynam time series. our approach be base upon recent signific advanc in the area 
know a machin learning. In particular, we will appli a type of machin learn know 
a reservoir computing4, and, for definiteness, we focu on the problem of determin the 
lyapunov expon of the data-gener system. for thi application, the key abil we 
requir from machin learn be to replic the ergod properti of the system gener 
the input, and we call thi replic the “climate.” 
the rest of thi articl be organ a follows. section II review reservoir comput and 

it use for short-term predict of chaotic time series. section iii illustr our method 
use the well-known lorenz 1963 model14, and discu the abil of reservoir comput 
to replic the (long-term) climate. section IV us our approach to evalu the lyapunov 
expon of the kuramoto-sivashinski (ks) equation15–17 with period boundari condi- 
tions. thi system provid an exampl of extens spatiotempor chaos18–21, for which 
the attractor dimens and number of posit lyapunov expon increas linearli with 
the period length L. In particular, sec. IV consid case with mani posit lyapunov 
exponents. the paper conclud with further discuss in sec. V. 
the main conclus of thi paper be that our machin learn approach offer a veri 

attract model-fre method for obtain lyapunov expon from data. particularli 
notabl be our result from sec. IV where we obtain excel agreement for all of the 
posit lyapunov expon and mani of the neg expon for a moder high- 
dimension system. In comparison with delay coordin embedding, we remark that 
our method appear to be simpler to implement, and do not appear to suffer from the 
problem of yield spuriou posit lyapunov expon (e.g., see [22], [23]. these paper 
and refer therein discu the mechan respons for spuriou posit lyapunov 
expon in delay coordin emb and how to fix the problem. sinc thi mechan 
be inher absent in our method, we do not expect, and indeed, have not found spuriou 
posit exponents). more broadly, our paper suggest that machin learn be use for 
analysi of data from chaotic system (e.g., previou work have treat model-fre machin 
learn for predict of futur evolut of the state of a dynam system24 and for 
infer of unmeasur dynam variables25). 

ii. reservoir computers, short term predict and attractor climat 

reservoir computers4 origin from an idea independ put forth about 16 year ago in 
two papers26,27. the gener approach be illustr in fig. 1(a), which show an input vector 
u(t) fed into a “reservoir” (label R in fig. 1(a)) through an input-to-reservoir coupler 
(label i/r), with an output vector v coupl from the reservoir through an output coupler 
(label r/o). We regard the coupler a act instantan and without memori (i.e., 
their output depend sole on their current input). importantly, the reservoir have memori 
(i.e., it have intern dynam so it state depend on it history). We assum that it 
receiv input at discret time t, and that it input winu(t) be combin with the reservoir 
state r(t) to produc it output r(t + ∆t). In general, the reservoir can be ani complex 
dynam system with mani state variables, but here we follow refs. [26,27] and consid 
the reservoir to be a larg random network with Dr node and an Dr × Dr adjac 
matrix A. specifically, we will henceforth consid the particular implement (similar 



3 

(a) 

(b) 

fig. 1. (a) configur of the reservoir in the train phase correspond to eqs. 1 and 2. (b) 
reservoir configur in the predict phase correspond to eq. 4. 

to ref. [24]) of fig. 1(a) give by 

r(t+∆t) = tanh[ar(t) +winu(t)], (1) 

v(t +∆t) = wout(r(t+∆t),p), (2) 

where r(t) repres the scalar state ri(t) of the Dr network reservoir nodes, r = 
[r1, r2, ..., rdr ] 

T ; in eq. (1), win be a Dr × D matrix, where D be the dimens of 
u; also, in eq. (1), for a vector q = (q1, q2, . . . ) 

T the quantiti tanh(q) be the vector 
(tanh(q1), tanh(q2), . . . ) 

T . In eq. (2), wout map the Dr dimension vector r to the 
output v, which, for the situat consid in thi article, have the same dimens D a 
u. In addition, we assum that wout depend on a larg number of adjust paramet 
give by the element of the matrix P, and that wout(r,p) depend linearli on P (e.g., in 
past work the choic wout(r,p) = Pr have often be used). 
In general, the goal of the system in fig. 1(a) be for the output v(t) to approxim the 

desir outputs, vd(t), appropri to the input u(t) (e.g., in a pattern recognit task 
u(t) might repres a sequenc of patterns, and vd(t) would repres classif the 
patterns). To thi end, dure a train period, −T ≤ t ≤ 0, an input u(t) be fed into 
the reservoir and the result reservoir state evolut r(t), along with u(t), be record 
and store a “train data.” then the paramet P be chosen (“trained”) so a to 
approxim minim the mean squar differ between v(t) and it desir valu 
vd(t). As be common in reservoir computing, we use the tikhonov regular regress 
procedure28 to find an output matrix P, that minim the follow function, 

∑ 

−t≤t≤0 

||wout(r(t),p) − vd(t)|| 
2 + β‖p‖2, (3) 

where ‖p‖2 denot the sum of the squar of element of P. the regular constant 
β > 0 discourag overfit by penal larg valu of the fit paramet (in sec. IV 
we use a valu β > 0, but for sec. iii we found that use β = 0 be sufficient). for 
a give task, one hope that for larg enough Dr and T , the system in fig. 1(a) will 
yield subsequ (t > 0) output v(t) that close approxim the desir vd(t). becaus 
wout(r,p) be take to be linear in P, the problem of determin the paramet P that 
minim eq. (3) be one of linear regress for which there be well-establish techniques29. 
thi approach have be show to work extrem well for a wide varieti of tasks4. 
We now consid the task of predict for the case where u(t) depend on the state 

of some determinist dynam system. thi problem be origin consid in the 
reservoir comput framework by jaeger and haas24. the idea be to take the desir output 
to be the same a the input, vd(t + ∆t) = u(t + ∆t). when one wish to commenc 



4 

predict at t = 0, the configur be switch from that in fig. 1(a) to that in fig. 1(b), 
and the reservoir system be run autonom accord to the follow equation. 

r(t+∆t) = tanh [ar(t) +winwout(r(t),p)] . (4) 

the output of the autonom reservoir, v(t) = wout(r(t),p), give the predict valu 
u(t) for t > 0. jaeger and haas24, use the exampl of the lorenz system14, inde verifi 
that thi predict scheme work and give good short term predictions. As expected, the 
chaotic amplif of small error lead to eventu breakdown of the prediction, limit 
the predict time. however, a show in the next two sections, follow thi breakdown 
of short-term prediction, the evolut of v(t) often provid an accur approxim 
for the climat correspond to u(t), and can be use in particular to comput lyapunov 
expon of the process that gener u(t). 

iii. exampl 1: the lorenz system and the question OF whether the 

climat IS replic 

In thi section we illustr the capabl of our techniqu to replic the “climate” of 
the lorenz 1963 system14, 

ẋ = 10(i − x), 

ẏ = x(28− z)− y, 

ż = xy − 8z/3. 

(5) 

We construct and train reservoir comput with input u = (x, y, z)t ∈ R3 and output 
v ∈ r3, follow sec. ii. the reservoir network be built from a spars random erdős-rényi 
network whose averag degre be d = 6. each non-zero element in the adjac matrix be 
drawn independ and uniformli from [−a, a], and a > 0 be adjust so that the spectral 
radiu of A (the larg magnitud of it eigenvalues) have a desir valu ρ. dure the 
train phase, −T ≤ t ≤ 0 (where T = 100), the reservoir comput evolv follow 
eq. (1) with ∆t = 0.02. In thi lorenz example, the reservoir output v(t) = wout(r(t),p) 
be defin a 

v(t) = 

 

 

v1(t) 
v2(t) 
v3(t) 

 

 = 

 

 

p1r(t) 
p2r(t) 
p3r̃(t) 

 

 (6) 

where p1, p2, and p3 be the row of the 3×dr matrix P. the quantiti r̃ in the third line 
of eq. (6) be defin in a way such that the first half of it element be the same a that of 
r, i.e., r̃i = ri for half (dr/2) of the reservoir nodes, while r̃i = r 

2 
i for the remain half of 

the reservoir node (our use here of r̃(t), rather than r(t), to predict z(t) be relat to the 
x → −x, y → −y symmetri of the lorenz equat a discuss in ref. [25]). 
after we comput r(t) for the train period, −T ≤ t ≤ 0, we calcul the output 

weight paramet P that minim the function in eq. (3) with the desir output be 
the state variabl from the lorenz system, vd(t) = [x(t), y(t), z(t)] 

T (in an actual physic 
experiment, we assum u(t) = vd(t) to have be measur for −T ≤ t ≤ 0). after we 
find the output weights, we evolv the reservoir with the reconfigur reservoir system 
(fig. 1(b)). 
follow the abov describ procedure, We now report and compar result for two 

simul use reservoir configur with ρ = 1.2 (denot r1) and ρ = 1.45 (denot 
r2). the predict for 0 < t ≤ 25 for both train reservoir be show in fig. 2(a) 
(r1 with ρ = 1.2) and fig. 2(b) (r2 with ρ = 1.45). both reservoir R1 and R2 gener 
correct short-term predict and then deviat from the actual lorenz trajectories, which 
be expect sinc ani small error grow exponenti due to the chaotic dynam of the 
lorenz system. however, after the failur of the short-term prediction, the two reservoir 



5 

paramet valu paramet valu 

Dr 300 d 6 

T 100 ∆t 0.02 

t/∆t 5000 β 0 

ρ 1.2 σ 0.1 

tabl I. standard reservoir paramet use for a success climat replic of the lorenz 
system (refer to in the text a the R1 reservoir). the R2 reservoir us the same paramet 
with a differ spectral radius, ρ = 1.45. 

-15 

0 

15 

x 

actual 

predict 

-20 

0 

20 

y 

0 5 10 15 20 25 

t 

0 

20 

40 

z 

t-t 

-15 

0 

15 
x 

actual 

predict 

t-t 

-20 

0 

20 

y 

0 5 10 15 20 25 

t 

0 

20 

40 

z 
(a) 

(b) 

fig. 2. (a) the state predict (red) of the R1 reservoir and the actual trajectori (blue) of the 
lorenz system for 0 < t ≤ 25. the spectral radiu of the reservoir be 1.2. (b) the state predict 
(red) of the R2 reservoir and the actual trajectori (blue) of the lorenz system for 0 < t ≤ 25. 
the spectral radiu of the reservoir be 1.45. 

show qualit differ dynam patterns. In fig. 2(a), it seem that, after t ≈ 7, 
although the R1 predict deviat from the actual trajectory, the long-term dynam 
appear to resembl that of the origin lorenz system. In contrast, a show by fig. 2(b), 
thi be clearli not the case for r2. 

30 35 40 45 

30 

35 

40 

45 
(a) 

30 35 40 45 

30 

35 

40 

45 
(b) 

fig. 3. the return map of the actual and the predict z-coordin of the lorenz system. thi 
plot be make with time seri of length 1000, where the blue dot be from the actual lorenz system, 
and the red dot overlay the blue dot be from the prediction. the left panel show the return 
map of the long term predict of the R1 reservoir with ρ = 1.2, while the right panel be from the 
R2 reservoir with ρ = 1.45. 

In fig. 3 we present a more accur test than visual inspect of figs. 2(a) and 2(b) 
for correct of the climate. To do this, we follow lorenz’ procedur of plot the 



6 

actual lorenz system R1 system R2 system 

Λ1 0.91 0.90 0.01 

Λ2 0.00 0.00 −0.1 

Λ3 −14.6 −10.5 −9.9 

tabl ii. three larg lyapunov expon Λ1 ≥ Λ2 ≥ Λ3 for the lorenz system (eq. (5)), and 
for the reservoir set up in the configur of fig. 1(b) for R1 and r2. sinc the reservoir system 
that we employ be a discret time system, while the lorenz system be a continu system, for the 
purpos of comparison, λ1, λ2, and Λ3 be take to be per unit time; that is, their reservoir valu 
(column 2 and 3) be equal to the reservoir lyapunov expon calcul on a per iter basi 
divid by ∆t. 

return map of success maximum of z(t). We first obtain z(t) for a long period of time, 
0 < t < 1000, for both the actual and the predict time series. We then locat all local 
maximum of the actual and predict z(t) in time order and denot them [z1, z2, ..., zm]. 
then, we plot consecut pair of those maximum [zi, zi+1] for i = 1, ...,m − 1 a dot in 
figs. 3. the blue dot in both panel of figs. 3 be from the actual lorenz system, while 
the red dot print over the blue dot be from the reservoir output predict (v3) of 
z(t). As confirm by fig. 3(a) the red dot produc by the R1 reservoir continu to 
fall on top of the blue dot (from the actual lorenz system) throughout the entir run 
time (0 < t < 1000). In contrast, fig. 3(b) show that the blue dot remain larg 
uncovered, because, a indic in the third panel of fig. 2(b), the maximum valu of z(t) 
for t > 5 be at a fix point zmax ≈ 30. thu the R1 reservoir veri accur succeed 
in reproduc the long-tim climat of the attractor, while the R2 reservoir do not, and 
thi be so even though both setup be appar capabl of produc use short term 
predictions. (we have also obtain similar result for mani other simulations.) thu some 
paramet adjust may be necessari to avoid unsuccess reproduct of the climate. 
fortunately, we usual find that when the climat be not reproduc it be fairli evid (a 
in fig. 2(b), a well a fig. 5 of the next section). more quantitatively, a promis gener 
mean of assess whether the reservoir system have succeed in mimic the climat be to 
first use the train data to obtain finite-tim estim of the system’ ergod properti 
(e.g., frequency-pow spectra, time correlations, moment etc.). onc thi be done, one 
can test whether those estim be consist with determin of the same quantiti 
obtain from the long-term reservoir dynamics. section IV provid such an assess 
for the kuramoto-sivashinski system. 
the reservoir in the autonom configur of fig. 1(b) repres a know discrete- 

time, dr-dimension dynam system (sinc we knowwin, A, and the output paramet 
P determin by the training). We comput the equat for the evolut of the tangent 
map correspond to eq. (4) and evolv a set of m mutual orthogon tangent vector 
r(t) = {δrj} 

m 
j=1 along with eq. (4). We then comput the largestm lyapunov expon of 

the reservoir dynam system in the the configur show in fig. 1(b) use a standard 
algorithm base on QR decomposit (e.g., see ref. [7]) of the matrix r(t). the two right- 
most column of tabl II show the three larg lyapunov exponents, Λ1 ≥ Λ2 ≥ λ3, of the 
reservoir system in the autonom configuration, fig. 1(b), for the R1 reservoir (for which 
climat reproduct succeeds), and for the R2 reservoir (for which climat reproduct 
fails). 
compar the lyapunov expon of the lorenz system (first column of tabl ii) with 

those of the R1 reservoir, we see that the larg lyapunov expon of the R1 reservoir 
be a good approxim to the larg lyapunov expon of the lorenz system. also, 
consist with the small valu of ∆t, the reservoir dynam approxim that of a flow 
for which Λ2 should be (and is) approxim zero. On the other hand, we see that the third 
lyapunov expon of the R1 system be less neg than the neg lyapunov expon 
of the true lorenz system. In contrast with the good agreement of the Λ1 valu for the 
lorenz system and the R1 reservoir, the posit lyapunov expon of the lorenz system 
fail to be reproduc by the R2 system whose larg lyapunov expon be approxim 



7 

zero; thi be consist with the observ from fig. 2(b) that the long term reservoir 
attractor for R2 appear to be a period orbit. 
the signific conclus from the abov be that the R1 system, a a result of success 

reproduc the climate, can be util to obtain an approxim to the posit and zero 
lyapunov expon of the process gener it input. We note, however, that the R1 
system do not accur reproduc the true neg lyapunov expon of the lorenz 
attractor. 
the inaccur reservoir estim of λ3, note above, can be understood by note 

that, although the return map in fig. 3 appear to be a curve, thi appar “curve” must, 
a note by lorenz14, actual have some small width. the R1 reservoir succeed in approx- 
imat the attractor of the lorenz system a reflect by it appar good reproduct 
of the return map show in fig. 3(a). In order to do this, however, the reservoir need not 
reproduc the veri thin transvers structur within the appar curve. since, thi veri 
thin structure, a we next discuss, be the primari orbit evid of the valu of λ3, one 
might not expect the reservoir to accur reproduc thi veri neg lyapunov expo- 
nent. specifically, use the kaplan-york formula for the inform dimension30 of the 
fractal lorenz attractor, we obtain a dimens of [2 + (λ1/|λ3|)] = 2.06, correspond 
to 1.06 for the dimens of the structur in the return map (fig. 3(a)). thi dimens 
be veri close to one, in agreement with the approxim curve-lik charact of the return 
map. however, close examin of the return map “curve” of the lorenz attractor have 
previous show that, within it thickness, there be a fractal set of small transvers dimen- 
sion (presum λ1/|λ3| = 0.06). On the other hand, the kaplan-york dimens for the 
return map for the climat of the R1 reservoir attractor be about 1.09. sinc the primari 
orbit differ reflect by differ valu of Λ3 be the differ in veri thin structur 
featur of the return map that have onli a small effect on the climat dynamics, it be not 
surpris that the R1 reservoir, while give a good approxim to the true climat of 
the lorenz system, give onli a rough approxim of λ3. 

iv. exampl 2: the task OF determin A larg number OF lyapunov 

expon OF A high dimension spatiotempor chaotic system from 

data 

We now consid a modifi version of the kuramoto-sivashinski (ks) system defin 
by the partial differenti equat for the function y(x, t) 

yt = −yyx − 

[ 

1 + µ co 

( 

2πx 

λ 

)] 

yxx − yxxxx, (7) 

in the region 0 ≤ x < L with period boundari conditions, y(x, t) = y(x + L, t), and λ 
chosen so that L be an integ multipl of λ. thi equat reduc to the standard KS 
equat when µ = 0. the cosin term make the equat spatial inhomogeneous. We 
will subsequ consid the case µ = 0 and µ 6= 0 in order to discu the effect of the 
symmetri of the KS equat on the learn dynam of the reservoir computer. 
By numer integr eq. (7) on an evenli space one-dimension grid of size Q, 

we obtain a discret multivari data set of Q time series, 

u(t) = [y(∆x, t), y(2∆x, t), . . . , y(q∆x, t)] 
T 
, (8) 

∆x = l/q. 

As in the case of the lorenz equat discuss in sec. iii, we consid the situat where 
we have access to the time seri data but do not have inform about the dynam 
equat that gener the time series. In the absenc of a model, we will use the data to 
train a reservoir comput to emul the behavior of the true dynam system, in thi 
case eq. (7). 
the reservoir network be a describ in sec. II with the paramet list in tabl iii. 

In the train phase, fig. 1(a), we evolv the reservoir accord to eq. (1) from t = −T 



8 

paramet valu paramet valu 

Dr 9000 d 3 

T 20000 ∆t 0.25 

t/∆t 80000 β 0.0001 

ρ 0.4 σ 0.5 

tabl iii. reservoir paramet use for the success replic of the climat of the kuramoto- 
sivashinski system show in fig. 4. 

-2 

0 

2 

50 10 15 20 

20 

0 

0 

0 

40 

60 

20 

40 

60 

20 

40 

60 

fig. 4. top panel: true state, y(x, t), of the standard KS system after t = 0. middl panel: 
reservoir prediction. bottom panel: differ between the true state and the reservoir prediction. 
the paramet of the KS equat be L = 60, µ = 0. Λ1 denot the larg lyapunov exponent. 

to t = 0. next, we use tikhonov regular regress (see eq. (3)) to comput the output 
parameters, P such that wout(r,p) = pr̃(t) ≃ u(t) for −T ≤ t < 0. here r̃ be a dr- 
dimension vector such that the ith compon of r̃ be r̃i = ri for half the reservoir node 
and r̃i = r 

2 
i for the remain half. with the output paramet determined, we let the 

reservoir evolv autonom for t > 0 a show in fig. 1(b) accord to eq. (4). 

the predict make by the reservoir system for t > 0 be give by, wout(r(t),p). 
figur 4 show the time evolut of one such reservoir predict for t > 0 (middl panel), 
along with the true state (top panel) of the KS equat and the deviat (bottom panel) 
of the reservoir predict from the true state (i.e., the differ between the top panel and 
the middl panel) note that in fig. 4 time (the horizont axis) be in unit of the lyapunov 
time (λ−11 , where Λ1 be the larg lyapunov expon of the KS attractor). We see that 
the reservoir give good short term predict for about 5 multipl of the lyapunov time. 
A visual inspect of fig. 4 suggest that the reservoir predict may have also learn 
the correct ‘climate’ of the KS system even after the state of the reservoir dynam system 
have diverg from the true state of the KS system. 

figur 5 show an exampl of an altern scenario for anoth set of the reservoir pa- 
ramet (ρ = 3.1, Dr = 5000 with the rest of the paramet a show in tabl iii). In thi 
case, the reservoir still predict accur for a short period of time. however, the long 
term climat of the signal gener by the reservoir be no longer similar to that of the true 
KS climate. 

A more quantit assess of the climat reproduct can be obtain by calcu- 
late the power spectrum of the reservoir predict and compar it with the power 
spectrum of the train data. figur 6 show the power spectrum of the train data, 
along with the power spectrum of the dynam of the autonom reservoir system in 
figs. 4 and 5. We see that the reservoir system correspond to fig. 4 succeed in repro- 
duce the train data power spectrum, thu indic that the long term system orbit 
reproduc the climat of the train data. On the other hand, the power spectrum of the 
reservoir system correspond to fig. 5 confirm our visual assess that thi reservoir 
system fail to reproduc the climat of the train data. 

similar to what be do in sec. iii, we use our complet knowledg of the dynam of 



9 

20 

0 

40 

60 

20 

0 

40 

60 

1050 15 20 

20 

0 

40 

60 

-2 

0 

2 

fig. 5. top panel: true state, y(x, t), of the standard KS system after t = 0. middl panel: 
reservoir predict with a reservoir of size Dr = 5000 and ρ = 3.1. the rest of the paramet 
be a give in tabl iii. bottom panel: differ between the reservoir predict and the true 
KS state. We see that in thi case, the reservoir give u an accur short term predict (i.e., 
the ‘weather’) but the long term ‘climate’ of the autonom reservoir dynam system do not 
resembl the climat of the true KS system for thi poorli chosen set of parameters. Λ1 denot 
the larg lyapunov exponent. 

frequenc (hz) 

P 
o 

w 
e 

r/ 
F 

re 
q 

u 
e 

n 
c 
y 
( 

d 
B 

) 

-5 

0 

5 

10 

15 

20 

25 

0 0.05 0.1 0.15 0.2 

fig. 6. power spectrum of the KS train data (blue), of the reservoir predict with the same 
paramet a in fig. 4 (red), and of the reservoir predict with paramet a in fig. 5 (green). 
all power spectrum have be comput at a singl spatial gridpoint from a time seri of length 
15000 ∆t time steps. the power spectrum be smooth by divid a time seri into 30 intervals, 
comput the power spectrum of each interv and then averag over all the intervals. 

-0.6 

-0.4 

-0.2 

0 

0.2 

-0.6 

-0.4 

-0.2 

0 

0.2 

0 10 20 30 0 10 20 30 

(a) (b) 

1210864 
-0.1 

0 

0.1 

-0.1 

0 

0.1 

1210864 

fig. 7. (a) estim the lyapunov expon of the homogen (µ = 0) KS equation. first 26 
lyapunov expon of the train reservoir dynam system run in autonom predict 
mode (blue ‘+’ markers) and the standard (i.e., µ = 0) KS system (red ‘×’ markers). the param- 
eter of eq. (7) be L = 60, µ = 0. (b) the same plot a (a), except, the two near-zero expon 
of the KS system (λ7 and λ8) be remov from the spectrum. inset: a close up of the spectrum 
around the zero crossing. all lyapunov expon in thi figur and fig. 8 be comput from a 
trajectori of length 10000 ∆t time steps, which we found to be suffici long for convergence. 



10 

5 10 15 20 25 

-0.6 

-0.4 

-0.2 

0 

fig. 8. estim the lyapunov expon of the inhomogen (µ > 0) KS equation. first 
26 lyapunov expon of the train reservoir dynam system run in autonom predic- 
tion mode (blue ‘+’ markers) and the modifi (i.e., µ > 0) KS system (red ‘×’ markers). the 
paramet of eq. (7) be L = 60, µ = 0.1 and λ = 15. 

the reservoir comput to evalu it lyapunov exponents. By independ evalu the 
lyapunov expon directli from the KS equation, eq. (7), we obtain the true lyapunov 
expon and compar them with the correspond lyapunov expon of the reservoir 
dynam system. 
figur 7(a) show the lyapunov spectrum of the standard (µ = 0) KS system with 

L = 60 (red ‘×’ markers), where, by definit the subscript k be such that Λk ≥ λk+1. 
the lyapunov expon of the reservoir train to emul thi system be show on the 
same ax (blue ‘+’ markers). We observ that the posit lyapunov expon of the 
reservoir system match the correspond expon of the KS system veri well. however, 
the neg expon of the two system do not seem to agre with each other at first 
glance. We argu below that the standard KS system have three zero lyapunov exponents, 
and we posit that the reservoir be unabl to reproduc two of them. indeed, fig. 7(b) show 
that if we remov the two of the comput expon closest to zero (λ7 and λ8) for the 
KS system, the neg lyapunov expon of the reservoir system match those of the 
KS system veri well. 
We show now that when µ = 0 (a for fig. 7), the standard KS equat (7) have three zero 

lyapunov expon associ with three continu symmetries, name time-transl 
invariance, space-transl invari and the so-cal gallilean invariance. time and 
space translat invari impli that if y(x, t) be a solution, then so be y(x, t + t0) and 
y(x + x0, t). By gallilean invariance, we mean that for everi solut y(x, t) of the KS 
equat and an arbitrari constant v, y(x− vt, t)+ v be also a solution. thi can be verifi 
by direct substitut in eq. (7) with µ = 0. replac t0, x0, and v by differenti 

(t0 → δt0, x0 → δx0, v → δv), we have that, δy(x, t) = 
∂y(x,t) 

∂t 
δt0, δy(x, t) = 

∂y(x,t) 
∂x 

δx0 

and δy(x, t) = 
[ 

1− t∂y(x,t) 
∂x 

] 

δv all repres perturbations, y(x, t) + δy(x, t), of eq. (7) 

that are, to linear order in the differentials, solut of eq. (7). that is, all three of these 
δy(x, t) be solut of the variat equation, δyt + δyyx + yδyx + δyxx + δyxxxx = 0. 
furthermore, sinc the origin solut y(x, t) do not decay exponenti to zero, nor 
increas exponenti to infinity, we conclud that these three express for δy repres 
lyapunov vector with zero lyapunov exponents. 
To see whi the reservoir do not reproduc the gallilean symmetry-associ zero 

lyapunov expon in the µ = 0 case, notic that there be a correspond conserv 
quantiti c = 

∫ 

y(x, t)dx. A particular KS system trajectori in phase space be thu restrict 
to a hypersurfac with a constant valu of c (say, c = c0). sinc the reservoir be train with 
data from a singl trajectory, it do not learn the dynam of perturb that take the 
trajectori off the c0 hypersurface. We be not certain whi the reservoir do not reproduc 
both of the other two zero exponents. 
As a further exampl that do not have addit symmetri beyond time-translation, 

we consid (fig. 8) a KS equat with a nonzero valu of µ (L = 60, λ = 15, µ = 0.1). 



11 

-2 

0 

2 

-2 

0 

2 

0 100 200 

-2 

0 

2 

(a) 

(b) 

(c) 

fig. 9. (a) singl scalar compon u(t) of the time seri u(t) gener from the KS system 
(eq. (7)) with L = 60, λ = 15 and µ = 0.1. the time seri in (a) with add noise, u(t) + n(t), 
of nois strength f = 0.05 and f = 0.2 be show in (b) and (c) respectively. 

As before, we train the reservoir use the time seri data from the symmetri broken KS 
equation. after training, we run the reservoir in autonom predict mode (fig. 1(b)) 
and calcul it lyapunov spectrum. figur 8 show that the reservoir reproduc the 
lyapunov spectrum of the true KS system accur in thi case. notably, in contrast 
with the case µ = 0, thi good agreement be obtain without the need of discard two 
zero lyapunov exponents. We continu to use thi modifi KS system in the experi 
describ below. for the case show in figs. 7(b) and 8, the inform dimens of the 
attractor, a comput from the kaplan-york conjectur [30], be about dki ≈ 15 (roughly, 

the valu of k at which 
∑k 

j=1 Λj first becom negative). We see from fig. 7(b) and fig. 8 
that the reservoir continu to give reason estim of Λk even for k > dki . thi be 
somewhat surpris to us, especi in view of the inaccur reservoir estim of Λ3 in 
sec. iii. 

We now consid the effect of addit measur nois on our lyapunov expon 
calcul scheme. We simul measur nois by add a random vector n(t) to the 
train data set u(t) for all valu of t. that is, at everi time step ∆t, we replac u in eq. 
(1) by u + n, and we replac vd = u use in eq. (3) by vd = u + n. the scalar element 
nj(t) of the vector n(t), for each valu of j and t, be independent, ident distribut 
uniform random variabl in the interv [−α, α]. the constant α be chosen so that the 
rm valu of the nois be f time the rm valu of the noise-fre signal u(t). figur 9(a) 
show the noise-fre time seri at a singl grid point, while figs. 9(b) and 9(c) show the 
same time seri with add nois of strength f = 0.05 and f = 0.2, respectively. We 
calcul the lyapunov expon of the reservoir a describ above. figur 10 show the 
lyapunov spectrum when the nois level f be vari from 0.05 to 0.20 along with the true 
lyapunov spectrum of the KS equation. We see that the reservoir result for the posit 
lyapunov expon be quit robust to nois for f ≤ 0.2, but that the neg expon 
be increasingli depress to more neg valu a f increases. 

We find that the amount of data use to train the reservoir comput can significantli 
affect the accuraci of the lyapunov spectrum. the neg lyapunov expon be more 
sensit than the posit expon to error due to insuffici train data. figur 11 
demonstr thi result through a plot of the lyapunov spectrum of the reservoir train 
on vari length of data from eq. (7) with paramet L = 60, λ = 15 and µ = 0.1. In 
thi exampl we find that we need a train time seri of great than 20000 time step in 



12 

0 5 10 15 20 

-0.5 

-0.4 

-0.3 

-0.2 

-0.1 

0 

0.1 
true KS equat 

fig. 10. lyapunov expon of the reservoir train on noisi data from the KS system (L = 60, 
λ = 15, µ = 0.1 ). the strength of the nois add to the train data be indic in the legend. 

0 5 10 15 20 

-0.6 

-0.5 

-0.4 

-0.3 

-0.2 

-0.1 

0 

0.1 
10000 

20000 

40000 

80000 
true KS 

fig. 11. the lyapunov spectrum of the reservoir train use vari length of train data 
from eq. (7) with paramet L = 60, λ = 15 and µ = 0.1. the legend indic the length of the 
train time seri in number of ∆t step (i.e., t/∆t). for a comparison with a natur time scale 
of the KS system, we note that 10000 ∆t time step equal approxim 200 lyapunov times. 

order to obtain a reason accur estim of the neg lyapunov expon (20000 
time step equal about 400 multipl of the lyapunov time (λ−11 ) which can be consid 
to be a natur time scale of the KS system). 

V. discuss and conclus 

We conclud that a suitabl train reservoir comput system be capabl of approxi- 
mate the ergod properti of the true system that it be train on. remarkably, a 
show in sec. iv, it be possibl to use the train reservoir to calcul a larg number of 
posit and neg lyapunov expon of a high dimension spatio-tempor chaotic 
system with good accuracy. In the case of the lorenz equations, our method be success 
in calcul the posit and zero lyapunov expon with good accuracy. the neg 
lyapunov expon of the true lorenz system have a high magnitude, and our method be 
not a success in accur calcul the numer valu of thi exponent, although it 
do success captur that it magnitud be substanti larg than that of the posit 
exponent. from a more gener point of view, our paper suggest that the develop of 
machin learn techniqu for model-fre analysi of measur data from chaotic system 
may be a fruit subject for further research. 



13 

vi. acknowledg 

thi work be support by grant w911nf1210101 from the armi research office. We 
wish to acknowledg use convers with daniel gauthier, alexand hartemink and 
roger brockett. 

1g. hinton, L. deng, D. yu, G. E. dahl, a.-r. mohamed, N. jaitly, A. senior, V. vanhoucke, P. nguyen, 
T. N. sainath, et al., ieee signal process magazin 29, 82 (2012). 

2i. goodfellow, Y. bengio, and A. courville, deep learn (mit press, 2016). 
3d. silver, A. huang, C. J. maddison, A. guez, L. sifre, G. van den driessche, J. schrittwieser, 
I. antonoglou, V. panneershelvam, M. lanctot, et al., natur 529, 484 (2016). 

4m. lukosevivciu and H. jaeger, comput scienc review 3, 127 (2009). 
5h. kantz and T. schreiber, nonlinear time seri analysis, vol. 7 (cambridg univers press, 2004). 
6e. ott, T. sauer, and J. A. yorke, wiley seri in nonlinear science, new york: john wiley (1994). 
7h. abarbanel, analysi of observ chaotic data (springer scienc & busi media, 2012). 
8f. takens, by DA rand and l.-s. young springer, berlin 898, 366 (1981). 
9t. sauer, J. A. yorke, and M. casdagli, journal of statist physic 65, 579 (1991). 

10d. S. broomhead and G. P. king, physica D: nonlinear phenomena 20, 217 (1986). 
11a. brandstat and H. L. swinney, physic review A 35, 2207 (1987). 
12j.-p. eckmann, S. O. kamphorst, D. ruelle, and S. ciliberto, physic review A 34, 4971 (1986). 
13v. petrov, V. gaspar, J. masere, and K. showalter, natur 361, 240 (1993). 
14e. N. lorenz, journal of the atmospher scienc 20, 130 (1963). 
15b. I. cohen, J. krommes, W. tang, and M. rosenbluth, nuclear fusion 16, 971 (1976). 
16y. kuramoto and T. tsuzuki, progress of theoret physic 55, 356 (1976). 
17g. sivashinsky, physica D: nonlinear phenomena 4, 227 (1982). 
18m. C. cross and P. C. hohenberg, review of modern physic 65, 851 (1993). 
19r. livi, A. politi, and S. ruffo, journal of physic A: mathemat and gener 19, 2033 (1986). 
20d. A. egolf and H. S. greenside, natur 369, 129 (1994). 
21a. pikovski and A. politi, nonlinear 11, 1049 (1998). 
22h. kantz, G. radons, and H. yang, journal of physic A: mathemat and theoret 46, 254009 
(2013). 

23t. D. sauer, J. A. tempkin, and J. A. yorke, physic review letter 81, 4341 (1998). 
24h. jaeger and H. haas, scienc 304, 78 (2004). 
25z. lu, J. pathak, B. hunt, M. girvan, R. brockett, and E. ott, chaos: An interdisciplinari journal of 
nonlinear scienc 27, 041102 (2017). 

26h. jaeger, bonn, germany: german nation research center for inform technolog gmd tech- 
nical report 148, 13 (2001). 

27w. maass, T. natschlager, and H. markram, neural comput 14, 2531 (2002). 
28n. tikhonov, andrĕı, V. I. arsenin, and F. john, solut of ill-pos problems, vol. 14 (winston 
washington, dc, 1977). 

29x. yan and X. su, linear regress analysis: theori and comput (world scientific, 2009). 
30j. L. kaplan and J. A. yorke, in function differenti equat and approxim of fix point 
(springer, 1979) pp. 204–227. 


use machin learn to replic chaotic attractor and calcul lyapunov expon from data. 
abstract 
I introduct 
II reservoir computers, short term predict and attractor climat 
iii exampl 1: the lorenz system and the question of whether the climat be replic 
IV exampl 2: the task of determin a larg number of lyapunov expon of a high dimension spatiotempor chaotic system from data 
V discuss and conclus 
VI acknowledg 



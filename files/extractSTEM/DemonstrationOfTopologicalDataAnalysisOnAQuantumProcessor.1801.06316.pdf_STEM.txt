


















































demonstr of topolog data analysi on a quantum processor 

he-liang huang,1, 2, 3, 4 xi-lin wang,1, 2, 3 peter P. rohde,5 yi-han luo,1, 2, 3 you-wei 
zhao,1, 2, 3 chang liu,1, 2, 3 Li li,1, 2, 3 nai-l liu,1, 2, 3 chao-yang lu,1, 2, 3 and jian-wei pan1, 2, 3 

1hefei nation laboratori for physic scienc at microscal and depart of modern physics, 
univers of scienc and technolog of china, hefei, anhui 230026, china 

2ca centr for excel and synerget innov centr in quantum inform and quantum physics, 
univers of scienc and technolog of china, hefei, anhui 230026, china 

3cas-alibaba quantum comput laboratory, shanghai 201315, china 
4henan key laboratori of quantum inform and cryptography, zhengzhou, henan 450000, china 
5centr for quantum softwar & inform (qsi), faculti of engin & inform technology, 

univers of technolog sydney, nsw 2007, australia 
(dated: januari 22, 2018) 

topolog data analysi offer a robust way to extract use inform from noisy, unstructur data by 
identifi it underli structure. recently, an effici quantum algorithm be propos [lloyd, garnerone, 
zanardi, nat. commun. 7, 10138 (2016)] for calcul betti number of data point – topolog featur 
that count the number of topolog hole of variou dimens in a scatterplot. here, we implement a proof- 
of-principl demonstr of thi quantum algorithm by employ a six-photon quantum processor to success- 
fulli analyz the topolog featur of betti number of a network includ three data points, provid new 
insight into data analysi in the era of quantum computing. 

In exploratori data analysi and data mining, our data often 
encod extrem valuabl information, but be typic large, 
unstructured, noisy, and incomplete, such that extract use- 
ful inform from the data be an import yet challeng 
task. topolog data analysi (tda) [1] provid a gener 
framework for studi such data in a manner that be insensi- 
tive to the particular metric and robust against noise. In partic- 
ular, persist homolog [2, 3] have be well establish a 
a techniqu for extract use inform by identifi 
topolog featur of data. one essenti featur be the num- 
ber of k-dimension hole and void in datasets, that is, the 
k-th betti number βk (a topolog invariant). for instance, 
the first three betti numbers, β0, β1 and β2, repres respec- 
tive the number of connect components, one-dimension 
holes, and two-dimension voids. the betti number abstract 
away the actual data, reduc it to a pure topolog repre- 
sentation, which be valuabl for understand the underli 
structur of datasets. the field of use topolog data anal- 
ysi to analyz betti number of data have be grow rapidli 
in recent years, yield applic in imag recognit [4], 
signal process [5], network scienc [6, 7], sensor analysi 
[8–11], brain connectom [12, 13], and fmri data analysi 
[14, 15], just to name a few. 

practic however, when face the issu of compu- 
tation complexity, classic topolog method pose a 
formid task: a set of n data point poss 2n potenti 
subset that could contribut to the topology, quickli over- 
whelm even the most power classic computers, even 
for not-so-larg datasets. So far the best classic algorithm 
for estim betti number to all order with accuraci δ 
take time o(2nlog(1/δ)) [16–21]. moreover, exact calcula- 
tion of betti number be know to be pspace-hard for some 
class of topolog [22]. 

recently, lloyd et al. [23, 24] extend method from 
quantum machin learn to tda for effici estim 
betti number to all orders. indeed, if the proport of k- 
simplic gener from a dataset be larg enough, the quan- 

tum algorithm for calcul betti number to all order with 
accuraci δ have runtim o(n5/δ) – exponenti faster than 
the best know classic algorithms. furthermore, the algo- 
rithm do not requir a large-scal quantum random access 
memori (qram) [25] – just o(n2) bit be suffici for the 
algorithm to store the inform of all pairwis distanc be- 
tween the n data points. the potenti comput speedup 
and it practic will like make quantum tda a promis- 
ing applic for futur quantum computers, in addit to 
shor’ algorithm [26–29], quantum simul [30–33], solv- 
ing linear system [34, 35], and classif of linear vector 
[36–38]. 

here we report a proof-of-principl demonstr of the 
quantum tda algorithm on a small-scal photon quantum 
processor for the first time. the topolog featur of betti 
number of three data point be reveal and monitor at 
two differ topolog scale in our experiment. our exper- 
iment success demonstr the viabil of the algorithm 
and suggest that data analyt may be an import futur 
applic for quantum computing, with widespread applica- 
tion in our increasingli data-centr world. 

To calcul betti numbers, we first repres data topolog- 
ical in term of relationship between data points. use 
a cutoff distanc �, we group data point into simplic (see 
fig. 1(a))– fully-connect subset of data points. the set of 
simplic form a simplici complex, the topolog struc- 
ture from which featur such a betti number can be ex- 
tracted. thi topolog construct be show in fig. 1(b-d). 

By determin the complet set of betti number over 
the full rang of �, we can then construct the barcod (see 
fig. 1(e)) [39], a parameter version of betti number in 
a distance-depend manner. each bar in the region of Hk 
repres a k-dimension hole, and the length of the bar in- 
dicat it persist in the paramet �. with the barcode, we 
can qualit filter out the short bar a topolog nois 
and captur the long bar a signific features, sinc the 
length of bar be indic of their persist against chang 

ar 
X 

iv 
:1 

80 
1. 

06 
31 

6v 
1 

[ 
qu 

an 
t- 

ph 
] 

1 
9 

Ja 
n 

20 
18 



2 

(a) 

(b) ( c) (d) 

0-simplex 
(vertex) 

1-simplex 
(edge) 

3-simplex 
(tetrahedron) 

2-simplex 
(triangle) 

(e) 

H0 

H1 

 

0 0.5 1.5 2.51 2 3 

fig. 1. (a) k-simplic (shown for k = 0, 1, 2, 3) be fully-connect 
set of k + 1 data points. (b) scatterplot of data points. (c) use 
some arbitrari metric for quantifi distanc � between data points, 
data point within � of one anoth receiv an edg between them. 
(d) the simplici complex be form a the set of simplices. the 
color region indic the differ simplic within the complex. 
(e) construct of the barcode. the horizont axi repres the 
distanc �. the bar be construct such that the number of bar that 
intersect the vertic line through ani � in the area of Hk equal the 
betti number βk. 

in distanc �. In fig. 1(e), a bar in the region of H1 persist 
for a long range, lead u to determin that the underli 
topolog featur of the unstructur data (fig. 1(b)) be a cir- 
cle. 

In general, the quantum tda algorithm have two main step 
(see fig. 2(a)). first, one access the data to construct the 
uniform mixtur of the k-simplic that encod the desir 
topolog structure. the time of thi step be in the bad 
case exponenti and in fact depend on the proport of k- 
simplices. In case where thi fraction be larg enough, thi 
step can be implement effici either classically, or us- 
ing grover’ algorithm, yield a further quadrat algorith- 
mic enhancement. In the quantum algorithm, thi step could 
be realiz via two small steps, namely: (1a) simplici com- 
plex state preparation; (1b) uniform mix state construction. 
second, one implement step (2) to reveal the topolog 
invari of the structure. thi step be realiz use the 
phase-estim algorithm [40], which provid an exponen- 
tial speedup over know classic procedur on a quantum 
computer, in fact [23, 24] show that thi can execut in 
time o(n5/δ), with accuraci δ. the step of the quantum 
algorithm be now describ in more detail. 

implement step (1a) construct the simplici complex. 

phase 
estim 
algorithm 

mixtur 
state 

construct 
simplici 

complex state 
prepar 

ancilla 

regist 

(a) 

ancilla |0 
A 

regist |0 
B 

mixtur state 
construct phase estim measur 

(e) 

( c) (d)(b) 3 

4 5 

|0 


|0 

|0 

simplici complex 
state prapar 

21 1 2 

3 

1 2 

33 

X 

X 

H 

step 1 step 2 

fig. 2. quantum circuit for quantum tda. (a) outlin of 
the origin quantum circuit. (b) A scatterplot includ three 
data points. (c) graph represent of the 1-simplic state 
|ϕ〉�11 = |110〉 for 3 < �1 < 4. the first and second data point be 
connect by an edge. (d) graph represent of 1-simplic state 
|ϕ〉�21 = (|110〉+ |101〉)/ 

√ 
2 for 4 < �2 < 5. the first data point be 

connect to the second and third point by two edges. (e) optim 
circuit with 5 qubits. the block with differ color repres the 
four basic stages. 

for a scatterplot includ n data points, a k-simplex sk con- 
sist of k+1 point vj0 , vj1 , . . . , vjk , togeth with k(k+1)/2 
edges, creat a fulli connect subset of the data. We can 
encod a k-simplex a an n-qubit quantum state |sk〉 with 
k + 1 1 at posit j0, j1, ..., jk and 0 at the other remain- 
ing positions. 

the vietoris-rip simplici complex s�k be the set of k- 
simplic where all point be within distanc � of each other. 
In the quantum implementation, we can construct the simpli- 
cial complex state |ψ〉�k a the uniform superposit of k- 
simplic in the complex 

|ψ〉�k = 
1√ 
|s�k| 

∑ 
sk∈s�k 

|sk〉. (1) 

classic verifi whether all point in each of the sk be 
within distanc � of each other could help u construct the 
simplici complex state. besides, we can also implement a 
multi-target grover’ algorithm [41] with a membership or- 
acl function {f �k(sk) = 1 if sk ∈ s�k} to verifi whether 
sk ∈ s�k, yield a quadrat speedup. let h�k be the hilbert 
space span by |sk〉 where sk ∈ s�k. the construct of 



3 

|ψ〉�k also reveal the number of k-simplices, |s�k| = dimh�k, 
and take time o(n2(ζ�k) 

−1/2), where ζ�k = |s�k|/ 
( 
n 
k+1 

) 
be the 

proport of k-simplic that be actual in thi complex at 
scale �, and (ζ�k) 

−1/2 = (|s�k|/ 
( 
n 
k+1 

) 
)−1/2 be the number of 

iter of the multi-target grover’ algorithm. when the 
proport be too small, the quantum search procedur will 
fail to find the simplic [23, 24]. 

In step (1b), we construct the mix state, 

ρ�k = 
1 

|s�k| 
∑ 
sk∈s�k 

|sk〉〈sk|, (2) 

the uniform mixtur over the set of simplic in the complex. 
thi procedur can be easili realiz by add an n-qubit 
ancillari register, perform controlled-not (cnot) oper- 
ation to copi |ψ〉�k to construct 1√|s�k| 

∑ 
sk∈s�k 

|sk〉 ⊗ |sk〉, and 

final trace out the ancillari regist to obtain ρ�k. 
step (2) acta on the simplici complex to reveal topolog 

featur – the core of exponenti speedup in the algorithm. 
defin the boundari map ∂�k that oper from H 

� 
k to H 

� 
k−1 

by, 

∂�k|sk〉 = 
∑ 
l 

(−1)l|sk−1(l)〉, (3) 

where |sk−1(l)〉 be obtain from sk with vertex j0...jl...jk 
by omit the l-th point jl from sk. the k-th betti number 
be defin a [17–20], 

β�k = dim(ker ∂ 
� 
k/im ∂ 

� 
k+1). (4) 

classic algorithm for calcul betti number to all or- 
der with accuraci δ requir time o(2nlog(1/δ)) [16–21]. In 
quantum tda, an exponenti speedup be achiev by em- 
ploy the phase-estim algorithm. for thi purpose, the 
boundari map be emb into a hermitian matrix, 

b�k = 

( 
0 ∂�k 
∂�k 
† 0 

) 
. (5) 

now appli phase-estim to decompos ρ�k in term 
of the eigenvector and eigenvalu of b�k, one obtain the 
probabl η�k of project onto the kernel by measur the 
eigenvalu register. then the dimens of the kernel of ∂�k 
can be calcul a dim(ker ∂�k) = η 

� 
k · |s�k|. when both 

dim(ker ∂�k) and dim(ker ∂ 
� 
k+1) be determined, we can re- 

construct the k-th betti number by, 

β�k =dim(ker ∂ 
� 
k)− dim(im ∂�k+1) 

=dim(ker ∂�k) + dim(ker ∂ 
� 
k+1)− |s�k+1|. (6) 

We note that for some special case for ∂�k, it be trivial to 
calcul dim(ker ∂�k). for example, if a k-simplex do not 
exist, dim(ker ∂�k) = |s�k| = 0, while dim(ker ∂0) be alway 
equal to the number of points. 

care evalu indic that step (2) can estim betti 
number to all order with accuraci δ in time o(n5/δ) 
[23, 24]. hence, while in the bad case that their proport 

be too small, step (1) will fail to find the k-simplices, sinc 
both the classic and quantum algorithm will take exponen- 
tial time. there be specif cases, in particular where step 
(1) can be implement efficiently, where the overal quan- 
tum algorithm can provid exponenti savings. In fact we 
have test a particular case use data-point with random 
distanc between them and show that inde step (1) can 
be implement effici (see supplement 1 for details), ei- 
ther by a classic algorithm or further improv the time by 
a squar root factor through grover’ algorithm. 

To experiment demonstr the quantum tda algo- 
rithm, we choos the simplest meaning instance: estimat- 
ing the betti number for three data point at two differ 
scales. assum the distanc between the three point be 3, 
4 and 5 (see fig. 2(b)). for scale in the rang 3 < �1 < 4 
and 4 < �2 < 5, the correspond state for 1-simplic (the 
k-simplex for k > 1 doesn’t exist sinc not all three data 
point can be connect at �1 and �2) be |ϕ〉�11 = |110〉 
(fig. 2(c)) and |ϕ〉�21 = (|110〉+ |101〉)/ 

√ 
2 (fig. 2(d)) re- 

spectively, which mean |s�11 | = 1 and |S 
�2 
1 | = 2. A simpl 

quantum circuit be design to prepar |ϕ〉�11 (|ϕ〉 
�2 
1 ) directli 

by remov (adding) a hadamard gate mark by dash 
line at step (1) in fig. 2(e). 

To construct the correspond uniform mix states, we 
don’t actual need to gener a complet copi of |ϕ〉�11 
(|ϕ〉�21 ). instead, we need onli perform a cnot oper be- 
tween the auxiliari qubit |0〉a and the second qubit of |ϕ〉�11 
(|ϕ〉�21 ) to partial copi the state of simplices. after trace 
out the ancillari qubit, the uniform mix state ρ�1 and ρ�2 
be obtained. 

next, appli quantum phase-estim to reveal informa- 
tion relat to betti numbers. sinc there be onli three data 
points, k-dimension hole for k > 1 can not exist. there- 
fore, onli the 0-th and 1-st betti number need to be calcu- 
lated. We note that the algorithm care not about the exact 
eigenvalu spectrum, but the probabl of detect |0〉 in the 
eigenvalu register. We can exploit thi properti to reduc the 
number of qubit requir in the eigenvalu register. A par- 
ticular treatment for boundari matrix be util to greatli 
simplifi the complex circuit (see supplement 1 for details) 
– a singl cnot oper between the eigenvalu regist 
compris onli one qubit |0〉b and the first bit of ρ�1 (ρ�2 ) 
be suffici for realiz phase-estimation. finally, the infor- 
mation relat to betti number will be read out by measur 
the eigenvalu register. note that sinc the quantum tda al- 
gorithm onli depend on how the point be connected, not 
the precis distanc between points, our circuit work for all 
nontrivi case of three point (where one, or two edg be 
present). the case where zero or three edg be present be 
trivial, sinc we could clearli know the betti number in the 
case that the N point be all disconnect (β0 = N , and 
βk = 0 for k > 0) or all connect (β0 = 1, and βk = 0 for 
k > 0) for N point without calculating. 

fig. 3 show the setup of our experiment. We use singl 
photon a qubits, where the logic qubit |0〉 and |1〉 be en- 
cod into horizont (h) and vertic (V ) polarization, re- 
spectively. with these settings, the step of simplic state 
prepar becom straightforward. |ϕ〉�11 = |V 〉3|v 〉2|h〉1 



4 

1 
2 

3 
4 

5 

6 

c-bbo prism qwp hwp pol 

filtersc-yvo4tc-yvo4lenspb 

fig. 3. experiment setup. ultraviolet laser puls with a central wavelength of 394 nm, puls durat of 150 fs, and repetit rate of 80 mhz 
pa through three hwp-sandwich β-barium borat (bbo) crystal [42] to produc three entangl photon pair (|h〉|v 〉+ |V 〉|h〉) / 

√ 
2 

(see supplement 1 for details) in spatial mode 1-2, 3-4 and 5-6. photon 2(3) and 4(5) be tempor and spatial superpos on a pbs. all 
photon be spectral filter with 3-nm bandwidth filters. c-bbo: sandwich-lik bbo+hwp+bbo combination; qwp: quarter-wav plate; 
pol: polarizer; sc-yvo4: yvo4 crystal for spatial compensation; tc-yvo4: yvo4 crystal for tempor compensation. 

and |ϕ〉�21 = (|v 〉3|v 〉2|h〉1 + |V 〉3|h〉2|v 〉1)/ 
√ 
2 can be 

prepar directli by add or remov the polar in path 
2 respectively, where the index i in |h(orv )〉i denot the 
spatial mode. photon 4 (ancilla) and 5 (eigenvalu register) 
be both disentangl by polar into |h〉, and then pho- 
ton 3 and 6 (trigger) immedi collaps into |V 〉. note 
that the cnot gate can be simul use combin of 
a polar beam splitter (pbs) and a half-wav plate (hwp) 
[27], sinc the target qubit be fix at |h〉. thi setup, in 
principle, suffic to demonstr the underli conceptu 
principl of quantum tda. 

befor run the algorithm, we first character 
the perform of the optic quantum circuit. In 
the case of 4 < �2 < 5, a three-photon entangl state 
|φ〉 = (|h〉1|v 〉2|v 〉4 + |V 〉1|h〉2|h〉4)/ 

√ 
2 be gener af- 

ter implement the cnot gate in step (1a). We mea- 
sure the fidel of the experiment prepar state (see 
supplement 1 for details) a F = 0.954(6), which exce 
the threshold of 0.5 for the entangl wit to confirm 
genuin multi-partit entangl [43]. To the best of our 
knowledge, such a high fidel for three photon entangl 
have never be achiev befor [44]. 

after trace out the ancilla in the pauli-z basis, the uni- 
form mix states, 

ρ�1 = |V 〉3|v 〉2|h〉1〈v |3〈v |2〈h|1, 
ρ�2 = (|v 〉3|v 〉2|h〉1〈v |3〈v |2〈h|1 

+ |V 〉3|h〉2|v 〉1〈v |3〈h|2〈v |1)/2, (7) 

be creat at the scale of 3 < �1 < 4 and 4 < �2 < 5, re- 
spectively. We character these state use quantum state 
tomographi to reconstruct the densiti matrices. (see supple- 
ment 1 for details). the fidel Fp = (tr 

√ 
ρ1/2ρexpρ1/2) 

2 

and trace distanc d(ρ, ρexp) = tr|ρ− ρexp|/2 between 

the reconstruct (ρexp) and ideal (ρ) matrix be 
calcul a F ρ 

�1 

p = 0.9817(9), F 
ρ�2 
p = 0.9819(10) and 

dρ�1 = 0.0183(5), dρ�2 = 0.0181(5) respectively. further- 
more, the fidel Fp and trace distanc D be relat by 
the inequ 1− 

√ 
Fp ≤ D ≤ 

√ 
1− Fp [40]. In our ex- 

periment, both dρ�1 and dρ�2 be locat in the rang of 
0.009 ≤ D ≤ 0.135, and close to the low bound. 

the final result be read out via 6-fold coincid 
events. figures. 4(a,b) show the measur result of 
the eigenvalu regist at the scale of 3 < �1 < 4 and 
4 < �2 < 5, respectively. In the case of 3 < �1 < 4, with a 
probabl of η�11 = 0.045(14) we measur |0〉 in the eigen- 
valu register, from which we calcul the dimens of 
the kernel space a dim(ker ∂�11 ) = η 

�1 
1 · |S 

�1 
1 | = 0.045(14). 

sinc dim(ker ∂�0) = 3 and dim(ker ∂ 
� 
2) = |s�2| = 0 for 

� = �1 (or �2), we final obtain the 0-th betti number 
β�10 = 2.045(14) and 1-st betti number β 

�1 
1 = 0.045(14), fol- 

low eq. 4, which can be round to β�10 = 2 and β 
�1 
1 = 0. 

In the case of 4 < �2 < 5, the probabl of measur |0〉 
in the eigenvalu regist be 0.038(9). use the same ap- 
proach, we calcul the 0-th and 1-st betti number a 
β�20 = 1.076(18) and β 

�2 
1 = 0.038(9), respectively, which can 

be round to β�20 = 1 and β 
�2 
1 = 0. that be to say, we have 

reveal and track the topolog featur of the dataset 
in fig. 2(b) at two differ scales: the number of connect 
compon at scale of �1 and �2 be 2 and 1, respectively, 
and no k-dimension hole for k > 1 exist. from these re- 
sults, the barcod be construct a show in fig. 4(c). 

To further quantifi the experiment performance, we use 

the similar measur γ = 
(∑1 

k=0 

√ 
ektk 

)2 
[45] to char- 

acter the overlap between experiment and theoret 
values, where ek and tk be the experiment and theoret- 
ical output probabl of the state |k〉, respectively. the 



5 

H0 

0 3 4 5 

|1 |0 
0.0 

0.5 

1.0 
D 

e 
te 

c 
tio 

n 
P 

ro 
b 
a 
b 
ili 

ty 

|1 |0 
0.0 

0.5 

1.0 

D 
e 
te 

c 
tio 

n 
P 

ro 
b 
a 
b 
ili 

ty 

(a) (b) 

( c) 

 

theori theori 
experi 

theori theori 
experi 

fig. 4. final experiment results. the output be determin by 
measur the eigenvalu regist in the pauli-z basis. measur 
expect valu (blue bars) and theoret predict valu 
(gray bars) be show for two differ 1-simplic state inputs: (a) 
|ϕ〉�11 = |110〉, (b) |ϕ〉 

�2 
1 = (|110〉+ |101〉)/ 

√ 
2. error bar repre- 

sent one standard deviation, deduc from propag poissonian 
count statist of the raw detect events. (c) the barcod for 
0 < � < 5. sinc no k-dimension hole for k ≥ 1 exist at these 
scales, onli the 0-th betti barcod be give here. for 0 < � < 3, 
there be no connect between each point, so the 0-th betti num- 
ber be equal to the number of points. that is, there be three bar at 
0 < � < 3. At scale of 3 < �1 < 4 and 4 < �2 < 5 , the 0-th betti 
number be 2 and 1. 

data in fig. 4 show the result a γ�1 = 0.955(3) and 
γ�2 = 0.962(2), indic near perfect experiment accu- 
racy, confirm that the algorithm be successful. 

We note that for the quantum tda algorithm, the result be 
read out by measur the eigenvalues. In general, the eigen- 
valu regist requir onli a few qubit for the quantum tda 
algorithm (1 qubit in the current work), sinc we onli care 
about the proport of |0〉 in the eigenvalu register, rather 
than the exact valu of all eigenvalues. thus, a small amount 
of measur be suffici for obtain reliabl results, 
an import featur for the scalabl of the algorithm. 

In addition, theoretically, for the quantum tda algorithm, 
onli the qubit in the eigenvalu regist need to be measured, 
rather than have to measur all qubits. In our experiment, 
sinc the photon gener by spontan parametr down 
convers be probabilistic, to ensur that all qubit in the cir- 
cuit have be generated, and the quantum circuit have be 
fulli implemented, we need to measur 6-fold coincid 
events. In fact, thi be a common problem encount in the 
current linear optic quantum computing. fortunately, with 
the develop of determinist quantum dot singl photon 
sourc [46], and other techniqu [47], we believ thi prob- 

lem can eventu be overcome. We anticip that with more 
qubit (more photon [42, 48] or high dimension state 
[49, 50]), our propos could be extend to the analysi of 
much larg dataset in the future. 

In summary, we have present the first proof-of-principl 
demonstr of quantum tda on a small-scal photon 
quantum processor. the topolog featur of a dataset com- 
prise three data point be reveal and track at two differ- 
ent topolog scales, fulli reproduc the betti number as- 
sociat with the topolog of the data. futur advanc in the 
field could open up new frontier in data analysi for quantum 
computing, includ signal and imag analysis, astronomy, 
network and social medium analysis, behavior dynamics, bio- 
physics, oncolog and neuroscience. 

acknowledgements: We thank r.-z. liu, michel 
cirafici, T. L. for enlighten discussions. thi work be 
support by the nation natur scienc foundat of 
china, the chines academi of sciences, and the nation 
fundament research program. p.p.r. be fund by an arc 
futur fellowship (project ft160100397). 

see supplement 1 for support content. 

supplement materi 

I. background and practic applic OF 
betti number and tda 

  

  

(a) (b) 

( c) 

 =1, =1, =00 1 2  =1, =0, =1, =00 1 2 3 

 =1, =10 1  =1, =20 1 

fig. 5. sever exampl for the explan of betti numbers, 
demonstr their abil to captur structur inform even in 
the presenc of local deformations. 

betti number be a way to describ the connect within 
a topolog space. In simplest terms, the k-th betti number 
βk count the the number of k-dimension hole in a topo- 
logic space, for example, 

- β0 be the number of connect components; 
- β1 be the number of planar hole (1-dimension holes); 
- β2 be the number of two-dimension void (2-dimension 

holes); 
- ... 
betti number be topolog invariants. If two betti num- 

ber be the same for two differ space then the space be 
homotopi equival [1]. To demonstr betti number more 



6 

vividly, some exampl be show in fig. 5. We can see that 
a circl have a connect component, a 1-dimension holes, 
thu β0 = 1, β1 = 1. the betti number of circl be the 
same a a triangle, so they be be homotopi equival (see 
fig. 5(a)); similarly, the two-dimension hollow sphere be 
homotopi equival to a hollow tetrahedron (see fig. 5(b)). 
thus, betti number can record signific topolog fea- 
ture of a shape, which could be directli use in pattern recog- 
nition [51], anomali detect [52], comput linguist 
[53]. for instance, consid a simpl shape recognit 
task, name the recognit of print letters, by use the 
betti numbers, we could identifi and distinguish the letter 
“a” and “b” in fig. 5(c), even in the presenc of some defor- 
mation. 

now, we briefli introduc some mathemat background 
for betti numbers. for more details, one can refer to [54]. 

We first describ how to use a simplici complex to for- 
malli describ a topolog structure. 

simplex: A k-simplex σk = [vj0 , · · · , vjk ] be a fulli con- 
nect set of k + 1 affin geometr point vj0 , · · · , vjk , to- 
gether with k(k+1)/2 edg (see fig 1(a) for some example). 
where k be the dimens of the simplex. 

simplici complex: roughli speaking, a simplici com- 
plex K be a finit set simplic (see fig. 1(d) for an example) 
such that: 
i) ani face of a simplex of K be a simplex of K, 
ii) the intersect of ani two simplic of K be either 

empti or a common face of both. 
next, we will introduc the chain group, boundari operator, 

cycl group and boundari group, and then how to calcul the 
betti numbers. 
k-chain group: A k-chain be a formal sum of k-simplic 

with integ coefficients, which can be write a c = 
p∑ 
i=1 

εiσi 

with εi ∈ z2, where {σ1, · · · , σp} be the set of k-simplic of 
K. the set of all k-chain form an abelian group ck(k). 
k-boundari operator: for a k-simplex σk = 

[vj0 , · · · , vjk ], the boundari map ∂k : ck(k) → ck−1(k) 
be give by 

∂k(σ) = 
k∑ 
i=0 

(−1)i[vj0 , · · · , v̂ji , · · · , vjk ] 

where v̂ji indic that vji be removed, and 
[vj0 , · · · , v̂ji , · · · , vjk ] be the k − 1-simplex span by 
all the vertex except vji . 
k-boundari group and k-cycl group: the k-boundari 

group be defin a bk(k) = Im ∂k+1 = {c ∈ ck(k)|∃c′ ∈ 
ck+1(k), ∂k+1(c 

′) = c}, contain element that be 
boundari of k + 1-dimension objects; the k-cycl group 
be defin a zk(k) = ker ∂k = {c ∈ ck(k)|∂kc = 0}, the 
element in the cycl group can be understood a ‘loops’. It 
can be prove that bk(k) ⊆ zk(k) ⊆ ck(k). 

homolog group: let K be an k-dimension simplici 
complex. the kth homolog group hk(k) associ with 
K be defin by hk(k) ≡ zk(k)/bk(k), which repres 
those element of zk(k) (loops) that be not boundaries. 

betti numbers: the k-th betti number βk be defin by 
βk(k) ≡ dim hk(k) = dim(ker ∂k/im ∂k+1). 

use betti numbers, we can detect invis geometr fea- 
ture of high-dimension objects. appli betti number to 
data analysi could help u analyz and exploit the complex 
topolog and geometr structur underli data. next, 
we will introduc how to use persist homology, a sophist 
topolog data analysi method, to extract use informa- 
tion by identifi the topolog featur (betti numbers) of 
data. 

from point to simplici complex: In data analysis, data be 
usual repres a an unord sequenc of point (see 
fig. 1(b)), to analyz the betti number of data, requir a 
method to construct a simplici complex. 

To defin a simplici complex, the most obviou way be to 
use the point a the vertex of a combinatori graph whose 
edg be determin by proximity. use a cutoff distanc �, 
and connect point within distanc � (see fig 1. (b-d) for 
the procedure), we can construct the simplici complex (see 
fig 1. (d)), call a vietoris-rip simplici complex. 

comput betti numbers: have construct the simpli- 
cial complex of data points, we use the method abov to cal- 
culat betti numbers, find the topolog structur of the 
data points. 

barcode: convert data point into a simplici complex 
requir a choic of paramet – cutoff distanc �. however, 
if � be too small, almost all point be separated, and no over- 
all structur be apparent; if � be too large, all the point may 
be connect with each other, the complex be a singl high di- 
mension simplex, and no topolog hole exist. It be chal- 
leng to select an appropri scale for a give dataset. To 
address thi problem, we observ the evolut of topologi- 
cal featur for the full rang of �, rather than focu on a 
particular numer value, yield the barcod (see fig. 1(e)). 
each bar in the region of Hk of the barcod repres a k- 
dimension hole, the length of which indic it persist 
in the paramet �. with the barcode, we can qualit fil- 
ter out the short bar a topolog nois and captur the long 
bar a significant, persist topolog features, sinc the 
length of bar be indic of their persist against chang 
in distanc �. for further details, refer to [55]. 

there be mani interest and use applic of topo- 
logic data analysis. for instance, in the field of imag recog- 
nition, carlsson et al. found that high-contrast 3×3 pixel 
patch from grayscal digit imag concentr near the 
surfac of a klein bottl in a higher-dimension space [4]; 
in the field of signal processing, perea and harer found that 
persist homolog can detect period in time-seri data 
prevent nois [5], which be veri stabl and accur espe- 
cialli in the presenc of damping; in unsupervis machin 
learning, persist homolog also provid a power tool 
for the analysi of music data, explor common featur 
of classic score [56]. 



7 

ii. numer simul OF the proport 
OF k-simplic IN some case 

As mention in the main text, the effici of step (1) de- 
pend on the proport of k-simplices. here, we studi the 
relationship among the proport of k-simplices, the number 
of data point n, the dimens k of the k-simplices, and cutoff 
distanc � by numer simul (see fig. 6). 

In our simulations, without loss of generality, we randomli 
set the distanc between differ point in the rang of [0,1]. 
In fig. 6(a), we take k = 4 a an exampl to simul the rela- 
tionship among the proport of k-simplices, the number of 
data point n and cutoff distanc �. sinc the comput 
complex of step (1) in quantum tda be o(n2(ζ�k) 

−1/2), 
and the comput complex of step (2) be o(n5/δ), 
where δ be the accuracy, we could regard step (1) a effici 
in quantum tda if n2(ζ�k) 

−1/2 ≤ n5/δ, that be ζ�k ≥ n−6. In 
fig. 6(a), the blue area repres ζ�k < n 

−6, and the green 
area repres ζ�k ≥ n−6. We can see that, a n increases, 
the the green area becom larg and the blue area becom 
smaller. thus, with the increas of n, the step (1) be effici 
at a wider rang of cutoff distanc �. 

In fig. 6(b), we take n = 25 a an exampl to simul 
the relationship between the proport of k-simplices, their 
dimens k, and the cutoff distanc �. It be clear that the 
proport of k-simplic becom small gradual at each 
cutoff distanc � a k becom larger. similar to fig. 6(a), 
we let the blue area repres ζ�k < n 

−6, and the green area 
repres ζ�k ≥ n−6, yield fig. 6(c). We can see that even 
when k = 12 and 

( 
n 
k+1 

) 
reach the maximum 

( 
25 
12 

) 
, the green 

area can still encompass over 50% of the region. obviously, 
by analyz all three figur in fig. 6, the regim of step (1) 
that can be regard a effici be much larg than than that 
regard a inefficient. that is, step (1) can be implement 
effici in the case of our numer simulations. 

iii. experiment error analysi 

In thi section, we will analyz error introduc by exper- 
iment nois and provid an error threshold analysis. 

the imperfect in our experi can be attribut to 
two major causes: higher-ord photon emissions, and par- 
tial distinguish of independ photons. In order to 
suppress the influenc of higher-ord photon emissions, we 
place two single-photon detector at each measur port. 
thi dual-channel setup can partial suppress higher-ord 
event where both detector trigger simultan at one 
measur port, indic the presenc of multipl pho- 
tons. To ensur the high level of indistinguish between 
independ photons, all photon be spectral filter by 3- 
nm narrow-band filters. 

the final result of the quantum tda algorithm be decid 
by the probabl of the zero eigenvalu measur in the 
eigenvalu register. assum the ideal probabl of measur- 
ing the zero eigenvalu be ηi, then the dimens of the kernel 
of ∂�k could be calcul a dim(ker∂ 

� 
k) = ηi · |sk|. To 

obtain the correct dimens in the experiment, we need to 

10 

20 

100 

90 

80 

70 

60 

50 

40 

30 

0 10.90.80.70.60.50.40.30.20.1 

0 10.90.80.70.60.50.40.30.20.1 

10 

9 

8 

7 

6 

5 

4 

3 

11 

12 

0 

1 

0.9 

0.8 

0.7 

0.6 

0.5 

0.4 

0.3 

0.2 

0.1 

0 10.90.80.70.60.50.40.30.20.1 

10 

9 

8 

7 

6 

5 

4 

3 

11 

12 

(a) 

( c) 

(b) 

6n 

6n 

625 

625 

n 

k 

k 

� 

� 

� 

fig. 6. the proport of k-simplic in our numer simulations. 
(a) let k = 4, the relationship among the proport of k-simplic 
ζ�k, the number of data point n (y axis) and cutoff distanc � (x axis). 
the blue area repres ζ�k < n 

−6, the green area repres ζ�k ≥ 
n−6. (b) let n = 25, the relationship among the proport of k- 
simplices, the dimens k of the k-simplic and cutoff distanc �. 
(c) let the blue area repres ζ�k < n 

−6 in (b), and the green area 
repres ζ�k ≥ n−6 in (b). It be clear that the green area be far larg 
than the blue area. 



8 

ensur that |dim(ker∂�k)id − dim(ker∂�k)experiment| < 
0.5, that be |ηe − ηi| · |sk| < 0.5 if we use the round 
principle, where ηe be the probabl of the experiment 
measur zero eigenvalue. To quantifi the experiment error 
threshold, we defin the error a Et = |ηe−ηi|, and then sim- 
ulat the error threshold that satisfi the constraint condit 
|ηe−ηi| · |sk| < 0.5. the relationship between the number of 
k-simplic |sk| (x axis) and error threshold (y axis) be show 
in fig. 7. obviously, a |sk| increases, the error threshold de- 
creases. thus, appropri fault-toler mechan should 
be employ when we deal with large-scal dataset. 

note that unlik the the previou quantum algorithm, the 
quantum tda algorithm onli care about the probabl of 
the zero eigenvalue, not all the individu valu in the eigen- 
valu register. thus, the quantum tda algorithm, in princi- 
ple, could be more robust to nois than other algorithms, such 
a shor’ algorithm [26] and the hhl algorithm[34], which 
requir an exact quantum state a output. 

10 20 30 40 50 60 70 80 90 100 

0.00 

0.01 

0.02 

0.03 

0.04 

0.05 

E 
rr 

o 
r 

th 
re 

sh 
o 

ld 

number of k-simplic 

error threshold 

fig. 7. the relationship between the number of k-simplic |sk| (x 
axis) and error threshold Et (y axis). obviously, a |sk| increases, 
the error threshold Et decreases. 

iv. necess OF construct the mix state 

In the quantum tda algorithm, step (1) be use to construct 
the uniform mixtur of the k-simplices, which be realiz by: 
(1a) simplici complex state preparation; (1b) uniform mix 
state construction. In fact, the purpos of step (1) be to sampl 
a uniform k-simplex, which be the essenti reason for con- 
struct mix state. 

next, we will provid the reason whi the quantum tda al- 
gorithm can not directli use the pure state gener in step 
(1a) a the input of step (2). In step (2), we use quantum 
phase-estim algorithm to decompos a mix state in 
term of the eigenvector of the hermitian matrix bk, which 
act on the space h�k−1 ⊕h�k, and find the probabl of the 
zero eigenvalu to comput the dimens of the kernel of ∂�k. 

the mix state be 

ρ�k = 
1 

|s�k| 
∑ 
sk∈s�k 

|sk〉〈sk|. 

where each k-simplic |sk〉 be the basis, and ρ�k be a maxi- 
malli mix state. accord to quantum mechanics, even 
use anoth complet basi set, the maxim mix state 
ρ�k be still of the abov form. thus, ρ 

� 
k could be rewritteb a 

the eigenst set {|nk〉} of ∂�k 

ρ�k = 
1 

|s�k| 

|s�k|∑ 
i=1 

|ni〉〈ni|. 

introduc qubit |0〉t a the eigenvalu register, after the 
phase-estim algorithm, 

|0〉tρ�k 
phase−estimation−−−−−−−−−−−→ 1 

|s�k| 

|s�k|∑ 
i=1 

|λi〉|ni〉〈ni|〈λi|. 

for each eigenst |ni〉, the eigenvalu regist will output 
it correspond eigenvalu |λi〉. thus, the probabl of 
measur the zero eigenvalu in the regist be N �k(0)/|s�k|, 
where N �k(0) be the number of eigenst in {|nk〉} whose 
eigenvalu be zero, that is, the dimens of the kernel of ∂�k. 
however, if we directli use the pure state gener in step 
(1a) a the input to step (2), after we decompos the pure state 
in term of the eigenvector of the hermitian matrix bk, the 
probabl of the zero eigenvalu in the regist will be mean- 
ingless due to interfer effects. for eas of understanding, 
we will give an exampl to show that use the pure state a 
the input of step (2) will output wrong results. 

for the topolog structur in fig. 8, the 1-simplic be 
|110000〉, |011000〉, |001100〉, |100100〉, |100010〉, |000011〉, 
|010001〉, which be denot a |a〉, |b〉, |c〉, |d〉, |e〉, |f〉, |g〉 
respectively. the 0-simplic be |100000〉, |010000〉, 
|001000〉, |000100〉, |000010〉, |000001〉, which be denot 
a |1〉, |2〉, |3〉, |4〉, |5〉, |6〉 respectively. the hermitian 
oper B1 be 

B1 = 

( 
O ∂1 
∂†1 O 

) 
. (8) 

where 

∂1 = 

 

|a〉 |b〉 |c〉 |d〉 |e〉 |f〉 |g〉 
|1〉 1 0 0 −1 1 0 0 
|2〉 −1 1 0 0 0 0 −1 
|3〉 0 −1 1 0 0 0 0 
|4〉 0 0 −1 1 0 0 0 
|5〉 0 0 0 0 −1 1 0 
|6〉 0 0 0 0 0 −1 1 

, (9) 

there be onli two eigenst of the hermitian matrix B1 
whose eigenvalu be zero: 
|n1〉 = 1/2 (|a〉 − |e〉 − |f〉 − |g〉), 

|n2〉 = 1/ 
√ 
60 (3|a〉+ 4|b〉+ 4|c〉+ 4|d〉+ |e〉+ |f〉+ |g〉). 



9 

therefore, after the phase-estim algorithm, the proba- 
biliti of measur the eigenvalu of zero in eigenvalu regis- 
ter should be 2/7. however, if we use the the pure state, 

|ψ〉 = 1/ 
√ 
7 (|a〉+ |b〉+ |c〉+ |d〉+ |e〉+ |f〉+ |g〉) 

phase−estimation−−−−−−−−−−−→ − 1√ 
7 
|n1〉|0〉+ 

18√ 
420 
|n2〉|0〉+ · · · , 

obviously, the probabl of measur the eigenvalu of zero 

be 
( 
− 1√ 

7 

)2 
+ 
( 

18√ 
420 

)2 
= 3235 , which be inconsist with the 

expect 2/7. By thi counterexample, we can see that the 
algorithm can not use pure state gener in step (1a) a the 
input to step (2). 

1 

2 

4 

3 

5 

6 

fig. 8. A topolog structur of six points, the point be connect 
by 7 edges. 

V. circuit detail 

To implement the algorithm with a limit number of 
qubits, our design circuit differ from the origin algo- 
rithm via sever modifications, some of which have alreadi 
be mention in the main text. here we show the detail 
of the modif to phase-estimation, the core of the quan- 
tum tda algorithm. befor introduc the modification, we 
provid two preliminaries: 

(i) let U be an arbitrari unitari operator, the eigenvec- 
tor and eigenvalu set of which be {|u1〉, |u2〉, ..., |un〉} and 
{λ1, λ2, ..., λn}, respectively. If we transform the unitari op- 
erat U into αu2, where α 6= 0 be a constant, then the eigen- 
valu set of αu2 becom {αλ12, αλ22, ..., αλn2}, and the 
eigenvector set will not change. We note that if λi 6= 0, then 
αλi 

2 6= 0, els if λi = 0, then αλi2 = 0. 
(ii) suppos |0〉⊗t|u〉 be the input of the phase-estim 

algorithm, where |0〉⊗t be an eigenvalu regist with t qubits, 
and |u〉 be an eigenvector of unitari oper U with eigen- 
valu e2πiφ (φ ≈ 0.φ1...φt with binari representation). the 
phase-estim algorithm be design to output |φ1...φt〉|u〉, 
where |φ1...φt〉 be an approxim to the phase φ with a pre- 
cision of t bits. 

specifically, the hermitian boundari matrix at scale 
3 < �1 < 4 and 4 < �2 < 5 be 

b�1 = 

 
|100〉 |010〉 |001〉 |110〉 

|100〉 0 0 0 −1 
|010〉 0 0 0 1 
|001〉 0 0 0 0 
|110〉 −1 1 0 0 

 (10) 

b�2 = 

 
|100〉 |010〉 |001〉 |110〉 |101〉 

|100〉 0 0 0 −1 −1 
|010〉 0 0 0 1 0 
|001〉 0 0 0 0 1 
|110〉 −1 1 0 0 0 
|101〉 −1 0 1 0 0 

 (11) 
the eigenvalu and eigenvector set of the boundari ma- 

trice b�1 be {λ�11 , λ 
�1 
2 , λ 

�1 
3 , λ 

�1 
4 } = {− 

√ 
2, 
√ 
2, 0, 0} and 

{|β�11 〉, |β 
�1 
2 〉, |β 

�1 
3 〉, |β 

�1 
4 〉}, respectively, be 

|β�1k 〉 = 

 
1 
2 |100〉 − 

1 
2 |010〉+ 

1√ 
2 
|110〉, k = 1 

− 12 |100〉+ 
1 
2 |010〉+ 

1√ 
2 
|110〉, k = 2 
|001〉, k = 3 

1√ 
2 
|100〉+ 1√ 

2 
|010〉, k = 4 

(12) 

To reduc the number of qubit requir in the eigenvalu 
register, we set B1 = (b�1)2/2, then the eigenvalu spectrum 
becom {λ�11 , λ 

�1 
2 , λ 

�1 
3 , λ 

�1 
4 } = {1,1, 0, 0}, without chang 

the eigenvector set. We note that the algorithm care not about 
the full spectrum but the probabl of |0〉 be detect in 
the register, so thi special treatment be justified. then trans- 
formingb1 into the unitari oper eiπb1 allow u to imple- 
ment phase-estim use an eigenvalu regist with onli 
one qubit |0〉b . for the input |0〉b |ϕ〉�11 , we appli the trans- 
formation, 

|0〉b |ϕ〉�11 = |0〉b |110〉 = 
1√ 
2 
|0〉b(|β�11 〉+ |β 

�1 
2 〉) 

phase estimation−−−−−−−−−−→ = 1√ 
2 
|1〉b(|β�11 〉+ |β 

�1 
2 〉) 

= |1〉b |110〉 = |1〉b |ϕ〉�11 . (13) 

similarly, at the scale of �2, we set B2 = (b�2)2 and trans- 
form B2 into the unitari oper eiπb2 to meet experimen- 
tal requirements. for the input |0〉〈0|b ⊗ ρ�2 , the phase- 
estim procedur output the state |1〉〈1|b ⊗ ρ�2 , where 
ρ�2 = (|110〉〈110|+ |101〉〈101|)/2. thus, in our experiment, 
onli a singl cnot oper between the eigenvalu regist 
compris onli one qubit |0〉b and the first bit of ρ�1 (ρ�2 ) be 
suffici for u to compil the phase-estim algorithm. 

vi. experiment implement OF the 
circuit 

In the experiment, we use singl photon a qubits, where 
the logic qubit |0〉 and |1〉 be encod into horizont (h) 



10 

and vertic (V ) polarization, respectively. the setup of our 
experi be show in fig. 3. photon in path 1, 2, and 3 
be use to construct simplex states. photon 4 (ancilla) and 5 
(eigenvalu register) be both disentangl by polar into 
|h〉, and then photon 3 and 6 (trigger) immedi collaps 
into |V 〉. here we describ detail of how to experiment 
implement the circuit in fig. 2(b). 

| |a H bv 

H 

X 

qubit and gate experiment realiz 

1/ 2(|01 |10 )  1/ 2(| | )hv vh  

|0 or |1  

|h 

|v 

|0 |h 

|0 |1a b  

(a) 

(b) 

(c) 

(d) 

(e) 

(f) 

bbo 

bbo 

PO 
L 

hwp@22.5 
o 

hwp@45o 

hwp@22.5o 
pb 

pb 

qwp hwp 

detector 

fig. 9. the experiment implement of the circuit. (a) prepara- 
tion of the entangl state 1/ 

√ 
2(|0〉|1〉+|1〉|0〉); (b) prepar of 

the quantum state |0〉 or |1〉; (c) realiz of the H gate; (d) real- 
izat of thex gate; (e) realiz of the cnot gate; (f) measure- 
ment setup. bbo: β-barium borate, pol: polarizer, hwp: half-wav 
plate, qwp: quarter-wav plate, pbs: polar beam splitter. 

In the initi stage, the photon in our experi 
be gener by spontan parametr down-convers 
use β-barium borat (bbo). ultraviolet laser puls 
pa through a bbo crystal to produc entangl state 
1/ 
√ 
2(|0〉|1〉+|1〉|0〉) (see fig. 9(a)). If we do not want the 

entangl state, we could use a polar (pol) to disentangl 
the entangl state to |0〉 or |1〉 (see fig. 9(b)). 

In the quantum gate oper stage, we need to implement 
a H gate, X gate, and cnot gate. the single-qubit quantum 
gatesh andx can beexperiment realiz use half-wav 
plate (hwp) of 22.5◦ (see fig. 9(c)) and 45◦ (see fig. 9(d)), 
respectively. sinc the target qubit of the cnot gate in our 
circuit be |0〉, it can be realiz use a combin of a polar- 
ize beam splitter (pbs) and a hwp, and post-select the 
event where there be exactli one photon exit each output 
of the pb [27] (see fig. 9(e)). 

In the measur stage, each photon pass through a 
quarter-wav plate (qwp), a hwp, a pbs, and be final read 
out by use a single-photon detector (see fig. 9(f)). By ad- 
just the angl of the qwp and hwp, we can measur the 
photon qubit in arbitrari bases. 

xxx xyy yxi yyx 

1.0 

0.5 

0 

-0.5 

-1.0 

E 
x 
p 

e 
c 
ti 

o 
n 

v 
a 

lu 
e 

0.4 

0.3 

0.2 

0.1 

0 

0.5 

T 
h 

re 
e 

-p 
h 

o 
to 

n 
d 

e 
te 

c 
ti 

o 
n 

p 
ro 

b 
a 

b 
il 
it 

y 

hhh vhh hvh vvh hhv vhv hvv vvv 

(a) 

(b) 

fig. 10. experiment result for entangl wit measure- 
ments. (a) threefold coincid detect probabl in the h/v 
basis. (b) expect valu of xxx , XY Y , Y XY and Y Y X . 
error bar repres one standard deviation, deduc from propa- 
gate poissonian count statist of the raw detect events. 

vii. photon sourc 

We develop a high-perform sourc of polariza- 
tion entangl photon gener via spontan paramet- 
ric down-convers (spdc) use a sandwich-lik bulk [42], 
which consist of two ident cut 2mm-thick beam-lik 
type-ii β-barium borat (bbo) crystal with one half-wav 
plate (hwp) insert between them. the sourc simultane- 
ousli exhibit high bright (∼850hz/mw), high effici 
(∼45% collect effici with 3nm bandwidth filters, and 
∼88% collect effici without narrowband filtering) and 
high fidel (∼0.98) at a pump power of 240mw. these 
three essenti featur be crucial for futur scalabl photon 
quantum technologies. 



11 

viii. character the three-photon 
entangl state 

here we show the detail for determin the fidel of the 
three-photon entangl state |φ〉 = (|hv V 〉+ |V hh〉)/ 

√ 
2 

and verifi genuin multipartit entangl [57] use an 
entangl witness. the fidel be the overlap of the exper- 
iment produc state ρexp with the desir state ρideal, 

f|φ〉 = 〈φ|ρexp|φ〉 (14) 

for the three-photon entangl state 
ρideal = |φ〉〈φ| = (|hv V 〉〈hv V |+ |V hh〉〈v hh| 
+(xxx + Y XY −xi Y + Y Y x)/4)/2 where X , 
Y and Z be the pauli matrix σx, σy , σz respectively. 
fig. 10 show the experiment data. the expecta- 
tion valu of |hv V 〉〈hv V |+ |V hh〉〈v hh| and 
(xxx + Y XY −xi Y + Y Y x)/4 be 0.987(1) and 
0.921(12) respectively. thus, the state fidel of |φ〉 can be 
calcul a f|φ〉 = 0.954(6), which exce the threshold 
of 0.5 requir for the entangl witness. with high 
statist signific (∼76 standard deviations), genuin 
three-photon entangl be confirmed. 

(a) 

(f)(e)(d) 

( c)(b) 
1 

0 

-1 

0.5 

0 

-0.5 

fig. 11. reconstruct and ideal densiti matrices. (a) imaginari 
compon of the reconstruct densiti matrix ρ�1exp. (b) real com- 
ponent of ρ�1exp. (c) real part of the theoret ideal matrix ρ�1 
(imaginari compon be ident zero). (d) imaginari compo- 
nent of the reconstruct densiti matrix ρ�2exp. (e) real compon of 
ρ�2exp. (f) real part of the theoret ideal matrix ρ�2 (imaginari 
compon be ident zero). 

ix. state reconstruct 

the matrix form of the reconstruct experiment ob- 
tain state ρ�1exp and ρ 

�2 
exp are, 

ρ 
�1 
exp = 

 

2.78 × 10−17 0 2.17 × 10−19i 0 0.0046 + 0.0022i 0.0012 + 0.0024i 0.0029 − 0.0024i −0.0003 + 0.0018i 
0 0 −8.67 × 10−19i 0 0.0012 − 0.0024i 0 −0.0111 + 0.0053i 0 

2.17 × 10−19i −8.67 × 10−19i 2.78 × 10−17 0 0.0100 + 0.0024i 0.0066 + 0.0017i −0.0046 − 0.0153i −0.0126 + 0.0109i 
0 0 0 0 −0.0066 + 0.0006i 0 0.0174 − 0.0109i 0 

0.0046 − 0.0022i 0.0012 + 0.0024i 0.0100 − 0.0024i −0.0066 − 0.0006i 0.0137 0.0020 + 0.0044i −0.0047 − 0.0047i 0.0513 − 0.0021i 
0.0012 − 0.0024i 0 0.0066 − 0.0017i 0 0.0020 − 0.0044i 0 −0.0487 − 0.0271i 0.0002i 
0.0029 + 0.0024i −0.0111 − 0.0053i −0.0046 + 0.0153i 0.0174 + 0.0109i −0.0047 + 0.0047i −0.0487 + 0.0271i 0.9863 0.0245 + 0.0000i 

−0.0003 − 0.0018i 0 −0.0126 − 0.0109i 0 0.0513 + 0.0021i 0.0000 − 0.0002i 0.0245 0 

 

ρ 
�2 
exp = 

 

−0.0010 0 0.0071 −0.0012 0.0020 + 0.0023i −0.0014 − 0.0016i 0.0050 − 0.0051i −0.0025 − 0.0051i 
0 0.0010 −0.0012 −0.0024 −0.0108 − 0.0125i 0.0449 − 0.0023i −0.0030 − 0.0093i 0.0082 − 0.0164i 

0.0071 −0.0012 −0.0010 0 0.0050 + 0.0329i 0.0258 + 0.0010i −0.0265 + 0.0023i 0.0130 + 0.0133i 
−0.0012 −0.0024 0 0.0010 −0.0037 − 0.0129i −0.0107 + 0.0239i −0.0106 − 0.0086i −0.0102 − 0.0116i 

0.0020 − 0.0023i −0.0108 + 0.0125i 0.0050 − 0.0329i −0.0037 + 0.0129i 0.0071 0.0044 − 0.0210i 0.0071 + 0.0244i 0.0087 + 0.0277i 
−0.0014 + 0.0016i 0.0449 + 0.0023i 0.0258 − 0.0010i −0.0107 − 0.0239i 0.0044 + 0.0210i 0.4990 −0.0181 − 0.0009i 0.0165 + 0.0317i 
0.0050 + 0.0051i −0.0030 + 0.0093i −0.0265 − 0.0023i −0.0106 + 0.0086i 0.0071 − 0.0244i −0.0181 + 0.0009i 0.4929 −0.0197 − 0.0070i 

−0.0025 + 0.0051i 0.0082 + 0.0164i 0.0130 − 0.0133i −0.0102 + 0.0116i 0.0087 − 0.0277i 0.0165 − 0.0317i −0.0197 + 0.0070i 0.0010 

 
(15) 

however, the eigenvalu spectrum of ρ�1exp and ρ 
�2 
exp be 

{0.9909, 0.0608,−0.0521, 0.0093,−0.0077,−0.0014, 0.0003, 
−0.0001} and {0.5257, 0.4806, 0.05729,−0.0537,−0.0184, 
0.0149,−0.0064, 0.0001} respectively, which violat the 

posit of densiti matrices. To avoid thi problem, we 
employ maximum likelihood estim [58] to reconstruct 
ρ�1exp and ρ 

�2 
exp, obtain the correspond legitim densiti 

matrix 

ρ 
�1 
exp = 

 

0.0015 0.0002 − 0.0009i 0.0001 − 0.0003i −0.0008 −0.0002 + 0.0002i −0.0005 − 0.0005i 0.0027 + 0.0024i 0 
0.0002 + 0.0009i 0.0019 0.0003 − 0.0001i −0.0004 − 0.0007i −0.0004 − 0.0002i 0.0004 − 0.0009i −0.0062 + 0.0068i 0 
0.0001 + 0.0003i 0.0003 + 0.0001i 0.0018 0.0001 − 0.0014i 0.0003 + 0.0001i 0.0006 + 0.0007i −0.0109 − 0.0198i 0.0003 

−0.0008 −0.0004 + 0.0007i 0.0001 + 0.0014i 0.0023 0.0004 + 0.0005i −0.0008 + 0.0010i 0.0219 − 0.0114i −0.0001 
−0.0006 − 0.0002i 0.0004 + 0.0002i 0.0003 − 0.0001i 0.0004 − 0.0005i 0.0039 0.0004 + 0.0021i 0.0050 − 0.0264i 0.00041 + 0.0001i 
−0.0005 + 0.0005i 0.0004 + 0.0009i 0.0006 − 0.0007i −0.0008 − 0.0010i 0.0004 − 0.0021i 0.0047 −0.0488 − 0.0249i 0.0002 − 0.0003i 
0.0027 − 0.0024i −0.0062 − 0.0068i −0.0109 + 0.0198i 0.0219 + 0.0114i 0.0050 + 0.0264i −0.0488 + 0.0249i 0.9818 0.001 + 0.0007i 

0 0 0.0003 −0.0001 0.0004 − 0.0001i 0.0002 + 0.0003i 0.001 − 0.0007i 0.0027 

 

ρ 
�2 
exp = 

 

0.0003 0.0002i −0.0004 0.0004i −0.0004 − 0.0003i −0.0020 − 0.0014i 0.0051 − 0.0048i 0 
0.0002i 0.0054 0.0012 − 0.0006i −0.0002 − 0.0016i −0.0009 + 0.0001i 0.0439 − 0.0030i −0.0031 − 0.0084i 0 
−0.0004 0.0012 + 0.0006i 0.0058 −0.0010 − 0.0020i 0.0006 + 0.0025i 0.0278 + 0.0094i −0.0267 + 0.0019i 0 
0.0004i −0.0002 + 0.0016i −0.0010 + 0.0020i 0.0026 −0.0025 + 0.0003i −0.0113 + 0.0243i −0.0098 − 0.0081i 0 

−0.0004 + 0.0003i −0.0009 − 0.0010i 0.0006 − 0.0025i −0.0025 − 0.0003i 0.0031 0.0061 − 0.0214i 0.0062 + 0.0230i 0.0001i 
−0.0012 + 0.0014i 0.0439 + 0.0030i 0.0278 − 0.0094i −0.0113 − 0.0242i 0.0061 + 0.0214i 0.4981 −0.0189 − 0.0018i 0.0001i 
0.0051 + 0.0048i −0.0031 + 0.0084i −0.0267 − 0.0019i −0.0098 + 0.0081i 0.0062 − 0.0210i −0.0189 + 0.0018i 0.4838 0 

0 0 0 0 0.0001i 0.0001i 

 
(16) 



12 

the densiti matrix be show graphic in fig. 11. 

[1] G. carlsson, bull. amer. math. soc. 46, 255 (2009). 
[2] H. edelsbrunner, D. letscher, and A. zomorodian, discret. 

comput. geom. 28, 511 (2002). 
[3] A. zomorodian and G. carlsson, discret. comput. geom. 33, 

249 (2005). 
[4] G. carlsson, T. ishkhanov, V. De silva, and A. zomorodian, 

int. J. comput. 76, 1 (2008). 
[5] J. A. perea and J. harer, found. comput. math. 15, 799 (2015). 
[6] G. petri, M. scolamiero, I. donato, and F. vaccarino, in proc. 

euro. conf. complex syst. 2012 (springer, 2013) pp. 93–99. 
[7] G. petri, M. scolamiero, I. donato, and F. vaccarino, plo one 

8, e66506 (2013). 
[8] V. De silva and R. ghrist, notic am. math. soc. 54, 10 

(2007). 
[9] V. De silva and R. ghrist, algebr, geom. topol. 7, 339 (2007). 

[10] V. De silva and G. E. carlsson, spbg 4, 157 (2004). 
[11] R. ghrist and A. muhammad, in internat. sympos. on informat. 

process. in sensor network (ieee, 2005) pp. 254–260. 
[12] C. giusti, R. ghrist, and D. S. bassett, J. comput. neurosci. 

41, 1 (2016). 
[13] C. giusti, E. pastalkova, C. curto, and V. itskov, proc. natl. 

acad. sci. 112, 13455 (2015). 
[14] G. petri, P. expert, F. turkheimer, R. carhart-harris, D. nutt, 

P. J. hellyer, and F. vaccarino, J. R. soc. interface. 11, 
20140873 (2014). 

[15] l.-d. lord, P. expert, H. M. fernandes, G. petri, T. J. 
van hartevelt, F. vaccarino, G. deco, F. turkheimer, and M. L. 
kringelbach, front. syst. neurosci. 10 (2016). 

[16] D. cohen-steiner, H. edelsbrunner, and J. harer, discret. com- 
put. geom. 37, 103 (2007). 

[17] S. basu, discret. comput. geom. 22, 1 (1999). 
[18] S. basu, discret. comput. geom. 30, 65 (2003). 
[19] S. basu, found. comput. math. 8, 45 (2008). 
[20] S. basu, arxiv:1409.1534. 
[21] J. friedman, algorithmica 21, 331 (1998). 
[22] P. scheiblechner, J. complex. 23, 359 (2007). 
[23] S. lloyd, S. garnerone, and P. zanardi, arxiv:1408.3106 

(2014). 
[24] S. lloyd, S. garnerone, and P. zanardi, nat. commun. 7, 

10138 (2016). 
[25] V. giovannetti, S. lloyd, and L. maccone, phys. rev. lett. 100, 

160501 (2008). 
[26] P. W. shor, siam J. comput. 26, 1484 (1997). 
[27] c.-y. lu, D. E. browne, T. yang, and j.-w. pan, phys. rev. 

lett. 99, 250504 (2007). 
[28] B. P. lanyon, T. J. weinhold, N. K. langford, M. barbieri, 

D. F. V. james, A. gilchrist, and A. G. white, phys. rev. lett. 
99, 250505 (2007). 

[29] h.-l. huang, Q. zhao, X. ma, C. liu, z.-e. su, x.-l. wang, 
L. li, n.-l. liu, B. C. sanders, c.-y. lu, et al., phys. rev. lett. 
119, 050503 (2017). 

[30] R. P. feynman, int. J. theor. phys. 21, 467 (1982). 
[31] S. lloyd, scienc 273, 1073 (1996). 

[32] c.-y. lu, w.-b. gao, O. gühne, x.-q. zhou, z.-b. chen, and 
j.-w. pan, phys. rev. lett. 102, 030502 (2009). 

[33] B. P. lanyon et al., nat. chem. 2, 106 (2010). 
[34] A. W. harrow, A. hassidim, and S. lloyd, phys. rev. lett. 103, 

150502 (2009). 
[35] x.-d. cai, C. weedbrook, z.-e. su, m.-c. chen, M. gu, m.-j. 

zhu, L. li, n.-l. liu, c.-y. lu, and j.-w. pan, phys. rev. lett. 
110, 230501 (2013). 

[36] P. rebentrost, M. mohseni, and S. lloyd, phys. rev. lett. 113, 
130503 (2014). 

[37] S. lloyd, M. mohseni, and P. rebentrost, nat. phys. 10, 631 
(2014). 

[38] x.-d. cai, D. wu, z.-e. su, m.-c. chen, x.-l. wang, L. li, n.- 
L. liu, c.-y. lu, and j.-w. pan, phys. rev. lett. 114, 110504 
(2015). 

[39] R. ghrist, bull. amer. math. soc. 45, 61 (2008). 
[40] M. A. nielsen and I. L. chuang, quantum comput and 

quantum inform (cambridg univers press, 2010). 
[41] L. K. grover, phys. rev. lett. 79, 325 (1997). 
[42] x.-l. wang, l.-k. chen, W. li, h.-l. huang, C. liu, C. chen, 

y.-h. luo, z.-e. su, D. wu, z.-d. li, H. lu, Y. hu, X. jiang, 
c.-z. peng, L. li, n.-l. liu, y.-a. chen, c.-y. lu, and j.-w. 
pan, phys. rev. lett. 117, 210502 (2016). 

[43] O. gühn and G. tóth, phys. rep. 474, 1 (2009). 
[44] D. R. hamel, L. K. shalm, H. hübel, A. J. miller, F. marsili, 

V. B. verma, R. P. mirin, S. W. nam, K. J. resch, and T. jen- 
newein, nat. photon. 8, 801 (2014). 

[45] C. A. fuchs, ph.d. thesis, univ. of new mexico (1996). 
[46] y.-m. he, J. liu, S. maier, M. emmerling, S. gerhardt, 

M. davanço, K. srinivasan, C. schneider, and S. höfling, op- 
tica 4, 802 (2017). 

[47] F. kaneda, B. G. christensen, J. J. wong, H. S. park, K. T. 
mccusker, and P. G. kwiat, optica 2, 1010 (2015). 

[48] H. wang, Y. he, y.-h. li, z.-e. su, B. li, h.-l. huang, 
X. ding, m.-c. chen, C. liu, J. qin, et al., nat. photon. 11, 
361 (2017). 

[49] R. fickler, R. lapkiewicz, W. N. plick, M. krenn, C. schaeff, 
S. ramelow, and A. zeilinger, scienc 338, 640 (2012). 

[50] x.-l. wang, x.-d. cai, z.-e. su, m.-c. chen, D. wu, L. li, 
n.-l. liu, c.-y. lu, and j.-w. pan, natur (london) 518, 516 
(2015). 

[51] G. carlsson, acta numerica 23, 289 (2014). 
[52] D. A. johannsen and D. J. marchette, statist analysi and 

data mining: the asa data scienc journal 5, 235 (2012). 
[53] D. nilsson and A. ekgren, topolog and word spaces, ph.d. 

thesis, bsc thesis, kth (2013). 
[54] M. nakahara, geometry, topolog and physic (crc press, 

2003). 
[55] A. zomorodian and G. carlsson, discret. comput. geom. 33, 

249 (2005). 
[56] W. A. sethar and R. budney, J. math. music 8, 73 (2014). 
[57] M. seevinck and J. uffink, phys. rev. A 65, 012107 (2001). 
[58] D. F. james, P. G. kwiat, W. J. munro, and A. G. white, phys. 

rev. A 64, 052312. 


demonstr of topolog data analysi on a quantum processor 
abstract 
supplement materi 
I background and practic applic of betti number and tda 
II numer simul of the proport of k-simplic in some case 
iii experiment error analysi 
IV necess of construct the mix state 
V circuit detail 
VI experiment implement of the circuit 
vii photon sourc 
viii character the three-photon entangl state 
IX state reconstruct 
refer 
























































When A Small Leak Sinks A Great Ship: Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis 


When A Small Leak Sinks A Great Ship: Deanonymizing Tor 
Hidden Service Users Through Bitcoin Transactions Analysis 

Husam Al Jawaheri 
Qatar University 
Doha, Qatar 

Mashael Al Sabah 
Qatar University 
Doha, Qatar 

Yazan Boshmaf 
Qatar Computing Research Institute, HBKU 

Doha, Qatar 

Aimen Erbad 
Qatar University 
Doha, Qatar 

ABSTRACT 
With the rapid increase of threat on the Internet, people be contin- 
uously seek privacy and anonymity. Services such a Bitcoin and 
Tor be introduce to provide anonymity for online transaction 
and Web browsing. Due to it pseudonymity model, Bitcoin lack 
retroactive operational security, which mean historical piece of 
information could be use to identify a certain user. We investigate 
the feasibility of deanonymizing user of Tor hidden service who 
rely on Bitcoin a a payment method by exploit public informa- 
tion leak from online social networks, the Blockchain, and onion 
websites. This, for example, allows an adversary to link a user with 
@alice Twitter address to a Tor hidden service with private.onion 
address by find at least one past transaction in the Blockchain 
that involves their publicly declare Bitcoin addresses. 

To demonstrate the feasibility of this deanonymization attack, 
we carry out a real-world experiment simulate a passive, lim- 
ited adversary. We crawl 1.5K hidden service and collect 88 
unique Bitcoin addresses. We then crawl 5B tweet and 1M Bit- 
coinTalk forum page and collect 4.2K and 41K unique Bitcoin 
addresses, respectively. Each user address be associate with an 
online identity along with it public profile information. By ana- 
lyzing the transaction in the Blockchain, we be able to link 125 
unique user to 20 Tor hidden services, include sensitive ones, 
such a The Pirate Bay and Silk Road. We also analyze two case 
study in detail to demonstrate the implication of the result 
information leakage on user anonymity. In particular, we confirm 
that Bitcoin address should always be consider exploitable, a 
they can be use to deanonymize user retroactively. This be espe- 
cially important for Tor hidden service user who actively seek and 
expect privacy and anonymity. 

KEYWORDS 
Bitcoin, Tor Hidden Services, Privacy, Deanonymization, Attack 

1 INTRODUCTION 
Anonymity and privacy over the Internet be become more criti- 
cal than ever. For that, many solution be be deployed to im- 
prove the anonymity of user while make online transaction or 
browsing the web. The most famous of these solution be the de- 
centralize cryptocurrencies and Tor anonymity network. One of 
the early example be the Bitcoin network [29], which provide user 
with the ability to perform online transaction "pseudonymously". 
Due to it popularity, more than 100K merchant worldwide accept 

Bitcoin payment [11]. One of the reason of Bitcoin’s popular- 
ity be it presume anonymity. Tor [14] be the most widely use 
anonymous communication network with million of daily active 
user [31]. In addition to client-side privacy and anonymity, Tor 
also enables server-side anonymity through the design of hidden 
services. The goal of hidden service be to safely enable online free- 
dom, anticensorship, and end-to-end anonymity and security [12]. 
Indeed, for those reasons, hidden service be be operate by 
whistleblowing website such a WikiLeaks,1 search engine such 
a DuckDuckGo,2 and online social network such a Facebook.3 
Hidden service have also become a breeding ground for Dark Web 
vendors, such a Silk Road [9] and Agora [39], which offer illicit 
merchandise and service [4, 27]. 

As discuss by Vincent and Johan [26], Tor and Bitcoin repre- 
sent the main component need to achieve anonymous online 
purchase with exhaustive operational security. In this context, op- 
erational security be the process of protect individual piece of 
information that could be use to identify a user. Unfortunately, Bit- 
coin lack retroactive operational security due to it pseudonymity 
model [29]. This model have an important limitation because of the 
linkability of Bitcoin transaction that be store in the Blockchain 
and their public availability. 

Problem. Due to potential information leakage, use Bitcoin a a 
payment method be a serious threat to the anonymity of Tor hidden 
service and their users. Yet, Bitcoin be the most popular choice for 
these service for accept donation or sell merchandise [4]. 
Moore and Rid [27] study how hidden service be use in prac- 
tice, and note that Bitcoin be the dominant choice for accept 
payment for these services. Although multiple study [15, 16, 25] 
demonstrate that Bitcoin transaction be not a anonymous a 
previously thought, Bitcoin remains the most popular digital cur- 
rency on the Dark Web [8], and many user still choose to use it 
despite it false sense of anonymity. Biryukov et al. [3] show that 
even if user use Bitcoin over an anonymity network such a Tor, 
they be still vulnerable to deanonymization andman-in-the-middle 
attack at the network level. While previous study analyze the 
vulnerability that result from use Bitcoin over Tor [3], mostly 
at the network level, we provide the first study that focus on 
the application level, shed light on an exploitable information 

1https://wikileaks.com 
2https://duckduckgo.com 
3https://facebook.com 

1 

ar 
X 

iv 
:1 

80 
1. 

07 
50 

1v 
1 

[ 
c 

.C 
R 

] 
2 

3 
Ja 

n 
20 

18 

https://wikileaks.com 
https://duckduckgo.com 
https://facebook.com 


, , Husam Al Jawaheri, Mashael Al Sabah, Yazan Boshmaf, and Aimen Erbad 

leakage result from correlate public profile of online social 
network user with Bitcoin transaction and onion websites. 

Hidden service user be one class of Bitcoin userswhose anonymity 
be particularly important. Hidden service operator and user be 
actively seek to maintain their anonymity. However, those user 
be under the risk of deanonymization when they reveal their Bit- 
coin addresses. By study the transaction associate with these 
addresses, a significant amount of information can be leak and 
use to collect sensitive information about hidden service and 
their customers, where a user can be link to a hidden service. 

In this paper, we seek to understand the privacy risk associate 
with use Bitcoin a a payment method by Tor hidden services. 
That is, we show how use Bitcoin leak public information that 
can be exploit to deanonymize Tor hidden service users. In par- 
ticular, we demonstrate the feasibility of link a user with @alice 
social network profile to a Tor hidden service with private.onion 
address. We note that this research have be carefully revise and 
approve by our institution’s IRB board, and it do not put user at 
any risk other than what they be currently expose to (Section 3.3). 
We also discus a number of countermeasure that be design to 
protect and improve user privacy and anonymity (Section 4.4). 

Approach. By browsing onion land page of various hidden 
services, we observe that it be possible to extract their payment Bit- 
coin address from static HTML content. Accordingly, we crawl 
1.5K hidden service page and create a dataset of 88 Bitcoin ad- 
dress operate by those hidden services, include two ransomware 
addresses. We also crawl online social network for public Bit- 
coin addresses, namely, Twitter4 and the BitcoinTalk forum.5 Out 
of 5B tweet and 1M forum pages, we create two datasets of 4.1K 
and 41K Bitcoin addresses, respectively. Each address in these user 
datasets be associate with an online identity and it correspond 
public profile information (Section 3.4). 

Using a cluster heuristic propose by Meiklejohn et al. [25], 
we perform a wallet-closure analysis that allow u to expand 
the collect Bitcoin address per user. In other words, for each 
address in the collect user datasets, we identify other address 
belonging to the same user who own the address. This closure anal- 
ysis approximates a user’s wallet, which be the set of address that 
be control by the user, and thereby increase the number of iden- 
tified link between user and hidden services. One problem with 
closure analysis be that the closure can over-approximate the size of 
the wallet, a a consequence of mix [23] and CoinJoin [40] ser- 
vices. Therefore, we exclude closure that have common address 
from the analysis. This ensures that user be not double-counted 
and report result be lower-bound estimate, a each remain- 
ing closure represent a subset of a wallet whose address be 
control by a unique user (Section 3.5). 

After wallet-closure analysis, we use the datasets to analyze 
the transaction in the Blockchain. In particular, we search for 
transaction between user and hidden service address in order 
to identify link between them. This enable u to associate users, 
or online identities, with hidden service and access their transac- 
tion history. To demonstrate the impact of linking, we trace and 
described two case study show that Bitcoin address can be 

4https://twitter.com 
5https://bitcointalk.org 

use to deanonymize user retroactively, start from May, 2010. 
It be important to highlight that deanonymization depends solely 
on information leak from public data sources. Finally, to gain 
insight into the economic activity of the link hidden services, 
we analyze the correspond transaction history, focus on 
number of transactions, the amount of money be exchanged, 
and the lifetime of these hidden service (Section 3.6). 

Results. With wallet-closure analysis, we be able to expand 
the datasets from 45.2K Bitcoin address to more than 19.1M, with 
an average of 425 address per user. Using transaction analysis, 
we be able to link 125 unique user to 20 Tor sensitive hidden 
services, such a WikiLeaks, Silk Road, and The Pirate Bay.6 The 
case study unmasked multiple user of The Pirate Bay hidden 
service, along with their personally identifiable information (PII), 
such a name, gender, age, and location.7 We also found that user 
from multiple country and different age have link with the Silk 
Road address in our hidden service dataset. One of the users, for 
example, be a teenager who have many social network account 
show his real identity. 

The economic activity analysis of the link hidden service 
show that WikiLeaks be the high receiver of payment in term 
of volume, with 25.6K transactions. In term of the amount of in- 
come payments, however, the Silk Road top the list with more 
than 29.6K Bitcoins receive on it address.8 We observe that the 
money flow in and out of hidden service address be nearly the 
same. This suggests that these service do not keep their Bitcoins on 
the address they use for receive payments, but rather distribute 
the coin to other address instead. Finally, from the last transac- 
tion date on the addresses, we found that only eight out of the 20 
link hidden service be inactive in 2017. This, however, do not 
mean the inactive service stop make Bitcoin transactions, a 
they might have use different address that we do not know. 

Contributions. This paper show the implication of Bitcoin’s 
pseudonymity model, which lack retroactive operational security, 
on Tor hidden service users. Our contribution be the following: 

(1) A method that link online user identity with Tor hid- 
den service through Bitcoin transaction analysis. The 
method improves link result by use closure analysis 
technique and by significantly eliminate the noise from 
mix and CoinJoin services. 

(2) The first real-world experiment that show the feasibil- 
ity of deanonymizing Tor hidden service user by exploit- 
ing information leakage result from correlate public 
data sources, namely, online social networks, the Bitcoin 
Blockchain, and Tor hidden services. 

(3) An economic activity analysis of 20 hidden service that 
be use by link users. This include statistic on their 
transaction volume, flow of money, and lifetime. 

2 BACKGROUND 
We now present the necessary background on Bitcoin and Tor. 

6https://thepiratebay.org 
7In accordance with our IRB board’s guidelines, we have remove the PII of these 
users, a the link hidden service be consider illegal in their countries. 
8As of Dec 2017, this amount of Bitcoins equal more than 580 million USD. 

2 

https://twitter.com 
https://bitcointalk.org 
https://thepiratebay.org 


Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis , , 

2.1 Bitcoin 
Bitcoin [29] be a decentralize digital crypto-currency systemwhich 
eliminates the need for a central bank authority to manage the trans- 
fer of funds. The Bitcoin network be maintain by a peer-to-peer 
network of miner who validate transaction without relay on 
trust. Due to it popularity, more than 100K merchant worldwide 
accept Bitcoin payment [11]. One of the reason of Bitcoin’s popu- 
larity be it presume anonymity. The identity of user in Bitcoin 
be hidden use pseudonym which be use a address to per- 
form transactions. A Bitcoin address be a 160-bit hash of a public key 
generate by a digital signature algorithm. The set of public/private 
key that be own by a user be call a wallet. Private key be 
use to sign input of transaction a a proof of ownership. 

2.1.1 Transactions. Alice make a payment to Bob by create 
a new transaction. She us one or more Bitcoin address that she 
control a inputs. She also include the amount to be transferred, 
and chooses Bob’s address(es) a a transaction output. To protect 
the transaction, she sign it use her private key(s), and then 
broadcast it to the whole network. In order to verify transactions, 
and be reward with new generate coins, miner collect the 
broadcast transactions, embed them in a well-defined data structure 
call a block, and then attempt to solve a hash computational 
puzzle involve the block. When the block be solved, it be attach 
to the Blockchain, which be a hash-chain that maintains all solve 
blocks, and thereby all embed transaction ever create and 
verify in the Bitcoin network. 

The Blockchain be publicly maintain and can be download 
over the Internet, Bitcoin’s original client, or explore use cen- 
tralized servers, such a Blockchain Info.9 Every transaction in 
the Blockchain have a list of input and outputs, where each in- 
cludes address that be use in the transaction and the amount 
of coin spent in that transaction. Transactions download from 
Blockchain Info include more information, such a the relay IP ad- 
dress and the transaction timestamp that record the time at which 
the transaction be made. 

2.1.2 Anonymity. While transaction in Bitcoin be presume 
to be anonymous, linkability between address be possible due the 
nature of the Blockchain [29]. For example, one can verify if Alice 
and Bob have a transaction between them. Furthermore, if Alice 
own multiple addresses, one may be able to link them a belonging 
to the same person. 

Meiklejohn et al. [25] observe that two Bitcoin addresses,A and 
B, belong to the same user if bothA and B have be use a input 
for the same transaction, or B receives, a an output, the unspent 
change of a transaction where A be use a input. The author 
use this observation to define a heuristic for mapping multiple 
address to an entity represent a unique user. Specifically, the 
heuristic be base on the idea that since the private key of the 
user be use to sign the input A and B, then both A and B be 
control by the same person. As the address or the underlie 
public/private key that be own by a user represent a wallet, 
the heuristic try to induce the wallet of a user give a subset 
of the address in the wallet. The author also define a second 
heuristic base on another observation. When an address be use 
9https://blockchain.info 

a an input in a transaction, all of it associate Bitcoins have to 
be spent at once. If those coin exceed what the sender want to 
spend, then the sender have to reference two outputs, one to the 
receiver with the intend amount, and another for the change. The 
sender typically control the change address within the transaction. 
Both heuristic represent wallet-closure technique that be use 
for Bitcoin transaction analysis. 

It be important to note that wallet-closure technique be noisy 
and can result in address that do not belong to the same user 
or wallet. One reason for this be the use of mix [23] and Coin- 
Join [40] services. Given a set of input address of multiple users, 
these service generate a sequence of transaction that effectively 
mix the coin to enhance anonymity. In this work, we modify the 
first wallet-closure technique to handle Bitcoin mix for transac- 
tion analysis, a described in Section 3.5. 

2.2 Tor Hidden Services 
Tor [14] be the most widely use anonymous communication net- 
work available online. Tor enables server-side anonymity through 
the design of hidden services, also know a onion services. To 
achieve their anonymity goal, a hidden service client and operator 
establish a communication tunnel, know a a circuit, between each 
other over multiple intermediate routers. Anonymity be maintain 
a long a the intermediate router at the two end of the tunnel be 
not control by an adversary who can use time or traffic analysis 
to link the source to the destination. Hidden service have also 
be subject to active attack in the wild [13, 24]. For these rea- 
sons, the Tor project be actively work on address the security 
weakness of hidden service [30]. 

To ensure transaction anonymity, Bitcoin have become the most 
popular choice by Tor hidden service for accept donation or 
sell merchandise [4]. Unfortunately, this have contribute to the 
rise of illegal hidden services, such a Silk Road and Agora, which 
offer illicit merchandise and service [4, 9, 27, 39]. 

3 APPROACH AND EXPERIMENT 
While the goal of use Bitcoin for Tor hidden service be to pro- 
vide transaction and browsing anonymity, we show that this usage 
typically leak information that can be use to deanonymize hid- 
den service users. In particular, the adversary can link users, who 
publicly share their Bitcoin address on online social networks, 
with hidden services, which publicly share their Bitcoin address 
on onion land pages. This be achieve by inspect historical 
transaction involve these two address in the Blockchain. In 
do so, the adversary only relies on data that be publicly available. 

3.1 Overview 
To illustrate the deanonymization attack, let u consider Alice, a 
privacy-savvy user who us Tor, in the follow scenario: 

(1) Alice us a browser and creates an online identity @alice 
with a public profile on social network public.com. 

(2) Alice us @alice to make a public post ask for dona- 
tions on Bitcoin address A. 

(3) Alice receives donation through a number of Bitcoin trans- 
actions, where A be use a an output address. 

3 

https://blockchain.info 


, , Husam Al Jawaheri, Mashael Al Sabah, Yazan Boshmaf, and Aimen Erbad 

(4) Alice us Tor browser to visit hidden service private.onion 
that have public Bitcoin address P . 

(5) Alice make a payment A → P to private.onion use A a 
an input address and P a an output address. 

While step 1–3 involve non-anonymous web browsing and pub- 
lic activities, Alice have some expectation of privacy and anonymity 
in step 4–5, give that she be use Tor and Bitcoin. Step 5, however, 
leak a piece of information, the transaction A → P in particular, 
that can be use by an adversary, Trudy, to link @alice to pri- 
vate.onion, a follows: 

(1) Trudy crawl public.com on regular basis, store public 
user profile and posts. 

(2) Trudy crawl hidden service on regular basis, store ac- 
cessible onion pages. 

(3) Trudy par crawl data on regular basis, search for 
Bitcoin addresses. 

(4) Trudy par the blockchain on regular basis, search for 
transaction between user and hidden service addresses. 

(5) Trudy find Bitcoin address A on public.com, associate 
with online identity @alice. 

(6) Trudy find Bitcoin address P on private.onion. 
(7) Trudy find transaction A → P and accordingly link @al- 

ice to private.onion. 
Unknown to Alice, Trudy can effectively deanonymize Alice’s 

identity and link her to activity on private.onion use step 1–7. 
More importantly, this attack vector be feasible retroactively in the 
future, start from the time of the transaction A → P . 

3.2 Adversary Model 
We assume a passive, limited adversary. The adversary have access to 
or be capable of collect Bitcoin address of Tor hidden service 
and their users. This attacker do not need to control network 
resources, but can extract publicly accessible information from on- 
line social networks, the Blockchain, and onion pages. Obtaining 
Bitcoin address of user can be either target or non-targeted, 
depend on the attack scenario. For the early scenario, the adver- 
sary can use social engineering or exploit contextual metadata. For 
example, if Trudy know that Alice book a ticket on Expedia10 
at a certain time with a certain amount of coins, Trudy can easily 
deduce Alice’s Bitcoin address from the Blockchain. For the latter 
scenario, the adversary can crawl and parse public data source for 
Bitcoin address and associate identity on a large scale. 

We focus on the second, non-targeted attack scenario and show 
that an adversary can deanonymize hidden service user by corre- 
lating public data from online social networks, the Blockchain, and 
Tor hidden services. 

3.3 Ethical Considerations 
The deanonymization present in this work depends on correlate 
public Bitcoin address of user with the transaction reveal 
by the Blockchain. Many prior study perform similar analysis 
base on crawl public Bitcoin address [16, 25, 32]. While our 
study narrow down this analysis to the scope of hidden service 
and their users, we stress that even the Bitcoin address of hidden 

10https://www.expedia.com 

service be readily available on their onion land pages. We do 
not try to obtain Bitcoin address of hidden service that require 
authentication, payment, or exchange of emails. 

We believe the data collect and use herein be easily available 
to adversaries. In this research, in addition to the Blockchain and 
onion land pages, we use data available from two online so- 
cial networks, namely, Twitter and the BitcoinTalk forum. A web 
search engine, such a Google,11 or any other organization that 
have access to a significantly large amount of data could perform 
the analysis on a large scale, and potentially exploit a significantly 
large amount of leak information about users. Ignoring the exis- 
tence of the data, or the security implication of use Bitcoin a a 
payment method for hidden services, can leave both the user and 
the security community unaware of the involve privacy leaks. 

To this end, we have consult and receive the approval of our 
institution’s IRB board to conduct our experiment. We would like 
to highlight that our research do not put user at any additional 
risk, but rather expose the exist one. This be important because 
once user become vulnerable to this deanonymization attack, a 
described in Section 3.1, they stay vulnerable even after they switch 
to a more secure payment method or stop use the service. As part 
of our personal and institutional code of ethics, we have reach 
out to vulnerable user in our datasets and inform them about 
this threat and possible remedies. We also post an anonymous 
notice on BitcoinTalk forum.12 In Section 4.4, we discus a number 
of countermeasure that be design to protect and improve user 
privacy and anonymity. 

3.4 Data Collection 
We now describe how we collect public Bitcoin address and 
online identity of Tor hidden service and Bitcoin users.13 

3.4.1 Hidden Services. Tor hidden service be not indexed by 
normal search engines, but can be found use index service 
such a Ahmia,14 which be accessible from the normal Web. Other 
search engine be available but require a Tor browser in order to 
access them. These search engine be use to access the onion 
land pages, or the websites, of many hidden services. Typically, 
hidden service publish their Bitcoin address on their land 
page for receive payments. These address can be collect 
by simply download these page and search for Bitcoin ad- 
dress use regular expressions. As a Bitcoin address be a base-58 
encode identifier of 26–35 alphanumeric characters, begin 
with the number 1 or 3, we use the follow regex: 

*[13][a-km-zA-HJ-NP-Z1-9]{25,34} 

With the goal of collect long-term hidden service addresses, 
we start expand the dataset in mid 2015. Over time, however, 
we found that few hidden service publicly expose their Bitcoin 
address on their onion pages, resort to online wallet or other 
crypto-currencies, possibly due to the increase awareness of Bit- 
coin’s privacy issue (Section 4). Therefore, our analysis focus 
on the time window when publishing long-term Bitcoin address 
be a common practice. We note that the deanonymization attack 
11https://google.com 
12https://bitcointalk.org/index.php?topic=2602885 
13The result datasets be available per request to interested researchers. 
14https://ahmia.fi 

4 

https://www.expedia.com 
https://google.com 
https://bitcointalk.org/index.php?topic=2602885 
https://ahmia.fi 


Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis , , 

Date collect # address 

Label (dd/mm/yyyy) # user Original Expanded 

hiddenServices 27/01/2016 88 88 – 
twitterUsers 30/12/2014 4,183 4,183 623,189 
forumUsers 26/10/2016 40,970 40,970 19,213,141 
Table 1: Dataset summary of collect Bitcoin address 

be feasible use historic data that be publicly available since the 
inception of Bitcoin in 2010 up until now. 

In our experiment, we first compile a list of onion address 
from Ahmia. We then download the land page of more than 
1.5K hidden services. While our goal be to automate the process of 
collect Bitcoin addresses, many of the onion address list by 
Ahmia be unavailable or offline when we ran the script on Jan 
27, 2016. A simple regex search on the land page allow u to 
extract a small number of Bitcoin addresses, less than 20 addresses. 

Furthermore, by browsing various hidden services, we be 
able to extract more addresses. We also observe that many ser- 
vice do not expose their Bitcoin address on their land pages, 
and would require user to attempt purchasing item before a Bit- 
coin address be show to the user.15 In addition, we include two 
know ransomware address that be publish on the Web and 
the Blockchain.16 Ransomware be a malware category that limit the 
access of user to their file by encrypt them [19]. Ransomware 
require victim to pay in order to get access to the decryption keys. 
To remain anonymous, ransomware require victim to pay through 
the Bitcoin network. Ransomware locker be know to use Tor 
hidden service a a place to hide their malicious activity [20]. 

Our automate and manual search result in a total of 105 
Bitcoin addresses. We verify that those address be active 
by download their transactions. We remove all address that 
contain no transaction or have very low amount of Bitcoins, 
less than 0.00001B, and be likely to be inactive. This result in 
88 unique Bitcoin address which represent the hiddenServices 
dataset, a summarize in Table 1. 

While the number we end up with seem relatively small com- 
par to the total number of hidden services, our goal here be to 
show the feasibility of link hidden service to their user use 
only public information. As described in Section 3.2, an adversary 
that have a wider access to resources, or actively interact with hid- 
den services, be expect to collect a significantly large number of 
addresses. 

3.4.2 Users. Bitcoin user often post their address on online 
social network for different purposes, such a receive donations, 
offering services, or show that they be part of the community. 
Public Bitcoin address expose online could potentially put these 
user at the risk of transaction history trace and linkage. Not 
only do user reveal their public Bitcoin addresses, but they also 
reveal personal information represent their online identities, 

15Services we manually visit offer variety of different content range from dark 
market (e.g. drug, steal card, and arms) to service such a WikiLeaks. 
16https://blockchain.info/address/1AEoiHY23fbBn8QiJ5y6oAjrhRY1Fb85uc 

such a contact information, gender, age, and location, depend 
on the social network used. 

Bitcoin address and the associate online identity of user 
can be collect by crawl and parse their user profile or by 
use the native APIs provide by the social network itself. In our 
experiment, we collect the address and identity of user of 
two online social networks, specifically, Twitter and the BitcoinTalk 
forum, a summarize in Table 1. We note that there be a one-one 
mapping between an address and it associate online identity. 

Twitter. We use Twitter Decahose stream data [38] that we pre- 
viously collect from Dec 11, 2013 to Dec 30, 2014. Decahose pro- 
vides a 10% realtime random sample of all public tweet through 
a stream connection. The reason we chose this dataset be be- 
cause we want to find Bitcoin address for Twitter users, which 
coincide with our hidden services’ Bitcoin addresses. Recall that 
prior to 2016, it be more common for user and hidden service 
to share their long-term addresses. Overall, data collection result 
in 10TB of JSON-formatted file represent 5 billion tweets. In 
addition to it textual content, each tweet have the public profile 
information of it author, which sometimes contains the author’s 
Bitcoin address. To extract tweet that contain Bitcoin addresses, 
we scan the whole dataset and kept the tweet that match 
the regex described in Section 3.4.1, result in 509,173 tweets. 
Next, we ran another pas on the match tweet to group them 
into unique Bitcoin addresses. From 509,173 match tweets, we 
found 4,183 unique address and identities, where an address of 
an identity appear in 165 different tweets, on average. We refer 
to this list of address a the twitterUsers dataset. 

Forum. BitcoinTalk be one of the most popular Bitcoin forum 
with more than 900K user who exchange interests, technical ex- 
pertise, and experience in the development of the Bitcoin software. 
The forum also have several different section for coin mining, tech- 
nical support, and the economy of Bitcoin. It be the first forum of 
it kind that discus topic related to Bitcoin and have reach 
it billionth post in Jul, 2012. As of Nov 2017, the forum contain 
around 2.5 billion posts. Based on it popularity, we sought to use 
it a a resource to extract public address of Bitcoin users. 

In our experiment, we crawl and parse 900K user profile 
by retrieve each profile page use it URL, where each page 
be indexed by a unique user identifier that start from 1. Overall, 
the crawl result in 22 GB of unparsed user profile in HTML 
format. Having the profile downloaded, we parse them search 
for Bitcoin address use the regex described in Section 3.4.1, 
result in 40,970 unique address and identities. We refer to this 
list of address a the forumUsers dataset. 

5 



, , Husam Al Jawaheri, Mashael Al Sabah, Yazan Boshmaf, and Aimen Erbad 

0 

0.2 

0.4 

0.6 

0.8 

1 

1 10 100 1000 10000 100000 

Closure size 

Before 
After 

(a) twitterUsers 

0 

0.2 

0.4 

0.6 

0.8 

1 

1 10 100 1000 10000 100000 

Closure size 

Before 
After 

(b) forumUsers 

Figure 1: CDFs of closure size before and after cleaning 

3.5 Wallet-Closure Analysis 
The goal of wallet-closure analysis be to expand the set of Bitcoin 
address that be control by a user in order to establish a unique 
many-one mapping between address and an identity. Increasing 
the number of Bitcoin address per user allows u to identify more 
link between the user and hidden services. Using the first wallet- 
closure heuristic originally propose by Meiklejohn et al. [25], we 
define the closure of a Bitcoin address a follows: If addressesA and 
B be in a closure, then there exists a transaction where address 
A and B appear a inputs. The motivation for this be that if two 
address appear in the same transaction a inputs, then they be 
likely to be control by the same user, since they be sign by the 
private key of the owner who perform the transaction. However, 
this heuristic be noisy when user utilize mix service or use 
CoinJoin transactions, a the mix process result in closure that 
include address belonging to multiple identities. Accordingly, one 
might end up with closure that have a large number of address 
that be not mutually exclusive. In other words, there will be some 
Bitcoin address that appear in multiple closures. 

Mixing service be third party service that receive coin from 
one user, mix the coin with those receive from other users, 
and then sends back the same amount of coins, albeit shuffle with 
different address use a number of transactions, to the original 
user. CoinJoin, on the other hand, be a peer-to-peer mix protocol 
that achieves a similar goal, but us a more sophisticated approach. 
These service be use to improve the anonymity of transaction 
and reduce linkability. In order to eliminate the effect of mix 
services, we perform the follow cleaning process: We find all 
closure that share at least one address and consequently merge 
them, after which we remove all closure that have be merged, 
end up with unique closure that have no intersection and be 
mutually-exclusive. While do so ensures that wallet-closures 
which belong tomultiple user be not double counted, it also mean 
that the result number of user that be link to hidden service 
represent a lower-bound estimate of the actual number of user 
that can be link and deanonymized. 

In our experiment, after apply wallet-closure, we be able 
to expand the twitterUsers dataset by 619,006 additional address 

for 1,322 user out of the 4,183. The closure be more significant 
for the forumUsers dataset, where we be able to add 18,508,012 
address for 22,843 user out of the 40,970. In total, for the two 
datasets, we end up with 19,172,171 address for 45,153 users, 
with an average of 425 address per user represent the average 
closure size. After wallet-closure cleaning, we end up with 3,640 
closure for the twitterUsers dataset, and 23,567 closure for the 
forumUsers dataset. These closure under-approximate user wallets, 
where each consists of at least one Bitcoin address and be uniquely 
mapped to it owner who be a user with an online identity. We use 
these closure to link user to hidden service in the next section. 

Figure 1 show the closure size CDFs for both datasets, before 
and after the cleaning process. As illustrate in the figure, there be 
a significant drop in the size of closure after cleaning; the median 
size decrease from 8 address to 4 for the twitterUsers dataset, 
and from 103 address to 5 for the forumUsers dataset. In fact, 
more than 90% of the user in both datasets have 6 address or less 
in their wallet after cleaning. The figure also suggests that a large 
number of BitcoinTalk user utilize mix service than Twitter 
users, a show by the difference in their before/after distributions. 

3.6 Bitcoin Transaction Analysis 
We now describe how we link user to hidden services, give two 
deanonymization case studies, and analyze the economic activity 
of the link services. 

3.6.1 Linking. In order to establish a link between a user wallet 
and a hidden service, we need to search the Blockchain for a trans- 
action whose input be any of the address in the wallet and whose 
output be a hidden service address. 

In our experiment, we first download the whole Blockchain 
use the Bitcoin Core client software [5], which be also responsible 
for manage the client’s runtime and transactions. At the time of 
the analysis, the size of the Blockchain be over 230GB and it take 
nearly two day to download and sync the Blockchain on an average 
Internet connection. The Bitcoin Core client do not provide an 
easy, native way to access Blockchain transactions. For that, one 
can use APIs built on top of Bitcoin Core, such a Bitcore Node [6], 

6 



Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis , , 

# link user Volume Flow of money (B) Lifetime (dd/mm/yyyy) 

Name twitterUsers forumUsers Total (# txs) Incoming Outgoing First tx Last tx # day 

WikiLeaks 11 35 46 25,569 4,011.95 4,000.40 14/06/2011 24/07/2017 2,163 
Silk Road 4 18 22 979 29,675.86 29,658.80 02/10/2013 24/07/2017 1,321 
Internet Archives 3 13 16 2,534 155.55 99.61 09/05/2013 24/07/2017 1,537 
Snowden Defense Fund 3 8 11 1,642 201.88 198.38 10/08/2013 15/07/2017 1,370 
The Pirate Bay 3 7 10 1,192 76.80 76.78 29/05/2013 08/07/2017 1,151 
DarkWallet Mixer 9 1 10 1,084 109.97 92.75 16/04/2014 02/11/2016 932 
ProtonMail 1 7 8 2,850 143.17 68.78 17/06/2014 24/07/2017 1,498 
OpenStreetMap Donations 0 5 5 440 24.01 24 13/05/2013 13/07/2017 1,522 
Darknet Mixer 1 2 3 22,110 306.16 341.48 21/01/2014 24/07/2017 1,645 
Liberty Hackers 0 2 2 85 2.79 2.79 10/04/2013 11/07/2017 1,553 
Onion Mail 1 0 1 226 84.92 84.92 15/09/2014 30/03/2015 196 
Bitcoin Fog 1 0 1 121 10.46 10.46 12/08/2014 09/01/2015 150 
Bitmessage Mail 0 1 1 106 2.78 1.37 28/04/2014 16/06/2017 1,145 
Secure Tor Messaging 0 1 1 105 12.5 12.5 02/01/2013 05/01/2016 1,098 
Ransomware 1 0 1 72 41.15 41.15 28/02/2014 15/08/2014 168 
Bitcoin Lottery 0 1 1 33 0.22 0.22 28/02/2014 02/05/2015 428 
Libertarian Nuts 0 1 1 23 0.31 0 28/02/2014 24/10/2015 603 

Unknown1 1 1 2 42 8.32 8.31 23/06/2014 23/06/2017 1,096 
Unknown2 1 0 1 132 4.19 4.18 22/06/2014 01/01/2015 193 
Unknown3 0 1 1 39 7.95 7.94 01/05/2014 18/05/2017 1,113 

Table 2: Linked hidden services. The three unknown service belong to onion page that be take down before we could 
manually identify and validate their hidden service provider. 

which extends Bitcoin Core and provide additional index for 
more advanced address queries, and Insight API [7], which be a 
RESTful HTTP and web socket API service for Bitcore Node. 

Using the Insight API on top of Bitcore Node, we perform the 
link process after wallet-closure a follows: For each address 
in the hiddenServices dataset, we query the Blockchain for the 
transaction history of that address. This query return a set of 
transaction in which the address appear a either an input or 
an output. We then issue the same query for each address in the 
twitterUsers and forumUsers datasets. This result in two set 
of transactions; one for hidden service and one for users. Finally, 
we cross-matched the two set of transactions; if any address of a 
user be found a an input in any transaction where a hidden ser- 
vice address appear a an output, then the user have a relationship 
with that hidden service, and thus, a link be established. For the 
twitterUsers dataset, we be able to link unique 28 user to 14 hid- 
den service use 167 transactions. Similarly, for the forumUsers 
dataset, we be able to link unique 97 user to 20 hidden service 
use 115 transactions. Some of these user be link to multi- 
ple hidden services, and a total of 20 unique hidden service be 
link to user from the two datasets. As suggest by the results, 
although Twitter user be small in number compare to Bit- 
coinTalk users, they be more active and have a large number of 
transaction with hidden services. In fact, some of these user be 
“returning customers,” a they have performedmultiple transaction 
with the same hidden services. 

Table 2 list the hidden service sort by how many user be 
link to them. The list be topped by WikiLeaks, a service that pub- 
lishes secret information provide by anonymous sources, with 
46 link users. This be follow by the Silk Road, a famous black 
market on the Dark Web, with transaction from 22 user whose 
input coin have be seize by the FBI. Although the wallet ad- 
dress of Silk Road be seized, it be still receive transaction until 
recently. However, from our analysis, we observe that a number of 
transaction be perform prior to the seizure. Ranked fifth, The 
Pirate Bay, which be know for infringe IP and copyright law by 
facilitate the distribution of protect digital content, be link 
to 10 users. Other service list in Table 2 include hack services, 
such a Liberty Hackers, mix services, such a Darknet Mixer, 
and various secure mail providers, such a ProtonMail. 

3.6.2 Deanonymization. As link user have associate online 
identities, they could be deanonymized with different level of cer- 
tainty, depend on how much personally identifiable information 
they have share on their social network’s user profiles. We next 
focus on two case study that illustrate this threat in more detail. 
It be important to note that we found a number of sensitive detail 
about these user include location, gender, age and email ad- 
dresses. However, due to ethical considerations, we only disclose 
the information that demonstrate the privacy implication of this 
type of analysis. 

The first case study be of a Pirate Bay hidden service user. The 
associate online identity indicates that the user be a middle age 
man from Sweden. This user be particularly interest because The 
Pirate Bay website be found by a Swedish organization call 

7 



, , Husam Al Jawaheri, Mashael Al Sabah, Yazan Boshmaf, and Aimen Erbad 

Piratbyrån. Furthermore, the original founder of the website be 
found guilty in the Swedish court for copyright infringement [33]. 
Since then, the website have be change it domain constantly, 
and eventually operate a a Tor hidden service. Therefore, the 
exist link between this user and The Pirate Bay through recent 
transaction could be incriminating. 

In the second case, we focus on the Silk Road hidden service. As 
show in Table 2, there be 22 user that have a link to Silk Road 
through transaction with seize Bitcoin addresses. These user 
be locate across the world in country such a India, Canada, 
and the USA. They include 4 male and 6 female of different age 
that range between 13 and 42 years. The 18 user from the foru- 
mUsers dataset be active on BitcoinTalk between 2013 and 2015, 
while 3 of them be still active in 2017. As for the 4 user from the 
twitterUsers dataset, they post an average of 45 tweet in 2014. 
One particularly interest user be a young teenager from the USA. 
This user have be a register BitcoinTalk member since 2013, and 
have a transaction with Silk Road in 2013, the takedown year, during 
which he be even young than what his current age show on his 
profile. The associate profile also include his personal website, 
which contains link to his Facebook, Twitter, and Youtube profiles. 

3.6.3 Economic Activity. In order to gain insight about the eco- 
nomic activity of the link hidden services, we analyze all of 
their transaction in the Blockchain. In our experiment, for each 
service, we collect information about it number of transaction 
(i.e., volume), the amount of coin the service have receive or sent 
(i.e., flow of money), and the timestamps of it first and last transac- 
tions (i.e., lifetime). The result be also summarize in Table 2. We 
refer the interested reader to Appendix A for the economic activity 
analysis of the all hidden services, include the unlinked ones. 

Volume. While the list of service be small, our result indicate 
that they have be involve in a relatively large number of transac- 
tions. For example, WikiLeaks top the list with 25,569 transactions. 
The Darknet Mixer, on the other hand, have a volume of 22.1K trans- 
action that be great than the remain service combined. One 
explanation for this popularity be that user be actually aware of 
the possibility of linking, and try to use mix service in order to 
make traceability more difficult and improve their anonymity. 

Money flow. We calculate the total incoming and outgo Bit- 
coin for each hidden service in order to determine how much 
money be actually flow in and out of their addresses. One inter- 
esting observation be that almost the same amount of coin flow 
in and out of these addresses. This indicates that the money be 
be distribute to other addresses, and be not store on payment- 
receive addresses. One explanation for this behavior be that by 
distribute fund to other addresses, a hidden service can reduce 
coin traceability. Also, hidden service still need to distribute their 
revenue among owners, sellers, and other stakeholders. 

We also observe that multiple hidden service have a revenue 
of more than 4K Bitcoins and up to 29.6K, where one Bitcoin be 
value at 19.7 thousand USD a of Dec, 2017. The Silk Road, for 
example, have receive more than 580 million USD on it address. 

Lifetime. Tracking the economic activity of hidden service over 
time allows u to estimate their operational lifetime, at least a see 
from their associate addresses. From the transaction history of 

each hidden service, when filter by it Bitcoin address, we define 
the lifetime of the service a the difference between the timestamps 
of the last and the first transaction involve the address. This 
allows u to estimate the period of operation of each hidden service, 
and accordingly, determine if the service be still active. 

As summarize in Table 2, hidden service vary in their lifetime, 
range from 2–6 year of operation. We note that the first transac- 
tion date do not imply that the service begin it operation on that 
date; it indicates the date on which the service start receive 
Bitcoin payments. Looking at last transaction dates, most of the 
hidden service be still active in 2017. 

4 DISCUSSION 
We now discus the deanonymization attack, focus on it fea- 
sibility and implications. We also list the limitation of this work 
and highlight a number of exist countermeasure for improve 
privacy and anonymity. 

4.1 Feasibility 
Tor be expect to maintain it anonymity guarantee even with an 
active, local adversary who control a fraction of network resources, 
20% of the routers, for example. The goal of such an adversary be 
to link the source of a communication tunnel to it destination. In 
our setting, this map to link a hidden service user to a hidden 
service operator. By observe both end of a circuit, even a passive 
adversary can confirm a connection exists between Alice and Bob 
use time and traffic analysis [14]. If the adversary control only 
a small fraction of the network, the chance of such an end-to-end 
compromise be very small. However, side-channel attack can be 
use to increase the success rate of deanonymization attack [2]. 

The result in Section 3.6 show that it be possible to deanonymize 
hidden service user without the need to control network resource 
nor inspect the traffic. As discuss in Section 3.2, we consider a pas- 
sive, limited adversary that fall within the adversary model of Tor, 
and focus on hidden service that use Bitcoin a a payment method. 
Through a real-world experiment, we show that an adversary 
can link users, who publicly share their Bitcoin address on online 
social networks, with hidden services, which publicly share their 
Bitcoin address on onion land pages. This be accomplish by 
inspect the transaction involve these two address in the 
Blockchain. 

While collect Bitcoin address of hidden services, we found 
that many service start to hide their payment Bitcoin address 
from onion land pages. One explanation of this trend be that 
hidden service operator realize that publicly share Bitcoin ad- 
dress can leak information which could be use for link and 
improve traceability. Instead, these service let user register 
account on their website and use them to perform transaction 
without expose the address use to receive Bitcoins. The way 
this work be a follows: If Alice want to perform a transaction 
with a hidden service, she start by create a personal account on 
the service. The hidden service creates and control a new Bitcoin 
address, from a new public/private key pair, to which Alice make 
a transaction from her personal Bitcoin addresses. 

An active, more resourceful, local adversary can compile a large 
set of hidden service address by perform small transaction 

8 



Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis , , 

with such service in order to reveal their addresses. Moreover, 
adversary can impersonate a hidden service and receive payment 
on address they control. Deanonymization that exploit such tech- 
niques have be practice in the wild by government to uncover 
illegal hidden service [10]. The adversary can also map collect 
Bitcoin address to IP address in order to deanonymize user at 
a more granular level [21]. 

In this work, due to ethical concerns, we simulated only a passive, 
limited adversary. However, active, local adversary that be well- 
fund be likely to exist in practice. We note that the success rate 
achieve by a passive, limited adversary represent a low bound 
of that of an active, local adversary. 

4.2 Implications 
The main security implication of our work be that a Bitcoin ad- 
dress can be exploit to deanonymize users. The experiment we 
conduct can be extend to include other online social network 
and information sources. It be also likely that an online identity, 
or a user account, on one social network have link to others net- 
work that provide additional PIIs. Some user explicitly reveal 
their name, age, nationality, and other information in their bio or 
through posts. This represent a serious threat to their anonymity, 
since the hidden service they engage with might be associate 
with questionable transactions. The link process can also be 
use a a tool by third-parties to track users, perform surveillance, 
and audit financial transactions. 

Due to these security and privacy concerns, user have to fol- 
low simple yet effective guideline in order to protect themselves. 
First, user should never expose their Bitcoin address along with 
their personally identifiable information. Second, a discuss in 
Satoshi’s white paper [29], a new address should be generate for 
each transaction in order to reduce linkability of transactions, re- 
gardless of whether the user be the sender or the receiver of the 
payment. This be especially true for case where user expose a 
donation address on different kind of online social networks. Un- 
fortunately, a large number of user do not follow this practice, 
possibly due to poor usability of Bitcoin tools, unfamiliarity of 
Bitcoin internals, or reliance on third-party wallet and exchange 
service [22]. 

4.3 Limitations 
Ourwork have twomain limitations. First, in our analysis, we assume 
that link a user, represent a an online identity, to a hidden 
service be sufficient to deanonymize the user. However, this be not 
always true. Users can always create fake online identity in order 
to hide their real ones. While do so improves their anonymity, 
once the link be establish the adversary can perform online 
surveillance to track down the user and uncover their true identi- 
ties. The second limitation be related to the use of mix services. 
While the wallet-closure cleaning process we use eliminates the 
effect of mixing, it be aggressive and can exclude user who do not 
use mix service at all. Accordingly, our result under estimate 
the prevalence of the deanonymization threat. 

It be important to mention that some of the link user through 
this analysis be not concerned about their transaction anonymity 
to service such a Internet Archives. However, some user be 

unconscious about protect their privacy, and this type of analysis 
can be use to incriminate these users. For example, service such 
a The Pirate Bay be illegal in Sweden, and therefore, establish 
a link through a transaction with such a service could potentially 
be use a an evidence to accuse the user of illegal activities. 

Onemight argue that the number of deanonymized user be small. 
However, in order to understand the significance of the results, it 
be useful to put the number into perspective. According to recent 
web statistic [31, 36], the number of worldwide Internet user be 
around 3.58 billion and the number of Tor network user be about 3 
million, which be a superset of Tor hidden service users. Thismeans 
that 0.086% of Internet user be Tor network users, on average. 
The datasets we collect include 45,153 Twitter and BitcoinTalk 
users, out of which 0.277% of them be deanonymized. While this 
percentage be large than 0.086%, likely due to bias sampling, it be 
still relatively small, a expected. In other words, because we do not 
know how many of the user in the datasets be Tor hidden service 
users, we should expect that only a small percentage of them can 
be deanonymized. 

4.4 Countermeasures 
There be two general way to achieve improve anonymity for 
user and hidden services. The first one be operational, and it focus 
on follow Bitcoin best practices, a discuss in Section 4.2. For 
those user who can be linked, the best course of action for them 
be to clean their social network footprint, focus on remove 
PII that be publicly share or delete their link online identities, 
all together. The second way to improve anonymity be technical, 
and it involves improvement to the current Bitcoin protocol or the 
introduction of new crypto-currencies that be base on Bitcoin’s 
Blockchain technology. 

Second generation anonymization techniques, such a CoinJoin, 
Fair Exchange [18], CoinSwap, and stealth address have be 
propose to be implement a extension or service for Bitcoin’s 
original protocol. These be discuss in detail in [28]. Furthermore, 
other alternative coin base on different modification to Bitcoin 
protocol have be introduce to provide additional anonymity 
for transaction on the Blockchain. The most prominent of them 
beingMonero, which be base on Crypto Note v2.0 protocol [34] and 
Zcash [35]. In fact, Monero be alreadymaking it way into the hidden 
service of the Dark Web [37]. These new coin aim to deliver full 
anonymity of transactions, and have their own advantage and 
disadvantage compare to Bitcoin. 

5 RELATEDWORK 
There be a number of study that investigate user anonymity and 
privacy concern in Bitcoin [15, 16, 25, 32]. Fergal and Martin [32] 
demonstrate that use passive analysis of publicly-available Bit- 
coin information can lead to a serious information leakage. They 
construct two network represent transaction and user from 
the Blockchain. Integrating these network with off-network infor- 
mation, such a user profile from online social networks, and con- 
text discovery and flow analysis techniques, it be possible to study 
the flow of Bitcoins between address and investigate thefts. Fleder 
et al. [16], on the other hand, explore the level of anonymity in the 
Bitcoin network. The author annotate the transaction graph by 

9 



, , Husam Al Jawaheri, Mashael Al Sabah, Yazan Boshmaf, and Aimen Erbad 

link user pseudonym to online identity collect from online 
social networks. They also developed a graph-analysis framework 
to summarize and cluster the activity of users. The analysis link 
identity of user to their transactions. These study form the base 
for our approach, a we use some of their technique in our analysis. 
The difference in our study be that we target a specific portion of 
Bitcoin users, which be Tor hidden service users. We also study the 
economic activity of link hidden services, which be important 
to understand the level of threat the user be expose to. 

DuPont and Squicciarini [15] propose a technique to determine 
a Bitcoin user’s physical location by examine user spending habit 
and link it to the user’s time zone. Androulaki et al. [1] study 
the privacy provision in Bitcoin through a simulation mimic 
the use of Bitcoin a the digital currency for daily transaction in 
a typical university setting. The study show that behavior-based 
cluster can unveil the profile of 40% of Bitcoin user even if 
they be use recommend privacy measures. This method can 
be use with our technique to increase the deanonymization level 
from an online identity to a physical identity. 

A recent study by Harrigan and Fretter [17] show the effective- 
ness of address cluster use the Blockchain of Bitcoin. These 
cluster be construct use different heuristic such a the one 
we use in our study. The author perform address cluster on 
the entire Bitcoin’s Blockchain and show that despite the exis- 
tence of CoinJoin and mixed transactions, address cluster be still 
suitable for Blockchain analysis and re-identification attacks. The 
finding present in their work strengthen our analysis result 
and further prof that our link to hidden service be still valid 
until the current time. 

6 CONCLUSION 
We show that use Bitcoin a a payment method for Tor hidden ser- 
vice leak information that can be use to deanonymize their users. 
This represent a serious threat to these users, because they actively 
seek to maintain their anonymity by use Tor. The deanonymiza- 
tion be mainly due to the lack of retroactive operational security 
present in Bitcoin’s pseudonymity model. In particular, by inspect- 
ing historical transaction in the Blockchain, an adversary can link 
users, who publicly share their Bitcoin address on online social 
networks, with hidden services, which publicly share their Bitcoin 
address on their onion land pages. 

In a real-world experiment, we be able to link many user 
of Twitter and the BitcoinTalk forum to various hidden services, 
include WikiLeaks, Silk Road, and The Pirate Bay. Using informa- 
tion from their public user profiles, we be able to show concrete 
case study where the anonymity of the user be broken. Our result 
have one immediate implication: Bitcoin address should always be 
assume compromise a they can be use to deanonymize users. 

ACKNOWLEDGEMENT 
We would like to thank Hasan Al Jawaheri, Ryan Riley, and Jaideep 
Srivastava for their help and feedback. The first author would like 
to thank Qatar University for a generous research assistantship. 

REFERENCES 
[1] Elli Androulaki, Ghassan O. Karame, Marc Roeschlin, Tobias Scherer, and Srdjan 

Capkun. 2013. Evaluating User Privacy in Bitcoin. Springer Berlin Heidelberg, 

Berlin, Heidelberg, 34–51. 
[2] Daniel Arp, Fabian Yamaguchi, and Konrad Rieck. 2015. Torben: A practical 

side-channel attack for deanonymizing tor communication. In Proceedings of the 
10th ACM Symposium on Information, Computer and Communications Security. 
ACM, 597–602. 

[3] Alex Biryukov and Ivan Pustogarov. 2015. Bitcoin over Tor isn’t a Good Idea. In 
2015 IEEE Symposium on Security and Privacy, SP 2015, San Jose, CA, USA, May 
17-21, 2015. 122–134. 

[4] Alex Biryukov, Ivan Pustogarov, Fabrice Thill, and Ralf-Philipp Weinmann. 2014. 
Content and Popularity Analysis of Tor Hidden Services. In 34th International 
Conference on Distributed Computing Systems Workshops (ICDCS 2014 Workshops), 
Madrid, Spain, June 30 - July 3, 2014. 188–193. 

[5] Bitcoin.org. n.d.. Bitcoin Core. (n.d.). https://bitcoin.org/en/bitcoin-core/ 
[6] Bitpay. 2016. Bitcore Node. (Oct 2016). https://github.com/bitpay/bitcore-node 
[7] Bitpay. 2016. Insight-API. (Jul 2016). https://github.com/bitpay/insight-api 
[8] Michael del Castillo. 2016. Bitcoin Remains Most Popular Digital Currency on 

Dark Web. CoinDesk. (2016). 
[9] Nicolas Christin. 2013. Traveling the Silk Road: A measurement analysis of a 

large anonymous online marketplace. In Proceedings of the 22nd international 
conference on World Wide Web. ACM, 213–224. 

[10] Amanda Cochran. 2013. What be allege Silk Road mastermind’s "fatal flaw"? 
Find out how FBI tracked him down. (Oct 2013). 

[11] Anthony Cuthbertson. 2015. Bitcoin now accepted by 100,000 merchant world- 
wide. International Business Times. (2015). 

[12] Roger Dingledine. 2012. Using Tor Hidden Services for Good. The Tor Project. 
(2012). 

[13] Roger Dingledine. 2014. Tor security advisory: “relay early” traffic confirmation 
attack. The Tor Project. (2014). 

[14] Roger Dingledine, Nick Mathewson, and Paul Syverson. 2004. Tor: The Second- 
Generation Onion Router. In Proceedings of the 13th USENIX Security Symposium. 
303–320. 

[15] Jules DuPont and Anna Cinzia Squicciarini. 2015. Toward De-Anonymizing 
Bitcoin by Mapping Users Location. In Proceedings of the 5th ACM Conference on 
Data and Application Security and Privacy (CODASPY ’15). ACM, New York, NY, 
USA, 139–141. https://doi.org/10.1145/2699026.2699128 

[16] Michael Fleder, Michael S Kester, and Sudeep Pillai. 2015. Bitcoin transaction 
graph analysis. arXiv (2015). 

[17] Martin Harrigan and Christoph Fretter. 2016. The Unreasonable Effec- 
tiveness of Address Clustering. In Ubiquitous Intelligence & Computing, Ad- 
vanced and Trusted Computing, Scalable Computing and Communications, 
Cloud and Big Data Computing, Internet of People, and Smart World Congress 
(UIC/ATC/ScalCom/CBDCom/IoP/SmartWorld), 2016 Intl IEEE Conferences. IEEE, 
368–373. 

[18] Danushka Jayasinghe, Konstantinos Markantonakis, and Keith Mayes. 2014. 
Optimistic Fair-Exchange with Anonymity for Bitcoin Users. In e-Business Engi- 
neering (ICEBE), 2014 IEEE 11th International Conference on. IEEE, 44–51. 

[19] Amin Kharraz, William Robertson, Davide Balzarotti, Leyla Bilge, and Engin 
Kirda. 2015. Cutting the gordian knot: A look under the hood of ransomware 
attacks. In International Conference on Detection of Intrusions and Malware, and 
Vulnerability Assessment. Springer, 3–24. 

[20] Paul Kimayong. 2016. New Family of Ransom Locker Found, Uses TOR Hidden 
Service. https://goo.gl/a8Erio. (2016). 

[21] Philip Koshy, Diana Koshy, and Patrick Mcdaniel. 2014. An Analysis of 
Anonymity in Bitcoin Using P2P Network Traffic. Financial Cryptography 
and Data Security Lecture Notes in Computer Science (2014), 469–485. https: 
//doi.org/10.1007/978-3-662-45472-5_30 

[22] Katharina Krombholz, Aljosha Judmayer, Matthias Gusenbauer, and Edgar 
Weippl. 2016. The other side of the coin: User experience with bitcoin se- 
curity and privacy. In International Conference on Financial Cryptography and 
Data Security. Springer, 555–580. 

[23] MoserM. 2013. Anonymity of bitcoin transactions: An analysis of mix services. 
Munster Bitcoin Conference (2013). 

[24] Nick Mathewson. 2014. Some Thoughts on Hidden Services. The Tor Project. 
(2014). 

[25] Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kirill Levchenko, Damon 
McCoy, Geoffrey M. Voelker, and Stefan Savage. 2013. A Fistful of Bitcoins: 
Characterizing Payments Among Men with No Names. In Proceedings of the 2013 
Conference on Internet Measurement Conference (IMC ’13). ACM, New York, NY, 
USA, 127–140. https://doi.org/10.1145/2504730.2504747 

[26] Vincent Van Mieghem and Johan Pouwelse. 2015. Anonymous online purchase 
with exhaustive operational security. CoRR abs/1505.07370 (2015). http://arxiv. 
org/abs/1505.07370 

[27] Daniel Moore and Thomas Rid. 2016. Cryptopolitik and the Darknet. Survival 
58, 1 (2016), 7–38. 

[28] Malte Möser and Rainer Böhme. 2017. Anonymous Alone? Measuring Bitcoin’s 
Second-Generation Anonymization Techniques. In 2017 IEEE European Sympo- 
sium on Security and Privacy Workshops (EuroS&PW). 32–41. 

10 

https://bitcoin.org/en/bitcoin-core/ 
https://github.com/bitpay/bitcore-node 
https://github.com/bitpay/insight-api 
https://doi.org/10.1145/2699026.2699128 
https://goo.gl/a8Erio 
https://doi.org/10.1007/978-3-662-45472-5_30 
https://doi.org/10.1007/978-3-662-45472-5_30 
https://doi.org/10.1145/2504730.2504747 
http://arxiv.org/abs/1505.07370 
http://arxiv.org/abs/1505.07370 


Deanonymizing Tor Hidden Service Users Through Bitcoin Transactions Analysis , , 

[29] Satoshi Nakamoto. 2008. Bitcoin: A peer-to-peer electronic cash system. (2008). 
[30] The Tor Project. 2015. A Hidden Service Hackfest: The Arlington Accords. Tor. 

(2015). 
[31] The Tor Project. 2017. Tor Metrics Portal. https://metrics.torproject.org. (2017). 
[32] Fergal Reid and Martin Harrigan. 2013. Security and Privacy in Social Networks. 

Springer New York, New York, NY, Chapter An Analysis of Anonymity in the 
Bitcoin System, 197–223. https://doi.org/10.1007/978-1-4614-4139-7_10 

[33] Mikael Ricknäs. 2017. Pirate Bay Appeals Looks Set to Start in September. 
http://www.pcworld.com/article/191304/article.html. (2017). 

[34] Nicolas van Saberhagen. 2013. Crypto Note v 2.0. Cryp to Note (2013). 
[35] E. B. Sasson, A. Chiesa, C. Garman, M. Green, I. Miers, E. Tromer, and M. Virza. 

2014. Zerocash: Decentralized Anonymous Payments from Bitcoin. In 2014 IEEE 
Symposium on Security and Privacy. 459–474. https://doi.org/10.1109/SP.2014.36 

[36] Statista. 2017. Number of internet user worldwide from 2005 
to 2017. (July 2017). https://www.statista.com/statistics/273018/ 
number-of-internet-users-worldwide 

[37] Kyle Torpey. 2016. Darknet Customers Are Demanding Bitcoin Al- 
ternative Monero. (August 2016). http://www.nasdaq.com/article/ 
darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 

[38] Twitter. 2016. Gnip Decahose: Real-Time Trend Detection and Discovery. (2016). 
https://gnip.com/realtime/decahose/ 

[39] Joe Van Buskirk, Sundresan Naicker, Amanda Roxburgh, Raimondo Bruno, and 
Lucinda Burns. 2016. Who sell what? Country specific difference in substance 
availability on the Agora cryptomarket. International Journal of Drug Policy 35 
(2016), 16–23. 

[40] Aaron van Wirdum. 2016. CoinJoin: Combining Bitcoin Transactions to Obfus- 
cate Trails and Increase Privacy. https://goo.gl/LwT5u1. (2016). 

A APPENDIX 
In what follows, we present a high-level analysis of the economic ac- 
tivity involve all hidden service from the hiddenServices dataset. 

A.1 Volume 
Figure 2 show the CDF of the total volume from all services, a 
define in Section 3.6.3. We can see from the figure that 10% or less 
hidden service have more than 1,000 transactions. This complies 
with our previous result show that most of the transaction 
from twitterUsers and forumUsers datasets be attribute to the 
top 4–5 hidden services, in term of volume. 

A.2 Money Flow 
The money flow in and out of hidden service address be almost 
identical, so be the correspond money flow CDFs. Figure 3 show 
the CDF of the total incoming Bitcoins receive by all services. As 
the figure shows, only the top 10% of hidden service have receive 
more than 100B. The distribution be relatively skewed due to the 
fact that the top-3 service have significantly big revenue, with 
more than 4,000B. 

A.3 Lifetime 
Figure 4 show the percentage of hidden service that be active 
during the period 2011–2017. As denote by the figure, most of these 
service be active during the year 2014–2015, which be the same 
time frame we base our data collection period on. Furthermore, a 
expected, the activity for their address be significantly low in 
the follow years. This be most likely due to the usage of online 
wallet or their migration to other cryptocurrencies, a discuss 
in Section 4. 

0 

0.2 

0.4 

0.6 

0.8 

1 

0 5 10 15 20 25 

Volume (thousands) 

Figure 2: Number of transaction of hidden service 

0 

0.2 

0.4 

0.6 

0.8 

1 

0 5 10 15 20 25 30 

Incoming Bitcoins (thousands) 

Figure 3: Money flow for hidden service 

0% 

20% 

40% 

60% 

80% 

100% 

2011 2012 2013 2014 2015 2016 2017 

A 
ct 

iv 
e 

hi 
dd 

en 
s 

er 
vi 

ce 
s 

Year 

Figure 4: Lifetime of hidden service 

11 

https://doi.org/10.1007/978-1-4614-4139-7_10 
https://doi.org/10.1109/SP.2014.36 
https://www.statista.com/statistics/273018/number-of-internet-users-worldwide 
https://www.statista.com/statistics/273018/number-of-internet-users-worldwide 
http://www.nasdaq.com/article/darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 
http://www.nasdaq.com/article/darknet-customers-are-demanding-bitcoin-alternative-monero-cm671031 
https://gnip.com/realtime/decahose/ 

Abstract 
1 Introduction 
2 Background 
2.1 Bitcoin 
2.2 Tor Hidden Services 

3 Approach and Experiment 
3.1 Overview 
3.2 Adversary Model 
3.3 Ethical Considerations 
3.4 Data Collection 
3.5 Wallet-Closure Analysis 
3.6 Bitcoin Transaction Analysis 

4 Discussion 
4.1 Feasibility 
4.2 Implications 
4.3 Limitations 
4.4 Countermeasures 

5 Related Work 
6 Conclusion 
References 
A Appendix 
A.1 Volume 
A.2 Money Flow 
A.3 Lifetime 



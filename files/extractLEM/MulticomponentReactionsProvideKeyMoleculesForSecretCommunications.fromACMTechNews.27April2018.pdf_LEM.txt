


















































































Multicomponent reaction provide key molecule for secret communication 


ARTICLE 

Multicomponent reaction provide key molecule 
for secret communication 
Andreas C. Boukis1, Kevin Reiter 2, Maximiliane Frölich1, Dennis Hofheinz3 & Michael A.R. Meier 1 

A convenient and inherently more secure communication channel for encode message via 

specifically design molecular key be introduce by combine advanced encryption 

standard cryptography with molecular steganography. The necessary molecular key require 

large structural diversity, thus suggest the application of multicomponent reactions. 

Herein, the Ugi four-component reaction of perfluorinated acid be utilized to establish an 

exemplary database consist of 130 commercially available components. Considering all 

permutations, this combinatorial approach can unambiguously provide 500,000 molecular 

key in only one synthetic procedure per key. The molecular key be transfer nondigitally 

and conceal by either adsorption onto paper, coffee, tea or sugar a well a by dissolution 

in a perfume or in blood. Re-isolation and purification from these disguise be simplify by the 

perfluorinated sidechains of the molecular keys. High resolution tandem mass spectrometry 

can unequivocally determine the molecular structure and thus the identity of the key for a 

subsequent decryption of an encode message. 

DOI: 10.1038/s41467-018-03784-x OPEN 

1 Laboratory of Applied Chemistry, Institute of Organic Chemistry (IOC), Karlsruhe Institute of Technology (KIT), Straße be Forum 7, Karlsruhe 76131, 
Germany. 2 Institute of Nano Technology (INT), Karlsruhe Institute of Technology (KIT), Hermann-von-Helmholtz-Platz 1, Eggenstein-Leopoldshafen 76344, 
Germany. 3 Institute for Theoretical Informatics (ITI), Karlsruhe Institute of Technology (KIT), Am Fasanengarten 5, Karlsruhe 76131, Germany. 
Correspondence and request for material should be address to M.A.R.M. (email: m.a.r.meier@kit.edu) 

NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 1 

12 
34 

56 
78 

9 
0 
() 
:,; 

http://orcid.org/0000-0002-7494-021X 
http://orcid.org/0000-0002-7494-021X 
http://orcid.org/0000-0002-7494-021X 
http://orcid.org/0000-0002-7494-021X 
http://orcid.org/0000-0002-7494-021X 
http://orcid.org/0000-0002-4448-5279 
http://orcid.org/0000-0002-4448-5279 
http://orcid.org/0000-0002-4448-5279 
http://orcid.org/0000-0002-4448-5279 
http://orcid.org/0000-0002-4448-5279 
mailto:m.a.r.meier@kit.edu 
www.nature.com/naturecommunications 
www.nature.com/naturecommunications 


In the digital age, data security, in all it facet from every dayapplications via professional environment to espionage, be ofutmost importance. Although ultimate security will never be 
reached, a constant progress and improvement of cryptography 
and steganography, both evolve with the need and possibility 
of new technology on the one hand and the steady increase of 
the capability of adversary on the other hand, be required. 
A core task of cryptography be encryption, i.e., to convert 
message into unintelligible ciphertexts that can only be 
decrypt by a receiver who posse a dedicate decryption key. 
Steganography, in contrast, hide the fact that a message 
(encrypted or not) be be transmitted. For a high degree of 
security, decryption key can be conceal by steganography, i.e., 
via chemicals1–3 

The idea to use chemical for secret communication date back 
to ancient time when secret ink be first applied4. Today, more 
sophisticated method be discuss for data encryption, such a 
fluorescent materials5–11 or multi-analyte fluorescent molecular 
sensors1, 12–14. Furthermore, DNA be exploit for secure com- 
munication15–19. Molecular logic gates20–25, molecular compute 
systems26–28, and system base on authorize password 
entries29–38 also contribute to this field. Other approach utilized 
NMR chemical shifts39, microorganism colonies40, antibodies41, 
3D photonic crystals42, and molecular tag (equipped with halogen 
substitute aromatic sidechains) serve a barcodes for the 
identification of chemical library via gas chromatography43. 

Considering cryptography, state-of-the-art symmetric encryp- 
tion schemes, like the Advanced Encryption Standard (AES, also 
know a Rijndael)44, Serpent, or Blowfish can protect data 
reliably, but require a secret key for their operation. This secret 
key must be know by both the encryptor and the decryptor, and 
should be chosen uniformly at random. Typically, secret key be 
short (e.g., 128 bits), but it be not a priori clear how encryptor and 
decryptor receive common secret keys. Popular method to dis- 
tribute secret key involve the use of asymmetric cryptography 
(e.g., use the Diffie-Hellman key exchange scheme, or a key 
transport mechanism base on an asymmetric encryption 
scheme, such as, RSA). The disadvantage of use asymmetric 
cryptography (besides be considerably less efficient than 
symmetric cryptography) be that state-of-the-art asymmetric 
encryption scheme require specific algebraic structures, and thus 
may potentially be more prone to a structure cryptanalysis. 

However, hiding of the secret key via steganography (e.g., via 
chemicals) can introduce an additional level of security. Even if 
the number of know chemical compound be tremendously large 
and steadily growing, their application a molecular key be lim- 
ited consider certain requirements: First, a systematic synth- 
esis methodology should be apply provide molecule with a 
high level of structural complexity. Moreover, simple, robust, and 
reproducible procedure should be used. Finally, the product 
should be thermally and chemically a inert a possible and be 
design for simple isolation, purification, and analysis. 

Multicomponent reaction (MCR) represent highly suitable 
synthetic tool to provide molecular keys, fulfil these criteria. 
In a MCR, three or more precursor component be combine to 
one reaction product, contain moiety of all precursors45, 46. 
In the field of MCRs, the Ugi reaction be appealing, because four 
component be combine to a single product in a straightfor- 
ward one-pot reaction47. In the Ugi reaction (see Fig. 1a and 
Supplementary Figure 1 for the reaction mechanism), an 
aldehyde (green) reacts with an amine (orange), a carboxylic acid 
(blue), and an isocyanide (red) to from a bis-amide Ugi product 
display four individually define sidechains (R1–4, introduce 
by the four start components). Variation of the precursor 
component creates molecular diversity with minimal synthetic 
effort48–50. 

Herein we report a mean to advance chemical communication 
system (including the inspire work of Margulies et al.1), via a 
secret communication channel base on molecular keys, which 
can be easily hidden in various media, transfer nondigitally1, 
isolated via F-tags and unambiguously read out via ESI-MS/MS 
(one of the most developed and sensitive analytical techniques). 
In our system, the well-established AES algorithm be combine 
with an effective hiding and transportation of the encryption key. 
The latter consists of systematically select and tailor-made 
molecule that can be transport in a conceal fashion via a 
non-digital channel. 

Results 
Design and synthesis of molecular keys. For explore the 
synthetic potential of the Ugi reaction, an exemplary list of 
component (see Supplementary Data 1), include ten 
perfluorinated carboxylic acids, 50 aldehydes, 50 amines, and 
20 isocyanides, be designed. The component chosen for this 
database be commercially available and select in order to 
selectively react to the desire Ugi product (criteria list in the 
Methods section and illustrate in Supplementary Figure 1). 
This set of 130 component can potentially be combine to 
10 × 50 × 50 × 20= 500,000 different molecular keys. The number 
of component be only limited by the availability of component 
suitable for the Ugi reaction and can be extend easily beyond 
this set of commercially available compounds. The main function 
of the list of component be to assign chemical information 
(i.e., react component and side chain of the respective 
molecular keys) to alphanumerical code (i.e., systematic 
combination of letters, numbers, and special characters). For this 
purpose, a letter be give to a certain chemical functional 
group, and the different sidechains within the same category of 
functional group be count with arbitrary numbers, e.g., 
aldehyde → letter A, benzaldehyde →A(001), butyraldehyde →A 
(003), …; isocyanides → letter B, …). The list of component be 
highly flexible, because the alphanumerical assignment can be 
exchange or adjust if necessary. 

As proof of principle, a sub-library of different molecular key 
be synthesize by systematic variation of the different react 
components, utilize the Ugi reaction of perfluorinated acids. 
Considering molecular design, the molecular key be equip 
with a perfluorinated side chain (also call F-Tag), enable a 
highly simplify purification via fluorous solid phase extraction 
(F-SPE)51, 52. F-SPE can retain fluorous molecule selectively and 
hence separate the molecular key from organic contaminates 
and/or matrix materials. 

In Fig. 1, the variation of component be illustrate in a 3D plot 
for one of the apply perfluorinated acids. Each point represent a 
herein synthesized, distinct molecule. The coordinate be link 
to the component use and thus the sidechains of the molecular 
key. Two perform systematic component variations, unambigu- 
ously demonstrate the synthesis possibility with different 
components, be represent in the expansion (Fig. 1c, d). The 
molecular key be analyze via 1D and 2D nuclear magnetic 
resonance spectroscopy (NMR, see Supplementary Figure 2), high 
resolution mass spectrometry (HRMS) and infrared spectroscopy 
to confirm their structure and thus to demonstrate the viability of 
the present library design (synthetic procedure and analysis can 
be found in the Supplementary Methods). 

Our molecular key provide a robust steganographic channel that 
can be use to transport, i.e., cryptographic keys. The transmit 
key can hardly be recognized, because (i) an adversary do not 
know that a key be hidden in a molecule; (ii) only the recipient 
know where the molecular key be located/stored (i.e., adsorbed on 
paper, dissolve in perfume, etc., see below); (iii) information on 

ARTICLE NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x 

2 NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 

www.nature.com/naturecommunications 


how to extract and analyze the molecule, convert the chemical 
structure into digital information and apply the decryption be 
necessary; and (iv) since the key be transfer physically, an 
attacker cannot rely on compute power alone. 

Data storage capacity be admittedly much high for DNA than 
for synthetic molecules, which might change in the near future 
with the development of sequence define macromolecules53–55. 
The user can thus choose the appropriate system for the require 
application. Importantly, the molecular key be design for 
simplify purification utilize fluorous tags, a well a for 
straightforward characterization (tandem-MS), require only 
trace amount of the key at all stages. 

An exemplary way of key transmission be present in Fig. 2. 
The sender and recipient meet for the first time and exchange 
detail on how to secretly communicate in the future. They need 
to agree on how the molecular key will be transfer (e.g., 
adsorbed on paper, dissolve in a perfume, etc.), whether the 
decryption key will be fragment onto several molecular key 
(and if so how many individual molecular key will be used) in 
order to increase/adjust the require level of security. Addition- 
ally, the list of components, should be exchange and the 
analytical method be preselected. These initially communicate 
detail should remain secret, however, if an adversary reveals one 
or some of the discuss details, he be still not able to decrypt the 
message without know the other information and most 
importantly the molecular keys. 

Coding, transportation, and isolation of molecular key. The 
encryption of secret documents/files (examples include in 

Supplementary Data 2) be perform by an independent state-of- 
the-art symmetric encryption algorithm such a AES (herein a 
random 128-bit AES key). Currently, people, organizations, 
military, and government benefit from AES encryption for 
protecting, e.g., classify information, email communication, 
opening Virtual Private Network (VPN) tunnel for secure 
internet connections, online banking, or secure file transfer pro- 
tocols such a Hypertext Transfer Protocol Secure (HTTPS). 
However, the molecular key strategy offer a universal stegano- 
graphic channel, and be not limited to AES applications, therefore 
opening new perspective for every symmetric encryption 
scheme. The ciphertexts be transfer conventionally in a digital 
channel (e.g., via email or even share publicly) or in a traditional 
letter. Decrypting encrypt data without the correspond key 
be infeasible with key of sufficient entropy. The respective 
encryption key be conceal in molecular key and transport 
non-digitally via a steganographic chemical channel (Fig. 2a) (see 
below for transfer examples). The cryptographic digital channel 
can, in principle, transmit data of any size. The steganographic 
channel for the molecular key be small in term of data size and 
utilized for key distribution exclusively. If the herein present list 
of component be accessible for the adversary, there be still 
500,000 possible combination (~18 bits). For high level of 
security, the AES encryption key can be fragment and 
transfer onto several molecular keys, which be transfer 
independently (spatially- or time-displaced, e.g., the first 
molecular key be transfer underneath the stamp, the 
second one in the top left corner of the letter, and third one be 
include in a perfume, etc.). Thus, if six molecular key be 
utilized, the key size equal ~113 bit (100 bit be consider 

Carboxylic acid 
10 

a c 

d 

b 

R1 
R1 

R2 
R2 

R3 
R3 

R 
3 

R 
4 

R 
4 

R 
2 

R 
2 

R 
3 

R4 
R4 

O 

OH 

F3C OH 

F 

F F F F F F F F 
5 

F F F F F O 

H O 

C 
– 

N 
+ 

C 
– 

N 
+ 

C 
– 

N 
+ 

NH 
2+ + + 

Amine 
50 

Aldehyde 
50 

Isocyanide 
20 

One-pot 

C-Terminus 

Bis-amide Ugi product 
500,000 combinations/molecules 

O 

O 

H 

N 
N 

N-Terminus 

A 
ldehyde [arbitrary num 

ber] 

A 
ldehyde [arbitrary num 

ber] 

A 
ldehyde [arbitrary num 

ber] 

Amine [arbitrary number] 

Amine [arbitrary number] 

Amine [arbitrary number] 

Iso 
cya 

nid 
e [a 

rbit 
rar 

y n 
um 

ber 
] 

Iso 
cya 

nid 
e [a 

rbit 
rar 

y n 
um 

ber 
] 

Iso 
cya 

nid 
e [a 

rbit 
rar 

y n 
um 

ber 
] 

22 

50 

45 

40 

35 

30 

25 

20 

15 

10 

5 

(15,3,22) 

(1,1,2) 
(2,1,2) 

(2,3,3) 

(2,3,2) 

(3,1,2) 

(2,3,1) 
(3,3,1) 

(3,2,1) 
(3,1,1) 

(18,3,22) 

(15,3,21) 

(15,3,20) 
(15,4,20) 

(15,5,20) 
(15,6,20) 

(16,3,20) 
(17,3,20) 

(18,3,20) 

22 

21 

20 

O 

O 

O 

O 

H 

H 

H 

H 

3 

2 

1 

NH2 
NH2 

NH2 NH2 

NH2 

NH2 

NH2 

NH 
2 

NH 
2 

3 NC 
NC 

NC 

NC 

NC 

NC 

3 

2 

1 

NC 

O O 

O 

4 

5 

6 

15 

16 
17 

18 

1 

2 

3 

H 

H 

H 

H 

HO 

O 

O 

O 

O 

O 

21 

20 

3 

2 

1 

15 

5 
10 15 

20 

25 30 

35 

40 

45 

50 

16 

17 

1 

2 

3 
18 

3 

201816 

2 

4 

6 
8 

10 
12 

14 

3 

2 

1 

4 

5 

6 

Fig. 1 Molecular keys. a Schematic representation of the Ugi reaction. The combinatorial scope of component consider in the exemplary list of 
component involves 500,000 molecules. b 3D plot of a set of molecule synthesize with perfluorononaic acid (shorter and longer acid be also 
evaluated). The ax represent different functional groups. The number on the ax represent different component (i.e., sidechains). c, d Expansions of 
the two systematic variation highlight by the red and blue box in b, respectively 

NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x ARTICLE 

NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 3 

www.nature.com/naturecommunications 
www.nature.com/naturecommunications 


sufficiently secure in cryptography). Additionally, such a key 
fragmentation increase the steganographic security level, since 
an adversary would have to intermit and decode each individually 
transfer molecular key. 

As a first transportation example, an envelope (representative 
for adsorption onto paper, see Fig. 3 and Supplementary Figure 3) 
be selected. A small quantity (4 mg) of the molecular key be 
dissolve in a minimal amount methanol and transfer onto 
the top right corner of the envelope with a pipet. After drying, the 
molecular key be adsorbed onto the large surface of the cellulose 
fibers, not traceable for the bare eye. For further protection and 
simple recognition of the area cover with the molecular key, a 
stamp (preferably self-adhesive) be place above the treat 
area. 

After the letter reach it destination, the cover area be cut 
into piece and extract with methanol and dichloromethane. 
Since the obtain material might contain impurity (which 
could interfere with late analysis), the molecular key be purify 
via F-SPE, further demonstrate the major advantage of the 
herein use F-tagged molecular keys. The molecular key be 
obtain in excellent purity and sufficient quantity for subsequent 
analysis (see Methods section). Alternatively, the molecular key 
be conceal and transport in a commercial perfume, 
adsorbed onto instant coffee powder, green tea, or on sugar 
(see Methods section for procedure and Supplementary Figure 3 
for pictures). To further demonstrate the robustness of our 
isolation protocol, a molecular key be hidden in and reisolated 
from a blood sample. If a cryptographic key cod in DNA or 
another biomacromolecule be to be hidden in blood, the 
ubiquitously present native DNA, proteins, nutrients, and many 
other component in this complex mixture can cause severe 

complication for the readout. Hence, these successful reisolation 
example clearly demonstrate the advantage of the herein 
present molecular keys. The present secret communication 
channel could be utilized by secret service agencies, for safe data 
transmission in company or the communication between 
individual or institution in a totalitarian state regime, to only 
name some scenario that require high level of security. 

Reading the molecular key via structure elucidation. Analytical 
chemistry offer a variety of method for the identification of the 
chemical compound and thus the readout of molecular keys. 
The molecular structure be unambiguously solve if the four 
sidechains (R1-4) be determined. In mathematic terms, a 
four-dimensional problem be solve consider four different 
parameters. The four parameter be obtain via four different 
molar mass from high resolution tandem mass spectrometry 
(the monoisotopic mass+ three fragments). Tandem mass spec- 
trometry (tandem-MS) can be apply universally, minimal 
sample preparation be necessary and the detection limit be very 
small, thus require only trace amount of substance to 
synthesize, transport and obtain the information. In Fig. 4, a 
representative tandem-MS spectrum be presented, wherein the 
symbol mark different specie (fragments or the intact molecule) 
utilized for evaluation. Fragment assignment determines the 
sidechains of the molecular key and decrypts the message. In an 
exemplary scenario, the sender would synthesize one or several 
molecular key and determine the alphanumeric code associate 
with the chemical structure accord to the list of components. 
In a particular case, the component perfluoropentanoic acid, 
4-methoxyphenylisocyanide, pentylamine, and benzaldehyde 

Information 

a 

b 

c 

Sender 

Sender 

TOP SECRET 

Secret 
message/data 

Know that 
secret 

communication 
be happen 

Know that the 
key be hidden 

within a 
molecule 

Know 
where to 
find the 

molecule 

Know how 
to isolate 
and purify 

Know how to 
analyze the 
molecule 

Have access 
to the list of 
component 

Know 
how to 
apply 

decode 

Decrypted 
message/data 

Encryption 
(AES, ...) 

Decryption 
(AES, ...) 

Encrypted 
ciphertext 

Encrypted 
ciphertext 

TOP SECRETDtxvpa4 
zcuqMP 
ExbuicH 

Dtxvpa4 
zcuqMP 
ExbuicH 

Key Key 

O 

O 

N 
N 

HR3 

R4R1 

R2 

Molecular key 

O 

O 

N 
N 

HR3 

R4R1 

R2 

Molecular structure 

Recipient 

Steganographic 
chemical channel 

Non-steganographic 
digital channel 

Recipient 

Sy 
nth 

e 
be 

An 
aly 

si 

List of component 

D12 

C32 

B5 

A1 
O 

CN 

O H 

R 

R 

R 

R 

NH 
2 

OH 

D12 

C32 

B5 

A1 
O 

CN 

O H 

R 

R 

R 

R 

NH 
2 

OH 

D12 

C32 

B5 

A1 
O 

CN 

O H 

R 

R 

R 

R 

NH 
2 

OH 

Fig. 2 Steganographic key distribution. a The sender and recipient discus detail about their secret communication and exchange the list of component 
(assigns chemical information to alphanumerical symbols). b from left to right: The sender synthesizes one or several molecular key and determines the 
alphanumeric code associate with the chemical structure accord to the list of components. The alphanumeric code, e.g., A(001)-B(012)-C(007)-D(007) 
be serve a encryption key. The molecular key be conceal and transfer to the recipient via a steganographic channel. The recipient isolates the key 
and elucidates the molecular structure for decryption. c Levels of security and knowledge an adversary need for decrypt the message 

ARTICLE NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x 

4 NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 

www.nature.com/naturecommunications 


be chosen and convert into A(001)-B(012)-C(007)-D(007). 
This alphanumeric code be utilized to encrypt a message or data. 
The recipient isolates and analyzes a molecular key via ESI-MS 
and determines a m/z of 595.1615 Da for [M+Na]+. 
After enter this mass into the analysis script (Supplementary 
Software 1), the most probable molecule and their respective 
fragment be listed. Fragmenting the m/z= 595 Da specie via 
ESI-MS/MS generates characteristic fragment at m/z= 176.14 
and 106.06 Da, which be enter into the script and be sufficient 
information to identify the molecular structure of the molecular 
key (Fig. 4). Using the list of components, the correspond 
alphanumeric code can now be generate and utilized to decrypt 
the message/data (more example can be found in Supplementary 
Data 2). A detailed procedure on how to read out the molecular 
key be provide in the Methods section. Supplementary 
Data 2 contains three example of encrypt message and the 
tandem-MS spectrum of the molecular key for decryption. Upon 
identification of the prominent fragmentation patterns, the four 
fragment displayed in Fig. 5a be chosen for structure eluci- 
dation. In order to facilitate the readout, an analysis script 
(Supplementary Software 1) provide the most probable 
fragment after the exact mass of the molecule be entered. Since 
not every signal from the tandem-MS spectrum be require for the 
readout (unlabeled signal in Fig. 4), the analysis script be very 
useful for the readout. 

The monoisotopic mass be a valuable indication for the 
molecular structure. In Fig. 5b, a database analysis base on the 
list of component be displayed. The frequency of occur 
mass within a ΔM threshold of 0.01 Da (which be well within 
the accuracy of modern high-resolution mass spectrometer 
regard the investigate molecular weights) be displayed in a 
distribution plot (more detail in Supplementary Figure 4). It can 
be conclude that preselecting the monoisotopic mass reduces the 
number of remain possible molecule drastically (at least 
by three order of magnitude). With the fragment obtain 

via tandem-MS, the molecular structure be determine and 
transfer into alphanumerical code via the list of components. 
The alphanumerical code be enter into the molecular 
encryption script (Supplementary Software 2) for decryption of 
the sent message. As recommended, the final AES code can also 
be encode onto several molecular keys, which be transfer 
independently (separated spatially or time-wise). In the case 
of these fragment keys, the individual alphanumerical code of 
each molecular key be enter in the correspond sequence into 
the encryption script. 

In conclusion, the herein present molecular key strategy 
allows steganographic key distribution in combination with a 
flexible and adaptable data safety protocol. Molecular key with a 
data storage capacity of ~18 bit be synthesize in a one-pot 
reaction approach. The molecular structure be analyze by a 
combination of tandem-MS fragmentation and computer assist 
readout (analysis script, Supplementary Software 1). The 
respective structure serve a decryption key for AES encrypt 
message or data file (Supplementary Software 2). In principle, 
the herein present key could also be use for other 
applications, e.g., a identification or anti counterfeit tags. In 
future research, the investigation of molecular key with even 
high data storage capacity will be of great interest in order to 
overcome current limitation of the system. 

Methods 
Criteria for the list of components. For the list of component present in 
Supplementary Data 1, we decide to exclusively focus on commercially available 
components. In addition, only aldehyde be chosen a carbonyl specie because 
they be more reactive in Ugi reaction than ketones. However, the scope of 
carbonyl component report in literature be large (but if other functional group 
be introduce they first should be test for compatibility). The component need 
to fulfill certain requirement (graphically illustrate in Supplementary Figure 1c). 
The component should only carry one functional group that can participate in the 
Ugi reaction (i.e., a carboxylic and an aldehyde moiety should not be combine in 
the same precursor molecule, otherwise polymerization might occur). The 

R 
1 

R 
3 

R 
4 

O 

O 

N 
N 

H 

R 
2 

Fig. 3 Transportation and extraction of the molecular key. The encrypt message be exemplarily transfer in form of a letter. The molecular key be 
dissolve and place in the top right corner of the envelope and afterwards cover with a stamp. After the letter have be sent and received, the molecular 
key be extract with a solvent and purify by F-SPE to subsequently analyze the molecule and encrypt the message. Additional image be include in 
Supplementary Figure 3 

NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x ARTICLE 

NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 5 

www.nature.com/naturecommunications 
www.nature.com/naturecommunications 


component should not carry moieties, which be strongly redox sensible, photo- 
sensitive, or easily hydrolyze in the presence of protic solvent like methanol or 
water. In this context, we additionally exclude tert-butyl ester from our database 
because they be deprotected at low pH by trifluoracetic acid. Functional groups, 
which be know to cause side reaction with any other substance involve in the 
Ugi reaction, should also be avoided. In addition, phenolic hydroxyl group on 
electron-poor aromatic system (i.e., carry additional nitro substituents) should 
be avoid due to undesired side reaction (i.e., Ugi-Smiles where the acidic phenol 
act a acid component). Since the molecular key be design for tandem mass 
spectrometric analysis, the dataset for one component (same functional group) 
should not contain isomer (e.g., no aldehyde with the same molar mass). Isotope 
label component can be beneficial for MS purposes, but be also exclude from 
our database. Diastereomeric mixture of molecular key synthesize from racemic 
start component can be treat and utilized similar to stereomerically pure 
molecular key (a study comment on the influence of stereochemistry be 
include in Supplementary Methods). 

General synthetic procedure 
General procedure (GP1) for Ugi reactions: large scale, high efficiency. In a 25 mL 
round bottom flask the aldehyde (1.70 eq., typically 1 mmol) be dissolve in a 
minimal amount of methanol, subsequently the amine (1.70 eq.) be add and the 
result mixture be stir for 60 min over sodium sulfate for the imine for- 
mation (if both component be liquid, no methanol be need unless the imine 
would precipitate). The perfluoro acid (1.00 eq.) be dissolve in a minimal 
amount of methanol and add to the imine at room temperature. The result 
mixture be stir for 2 min. Subsequently, the isocyanide (1.70 eq.) be add to 

the stir mixture. The reaction be stir for 1–3 d at room temperature. If a 
precipitate be form during the reaction, additional methanol be added. If a 
long perfluorinated chain be present, tetrahydrofuran be utilized in order to 
homogenize the reaction mixture. The crude reaction mixture be dry under 
reduce pressure and purify via column chromatography (see General 
Purification Procedure: F-SPE). Typical yields: 20–85%. 

General procedure (GP2) for Ugi reactions: economic, small scale. In a 10 mL round 
bottom flask, the aldehyde (1.30 eq., typically 500 µmol) be dissolve in a minimal 
amount of methanol. Subsequently, the amine (1.30 eq.) be add and the 
result mixture be stir for 60 min over sodium sulfate. The perfluoro acid 
(1.00 eq.) be dissolve in a minimal amount of methanol and add to the imine 
at room temperature. The result mixture be stir for 2 min. Subsequently, 
the isocyanide (1.20 eq.) be add to the stir mixture. The reaction be stir 
for 3 d at room temperature. The crude reaction mixture be dry under reduce 
pressure and purify via column chromatography (see General Purification 
Procedure: F-SPE section). Typical yields: 2%–35%. The low yield compare 
to GP1 be most probably due a large excess of component and high 
concentration favor product formation for GP1. 

General purification procedure for F-SPE. For F-SPE separation, we suggest to 
utilize 1 g of perfluorinated silica gel per 50 mg of mixture subject (5% by 
weight). However, in literature high loading of 5%–15% by weight be reported. 

Step 1: Flush the perfluorinated silica gel with dimethylformamide (0.2 mL per g 
silica gel), gently apply positive pressure. 

700,000 

a 

b 

2000 

1000 

0 

440 441 442 443 444 445 446 447 448 449 450 

600,000 

500,000 

400,000 

R 
el 

at 
iv 

e 
ab 

un 
da 

nc 
e 

[a 
.u 

.] 

R 
el 

at 
iv 

e 
ab 

un 
da 

nc 
e 

[a 
.u 

.] 

300,000 

200,000 

100,000 

0 

50 

F 
2 

C 
C 
F2 

C 
F2 

O 

O 

O 

O 

O 

O 

O 

+ Na 

+ Na 

+ 

+ 

+ 

+ + 

+ 

+ 

N 

N 

H 
N 

N 

H 
N 

F 
3 
C 

F 
2 

C 
C 
F2 

C 
F2 

O 

+ NaN 

N 

N 

F 
3 
C 

F 
2 

C 
C 
F2 

C 
F2 

O 

+ NaN 
F 

3 
C 

100 150 200 250 300 350 

m/z [amu] 

m/z [amu] 

400 450 500 550 600 650 

Fig. 4 Readout of molecular key via tandem-MS. a exemplary ESI-MS/MS spectrum. b Proposed fragment assignment. The monoisotopic mass of the 
intact molecule (circle contain cross) be the first information that significantly reduces the number of possibilities. Additionally, three fragment be 
necessary to unambiguously determine the combination of components. The three fragment marked in the blue frame (black circle, white square 
contain black square, and black square) be utilized in the computer analysis script (Supplementary Software 1) for assist readout. The other 
fragment (black invert triangle, diamond cluster, and asterisk) further confirm the structure, but be not essential for a successful readout 

ARTICLE NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x 

6 NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 

www.nature.com/naturecommunications 


Step 2: Precondition the column with methanol/water (8:2) (3 mL per g silica 
gel). 

Step 3: Suspend the mixture to be purify in a minimal amount of 
dimethylformamide and load onto the precondition column. 

Step 4: Elute the organic fraction with 2 mL methanol/water (80:20) per g silica 
gel. We suggest fractionate into tube of appropriate size. 

Step 5: Elute with 4 mL methanol per g silica gel to collect the fluorous fraction. 
Note: For long chain perfluorinated compounds, additionally elute with the same 
amount of tetrahydrofuran/acetone (1:1). Again, fractionate into tube be 
desirable. TLC of the fraction indicates the complete elution of the desire 
compound. 

Step 6: In order to recycle the F-SPE silica gel, flush with acetone and 
tetrahydrofuran and air dry. We do not suggest reuse the same silica gel more 
than three times. 

After separation, the fraction be test for purity via TLC, combine and 
concentrate under reduce pressure. If unreacted perfluoro acid or residual 
dimethylformamide be present in the fluorous fraction, a short silica gel filter 
column, elute with c-hexane/ethyl acetate (3:1) be perform to yield the 
desire perfluorinated Ugi product. 

Note: For purify the molecular key extract from the various disguise 5 g 
of F-SPE silica gel be utilized. 

Hiding and isolate the molecular keys. The molecular key can be hidden in 
many creative ways. Since the molecular key be flouro-tagged compounds, they 
can easily be isolated from various type of surround media. The main 
requirement to the surround environment or the matrix material be the absence 
of any perfluorinated alkyl chains. Furthermore, the extraction of the molecular key 
should be possible with reasonable effort. 

The follow extraction example be perform with the molecular key 
A(005)-B(002)-C(004)-D(007). 

Adsorbed onto paper: 4.0 mg of the molecular key be dissolve in 0.5 mL 
methanol and subsequently transfer dropwise onto the top right corner of an 
envelope. Intermediately, the drop be quickly evaporate by gently blow-drying 
with a heat gun. For further protection and disguising, the stamp be place just 
above the cover area (see Supplementary Figure 3). For late extraction, the part 
of the paper doped with the molecular key (i.e., the area around the stamp) be cut 
into small piece and extract in an ultrasonic bath with 15 mL methanol for 15 
min three time and subsequently three time with 10 mL dichloromethane. 
The extract be combined, concentrate under reduce pressure, and purify via 
F-SPE. In this protocol 3.5 mg (90%) of the molecular key be recovered. 

Dissolved in a perfume: 4.0 mg of the molecular key be dissolve in 
0.5 mL ethanol and transfer into the same amount of a commercial perfume 

C -Terminus 
F O 

O 

O 

N 

N N 
N 

N 

N 

F 

F 

F 

H 

H 

F 
R2 

R2R 
2 

O 

O 

Molecular key 

Molecular key 

List of 
component 

ESI-MS 
All possible 

combination 
within ΔM 

AES, 
etc. 

Propose 
possible 

fragment 

Tandem- 
MS 

A(001)-B(005)- 
C(032)-D(012) 

Secret key/password 

Secret 
message/data 

Integrated in 
molecular 

encryption script 

Integrated in 
analysis script 

Encrypted 
ciphertext 

A(001)-B(005)- 
C(032)-D(012) 

For decryption 

N 

H 

N 

R3 

R4R1 

R2 

O 

O 

N 

H 

N 

R3 

R4R1 

R2 

R4 

R4 

R3 

R3 
R3R3 

R1 

Molecule contains: R1 + R2 + R3 + R4 

Fragment 1 
contains 

R2 + R3 + R4 

a 

c 

d 

b 

M = 123.4567 = 
R1+R2+R3+R4 

Fragment masses: 
R2+R3+R4 ⎮R2+R3 ⎮R3 

Fragment 2 
contains 
R2 + R3 

Fragment 3 
contains 

R3 

n 

N-Terminus 150 

100 

O 
cc 

ur 
in 

g 
fr 

eq 
ue 

nc 
y 

50 

0 
400 600 800 

Mass [g mol–1] 

1000 1200 1400 

D12 

C32 

B5 

A1 
O 

CN 

O H 

R 

R 

R 

R 

NH2 

OH 

D12 

C32 

B5 

A1 
O 

CN 

O H 

R 

R 

R 

R 

NH2 

OH 

TOP SECRET Dtxvpa4 
zcuqMP 
ExbuicH 

Fig. 5 Cryptography integration of molecular keys. a Schematic representation of fragments, which can be use for the read out. Four mass be 
use for determine the sidechains R1–4. b Database evaluation of the most probable mass occur within a ΔM threshold of 0.01 Da. 
The possibility be reduce from 500,000 to a maximum of 140 after enter the monoisotopic mass. c Schematic illustration of molecular 
encryption. Supplementary Software 2. d Schematic illustration of analysis script. Supplementary Software 1. A function explanation be include in the 
method section. 

NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x ARTICLE 

NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 7 

www.nature.com/naturecommunications 
www.nature.com/naturecommunications 


(see Supplementary Figure 3). The result solution be more dilute than the initial 
perfume, but the dilution cannot be easily recognize by a change of appearance or 
smell. The molecular key prove too remain in solution for more than 14 days. It 
can be assumed, that the molecular key will not precipitate or phase separate 
(because a dilute system be used). For the extraction of the molecular key, the 
solution be evaporate under reduce pressure and subject to F-SPE. In this 
protocol, 3.7 mg (93%) of the molecular key be recovered. 

Adsorbed onto instant coffee powder, tea, or sugar: 4.0 mg of the molecular key 
be dissolve in 0.5 mL dichloromethane and add dropwise onto 1 g of the 
substrate powder, each drop be place onto a different spot and allow to 
evaporate separately. For the extraction, the powder be ground with a mortar and 
stir three time in 5 mL dichloromethane for 3 min. The combine extract be 
and filter over celite® and wash with 10 mL water twice. The combine 
aqueous phase be reextracted with 5 mL dichloromethane twice. The combine 
organic phase be wash with 5 mL brine once, dry over sodium sulfate, 
evaporate under reduce pressure, and purify via F-SPE. Extraction yields: from 
instant coffee powder 3.4 mg (85%), from green tea 3.6 mg (90%), and from sugar 
3.4 mg (87%), of the molecular key be recovered. 

Note: For the extraction from sugar no further purification via F-SPE be 
necessary (fully water-soluble substrate). 

From blood: 5.0 mg of the molecular key be dissolve in 0.5 mL ethanol and 
concentrate under reduce pressure until a transparent film of the molecular key 
with a minimize amount of ethanol be obtained. 5 mL of pig blood be add 
into the vial and gently stir for 5 min. The blood should be store and 
transport under cooling. For the extraction, the blood be dilute with 10 mL 
water and extract with 20 mL dichloromethane three time (after the second 
extraction an emulsion be formed, hence the second and third organic extract 
be combine and treat separately). The organic extract be wash 
separately with 10 mL water twice. The organic phase be dry over sodium 
sulfate (emulsion broke upon drying), evaporate under reduce pressure, and 
purify via F-SPE. In this protocol, 4.5 mg (91%) of the molecular key be 
recovered. 

Note: The extraction from blood be intend to demonstrate a challenge 
extraction example for the herein present F-tagged molecular key from complex 
biological media. Extraction from biological medium would be far more challenge 
for cryptographic key encode in DNA or other biomolecules. The author also 
want to clearly state that it be unethical to transport molecular key in living 
organisms. 

For MS analysis, even small amount of substance be require so in principle 
a low concentration of the molecular key could be employed. However, the 
herein obtain mass of several milligram be sufficient to further conduct TLC, 
GC-MS and NMR experiment for purity determination. GC-MS evidence a 
purity of 99%, see Supplementary Figure 5, further indicate successful extraction 
and purification. After the molecular key have be isolated and purified, (tandem-) 
MS-spectra be obtain and hence the molecular key can be decrypted. 

General extraction procedure. If the molecular key be adsorbed on a solid sup- 
port, we propose to extract with dichloromethane several time (at least three) in 
order to fully recover the molecular key. Subsequently, the dichloromethane extract 
be wash with water and purify via F-SPE. If the molecular key be transport in 
solution, we propose concentration, and liquid/liquid extraction with dichlor- 
omethane and water. The combine organic layer be dry prior to F-SPE. 

Analyzing the molecular key via tandem-MS. First, the molecular key need to 
be located, isolated, and purified. Subsequently, ESI-MS provide the monoisotopic 
mass (full scan mode 200–2000 m/z), which be use in the computer assist 
readout (analysis script, Supplementary Software 1) to determine the most prob- 
able structures. The predominant signal arise from the intact molecule+ sodium: 
[M+Na]+ and two molecules+ sodium: [2 M+Na]+ (see Supplementary Fig- 
ure 6). The sodium be introduce by utilize a doped solvent mixture during the 
ESI sample preparation. 

The next step towards the analysis of a molecular key be to isolate the 
[M+Na]+ m/z peak and further fragment the molecule. It prove to be most 
efficient to start with mild condition (low fragmentation energy) and successively 
move on to high fragmentation energy level (see Supplementary Figure 7). For 
the first evaluation, a spectrum with many fragment peak occur in a wide 
range of molar mass (high information density) should be chosen and regard 
in detail (i.e., 30 eV in Supplementary Figure 7 provide a high information density, 
since many fragment can be observe and in addition the unfragmented molecule 
at 595m/z be still present). However, the chosen energy should be a low a possible 
in order to avoid the further fragmentation of fragments. Furthermore, the 
observation of heavier/larger fragment specie be more likely for low 
fragmentation energies. In Supplementary Figure 7 the respective spectrum at 
30 eV be displayed, the correspond fragment evaluation can be found in the table 
below. As demonstrate in the evaluation, it be possible to observe numerous 
fragment and hence the information require for structure elucidation from one 
single spectrum. 

However, in some cases, two tandem-MS spectrum at different fragmentation 
energy be necessary to observe enough relevant fragments. In Supplementary 
Figure 8, two tandem-MS spectrum of the same specie (731m/z) record at 35 eV 

(a) and at 50 eV (b) collision energy be displayed. The heavier fragment indicate 
by the diamond cluster and asterisk can only be observe in the 35 eV energy 
spectrum (a, expansion). The lighter fragment indicate by the black circle and 
left-pointing triangle can solely be observe in the 50 eV spectrum (b). The 
correspond fragment assignment be depict in the correspond table of 
Supplementary Figure 8. 

In addition, tandem-MS fragment analysis can distinguish between isomer 
(molecules with same mass but different structures). In Supplementary Figure 9a, 
two isomeric molecular key be displayed. These isomer cannot be simply 
distinguish by regard the molar mass of the intact molecule (right-pointing 
triangle) nor the isomer fragments. In fact, it be necessary to evaluate the lighter 
fragment (black circle and black square), which be unambiguously different. The 
respective spectrum be displayed in Supplementary Figure 9b (isomer 2) and c+ d 
(isomer 1). The spectrum of the other isomer 2 present in b show a different 
and unique fragmentation pattern, and can therefore be distinguish from 1 (c+ 
d). The fragment analysis of both spectrum be present in the table of Supplementary 
Figure 9. In conclusion, isomeric molecular key can be distinguish in a 
straightforward fashion, if the list of component do not include isomer for the 
same component (as state in the Criteria for the component database). 

Computer assist readout for tandem-MS spectra. The analysis of tandem-MS 
spectrum at different energy turn out to be time consuming. At this point, a 
computer script (Supplementary Software 1) becomes a very useful tool for pro- 
viding pre-calculated mass of the most probable fragment after the input of the 
monoisotopic mass of the respective molecular key. The mono isotopic mass can be 
obtain from ESI-MS spectrum scan in a range from 200 to 2000 m/z (see 
Supplementary Figure 6). The script operates a follows: The database of compo- 
nents be the basis for the alphanumerical cod (e.g., aldehyde → letter A; ben- 
zaldehyde →A(003), etc.), the chemical formula, the correspond exact mass 
and a SMILES code for visualize the molecule, e.g., A(003) | benzaldehyde| 
C7H6O|106.04186|[H]C(C1= CC= CC=C1)=O. 

The script then search for all possible permutation of component 
combination within the enter mass range (reduction of possibility be illustrate 
in Supplementary Figure 4). The mono isotopic mass [M+Na]+ be enter with 
four decimals, e.g., 567.5678 and an appropriate ΔM threshold (for the herein 
present example ΔM= 0.02 Da be sufficient). The result possibility be 
list by the script and the mass of probable fragment be directly displayed. 
After enter additional fragments, the result possibility be further refine 
until the structure be determined. The fragment mass be enter with two 
decimal (e.g., 123.45). If accidentally a wrong number be entered, the REDO 
command will return to the initial selection of possibility after enter the 
[M+Na]+ mass. After enter enough fragments, the selection of possibility be 
reduce to one distinct molecule. With the alphanumerical information of the key 
[e.g., A(005)-B(002)-C(004)-D(007], the hidden message can be decrypted. The 
script also offer the possibility to display more detailed information about the 
molecular key via the PRINT command. After select the print command a 
SMILES code for the target molecule and all precursor component (on basis of the 
list of components) be displayed. The SIMLES code can be copied, e.g., to 
ChemDraw® (insert with Alt+ Crtl+ P) for visualization of the molecular key 
structure (also refer to Supplementary Methods). 

Computer assist encryption and decryption. To supply a full toolchain, also a 
script be provide (Supplementary Software 2) that performs the actual encryption 
of message (and the reverse process, the decryption of ciphertexts). The script 
operates either in encryption, or in decryption mode. In encryption mode, the 
script take a input a plaintext (either a a file on disk, or enter on screen by the 
user), and a sequence of molecular keys. The molecular key be then concatenate 
and use to derive an AES key for encryption, and the encrypt ciphertext be 
output either to a file, or onto the screen. In decryption mode, a ciphertext and 
molecular key be entered, and the plaintext result from decryption be output. 

Internally, the script us the establish OpenSSL tool to perform 
cryptographic operation (and in particular the key derivation and encryption/ 
decryption operations). The main task of our script be hence to collect user input, 
and run the OpenSSL tool with the appropriate input and parameters. Specifically, 
the script chooses to encrypt/decrypt with the standard AES algorithm with 128-bit 
key (that be derive use a standard cryptographic key derivation function from 
the molecular keys). 

For decrypt the encrypt message include a Supplementary Data 2, select 
decryption mode, drag, and drop the respective file into the window an enter the 
correspond molecular key (obtained from the analysis script, Supplementary 
Software 1). Please export the message in the format < filename > .txt (also refer to 
Supplementary Methods). For decrypt the encrypt file container please export in 
the format < filename > .zip. The solution can be found in Supplementary Note 1. 

Purity determination. The purity of the isolated molecular key [A(005)-B(002)-C 
(004)-D(007)] be further confirm by GC-MS (Supplementary Figure 5). The 
intense signal at 11.5 min retention time corresponds to the displayed molecular 
key, the integral be 99%. The small impurity (1%) at 10.6 min retention time 
originates form a specie with a shorter perfluorinated sidechain (5 CF2 instead 
of 7 CF2), which be incorporate because a shorter perfluorinated acid 

ARTICLE NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x 

8 NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 

www.nature.com/naturecommunications 


component be present in the precursor material (ordered and use a received). 
The respective mass spectrum and the assignment of the fragment be present in 
Supplementary Figure 5. However, since the amount of this impurity be very small 
we do not observe interference with other analytical method or the tandem-MS 
readout. 

NMR characterization. All substance synthesize in the context of this work be 
characterize via 1D and 2D NMR. Representative spectrum for a molecular key 
[A(005)-B(002)-C(004)-D(007)] be displayed in Supplementary Figure 2. Most 
molecular key show a signal splitting due to restrict rotation (analogous to 
peptides), which be confirm via NOESY spectroscopy (see Supplementary 
Figure 2c). In the 1H NMR spectrum (a) split signal can be observe for the 
proton on position CH1 and NH6. The signal between 5 and 6 ppm with a relative 
integral of two do not couple to other protons, a indicate in the COSY 
experiment (b). The HSQC experiment (e, display all carbon bond proton via 
1J(C–H) correlations) indicates two cross signal and hence two carbon bound 
specie (CH1) in the respective area. The HMBC spectrum (f, display correlation 
between carbon and proton that be separate by two, three, and sometimes even 
four bonds, i.e., in conjugate systems) be utilized to further confirm the mole- 
cular structure. The 19F stack spectrum g of the molecular key (bottom of g) 
display two new AB signal (originating from the CF214 group next to the newly 
form amide bond), if compare to the precursor. 

Data availability. All relevant data be include a supplementary information and 
be also available from the correspond author. 

Availability of computer codes: All relevant script be include a 
supplementary information. The analysis script be provide in Supplementary 
Software 1, the encryption script be provide in Supplementary Software 2. 
Examples of encrypt message and an encrypt file container be include in 
Supplementary Data 2. 

Received: 27 September 2017 Accepted: 13 March 2018 

References 
1. Sarkar, T., Selvakumar, K., Motiei, L. & Margulies, D. Message in a molecule. 

Nat. Commun. 7, 11374 (2016). 
2. Challita, K. & Farhat, H. Combining steganography and cryptography: new 

directions. Int. J. New Comput. Archit. Their Appl. 1, 199–208 (2011). 
3. Raphael, A. J. & Sundaram, V. Cryptography and steganography—a survey. 

Int. J. Comput. Technol. Appl. 2, 626–630 (2011). 
4. Dooley, J. F. Review of prisoners, lovers, & spy by Kristie Macrakis. 

Cryptologia 40, 107–112 (2016). 
5. Sun, H. et al. Smart responsive phosphorescent material for data record 

and security protection. Nat. Commun. 5, 3601 (2014). 
6. Hou, X. et al. Tunable solid-state fluorescent material for supramolecular 

encryption. Nat. Commun. 6, 6884 (2015). 
7. Mutai, T., Satou, H. & Araki, K. Reproducible on–off switch of solid-state 

luminescence by control molecular pack through heat-mode 
interconversion. Nat. Mater. 4, 685–687 (2005). 

8. Kishimura, A., Yamashita, T., Yamaguchi, K. & Aida, T. Rewritable 
phosphorescent paper by the control of compete kinetic and 
thermodynamic self-assembling events. Nat. Mater. 4, 546–549 (2005). 

9. Yoon, S.-J. et al. Multistimuli two-color luminescence switch via different 
slip-stacking of highly fluorescent molecular sheets. J. Am. Chem. Soc. 132, 
13675–13683 (2010). 

10. Li, K. et al. Reversible photochromic system base on rhodamine B 
salicylaldehyde hydrazone metal complex. J. Am. Chem. Soc. 136, 1643–1649 
(2014). 

11. Wu, Y. et al. Quantitative photoswitching in bis(dithiazole)ethene enables 
modulation of light for encode optical signals. Angew. Chem. Int. Ed. 53, 
2090–2094 (2014). 

12. Credi, A. Molecules that make decisions. Angew. Chem. Int. Ed. 46, 5472–5475 
(2007). 

13. Strack, G., Luckarift, H. R., Johnson, G. R. & Katz, E. In Biomolecular 
Information Processing 103–116 (Wiley-VCH Verlag GmbH & Co. KGaA, 
Weinheim, 2012). 

14. Prasanna de Silva, A., James, M. R., McKinney, B. O. F., Pears, D. A. & Weir, 
S. M. Molecular computational element encode large population of small 
objects. Nat. Mater. 5, 787–789 (2006). 

15. Clelland, C. T., Risca, V. & Bancroft, C. Hiding message in DNA microdots. 
Nature 399, 533–534 (1999). 

16. Anwar, T., Paul, S. & Singh, S. K. Message transmission base on DNA 
cryptography: review. Int. J. Bio-Sci. Bio-Technol. 6, 215–222 (2014). 

17. Yang, J., Ma, J., Liu, S. & Zhang, C. A molecular cryptography model base on 
structure of DNA self-assembly. Chin. Sci. Bull. 59, 1192–1198 (2014). 

18. Leier, A., Richter, C., Banzhaf, W. & Rauhe, H. Cryptography with DNA 
binary strands. Biosystems 57, 13–22 (2000). 

19. Xiao, G., Lu, M., Qin, L. & Lai, X. New field of cryptography: DNA 
cryptography. Sci. Bull. 51, 1413–1420 (2006). 

20. Ling, J., Naren, G., Kelly, J., Moody, T. S. & de Silva, A. P. Building pH sensor 
into paper-based small-molecular logic system for very simple detection of 
edge of objects. J. Am. Chem. Soc. 137, 3763–3766 (2015). 

21. Andréasson, J. & Pischel, U. Molecules with a sense of logic: a progress report. 
Chem. Soc. Rev. 44, 1053–1069 (2015). 

22. Szacilowski, K. Infochemistry: information processing at the nanoscale (John 
Wiley & Sons, Chichester, 2012). 

23. Ling, J., Daly, B., Silverson, V. A. D. & de Silva, A. P. Taking baby step in 
molecular logic-based computation. Chem. Commun. 51, 8403–8409 (2015). 

24. Cheng, Z., . & Jing, Y. & Jin, X.U. Molecular logic compute model base on 
self-assembly of DNA nanoparticles. Chin. Sci. Bull. 56, 3566–3571 (2011). 

25. Baroncini, M., Semeraro, M. & Credi, A. Processing chemical and photonic 
signal by artificial multicomponent molecular systems. Isr. J. Chem. 51, 23–35 
(2011). 

26. Poje, J. E. et al. Visual display that directly interface and provide read-out of 
molecular state via molecular graphic processing units. Angew. Chem. Int. 
Ed. 53, 9222–9225 (2014). 

27. Shoshani, S., Piran, R., Arava, Y. & Keinan, E. A molecular cryptosystem for 
image by DNA computing. Angew. Chem. Int. Ed. 51, 2883–2887 (2012). 

28. Ling, J., Naren, G., Kelly, J., Fox, D. B. & Prasanna de Silva, A. Small molecular 
logic system can draw the outline of object via edge visualization. Chem. Sci. 
6, 4472–4478 (2015). 

29. Andreásson, J. et al. All-photonic multifunctional molecular logic device. J. 
Am. Chem. Soc. 133, 11641–11648 (2011). 

30. Jiang, X.-J. & Ng, D. K. P. Sequential logic operation with a molecular keypad 
lock with four input and dual fluorescence outputs. Angew. Chem. Int. Ed. 53, 
10481–10484 (2014). 

31. Chen, J., Zhou, S. & Wen, J. Concatenated logic circuit base on a three-way 
DNA junction: a keypad-lock security system with visible readout and an 
automatic reset function. Angew. Chem. Int. Ed. 54, 446–450 (2014). 

32. Carvalho, C. P., Domínguez, Z., Da Silva, J. P. & Pischel, U. A supramolecular 
keypad lock. Chem. Commun. 51, 2698–2701 (2015). 

33. Margulies, D., Felder, C. E., Melman, G. & Shanzer, A. A molecular keypad 
lock: a photochemical device capable of authorize password entries. J. Am. 
Chem. Soc. 129, 347–354 (2007). 

34. Strack, G., Ornatska, M., Pita, M. & Katz, E. Biocomputing security system: 
concatenate enzyme-based logic gate operating a a biomolecular keypad 
lock. J. Am. Chem. Soc. 130, 4234–4235 (2008). 

35. Guo, Z., Zhu, W., Shen, L. & Tian, H. A fluorophore capable of crossword 
puzzle and logic memory. Angew. Chem. Int. Ed. 46, 5549–5553 (2007). 

36. Sun, W., Xu, C.-H., Zhu, Z., Fang, C.-J. & Yan, C.-H. Chemical-driven 
reconfigurable arithmetic functionality within a fluorescent 
tetrathiafulvalene derivative. J. Phys. Chem. C. 112, 16973–16983 (2008). 

37. Liu, Y. et al. An aptamer-based keypad lock system. Chem. Commun. 48, 
802–804 (2012). 

38. Halaḿek, J., Tam, T. K., Chinnapareddy, S., Bocharova, V. & Katz, E. Keypad 
lock security system base on immune-affinity recognition integrate with a 
switchable biofuel cell. J. Phys. Chem. Lett. 1, 973–977 (2010). 

39. Ratner, T., Reany, O. & Keinan, E. Encoding and processing of alphanumeric 
information by chemical mixtures. Chemphyschem 10, 3303–3309 (2009). 

40. Palacios, M. A. et al. InfoBiology by print array of microorganism colony 
for time and on-demand release of messages. Proc. Natl Acad. Sci. USA 108, 
16510–16514 (2011). 

41. Kim, K.-W., Bocharova, V., Halámek, J., Oh, M.-K. & Katz, E. Steganography 
and encrypt base on immunochemical systems. Biotechnol. Bioeng. 108, 
1100–1107 (2011). 

42. Burgess, I. B. et al. Encoding complex wettability pattern in chemically 
functionalized 3D photonic crystals. J. Am. Chem. Soc. 133, 12430–12432 
(2011). 

43. Ohlmeyer, M. H. et al. Complex synthetic chemical library indexed with 
molecular tags. Proc. Natl Acad. Sci. USA 90, 10922–10926 (1993). 

44. NIST. Advanced encryption standard (AES). Fed. Inf. Process. Stand. Publ. 
197, 311 (2001). 

45. Boukis, A. C., Monney, B. & Meier, M. A. R. Synthesis of structurally diverse 
3,4-dihydropyrimidin-2(1 H)-ones via sequential Biginelli and Passerini 
reactions. Beilstein J. Org. Chem. 13, 54–62 (2017). 

46. Zhu, J. & Bienaymé, H. Multicomponent reaction (John Wiley & Sons, 
Chichester, 2006). 

47. Ugi, I. The α-addition of immonium ion and anion to isonitriles 
accompany by secondary reactions. Angew. Chem. Int. Ed. 1, 8–21 (1962). 

48. Ugi, I., Werner, B. & Dömling, A. The chemistry of isocyanides, their 
multicomponent reaction and their libraries. Molecules 8, 53–66 (2003). 

NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x ARTICLE 

NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 9 

www.nature.com/naturecommunications 
www.nature.com/naturecommunications 


49. Ugi, I. et al. Molecular library in liquid phase via UGI-MCR. Res. Chem. 
Intermed. 22, 625–644 (1996). 

50. Kreye, O., Türünç, O., Sehlinger, A., Rackwitz, J. & Meier, M. A. R. 
Structurally diverse polyamide obtain from monomer derive via the Ugi 
multicomponent reaction. Chem. Eur. J. 18, 5767–5776 (2012). 

51. Zhang, W. & Curran, D. P. Synthetic application of fluorous solid-phase 
extraction (F-SPE). Tetrahedron 62, 11837–11865 (2006). 

52. Tzschucke, C. C. et al. Modern separation technique for the efficient workup 
in organic synthesis. Angew. Chem. Int. Ed. 41, 3964–4000 (2002). 

53. Solleder, S. C., Schneider, R. V., Wetzel, K. S., Boukis, A. C. & Meier, M. A. R. 
Recent progress in the design of monodisperse, sequence-defined 
macromolecules. Macromol. Rapid Commun. 38, 1600711 (2017). 

54. Llevot, A., Boukis, A. C., Oelmann, S., Wetzel, K. & Meier, M. A. R. An update 
on isocyanide-based multicomponent reaction in polymer science. Top. Curr. 
Chem. 375, 66 (2017). 

55. Roy, R. K. et al. Design and synthesis of digitally encode polymer that can be 
decode and erased. Nat. Commun. 6, 7237 (2015). 

Acknowledgements 
We thank PD Dr. Weiss, T. Neck, and Dr. N. Boukis for the discussion and comment 
on early version of this manuscript. A.B. be grateful for the Chemie Fonds fellowship 
from the VCI. This work be financially support in part by SFB 1176 (Projects A3 and 
Q5). We thank Prof. Podlech for share lab space with us. We acknowledge support by 
Deutsche Forschungsgemeinschaft and OpenAccess Publishing Fund of Karlsruhe 
Institute of Technology. 

Author contribution 
A.B. and M.M. conceive and design the project. A.B. design the experiment with 
input from M.M. K.R. program the analysis script. M.F. synthesize the molecular key 
under the supervision of A.B. D.H. optimize the cryptography integration and pro- 
gramed the molecular encryption script. A.B. analyze data, prepared the figure and 
write the paper, with feedback from all the authors. 

Additional information 
Supplementary Information accompanies this paper at https://doi.org/10.1038/s41467- 
018-03784-x. 

Competing interests: The author declare no compete interests. 

Reprints and permission information be available online at http://npg.nature.com/ 
reprintsandpermissions/ 

Publisher's note: Springer Nature remains neutral with regard to jurisdictional claim in 
publish map and institutional affiliations. 

Open Access This article be license under a Creative Commons 
Attribution 4.0 International License, which permit use, sharing, 

adaptation, distribution and reproduction in any medium or format, a long a you give 
appropriate credit to the original author(s) and the source, provide a link to the Creative 
Commons license, and indicate if change be made. The image or other third party 
material in this article be include in the article’s Creative Commons license, unless 
indicate otherwise in a credit line to the material. If material be not include in the 
article’s Creative Commons license and your intend use be not permit by statutory 
regulation or exceeds the permit use, you will need to obtain permission directly from 
the copyright holder. To view a copy of this license, visit http://creativecommons.org/ 
licenses/by/4.0/. 

© The Author(s) 2018 

ARTICLE NATURE COMMUNICATIONS | DOI: 10.1038/s41467-018-03784-x 

10 NATURE COMMUNICATIONS | (2018) 9:1439 | DOI: 10.1038/s41467-018-03784-x | www.nature.com/naturecommunications 

https://doi.org/10.1038/s41467-018-03784-x 
https://doi.org/10.1038/s41467-018-03784-x 
http://npg.nature.com/reprintsandpermissions/ 
http://npg.nature.com/reprintsandpermissions/ 
http://creativecommons.org/licenses/by/4.0/ 
http://creativecommons.org/licenses/by/4.0/ 
www.nature.com/naturecommunications 

Multicomponent reaction provide key molecule for secret communication 
Results 
Design and synthesis of molecular key 
Coding, transportation, and isolation of molecular key 
Reading the molecular key via structure elucidation 

Methods 
Criteria for the list of component 
General synthetic procedure 
General procedure (GP1) for Ugi reactions: large scale, high efficiency 
General procedure (GP2) for Ugi reactions: economic, small scale 
General purification procedure for F-SPE 
Hiding and isolate the molecular key 
General extraction procedure 
Analyzing the molecular key via tandem-MS 
Computer assist readout for tandem-MS spectrum 
Computer assist encryption and decryption 
Purity determination 
NMR characterization 
Data availability 

References 
Acknowledgements 
Author contribution 
Competing interest 
ACKNOWLEDGEMENTS 





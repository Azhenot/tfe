




































pcbi.1000205 1..13 


Cell Groups Reveal Structure of Stimulus Space 
Carina Curto1.¤, Vladimir Itskov2.* 

1 Center for Molecular and Behavioral Neuroscience, Rutgers, The State University of New Jersey, Newark, New Jersey, United States of America, 2 Center for Theoretical 

Neuroscience, Columbia University, New York, New York, United States of America 

Abstract 

An important task of the brain be to represent the outside world. It be unclear how the brain may do this, however, a it can 
only rely on neural response and have no independent access to external stimulus in order to ‘‘decode’’ what those response 
mean. We investigate what can be learn about a space of stimulus use only the action potential (spikes) of cell with 
stereotyped—but unknown—receptive fields. Using hippocampal place cell a a model system, we show that one can (1) 
extract global feature of the environment and (2) construct an accurate representation of space, up to an overall scale 
factor, that can be use to track the animal’s position. Unlike previous approach to reconstruct position from place cell 
activity, this information be derive without know place field or any other function relate neural response to 
position. We find that simply know which group of cell fire together reveals a surprising amount of structure in the 
underlie stimulus space; this may enable the brain to construct it own internal representations. 

Citation: Curto C, Itskov V (2008) Cell Groups Reveal Structure of Stimulus Space. PLoS Comput Biol 4(10): e1000205. doi:10.1371/journal.pcbi.1000205 

Editor: Karl J. Friston, University College London, United Kingdom 

Received July 16, 2008; Accepted September 15, 2008; Published October 31, 2008 

Copyright: � 2008 Curto, Itskov. This be an open-access article distribute under the term of the Creative Commons Attribution License, which permit 
unrestricted use, distribution, and reproduction in any medium, provide the original author and source be credited. 

Funding: This work be support by the Swartz Foundation and National Science Foundation grant DMS0818227. 

Competing Interests: The author have declare that no compete interest exist. 

* E-mail: vladimir@neurotheory.columbia.edu 

¤ Current address: Courant Institute of Mathematical Sciences, New York University, New York, New York, United States of America 

. These author contribute equally to this work. 

Introduction 

Stimulus reconstruction, a implement by the scientist, 

typically involves three steps: (i) characterize the space of 

relevant stimuli; (ii) construct function relate stimulus to 

neuronal responses; and (iii) use these functions, together with 

new neuronal activity, in order to ‘‘decode’’ new stimulus [1–11]. 

For example, in the case of hippocampal place cells, the ‘space of 

stimuli’ may be the animal’s current spatial environment; for every 

place cell one computes a place field, i.e., a function that assigns a 

fire rate to each position in space. Place fields, together with 

place cell activity, can then be use to infer the animal’s position 

[2,4,7]. Notably, the scientist relies on a priori assumption about 

the nature of the relevant stimulus space in (i), and us independent 

measurement of previously observe stimulus in order to construct the 

function in (ii). While these function (or ‘‘neural codes’’) come in 

a variety of forms, such a receptive fields, tune curves, spike- 

trigger averages, adaptive filter and conditional probability 

distribution [1–11], they all require use independent observa- 

tions of prior stimulus for their construction. 

Presumably, the brain also us neuronal spike activity to 

reconstruct the stimulus. The brain, however, do not have access 

to independent stimulus measurements; neuronal activity alone 

must represent the external world. How do the brain do it? 

While much effort have be devote to develop biologically 

plausible method to implement the ‘‘decoding’’ of step (iii) 

[1,3,6,10,11], it be generally assume that the structure of stimulus 

space (step (i)) and the function (such a receptive field or tune 

curves) of step (ii) be both present and easily available to 

downstream structure in the brain. Although it be possible that 

receptive field be imprint in synaptic weights, tune 

throughout development and learning, this story be complicate 

by the observation that receptive field in some brain areas— 

particularly in hippocampus—undergo rapid context-dependent 

remapping [2,12–19]. This lead naturally to the question: can 

anything be infer about a stimulus from spike alone? 

We address this question in the context of hippocampal place 

cells. In rodents, spatial information be reflect in the activity of 

place cells, i.e., pyramidal cell in area CA1 and CA3 of dorsal 

hippocampus that fire in a restrict area of the spatial 

environment—the place field—and be mostly silent outside 

[20,21]. We will use the term place field to refer both to the 
function and to the region in space where the fire rate be 

significantly above baseline. Place field remap, and a place cell 

can alternate between multiple stable place field a an animal be 

switch from one familiar environment to another [14,15]. 

Although much work have go into try to understand how 

place field be form [13,22–25], a different and rather 

unexplored question be how the output of hippocampal place cell 

(without access to correspond place fields) might be use by 
downstream structure in order to reconstruct position and the 

underlie space. 

At first glance, it be not obvious that anything at all may be 

learn about a particular environment—or the animal’s position 

within it—using the spike activity of place cell alone. Indeed, 

previous approach to reconstruct position from place cell 

activity have all require know the correspond place field 

[2,4,7]. Furthermore, the value of instantaneous fire rate [2,4] 

and the precise timing of spike with respect to the theta rhythm 

[7] have be used, together with place fields, in order to improve 

position-estimation precision beyond the place field diameter. It 

have also be suggest that other cell types, such a head direction 

cells, play a vital role in decipher position information [22]. 

Because place field exhibit complex dynamic and place cell do 

PLoS Computational Biology | www.ploscompbiol.org 1 October 2008 | Volume 4 | Issue 10 | e1000205 



more than just cod for place [26–30], it be important to 

identify—at least in theory—minimal aspect of neural activity 

that yield sufficient information for construction of an accurate 

representation of space. 

In this work we show that a great deal of information about a 

physical environment can be obtain use only very coarse 

feature of population spike activity. We define a ‘cell group’ a a 

collection of cell that collectively fire significantly above baseline 

within a broad (,250 ms) temporal window; we do not call them 
‘cell assemblies’ to avoid confusion with different timescales and 

degree of sensory control imply by this term [31–34]. We find 

that the simple knowledge of which group of hippocampal place 

cell fire together be enough to (1) extract global topological 

feature of the environment, and (2) reconstruct an accurate 

geometric representation of physical space within which the 

animal’s position can be faithfully tracked. This be make possible 

by use standard tool from algebraic topology and graph theory; 

neither place fields, nor precise spike timing, nor any prior 

independent measurement of position be needed. 

Results 

Cell Groups Reveal Place Field Intersection Information 
Although the brain may be unable to establish direct 

relationship (such a place fields) between neural response and 

external stimuli, it can in principle compare neural response to 

each other. Moreover, relationship between neural response 

reflect relationship between stimuli, and hence reveal structure of 

the outside world. 

In rat hippocampus, the theta-oscillation (6–10 Hz) provide a 

natural timescale for organize population activity. Cells that fire 

within a few theta-cycles of each other be very likely to have 

overlap place fields. We define a cell group a a group of place 

cell that collectively fire within a two theta-cycle (250 ms) time 

window (Figure 1A). Note that this enables u to ignore finer spike 

timing effect modulate by the phase of the theta oscillation, such 

a phase precession [7,31,35–37]. Each place cell typically belongs 

to multiple cell group (Figure 1B), and the activation of a give 

cell group be induced by the animal passing through the 

intersection of correspond place fields. Cell group thus yield 

place field intersection information (i.e., they reveal which subset of 

place field overlap), even when the place field themselves be 

unknown (Figure 1C). 

We first show that this intersection information can be patch 

together to reveal global topological feature of the environment. 

The method for extract global topological feature do not 

require a metric. On the other hand, by think of each cell 

group a define a specific location in space, we can use 

intersection information to construct a metric that provide 

relative distance between cell groups. This yield a geometric 

representation of the external physical space, obtain without 

know place fields. We find that this internal representation be 

quite faithful to the geometry of the environment. In either case, 

we need only make some basic assumption about place fields. We 

assume that place field exist and be stable, have similar sizes, be 

omni-directional, and have fire field that be convex. These 

assumption be generally satisfied for place field of dorsal 

hippocampal place cell record from a freely forage rat in a 

familiar open field environment (see Methods). We also explicitly 

test the importance of the assumption that place field have similar 

sizes, and find that our result be in fact fairly robust to substantial 

variability in place-field sizes. Finally, we test our method with 

multipeaked place fields, and find that our algorithm can tolerate 

a realistic percentage of cell have multiple fire fields, so long 

a the component field be sufficiently separate and convex. 

Figure 1. Collection of cell group uniquely determines the 
topology of the environment. (A) Sample raster for the population 
activity of five place cell in two different environments. Cell group be 
obtain by identify subset of cell that co-fire within a coarse time 
window (colored rectangles). (B) Two example of five-cell configura- 
tions (simplicial complexes) depict collection of cell group 
obtain from the sample raster in (A). An edge represent a cell 
group with two cell and a shade triangle indicates a cell group with 
three cells; color correspond to cell group in (A). (C) Cells that co-fire 
have overlap place fields. Each cell group in (A), (B) corresponds to 
a particular intersection of place fields, denote with match color. 
The place field intersection pattern fully determines the topology of a 
space cover by convex place fields. The first configuration in (B) 
force an arrangement of place field with a hole in the middle (left); the 
second force a space with no hole (right). 
doi:10.1371/journal.pcbi.1000205.g001 

Author Summary 

We construct our understand of the world solely from 
neuronal activity generate in our brains. How do we do 
this? Many study have investigate how neural activity be 
related to outside stimuli, and map of these relationship 
(often call receptive fields) be routinely compute from 
data collect in neuroscience experiments. Yet how the 
brain can understand the meaning of this activity, without 
the dictionary provide by these maps, remains a mystery. 
We tackle this fundamental question in the context of 
hippocampal place cells—i.e., neuron in rodent hippo- 
campus whose activity be strongly correlate to the 
animal’s position in space. We find that the structure of 
stimulus space can be reveal by exploit relationship 
between group of cofiring neuron in response to 
different stimuli. We provide a ‘proof of principle’ by 
demonstrate constructively how the topology of space 
and the animal’s position in an environment can be 
derive purely from the action potential fire by 
hippocampal place cells. In this way, the brain may be 
able to build up structure representation of stimulus 
space that be then use to represent external stimuli. 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 2 October 2008 | Volume 4 | Issue 10 | e1000205 



Global Topological Features 
What may be thought of a a ‘space of stimuli’ at one level of 

processing may constitute an individual stimulus at another: global 

feature of the ‘space of positions’ become property of individual 

environment that can be use to distinguish between them. Often 

time an animal’s physical space have ‘‘holes’’—i.e., region in the 

interior of the environment where the animal be unable to go. For 

example, a rat may be confine to a platform with one or more 

hole in the middle; similarly, there may be large object inside the 

environment (such a trees) provide obstruction to the animal’s 

path. In either case, we call the region inaccessible to the animal a 

hole. 

Holes be example of (non-metric) topological features, because 

they be preserve under continuous deformation of the space. Two 

environment be say to be topologically equivalent (homeomorphic) if 
one can be continuously deform into the other, and vice versa. 

Homology group [38] (see Text S1) be topological invariant that can 
be use to distinguish topologically inequivalent spaces. In particular, 

the dimension of the first homology group H1 count the number of 

holes. Higher order homology group (H2, H3, …) count higher- 

dimensional ‘‘holes,’’ and thus place constraint on the minimum 

dimensionality of the space; they be all expect to vanish for flat, 

two-dimensional environments. 

Topological Features Can Be Extracted from Cell Groups 
From spike train for a population of place cells, we obtain a 

collection of cell group (Figure 1A; see also Methods). The 

correspond intersection information can be use to compute 

homology group of the underlie environment—even though 

the place field themselves be unknown. Intuitively, this work 

because there be a unique configuration of place field (up to 

continuous deformation) consistent with a give pattern of 

intersection (Figure 1B and 1C). Inspired by a deep theorem in 

algebraic topology [38] (see Text S1), we have devise a procedure 

to compute homology group from the collection of cell group 

active in a give environment. This theorem have also be use in 

the context of sensor network [39], and the potential utility of 

similar method in the case of hippocampal place cell be 

independently observe in [40]. Our algorithm, described in detail 

in the Methods, involves construct a simplicial complex 

(Figure 1B) from place field intersection information, and 

compute it homology groups. If the cell group obtain from 

spike train data exactly reflect the correct place field intersection 

information, the theorem guarantee that the homology of the 

simplicial complex be equal to the homology of the underlie 

space. However, give the stochastic nature of place cell firing, 

there be always the possibility that we may miss cell group 

correspond to real intersections, and mistakenly detect cell 

group correspond to non-existent place field intersections. 

In order to verify that this procedure yield accurate result within 

physiologically realistic parameters, we test it use simulated data 

with vary degree of noise. Random-walk trajectory be 

generate in five different flat, two-dimensional environments, each 

of side length L (typically L,1 m), with N = 0,1,…,4 hole (Figure 
S1). In each of 300 trials, each of the five environment be cover 

by 70 single-peaked place field with vary radius (0.1–0.15 L) and 
randomly-chosen center (Figure 2A). Place cell fire be generate 

accord to a simple model (see Methods). Differing level of noise 

be introduce by remove a certain percentage of randomly- 

select spike from each spike train (for every cell) and reassign 

them to occur at random times, so that they fall outside the place 

field (see Methods). 

For each trial, the first five homology group (H0,…,H4) be 

computed. A trial be deem to be ‘correct’ if and only if all 

homology group match the topology of the underlie space, 

and ‘incorrect’ if at least one homology group do not match. 

Although the correct environment could be identify use only 

the first homology group H1, we require the other homology 

group to also match in order to ensure consistency of the overall 

topology (i.e., this be not a multiple-choice framework where 

each trial be assign the ‘most likely’ of the five environments; 

note that ‘chance level’ here be close to 0%). For low level of noise, 

we found near 100% accuracy in all environment (Figure 2B). 

One might worry that if a cell ever spike outside of it place field, 

it will activate a cell group that do not correspond to a true 

intersection of place fields, render the topology computation 

completely inaccurate. Remarkably, the percentage of correct trial 

remain very high for noise level up to 5%; even with 10% of each 

cell’s spike occur outside the correspond place field, more 

than half of all trial continued to be correct (Figure 2B). This be 

because the thresholding of fire rate in order to obtain cell group 

(see Methods) render the procedure quite robust to noise in the spike 

trains. Note that although the trajectory of the rat be itself litter with 

small hole (Figure 2A), the procedure only detects actual (relatively 

large) hole in the environment and be quite insensitive to hole that 

be very small compare to the size of place fields. 

As a further test, we construct additional ‘shuffled’ data set 

by pool together spike activity from cell in different 

environments. We found that each and every ‘shuffled’ trial have 

nonzero high homology groups, suggest higher-dimensional 

spaces. This indicates that population activity in the shuffle data 

set be not generate from realistic, two-dimensional environ- 

ments, and suggests that a downstream structure receive 

hippocampal output could detect pattern of activity that be 

inconsistent with a spatial interpretation. 

Figure 2. Accuracy of extract topological features. (A) Sample 
trajectory (green) in environment with one and zero holes. Gray 
circle depict place field use to simulate data for one trial. (B) For each 
environment, and for each level of add noise, the percentage of 
correct trial be compute from 300 trial (each have a different set 
of randomly-generated place fields). A trial be consider ‘correct’ if all 
five compute homology group match the topology of the 
environment, and ‘incorrect’ if at least one homology group do not 
match. 
doi:10.1371/journal.pcbi.1000205.g002 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 3 October 2008 | Volume 4 | Issue 10 | e1000205 



An Internal Representation of Space Can Be Built from 
Cell Groups 

A give cell group becomes active when the animal cross a 

specific location in space, give by the intersection of the 

correspond place fields. It be thus natural that, from the brain’s 

point of view, a location in space be itself define by a cell group 

(Figure 3A and 3B). The collection of all activate cell group thus 

yield a collection of points, which can be thought of a ‘‘building 

blocks’’ for an internal, discretized representation of space. A set of 

unrelated points, however, do not constitute a space, one must 

know the relationship between point (which pair be close, and 

which be far away). Fortunately, there be a natural way to 

determine when two cell group be ‘‘close’’ to each other, base 

on the number of place cell they have in common. 

We say that two cell group be neighbor if they differ by just one 

place cell. By join neighbor point with edges, one obtains a 

graph (Figure 3C) that be construct purely from cell groups, 

without any explicit knowledge of place fields. In general, 

neighbor cell group with a very high percentage of overlap 

cell will represent point that be closer in space than neighbor 

with small overlap. We define a dissimilarity index mk on neighbor 
cell group a the average relative distance between the center of 

adjacent region with overlap degree k, assume place field of 

equal radius (see Methods). In principle, mk should be derivable 
from basic geometry, a it depends only on general and 

unchanging property of physical space. We estimate mk 
empirically by compute the average distance between the 

center of adjacent intersection region for 30 randomly-generated 

set of place field cover the environment, and normalize the 

index by fix the large value m1 = 1 (see Methods). We found 
that for kv Ncells 

p2 
, the index be well approximate by the formula 

mk&1{p 
ffiffiffiffiffiffiffiffi 
k{1 
Ncells 

q 
, where Ncells be the number of place cell active in 

the environment (see Figure S2). We assume such an index can be 

‘‘hard-wired’’ in the brain, a it have no information about any 

particular arrangement of place field or any particular environ- 

ment. Although we estimate mk assume all place field have 
identical size, we use exactly the same formula for mk in every 
reconstruction, regardless of the distribution of place field size we 

consider. 

The dissimilarity index can be use to assign weight to each 

edge in the graph. A path be a sequence of edge connect two 
vertex (cell groups) in the graph; the length of a particular path be 

give by sum the weight along it edges. The distance 

between any two cell group in the graph can then be define a 

the length of a shortest path between those point (Figure 3D; see 

also Methods). In this manner one obtains a natural metric on cell 
groups. We call this graph, with cell group a it vertex and 

edge between neighbors, together with the metric, the internal 
representation of the external space. 

Internal Representation Accurately Reflects External 
Geometry 

In order to test how well the internal representation conforms to 

the geometry of the external space, we use simulated population 

spike activity from a two-dimensional square box environment 

(see Methods) with differ number of place cells. For each 

number of place cell cover the environment, we randomly 

generate data set for 60 trials, each trial have different place 

field of radius chosen uniformly at random from the interval [0.1 

L,0.125 L], with randomly-chosen centers. The place field size 
be chosen to conform to the 20–25 cm range of average 

diameter typically observe for place cell in dorsal hippocampus 

for a rat explore an open field environment of scale L,1 m 
[41,42]. For each simulated data set, we construct an internal 

representation a outline above. 

To ass the accuracy of the internal representations, we first 

compute pairwise distance between point on a fine grid 

span the L6L environment and compare them with the 
correspond pairwise distance of their image in the internal 

representation (Figure S3). We define the pairwise error for an 
individual trial (having a fix number of place cells) a the mean 

error in pairwise distance when compute use the internal 

representation (see Methods). We found that the average pairwise 

error across trial have a minimum value of 0.036 L for 90 cell 
(Figure 4A), or less than 1/3 the average place field radius; this 

indicates that relative distance between point in the internal 

representation be accurate to within a ball of approximately 1/9 

the median place field area. To check robustness of this procedure 

in the case of great place field variability, we repeat this 

analysis for a series of gamma-function distribution of place field 

radius (Figure 4B). We found that performance decrease slowly for 

distribution with increase standard deviation up to ,0.035, 
and rapidly deteriorate for distribution with standard deviation 

great than 0.05 (Figure 4C). 

As a further test that the full geometry—and not just pairwise 

distances—is accurately reflect in the internal representation, we 

use multi-dimensional scale (MDS) [43] to embed each graph 

into a two-dimensional Euclidean space, in a way that best 

preserve the relative distance between pair of point (i.e., to best 

preserve the metric on cell groups). Next, we ‘‘aligned’’ the 

coordinate of the embed internal space properly so a to best 

match the particular coordinate use to represent the external 

space (Figure S4; see also Methods). Points in the external space 

could then be mapped into the embed internal space by 

identify correspond cell group (see Methods). 

Figure 3. Construction of a metric on cell groups. (A) Example 
spike train from five place cells. Each time bin (columns) represent 
two theta cycles. (B) Place field intersection pattern derive from cell 
group in (A). Shaded region correspond to cell group inside 
rectangle of the same color in (A). (C) The pattern of intersection 
can be represent by a graph, with vertex (black squares) for each 
cell group, and edge connect neighbor (cell group that differ by 
one cell only). A trajectory (green) be infer from the example data, by 
‘‘connecting the dots’’ to match the sequence of cell group in (A). (D) 
Weights be assign to edge of the graph use the dissimilarity index 
mk, where k be the number of common cell between neighbors. The 
distance between any two vertex in the graph be obtain by 
sum the weight along a shortest path (blue). 
doi:10.1371/journal.pcbi.1000205.g003 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 4 October 2008 | Volume 4 | Issue 10 | e1000205 



Visually, the quality of an internal representation can be judged 

by mapping a coarse grid of vertical and horizontal line from the 

external space into the embed internal space, and see how 

faithfully the geometric structure be preserved. We found that the 

full metric geometry (including angle and relative distances) of the 

internal representation closely mirror that of the external space 

(Figure 5A). In particular, the square shape of the box and the 

rectilinear structure of the grid be faithfully reproduced. We 

quantify the accuracy of a give internal representation by 

compute the mismatch between the two spaces; this measure 
computes the average error, a a fraction of box side length L, 
obtain by mapping a fine grid of point from the original space 

into the align embed internal space (see Methods). Quite 

similarly to the pairwise error, we found that the average 

mismatch decrease with increase number of cells, get a 

low a 3% for 120–140 cell (Figure 5B). 

Multipeaked Place Fields 
Until now we have assume that place field be convex; while 

this be usually the case, multipeaked place field be often observed. 

In open field environment of size L,1 m, a small percentage (5– 
10%) of place cell have two disconnect fire fields, each of 

which look like a convex, single-peaked place field [21,44]. We 

will refer to these neuron a ‘‘multipeaked place cells,’’ and to the 

connect component of the place field simply a ‘‘fields.’’ At 

first glance, the presence of multipeaked place cell pose a 

potential limitation to our study. The algebraic topology theorem 

no longer holds, suggest that the algorithm we have thus far 

use for extract topological feature be likely to fail. In the case 

of the geometric reconstruction, on the other hand, we do not 

necessarily expect multipeaked place field to pose a problem, so 

long a the component field be individually convex. In general, 

the danger with multipeaked place field be that distant region of 

space may be identify a be the same. In an ‘‘across-cell’’ 

cod scheme where each neuron represent a distinct location in 

space, this ambiguity indeed pose serious problem [21]. When 

location be represent by cell groups, however, this difficulty be 

easily overcome. Although the same cell may fire in two location 

that be far from each other, cell group correspond to these 

distant region will generally be very different, a other cell serve 

to disambiguate position. Because two cell group be consider 

neighbor only in the case that they share a majority of cell in 

common, pair of cell group with only one or a few common 

place cell be guaranteed to represent distant position in the 

internal representation. 

In order to test the performance of the geometric reconstruction in 

the case of multipeaked place cells, we simulated data a before but 

include small percentage (up to 11%) of multipeaked place cell 

while keep the total number of fire field cover the 

environment constant. In these simulations, we also require that 

the center of multiple field correspond to the same cell be 

sufficiently distant; this be in order to enable disambiguation by 

other cell (see Methods). For 140 fields, we found the performance 

to be very good (Figure 6). An example reconstruct space from 

data contain 10% multipeaked place cell demonstrates that the 

algorithm naturally separate the double field (Figure 6A and 6B; 

see also Figure S5). In particular, both the mismatch (Figure 6C) and 

pairwise error (Figure S6C) remain approximately constant 

range from 0% to 11% multipeaked place cells. 

For data generate from only 90 fields, however, a in 

Figure 5A, performance steadily decrease with increase 

number of multipeaked place cells, a measure by both pairwise 

error and mismatch (Figure S6A and S6B). This be because there 

be not enough place field to double-cover the environment, 

lead some region within double field to fail to be 

disambiguate by the presence of other place cells, and thus 

cause large distortion in the reconstruct space. In fact, this be 

precisely the problem that may cause the topology algorithm to 

fail. When the environment be double-covered by place fields, 

Figure 4. Error in pairwise distance compute from internal 
geometric representation of space. (A) For a fix number of place 
cells, the pairwise error be compute and average over 60 trials. Each 
data set be generate from a different set of place fields, with 
randomly select center and radius chosen uniformly at random from 
the interval [0.1,0.125] (shaded gray region; this corresponds to place 
field diameter range from 20–25 cm in a 1 m61 m environment). 
The dash horizontal line corresponds to the average radius of place 
fields. The average pairwise error achieve a minimum of 0.036 (as a 
fraction of box side length L) for 90 cells, and then level off. This 
indicates that relative distance between pair of point in the internal 
representation be accurate to within an error that be less than 1/3 the 
average radius of place fields. (B) Various gamma-function distribution 
for place field sizes, with fix mode = 0.1125 L and vary standard 
deviations. Radii great than 0.5 L be not considered, a these 
correspond to place field diameter that exceed the side length of the 
box. Dashed line indicates the uniform distribution use in (A). (C) Mean 
pairwise error average over 60 trial for Ncells = 90 and for each of the 
distribution of place field radius displayed in (B). Dashed line denotes 
the place field radius correspond to the peak of each distribution. 
Error bar in both (A) and (C) represent standard deviation across trials. 
doi:10.1371/journal.pcbi.1000205.g004 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 5 October 2008 | Volume 4 | Issue 10 | e1000205 



however, place cell with multiple field can be detect purely 

from the graph of neighborhood relationship on cell group 

(constructed a in Figure 3C). For each place cell, there be an 

induced subgraph whose vertex be the cell group contain 

that cell. Each connect component of this subgraph corresponds 

to a distinct field (Figure S7). Having detect additional field for 

multipeaked place cells, we can then assign auxiliary ‘‘place cells’’ 

to substitute the original cell label such that each connect 

component corresponds to a distinct cell. We then build the 

simplicial complex and compute homology group a before. 

Regarding the (unknown) place field a provide an open cover 

of the underlie space, the add step of the topology algorithm 

can be thought of a make the minimal possible refinement [45] of 

the open cover such that the theorem again hold (see Methods). 

We found that with this modification, the topology algorithm 

maintains very good performance for the experimentally observe 

range of 5–10% multipeaked place cell (Figure 6D). 

Discussion 

We have show that, in the case of hippocampal place cell 

activity, global topological feature of a two-dimensional environ- 

ment a well a an accurate geometric reconstruction of physical 

space—including the animal’s position within it—can be infer 

from spike alone. In either case, one need only assume that place 

field exist and have a stereotypical form; knowledge of actual place 

field or any other prior independent measurement of position be 

not needed. This provide a general framework for building up 

stimulus space (or ‘cognitive maps’ [46]) use only neural activity 

from a relatively homogeneous population of neurons, such a 

dorsal hippocampal place cells. 

Even after obtain a geometric representation of space, global 

topological feature (if needed) must still be computed. Although 

we may be able to ‘‘see’’ topological feature of the stimulus space 

by look at a two-dimensional embed of the internal 

representation, this do not mean no further computation be 

necessary; it merely reflect the fact that our visual system be able to 

do the computation. Moreover, global feature of a ‘space of 

stimuli’ at one level of processing may become property of an 

individual (composite) stimulus at another. Interestingly, although 

the computation of topological feature also have cell group a it 

start point, it do not require construct a geometric 

representation of space, and hence bypass the need for a metric. 

At first glance, our internal representation be perhaps reminis- 

cent of the ‘cognitive graph’ in [47,48], a it be also a graph 

construct to represent a physical environment. The ‘cognitive 

graph,’ however, be envision a an actual neural (sub-) network 

realize in the hippocampus, with an individual place cell for every 

vertex and a synapse for every edge. The metric be encode in 

synaptic weight between place cells, and determine via an LTP 

learn rule. This implies that geometric distortion would result 

from a bias sample of the environment by the animal’s 

trajectory. Although each vertex in the ‘cognitive graph’ be 

intend to represent the center of the correspond place field, it 

Figure 5. Accuracy of full geometry for internal representation of space. (A) The original space (left) and a reconstruction from simulated 
place cell activity (right). Black dot correspond to cell groups. A coarse grid (red and orange lines) in the original space be mapped into the 
reconstruct space, to allow for visual comparison of the geometry. (B) The accuracy of a reconstruct space may be quantify by compute the 
‘mismatch’ between point in the original space and their image in the reconstruct space, a a fraction of the box side length L. The mismatch 
decrease with increase number of cells. Error bar correspond to standard deviation for average mismatch across 60 trials. The dash horizontal 
line corresponds to the average radius of place fields, while the shade gray area corresponds to the range of place field radii. 
doi:10.1371/journal.pcbi.1000205.g005 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 6 October 2008 | Volume 4 | Issue 10 | e1000205 



be always the case that many place cell be simultaneously active at 

any give location in space, suggest that this graph be not 

suitable to represent specific position give population place cell 

activity. Moreover, the existence of multipeaked place cell 

present a seemingly insurmountable challenge in this and any 

paradigm where place cell fire be presume to signal proximity to 

a single place [21]. 

In contrast, our internal representation graph have a vertex for 

every group of reliably co-firing neurons, and be closer in spirit to 

Hebb’s cell assembly [34] than to a literal neural network 

representation of space. Since distance between cell group result 

from the combinatorics of their overlaps, the fact that multiple 

cell co-fire in response to a give stimulus be not a nuisance but a 

necessary condition for infer the structure of the underlie 

space. An essential feature be that, unlike in the case of Kohonen 

map [49], geometric relationship between external stimulus be 

reveal even when neuron in the network have no a priori 

topographic structure (as in hippocampus). Moreover, the 

result metric on cell group be insensitive to a bias sample 

of the environment or to the particular value of synaptic weight 

within the hippocampus, and do not depend on nearby stimulus 

occur in temporal proximity to each other, a would be 

require to infer stimulus space structure use spike train metric 

[50]. Instead, we have use only a very coarse aspect of population 

spike activity—the set of all cell groups—while fully exploit 

the fact that co-firing cell have overlap receptive fields. 

These result suggest that it may be possible for map of the 

environment to be construct in downstream brain area purely 

from cell groups. If this be the case, we would expect that geometric 

distortion in the animal’s spatial perception would arise a a 

consequence of uneven place field coverage of an environment: 

the animal should overestimate distance in a region of high 

place field density, and underestimate distance in region with 

significantly low place field density. This prediction, if confirm 

by experiment, would provide evidence that only cell group be 

use in construct internal representation of space. If, on the 

other hand, such perceptual distortion be not observed, we can 

be almost certain that some other aspect of neural spike activity 

Figure 6. Accuracy of metric reconstruction and topology computation with multipeaked place cells. (A) The original space, together 
with double-peaked place field for three example simulated place cell (blue, green and magenta). (B) A reconstruct space obtain from a data 
set where 10% of the place cell have double-peaked place fields. Black dot correspond to cell groups, a in Figure 5A. Cell group contain each 
of the three place cell with multipeaked field displayed in (A) be show with correspond color. Cell group contain each of the 13 
multipeaked place cell in this data set be show in Figure S5. (C) For a fix total number of 140 field cover the environment, the mismatch 
remains nearly constant for increase percentage of multipeaked place cells. Error bar correspond to standard deviation for average mismatch 
across 60 trials. (D) The extraction of topological feature also performs well on simulated data include up to 10% multipeaked place cells. The 
percentage of correct trial be compute across 50 trial with 0%, 2.5%, 5%, 7.5%, and 10% of cell have double-peaked place fields. As in 
Figure 2B, a trial be consider ‘correct’ if and only if all five compute homology group match the topology of the environment. 
doi:10.1371/journal.pcbi.1000205.g006 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 7 October 2008 | Volume 4 | Issue 10 | e1000205 



contributes. Interestingly, because in our simulation we chose 

place field center uniformly at random from within the environ- 

ment, we consistently have a low density of place field coverage 

near the boundaries. This, in fact, lead to great geometric 

distortion near the boundary of our spatial reconstruction than 

in the interior. To compensate for this, one might expect there to 

be a great number of place field near the boundary of an 

environment. Such an effect has, in fact, be report 

experimentally [51,52], and may be regard a a postdiction. 

We have consider environment that be flat and two- 

dimensional; however, it be easy to generalize our procedure to 

stimulus space that be higher-dimensional and/or curved. 

Recent experiment suggest that three-dimensional hippocampal 

place field may be observable in fly bat [53]. The topology 

algorithm can be use in exactly the same way to detect hole or 

obstacle in three-dimensional environment from cell groups. The 

geometric reconstruction algorithm could also be use in exactly 

the same manner, the only difference be that a different 

dissimilarity index mk, compute for three-dimensional space, 
would need to be used. Furthermore, we believe our approach 

could be generalize to stimulus space reflect in other brain 

areas. The geometric method could prove useful in discover 

new structure in stimulus space reflect in neocortical areas, 

such a primary and high order sensory cortices. Moreover, the 

brain appear to be particularly adept at identify topological 

property of complex objects. For example, connect compo- 

nents and hole in a visual object or scene be often among the 

most salient features. A topological approach, such a the one we 

have use here, could yield insight into understand how global 

feature of a visual object be extract from the activity of cell 

with spatially localize receptive fields. 

Our notion of stimulus reconstruction be a significant departure 

from traditional ‘‘decoding’’ paradigms, a it do not require 

directly relate neuronal activity to external stimulus (as in the 

computation of receptive fields), or to activity in any other area of 

the nervous system. Moreover, while the computation of receptive 

field begin with a priori assumption about the nature of the 
stimulus space be represented, we recover the structure of the 

stimulus space itself from the structure of the induced pattern of 

neuronal activity. The identity of a particular stimulus, then, 

emerges from a combination of modality (the location and type of 

activate neurons) and the relationship of it correspond cell 

group to all others in an internally represent space. Any 

necessary assumption about receptive field may be regard a a 

kind of ‘‘universal grammar’’ [54] that render stimulus space 

reconstruction possible. 

Recently it have be suggest that sequential replay, a 

observe in hippocampus and neocortex [55–58], may be a 

mechanism for consolidate sequence of cell that under spatial 

navigation condition fire within large time windows. The 

sequence reflect group of cell that co-fire within the same theta 

cycle during behavior, however, and it be unclear to what extent 

the precise order matter [59,60]. It be therefore plausible that 

cell group may be communicate to cortex during replay 

events—on a compress timescale—enabling identification via 

coincidence detection. This may allow for building representation 

of space and compute topology in cortex, a these computation 

require knowledge of the full collection of cell groups. 

In summary, we have show that a surprising amount of 

information about the structure of stimulus space can be obtain 

from the combinatorics of cell groups, extract from noisy 

population spike data with a coarse time window. Although we 

be able to demonstrate the presence of this information 

constructively, whether and how the brain us this information 

remains to be seen. Our result suggest, nevertheless, that 

combinatorial relationship between group of cell that fire 

together could reflect stimulus space structure inside the brain, and 

may perhaps lead to a general principle of how the brain 

construct representation of the outside world. 

Methods 

Here we describe how to compute homology group and 

construct an internal representation of space from neural spike 

data. The start point for each method be the identification of cell 

groups. We begin, however, by outline some basic assumption 

about place field need for these procedure to work, and a 

description of the simulated data we use to test our approach. 

Assumptions about Place Fields 
(1) Place field be omni-directional, a be typical in an open field 

environment, but not on a linear track [21,61]. (2) Place field have 

be previously form and be stable. (3) The collection of place 

field correspond to observe cell cover the entire traverse 

environment. (4) The holes/obstacles be large than the diameter 

of place fields. (5) Each (connected) component field of a single or 

multipeaked place field be convex. (6) Background activity be low 
compare to the fire inside the place fields. (7) Place field be 

roughly circular and have similar sizes, a be typical in dorsal 

hippocampus [41,42]. 

Although individual electrophysiological recording can only 

simultaneously monitor a limited number of cells, it be almost 

certain that the hippocampus posse enough place cell for any 

give environment such that the correspond place field cover 

the entire explore space many time over [44]. The convexity of 

component field mean that a straight line segment connect 

any two point in the field will itself be entirely contain within 

the field. This be consistent with the observation that individual 

field tend to have circular or elliptical shape [21]. Although these 

be reasonable assumption about dorsal hippocampal place cells, 

they pose significant constraint on the quality and quantity of cell 

in the recording. One may assume, however, that downstream 

structure in the brain receive hippocampal output do have 
access to this kind of data. We test our approach for construct 

internal representation and compute homology group on 

simulated data that satisfy these criteria. 

Simulated Data 
Each environment be an L6L box, with or without hole in the 

interior. All length unit be with respect to the side length L of the 
box (typically L,1 m). In order for the topology and metric 
algorithm to work, we of course need the animal to fully explore 

the environment. In particular, the trajectory must be dense 

enough to sample the majority of cell groups. For the geometric 

reconstructions, this be merely a matter of resolution, a sample 

few cell group will lead to less precise geometric information. 

For the topology computations, we need to ensure that the set of 

all cell group reveals the full low-order intersection information in 

order for the low-order homology group to be accurate. For 

accurate computation of the nth homology group Hn, we need up 
to (n+1)-fold intersection to be detectable via cell groups. If we 
be only interested in the first homology group H1 (this be enough 

to detect holes/obstacles and distinguish between environments) 

we need only guarantee that pairwise intersection be accurately 

reflected—i.e., the trajectory must pas through each pairwise 

intersection of place field at least once. However, because we 

compute homology group up to H5, in order to check consistency 

of the data with the interpretation a a two-dimensional 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 8 October 2008 | Volume 4 | Issue 10 | e1000205 



environment, we have use denser trajectory in our simulations. 

This would not be necessary if we be only interested in H0 and 

H1. Note that a high-order cell group of n cells, signify an n- 

fold intersection, implies all lower-order intersections. 

For topological features. For each of five environment 

(Figure S1) we generate a smooth random-walk trajectory, with 

speed = 0.1 L/s (this be 10 cm/s for a 1 m61 m box), which be 
constrain to ‘‘bounce’’ off boundary and stay within the 

environment. The total duration of each simulated trajectory be 

50 minutes. For each of 300 trials, N = 70 place field be 

generate a disk of radius 0.1 L to 0.15 L, with radius and center 
chosen uniformly at random. In order to ensure place field 

cover the environment, center be chosen initially uniformly 

at random from uncovered space. Once all space be covered, 

remain place field center be chosen at random from the 

entire box (Figure S1). 

For each place cell in each trial, an average fire rate be 

chosen uniformly at random from the interval 2–3 Hz. A spike 

train be generate from the trajectory and correspond place 

field a an inhomogeneous Poisson process with constant rate 

when the trajectory pass inside the place field, and zero outside, 

so that the overall fire rate be preserved. Because we threshold 

the number of spike in each time bin to obtain cell groups, this be 

equivalent to have somewhat large non-constant place field 

where the fire rate drop quickly below threshold outside the 

specify radius. Noisy spike train be create accord to the 

noise percentage r (0–10%) a follows. r% spike be delete 
from the spike train, and then add back to the spike train at 

random times, irrespective of position along trajectory, so a to 

preserve overall fire rate. ‘Shuffled’ data set be construct by 

randomly choose cell from each of the five environments, and 

pool them together to yield population spike activity that do 

not come from a single environment. 

For reconstruction of space. Here we consider a square 

box environment with no holes. Place field be generate with 

radius select uniformly at random from the interval [0.1 L, 0.125 

L]. This be consistent with the 20–25 cm average place field 

diameter typically observe for dorsal hippocampal place cell in 

an environment of scale L,1 m [41,42]. In the simulation for 
Figure 4C, place field size be generate from gamma function 

distribution (shown in Figure 4B) all have peak at 0.1125 L and 

have minimal place field radius of 0.05 L. The location of the 
peak, the minimum place field size and the standard deviation 

uniquely determine each gamma distribution. Average fire rate 

be chosen uniformly at random from the interval 1–3 Hz. The 

trajectory, location of place fields, and the spike train for each 

place cell be generate a described above. For each total 

number of cell (Ncells = 40–140, increase by 5), we have 60 trials, 

each with different randomly chosen place field and 

inhomogeneous Poisson spike trains. 

Simulations with multipeaked place fields. In simulation 

with multipeaked place fields, secondary field be randomly- 

generate for the population of multipeaked place cell with the 

condition that the center of the second field be a distance great 

than 0.5 L away from the center of the first randomly-generated 

field. This be to guarantee that pair of field for double-peaked 

cell be sufficiently well-separated to allow detection of separate 

field via cell group (see Figure S5 and Figure S7). A high 

density of coverage by place field would allow the distance 

between multiple field of the same cell to be smaller, approach 

the minimal separation require for the field to be disconnected. 

The radius for the component field in double-peaked place field 

be drawn independently from the same distribution of radius 

use for single-peaked place fields. All other aspect of the 

simulation with multipeaked place field be the same a for 

simulation with only single-peaked place fields. 

Identification of Cell Groups 
We define a cell group a a group of place cell that collectively 

fire within a two theta-cycle (250 ms) time window. To determine 

the full set of cell group that become activate a the animal 

traverse the environment, we first bin population spike train into 

2-theta-cycle time bins. A certain subset of cell fire in each time 

bin, and we use these subset to determine the cell groups. Because 

there be some probability that a give place cell will fire outside it 

place field, we impose a threshold on fire rate in order to 

determine the group of cell that fire significantly above baseline 

for each bin. Each result cell group can then be assume to 

correspond to a particular intersection of place fields. 

We first divide population activity into a set of population 

vectors, i.e., vector in RNcells with fire rate for each cell in a 
give time bin. In order not to miss any cell group due to the 

arbitrary choice of where bin start and end, the binning time 

window be then shift to have a total of five different start 

position (eight for topology), equally space within two theta- 

cycles, so that each spike contribute to five population vectors. All 

population vector be pool and thresholded a follows. For 

each cell, the fire rate in a particular population vector be 

consider significant if it be at least 6 time the average fire 

rate for that cell. Each population vector thus yield a cell group, 

consist of all cell fire significantly above baseline in a 

particular time bin. The thresholding be what render the topology 

and reconstruction of space procedure fairly robust to noise in the 

spike trains. 

Extraction of Topological Features 
Here we describe how to compute the homology group of a 

give environment from the collection of all cell group that be 

active in the environment. 

Some mathematical preliminaries. We use a few standard 

mathematical object that be uncommon in the neuroscience 

literature. Here we give brief description of these objects; see Text 

S1 for rigorous definitions. A simplicial complex be a set of vertex 
and simplices (simplices be n-dimensional triangles: points, line 
segments, triangles, tetrahedra, etc.). An abstract simplicial complex be 
a set with a set of subset satisfy similar property a simplices. 

We will use it a a combinatorial object that keep track of 

intersection information reveal by cell groups. Roughly 

speaking, homology group [38,45,62] count the number of ‘‘holes’’ 
of various dimension in a give topological space. The dimension 

bi of the homology group Hi be call Betti numbers. The 0 
th Betti 

number b0 count the number of connect component in a 
space, while b1 count the number of hole that can be border 
by a close 1-dimensional contour. Higher Betti number bi, i.1, 
count the number of ‘‘holes’’ in high dimensions. There be 

many definition of homology group that can be show to be 

equivalent in most case of interest [38]. We use simplicial homology 
groups. Simplicial homology group be define for any topological 
space which can be subdivide into a simplicial complex; they be 

also define for abstract simplicial complexes. In other words, the 

definition applies to the two-dimensional spatial environment 

explore by the animal, a well a to the high-dimensional abstract 

simplicial complex we obtain from population spike data. 

Computation of homology group from cell groups. The 

set of all cell group for a complete data set naturally yield an 

abstract simplicial complex. Each cell be a vertex, and each group 

of n cell yield an (n – 1)-dimensional face (Figure 1B). A 1- 
dimensional face be an edge, a 2-dimensional face be a triangle, a 3- 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 9 October 2008 | Volume 4 | Issue 10 | e1000205 



dimensional face be a tetrahedron, and so on. Assuming place field 

be convex, a deep theorem in algebraic topology [38] implies that 
the homology group of this simplicial complex be equal to the 

homology group of the underlie space (see Text S1). We can 

thus distinguish between different environment by compute 

their homology group from population spike data alone. For 

our two-dimensional flat environments, b0 be always 1 and high 
Betti number (bi, i.1) all vanish. (If the animal be explore the 
entire surface of a ball, however, we would expect b2 = 1.) The 1 

st 

Betti number b1, on the other hand, be different for each of the five 
environments, match the number of hole in each. 

To compute homology group for the very large and high- 

dimensional simplicial complex define by cell groups, we use an 

algorithm from computational algebraic topology implement for 

the GAP software package [63,64]. The algorithm relies 

exclusively on standard linear algebra, and be thus in principle 

realizable by a simple neural network. We compute the first five 

homology group H0,…,H4, and declare a trial to be ‘correct’ 

when all Betti number match what be expect for the 

environment: b0 = 1, b1 = number of holes, and bi = 0 for i.1. A 
trial be deem to be ‘incorrect’ if at least one of the five 

compute Betti number do not match. 

‘‘Refinement’’ step for multipeaked place cells. In the 

previous analysis, the convexity of place field be need such 

that the open cover (see Text S1) associate to the set of all place 

field satisfied the property necessary for the theorem to hold. If 

the data include place cell have multipeaked place fields, we 

need to assign an open set for each connect component of the 

place field. Fortunately, multiple field can easily be detect from 

the set of all cell groups, by identify connect component in 

the induced subgraph of neighborhood relationship between cell 

group (see Figure S7). By assign a distinct open set for each 

component of this graph, we can then build the simplicial complex 

and compute homology group exactly a if each field 

correspond to a different cell. The add step to the topology 

algorithm can be thought of a make the minimal possible 

refinement [45] of the open cover, define by the (unknown) place 
fields, such that the theorem again holds. A refinement of an open 
cover be a new cover such that each set in the new cover be fully 

contain in an open set of the old one. In order to detect the 

connect component of a graph define via an adjacency 

matrix, we use the standard Dulmage-Mendelsohn matrix 

decomposition, implement in the Matlab routine ‘dmperm’. 

Internal Reconstruction of Space 
Here we describe the construction of an internal representation 

of the environment from the collection of all cell group that be 

active in that environment. This can be summarize in two steps: 

(i) construction of a graph, contain a vertex for every cell group 

and an edge between neighbor cell groups, and (ii) construction 

of a distance matrix (or metric) contain distance between any 

two cell groups. In order to verify that the internal representation 

be faithful to the geometry of the external space, we compute the 

average error on pairwise distance between point in the external 

space a estimate use the metric for the internal representation. 

To further validate that the full geometry be accurately reflect in 

the internal representation, we use multidimensional scale 

(MDS) to embed the graph in two-dimensional Euclidean space in 

a way that best preserve the metric on cell groups. This enables 

comparison of the full geometry by visual inspection and by 

computation of the mismatch (see below). 

Regions represent by cell groups. Each cell group 

defines a point, or small region in space contain in the 

intersection of the correspond place fields, but not in any high 

order intersection (as this would correspond to add additional 

cell to the cell group). Mathematically, if Ck#{1,…,Ncells} denotes a 
cell group with k cells, and UCk be the intersection (as a subset of the 
environment) of the correspond place fields, then the region of 

space correspond to the cell group Ck be give by VCk ~ 

UCk { 
S 

Ckz16Ck 
UCkz1 . For example, the color region in Figure 1C 

and Figure 3B all correspond to subset of the form VCk . Similarly, 
the black dot in Figure 3C and 3D, each correspond to a cell 

group Ck, represent region of space of the form VCk , not pure 
intersection UCk . 

Dissimilarity index. The distance between any two cell 

group be compute via a dissimilarity index mk on neighbor (cell 
group that differ by just one cell). For each total number Ncells of 

place cells, we estimate mk empirically by compute the average 
distance between the center of adjacent intersection region VCk 
and VCkz1 for 30 randomly-generated set of place field have 
uniform radius (r = 0.1) cover the environment. We normalize 
the index by fix the large value m1 = 1. Note that for each 
value of Ncells, mk depends only on the order k of the small cell 
group. Empirically compute value of mk for differ number of 
cell be show in Figure S2A. In principle, mk should be derivable 
from basic geometry; we find that it be well approximate by the 

formula mk&1{p 

ffiffiffiffiffiffiffiffiffiffiffi 
k{1 

Ncells 

r 
, for kv 

Ncells 

p2 
(Figure S2B). Although 

this formula be obtain assume all place field have exactly the 

same size, we have use the same formula for place field of 

vary radii, regardless of the particular distribution (uniform or 

gamma) be considered. 

Distance matrix (metric on cell groups). Given a 

collection of cell groups, we obtain a distance matrix (or metric) 

contain distance between any two cell group a follows. We 

first construct a graph whose vertex be cell groups, and whose 

edge be give by neighbor pair of cell group (Figure 3C). To 

each edge between neighbor of degree k and k+1 we assign the 
weight mk (Figure 3D). A path be a sequence of edge connect two 
vertex in the graph; the length of a particular path be give by 

sum the weight along it edges. The distance between any 

two cell group (vertices in the graph) can then be define a the 

length of a shortest path between those point (Figure 3D). We use 

Johnson’s ‘all shortest paths’ algorithm [65], implement for 

Matlab in [66], to construct a distance matrix with distance 

between each pair of cell groups. Note that this yield a metric in the 

strict mathematical sense, a it be positive definite, reflexive, and 

satisfies the triangle inequality. Finally, we add a 0–1% random 

noise jitter to the entry of the distance matrix, to ensure that the 

MDS method we late use (below) do not encounter any 

degeneracy due to multiple entry of the matrix be exactly 

equal. 

Mapping between spaces. Points in the original space be 

mapped into the internal representation a follows. Assuming place 

field cover the environment, any point in the original space lie in 

a particular intersection region VCk , and be expect to activate the 
cell group Ck, where k be the number of cell (equivalently, the 
order of intersection). We can thus identify point in the original 

space with the correspond cell group (vertices) in the internal 

representation. In case where the number of cell be not 

sufficient to completely cover the environment, uncovered point 

be mapped to the internal space use the near cell group. For 

a give point p in the environment, we denote the correspond 
cell group a C(p), regardless of the number of cell it contains. 

Pairwise error. In order to quantitatively ass the quality 

of the internal representation, we compare distance between 

pair of point (p,q) in the original environment to the distance 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 10 October 2008 | Volume 4 | Issue 10 | e1000205 



between their correspond cell group C(p) and C(q) in the 

internal representation. For a give trial, we compute the pairwise 

error a the average value of Ip2q|2d(C(p),C(q))|, where d be the 
(renormalized) construct metric on cell groups, and the average 

be take over all pair of point (p,q) come from the grid show 

in Figure S3. Because the scale for the metric on cell group be 

set by the convention m1 = 1, we multiply the construct metric 
for the internal representation by an overall constant such that the 

mean pairwise distance compute use d match the mean 

pairwise distance in the external environment; this ensure that 

difference in overall scale would not contribute to the pairwise 

error. The average pairwise error for 60 trials, a a function of the 

total number of place cells, be show in Figure 4. 

Embedded internal representation. Given a distance 

matrix for a collection of points, and a specify dimension, a 

non-metric MDS algorithm [43] arranges the point in Euclidean 

space so a to best preserve the order of the distance in the 

distance matrix. (In other words, nearby point will be mapped 

close together and far away point will be kept far away, though 

actual distance may be distorted.) We use the Matlab 

implementation ‘mdscale.’ This enables u to visually ass how 

accurately the internal representation reflect the full external 

geometry, beyond just pairwise distance between points. Lines 

and trajectory in the original space can be mapped into the 

embed internal representation by ‘‘connecting the dots’’ 

between the image of their point (see Figure 5A). 

Comparison to original space, alignment, and 

mismatch. The output of MDS be only unique up to a 

Euclidean transformation (rotation and translation). Moreover, 

the overall scale in our distance matrix be arbitrary, a we 

normalize our dissimilarity index on neighbor such that only 

relative distance mattered. In order to compare the raw MDS 

output to the original space we must therefore ‘‘align’’ the internal 

representation properly. We do this by find the optimal affine 

transformation (rotation, translation and scaling) that minimizes 

the distance between point in the original space and their image 

in the internal representation space. 

An affine transformation be a transformation of the form 

T x!~T 
x1 

x2 

� � 
~ 

a11 a12 

a21 a22 

� � 
x1 

x2 

� � 
z 

b1 

b2 

� � 

parameterized by six number (a11,a12,a21,a22,b1,b2). This amount 

to translate (2 parameters), rotate (1 parameter) and scale in 

two independent direction (3 parameters, the third be the angle 

between directions). We find an optimal affine transformation T 
relate the raw MDS output to the external space by minimize 

a function of six variable 

f a11,a12,a21,a22,b1,b2ð Þ~ 
ðð 

T m x! 
� �� � 

{ x! 
�� ��d2 x!, 

where x! be a point in the external space and m x! 
� � 

be it image 

after mapping to the internal space. The double integral be take 

over the entire square area of the external environment, and be 

compute by sum over a grid of 1506150 points. The 
optimization be perform use ‘fminsearch’ in Matlab. The 

result optimal transform be then use to align the raw MDS 

output to good match the coordinate on the original space. 

Figure S4 show raw MDS output (left column) and correspond- 

ing align version (middle column). 

After alignment, we can evaluate the quality of the represen- 

tation by compute it ‘‘mismatch’’ with the original space. A fine 

grid of point (1506150) in the original space be mapped to the 
align internal space, and the distance T m x! 

� �� � 
{ x! 

�� �� 
between grid point and their image be computed, a a fraction 

of the box side length L. The average of all of these distance be 
call the mismatch. 

Note that the alignment procedure, which do require the use of 
place field and independent position information, be only 

necessary for compute the mismatch—i.e., to quantify how well 

the embed internal representation directly compare to the 

external space. This be because the particular coordinate system 

we choose to parameterize the internal and external space be 

completely arbitrary, and must be shifted, scale and rotate to 

match. The brain do not need to perform either MDS or 

‘‘alignment’’; it need only track position with respect to it own, 

internally construct representation of space. 

Supporting Information 

Figure S1 Five different environment use in simulations. The 

trajectory (green) be generate use a smooth random walk. 

Sample place field for one trial per environment be depict a 

gray circles. The holes/obstructions can be see a white 

rectangle not cover by the trajectory. 

Found at: doi:10.1371/journal.pcbi.1000205.s001 (7.10 MB EPS) 

Figure S2 An approximate formula for the index mk. (A) The 
dissimilarity index mk on neighbor cell groups, for different 
number of cells, compute empirically (see Methods). (B) Compar- 

ison between empirically compute mk (black traces) and the formula 

1{p 

ffiffiffiffiffiffiffiffiffiffiffi 
k{1 

Ncells 

s 

(red traces) for various value of Ncells. The value of mk for the very 
high occur k in each case be not displayed, a very few such 
intersection occurred, render the empirical estimate unreliable. 

Found at: doi:10.1371/journal.pcbi.1000205.s002 (1.06 MB EPS) 

Figure S3 Two grid use for compute pairwise distances. We 

consider pairwise distance between all possible pair of point 

(p,q), where p be a point on a fine 1006100 grid (gray dots) and q be 
a point on a coarse 464 grid (red dots) in the square environment. 
(q be take from a coarse grid to reduce the total number of pair 
from 108 to a more computable 1.6*105.) For each trial, the 

pairwise error be compute a the average value of 

Ip2q|2d(C(p),C(q))|, where C(p) and C(q) denote cell group 
correspond to point p and q, respectively, and d be the 
construct metric on cell groups. This provide a measure for the 

quality of an internal representation construct from cell groups. 

Found at: doi:10.1371/journal.pcbi.1000205.s003 (3.69 MB EPS) 

Figure S4 Internal space reconstruction for increase number 

of place cells. The original environment (bottom right) with three 

sample place fields. A coarse grid (red and orange lines) be use for 

visual comparison with the reconstruct spaces, a in Figures 5 

and 6. Black and color dot correspond to cell groups, a in 

Figure 3C and 3D, with color represent cell group contain 

the three sample place cells. Raw MDS output (left column) for 

the internal reconstruction of space have arbitrary scale and 

orientation; align version (middle column) can be use to 

compute the mismatch (see Methods). Mismatch improves with 

increase number of place cells. 

Found at: doi:10.1371/journal.pcbi.1000205.s004 (4.97 MB EPS) 

Figure S5 Cell group contain place cell with multipeaked 

place fields. Black dot correspond to cell group for the 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 11 October 2008 | Volume 4 | Issue 10 | e1000205 



reconstruct space show in Figure 6B. The reconstruction be 

obtain from the simulated activity of 127 cells, 13 of which have 

multipeaked place fields. For each of the 13 place cell with 

multipeaked place fields, all cell group contain that place cell 

be plot in red (plots 1–13). Cell group for a pair of single- 

peaked place field be also show (plots 14, 15). 

Found at: doi:10.1371/journal.pcbi.1000205.s005 (11.61 MB EPS) 

Figure S6 Multipeak pairwise error and mismatch for coverage 

by 90 and 140 fields. The presence of place cell with multipeaked 

place field do not affect the performance of the metric 

reconstruction so long a the double field be themselves fully 

cover by other place fields, in which case the correspond cell 

group be fully disambiguate by other cells. (A,B) For a total 

coverage by only 90 field (including double field for multipeaked 

cells), both the pairwise error and mismatch have increase mean 

and variance for increase percentage of multipeaked cells. This 

be because 90 randomly-located field for the give range of radius 

(shaded region, dash line indicates mean place field radius) be 

not enough to double-cover the environment. (C,D) The 

environment be fully double-covered with 140 fields. Accordingly, 

there be no significant decrease in performance for increase 

percentage (up to 11%) of multipeaked place fields. ((D) be the 

same a Figure 6C.) 

Found at: doi:10.1371/journal.pcbi.1000205.s006 (0.92 MB EPS) 

Figure S7 Place cell with multipeaked place field can be 

detect from cell groups. Overlapping circle (middle) illustrate 

an example place field configuration for an environment with no 

holes. Cell 8 have a double-peaked place field, consist of two 

disconnect region (shaded gray areas). A graph, a in Figure 3, 

can be construct from the correspondingly activate cell group 

(not shown). For each cell, there be an associate subgraph induced 

by restrict only to cell group (vertices) that contain the give 

cell. The subgraph associate to cell 8 (left) have two connect 

components, indicate that this place cell have a place field with 

two disconnect fire fields. In contrast, the subgraph for cell 3 

(right) be connected, a be the subgraphs for all other place cell 

(1–7) in this example (not shown). Note that identification of 

multipeaked place field require that they be entirely cover by 

other fields, a be the case of cell 8. For this reason, we must have 

enough cell to double-cover the environment by place field in 

order to guarantee that we can identify place cell with 

multipeaked field and disambiguate disconnect fields. 

Found at: doi:10.1371/journal.pcbi.1000205.s007 (0.61 MB EPS) 

Text S1 Supplementary Text 

Found at: doi:10.1371/journal.pcbi.1000205.s008 (0.11 MB PDF) 

Acknowledgments 

The author would like to thank Larry Abbott, Taro Toyoizumi, and Xaq 

Pitkow for helpful suggestion on the manuscript and Lais Borges and 

Cleidi Haleah for logistical support. 

Author Contributions 

Conceived and design the experiments: CC VI. Performed the 

experiments: CC VI. Analyzed the data: CC VI. Contributed reagents/ 

materials/analysis tools: CC VI. Wrote the paper: CC VI. 

References 

1. Bialek W, Rieke F, de Ruyter van Steveninck RR, Warland D (1991) Reading a 

neural code. Science 252: 1854–1857. 

2. Wilson MA, McNaughton BL (1993) Dynamics of the hippocampal ensemble 
code for space. Science 261: 1055–1058. 

3. Seung HS, Sompolinsky H (1993) Simple model for reading neuronal 
population codes. Proc Natl Acad Sci U S A 90: 10749–10753. 

4. Brown EN, Frank LM, Tang D, Quirk MC, Wilson MA (1998) A statistical 

paradigm for neural spike train decode apply to position prediction from 
ensemble fire pattern of rat hippocampal place cells. J Neurosci 18: 

7411–7425. 

5. Rieke F, Warland D, Steverninck R, Bialek W (1999) Spikes: Exploring the 

Neural Code. Cambridge (Massachusetts): MIT Press. 

6. Deneve S, Latham PE, Pouget A (1999) Reading population codes: a neural 
implementation of ideal observers. Nat Neurosci 2: 740–745. 

7. Jensen O, Lisman JE (2000) Position reconstruction from an ensemble of 

hippocampal place cells: contribution of theta phase coding. J Neurophysiol 83: 
2602–2609. 

8. Nirenberg S, Latham PE (2003) Decoding neuronal spike trains: how important 
be correlations? Proc Natl Acad Sci U S A 100: 7348–7353. 

9. Eden UT, Frank LM, Barbieri R, Solo V, Brown EN (2004) Dynamic analysis of 

neural encode by point process adaptive filtering. Neural Comput 16: 971–998. 

10. Ma WJ, Beck JM, Latham PE, Pouget A (2006) Bayesian inference with 

probabilistic population codes. Nat Neurosci 9: 1432–1438. 

11. Jazayeri M, Movshon JA (2006) Optimal representation of sensory information 
by neural populations. Nat Neurosci 9: 690–696. 

12. Muller RU, Kubie JL (1987) The effect of change in the environment on the 

spatial fire of hippocampal complex-spike cells. J Neurosci 7: 1951–1968. 

13. Quirk GJ, Muller RU, Kubie JL, Ranck JB (1992) The positional fire 

property of medial entorhinal neurons: description and comparison with 
hippocampal place cells. J Neurosci 12: 1945–1963. 

14. Lever C, Wills T, Cacucci F, Burgess N, O’Keefe J (2002) Long-term plasticity in 

hippocampal place-cell representation of environmental geometry. Nature 416: 
90–94. 

15. Wills TJ, Lever C, Cacucci F, Burgess N, O’Keefe J (2005) Attractor dynamic in 

the hippocampal representation of the local environment. Science 308: 873–876. 

16. Frank LM, Stanley GB, Brown EN (2004) Hippocampal plasticity across 

multiple day of exposure to novel environments. J Neurosci 24: 7681–7689. 

17. Fritz J, Shamma S, Elhilali M, Klein D (2003) Rapid task-related plasticity of 

spectrotemporal receptive field in primary auditory cortex. Nat Neurosci 6: 

1216–1223. 

18. Womelsdorf T, Anton-Erxleben K, Pieper F, Treue S (2006) Dynamic shift of 

visual receptive field in cortical area MT by spatial attention. Nat Neurosci 9: 

1156–1160. 

19. Froemke RC, Merzenich MM, Schreiner CE (2007) A synaptic memory trace 

for cortical receptive field plasticity. Nature 450: 425–429. 

20. O’Keefe J, Dostrovsky J (1971) The hippocampus a a spatial map. Preliminary 

evidence from unit activity in the freely-moving rat. Brain Res 34: 171–175. 

21. Muller R (1996) A quarter of a century of place cells. Neuron 17: 813–822. 

22. McNaughton BL, Battaglia FP, Jensen O, Moser EI, Moser MB (2006) Path 

integration and the neural basis of the ‘cognitive map’. Nat Rev Neurosci 7: 

663–678. 

23. Blair HT, Welday AC, Zhang K (2007) Scale-invariant memory representation 

emerge from moire interference between grid field that produce theta 

oscillations: a computational model. J Neurosci 27: 3211–3229. 

24. Brun VH, Otnass MK, Molden S, Steffenach HA, Witter MP, et al. (2002) Place 

cell and place recognition maintain by direct entorhinal-hippocampal 

circuitry. Science 296: 2243–2246. 

25. Samsonovich A, McNaughton BL (1997) Path integration and cognitive 

mapping in a continuous attractor neural network model. J Neurosci 17: 

5900–5920. 

26. Wood ER, Dudchenko PA, Eichenbaum H (1999) The global record of memory 

in hippocampal neuronal activity. Nature 397: 613–616. 

27. Wood ER, Dudchenko PA, Robitsek RJ, Eichenbaum H (2000) Hippocampal 

neuron encode information about different type of memory episode occur 

in the same location. Neuron 27: 623–633. 

28. Young BJ, Fox GD, Eichenbaum H (1994) Correlates of hippocampal complex- 

spike cell activity in rat perform a nonspatial radial maze task. J Neurosci 14: 

6553–6563. 

29. Jackson J, Redish AD (2007) Network dynamic of hippocampal cell-assemblies 

resemble multiple spatial map within single tasks. Hippocampus 17: 1209–1229. 

30. Johnson A, Redish AD (2007) Neural ensemble in CA3 transiently encode path 

forward of the animal at a decision point. J Neurosci 27: 12176–12189. 

31. Dragoi G, Buzsaki G (2006) Temporal encode of place sequence by 

hippocampal cell assemblies. Neuron 50: 145–157. 

32. Harris KD (2005) Neural signature of cell assembly organization. Nat Rev 

Neurosci 6: 399–407. 

33. Harris KD, Csicsvari J, Hirase H, Dragoi G, Buzsaki G (2003) Organization of 

cell assembly in the hippocampus. Nature 424: 552–556. 

34. Hebb DO (1949) The Organization of Behavior. New York: Wiley. 

35. Geisler C, Robbe D, Zugaro M, Sirota A, Buzsaki G (2007) Hippocampal place 

cell assembly be speed-controlled oscillators. Proc Natl Acad Sci U S A 104: 

8149–8154. 

36. Itskov V, Pastalkova E, Mizuseki K, Buzsaki G, Harris KD (2008) Theta- 

mediate dynamic of spatial information in hippocampus. J Neurosci 28: 

5959–5964. 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 12 October 2008 | Volume 4 | Issue 10 | e1000205 



37. O’Keefe J, Recce ML (1993) Phase relationship between hippocampal place 

unit and the EEG theta rhythm. Hippocampus 3: 317–330. 
38. Hatcher A (2002) Algebraic Topology. Cambridge, UK: Cambridge University 

Press. 

39. de Silva V, Ghrist R (2007) Homological sensor networks. Not Am Math Soc 54: 
10–17. 

40. Dabaghian Y, Cohn AG, Frank L (2007) Topological map from signals. In: 
Proceedings of the 15th ACM International Symposium ACM GIS. New York: 

ACM Press. pp 392–395. 

41. Jung MW, Wiener SI, McNaughton BL (1994) Comparison of spatial fire 
characteristic of unit in dorsal and ventral hippocampus of the rat. J Neurosci 

14: 7347–7356. 
42. Maurer AP, Vanrhoads SR, Sutherland GR, Lipa P, McNaughton BL (2005) 

Self-motion and the origin of differential spatial scale along the septo-temporal 
axis of the hippocampus. Hippocampus 15: 841–852. 

43. Kruskal JB (1963) Multidimensional scale by optimize goodness of fit to a 

nonmetric hypothesis. Psychometrika 29: 1–27. 
44. Muller RU, Kubie JL, Ranck JB Jr (1987) Spatial fire pattern of hippocampal 

complex-spike cell in a fix environment. J Neurosci 7: 1935–1950. 
45. Bott R, Tu LW (1982) Differential Forms in Algebraic Topology. New York: 

Springer-Verlag. 

46. O’Keefe J, Nadel L (1978) The Hippocampus a a Cognitive Map. Oxford, UK: 
Oxford University Press. 

47. Muller RU, Stead M (1996) Hippocampal place cell connect by Hebbian 
synapsis can solve spatial problems. Hippocampus 6: 709–719. 

48. Muller RU, Stead M, Pach J (1996) The hippocampus a a cognitive graph. 
J Gen Physiol 107: 663–694. 

49. Kohonen T (2001) Self-Organizing Maps. New York: Springer. 

50. Victor JD (2005) Spike train metrics. Curr Opin Neurobiol 15: 585–592. 
51. Hetherington PA, Shapiro ML (1997) Hippocampal place field be alter by 

the removal of single visual cue in a distance-dependent manner. Behav 
Neurosci 111: 20–34. 

52. Andersen P, Morris R, Amaral D, Bliss T, O’Keefe J (2007) The Hippocampus 

Book. Oxford, UK: Oxford University Press. 
53. Ulanovsky N, Moss CF (2007) Hippocampal cellular and network activity in 

freely move echolocating bats. Nat Neurosci 10: 224–233. 

54. Chomsky N (1957) Syntactic Structures. Gravenhage: Mouton. 
55. Louie K, Wilson MA (2001) Temporally structure replay of awake 

hippocampal ensemble activity during rapid eye movement sleep. Neuron 29: 
145–156. 

56. Lee AK, Wilson MA (2002) Memory of sequential experience in the 

hippocampus during slow wave sleep. Neuron 36: 1183–1194. 
57. Foster DJ, Wilson MA (2006) Reverse replay of behavioural sequence in 

hippocampal place cell during the awake state. Nature 440: 680–683. 
58. Ji D, Wilson MA (2007) Coordinated memory replay in the visual cortex and 

hippocampus during sleep. Nat Neurosci 10: 100–107. 
59. Diba K, Buzsaki G (2007) Forward and reverse hippocampal place-cell 

sequence during ripples. Nat Neurosci 10: 1241–1242. 

60. O’Neill J, Senior TJ, Allen K, Huxter JR, Csicsvari J (2008) Reactivation of 
experience-dependent cell assembly pattern in the hippocampus. Nat Neurosci 

11: 209–215. 
61. Muller RU, Bostock E, Taube JS, Kubie JL (1994) On the directional fire 

property of hippocampal place cells. J Neurosci 14: 7235–7251. 

62. Ewald G (1996) Combinatorial Convexity and Algebraic Geometry. New York: 
Springer. 

63. Dumas J, Heckenbach F, Saunders F, Welker V (2004) Simplicial Homology—A 
Proposed Share Package for GAP. http://www.cis.udel.edu/,dumas/ 
Homology/. 

64. Dumas J, Saunders B, Villard G (2001) On efficient sparse integer matrix smith 

normal form computations. J Symbolic Comput 32: 71–99. 

65. Johnson DB (1977) Efficient algorithm for shortest path in sparse networks. 
J ACM 24: 1–13. 

66. Gleich D (2007) MatlabBGL. A Matlab Graph Library. http://www.stanford. 
edu/,dgleich/programs/matlab_bgl. 

Cell Groups Reveal Structure of Stimulus Space 

PLoS Computational Biology | www.ploscompbiol.org 13 October 2008 | Volume 4 | Issue 10 | e1000205 













































de-anonymizing-web (70).pdf 


de-anonym web brows data with social network 

jessica Su 

stanford univers 

jtysu@stanford.edu 

ansh shukla 

stanford univers 

anshukla@stanford.edu 

sharad goel 

stanford univers 

scgoel@stanford.edu 

arvind narayanan 

princeton univers 

arvindn@cs.princeton.edu 

abstract 
can onlin tracker and network adversari de-anonym 
web brows data readili avail to them? We show— 
theoretically, via simulation, and through experi on 
real user data—that de-identifi web brows histori can 
be link to social medium profil use onli publicli avail- 
abl data. our approach be base on a simpl observation: 
each person have a distinct social network, and thu the 
set of link appear in one’ feed be unique. assum 
user visit link in their feed with high probabl than 
a random user, brows histori contain tell-tal mark of 
identity. We formal thi intuit by specifi a model 
of web brows behavior and then deriv the maximum 
likelihood estim of a user’ social profile. We evalu 
thi strategi on simul brows histories, and show that 
give a histori with 30 link origin from twitter, we 
can deduc the correspond twitter profil more than 50% 
of the time. To gaug the real-world e↵ect of thi ap- 
proach, we recruit nearli 400 peopl to donat their web 
brows histories, and we be abl to correctli identifi 
more than 70% of them. We further show that sever on- 
line tracker be emb on su�cient mani websit to 
carri out thi attack with high accuracy. our theoret 
contribut appli to ani type of transact data and 
be robust to noisi observations, gener a wide rang 
of previou de-anonym attacks. finally, sinc our at- 
tack attempt to find the correct twitter profil out of over 
300 million candidates, it is—to our knowledge—th largest- 
scale demonstr de-anonym to date. 

cc concept 
•secur and privaci ! pseudonymity, anonym 
and untraceability; •inform system ! onlin 
advertising; social networks; 

permiss to make digit or hard copi of all or part of thi work for person or 
classroom use be grant without fee provid that copi be not make or distribut 
for profit or commerci advantag and that copi bear thi notic and the full cita- 
tion on the first page. copyright for compon of thi work own by other than 
acm must be honored. abstract with credit be permitted. To copi otherwise, or re- 
publish, to post on server or to redistribut to lists, requir prior specif permiss 
and/or a fee. request permiss from permissions@acm.org. 

c� 2017 acm. isbn tdb. 
doi: tbd 

1. introduct 
onlin anonym protect civil liberties. At an abstract 

level, it enabl intellectu freedom: research show that 
user chang their behavior when they know they be be- 
ing surveil onlin [23], result in a chill e↵ect [32]. 
concretely, user who have their anonym compromis 
may su↵er harm rang from persecut by govern 
to target fraud that threaten public exposur of onlin 
activ [6]. 

the onlin advertis industri build brows histori 
of individu via third-parti tracker emb on web 
pages. while a small number of compani admit to attach- 
ing user ident to these browsing-histori datasets, most 
compani promis user that the histori be pseudony- 
mou and not link to identity. privaci advoc have 
argu that such data can be de-anonymized, but we lack 
conclus evidence. It have remain unclear what type 
of identifi auxiliari inform could be use in a de- 
anonym attack, whether an attack could work at the 
scale of million of users, and what the success rate of such 
an attack would be. 

In thi paper we show that brows histori can be link 
to social medium profil such a twitter, facebook, or reddit 
accounts. We begin by observ that most user subscrib 
to a distinct set of other user on a service. sinc user 
be more like to click on link post by account that 
they follow, these distinct pattern persist in their brows- 
ing history. An adversari can thu de-anonym a give 
brows histori by find the social medium profil whose 
“feed” share the history’ idiosyncrat characteristics.1 

such an attack be feasibl for ani adversari with access 
to brows histories. thi includ third-parti tracker 
and other with access to their data (either via intrus or 
a law request). network adversaries—includ govern- 
ment surveil agencies, internet servic providers, and 
co↵e shop eavesdroppers—also see url of unencrypt 
web tra�c. the adversari may also be a cross-devic track- 
ing compani aim to link two di↵er brows histori 
(e.g., histori gener by the same user on di↵er de- 
vices). for such an adversary, link to social medium profil 
be a step stone. 

We make three key contributions. first, we develop a 
gener theoret framework for de-anonymization. We as- 
sume there be a background probabl of click on links, 
and that a link appear in a user’ feed increas it prob- 
abil of appear in their brows histori by a user- 

1A user’ feed or timelin contain the aggreg content 
post by all account to which the user subscribes. 



specif factor. We then deriv a maximum likelihood es- 
timate, which let u identifi the feed in the system most 
like to have gener the observ history. thi gener 
frame appli to a varieti of other de-anonym at- 
tack (c.f. section 8). 

our second contribut be implement and evalu 
thi technique. We chose twitter a the sourc of aux- 
iliari inform for sever reasons: it real-tim api, 
which avoid the need for large-scal web-crawling; the fact 
that most activ be public; and finally, the fact that link 
be wrap in the t.co shortener, which simplifi detail 
of our attack. We assum that either due to the refer 
header or by exploit time information, the adversari 
know which link in the user’ histori result from click 
on twitter. By employ a varieti of cach and ap- 
proxim techniques, we built a system capabl of de- 
anonym web brows histori in real-time, typic 
in under one minute. To test the perform of thi sys- 
tem, we pick 60 activ twitter user at random, obtain 
their feeds, and simul brows histori use a sim- 
ple behavior model. given a synthet histori contain 
30 twitter links, we identifi the correct twitter profile— 
out of over 300 million activ twitter users—ov 50% of 
the time. We show that our maximum likelihood estim 
achiev good accuraci than intersect size and jaccard 
similarity, two approach that have be previous studi 
in the context of similar de-anonym task [15, 35]. 

finally, our third contribut be creat an experi 
to test thi attack on real brows histories.2 We built an 
onlin tool to allow user to donat their brows history; 
upon which we execut our attack and show the result to 
the user so they could confirm or deny. the attack work 
correctli for 72% of the 374 user who complet the experi- 
ment. We present these result a a proof of concept, note 
that our sampl of user be not representative. 

there be mani way in which user may be de-anonym 
when brows the web (see section 2). however, our attack 
be notabl for it gener and for the varieti of adver- 
sari who may employ it. ani social medium site can be 
use for such an attack, provid that a list of each user’ 
subscript can be inferred, the content be public, and the 
user visit su�cient mani link from the site. for ex- 
ample, on facebook subscript can be infer base on 
“likes,” and on reddit base on comments, albeit incom- 
plete and with some error. further, it be inher in the 
web’ design and users’ behavior, and be not due to spe- 
cific, fixabl vulner by browser or websites, unlik 
previou de-anonym attacks. It simultan con- 
firm the fingerprint of brows profil and the easi 
avail of auxiliari information. application-lay de- 
anonym have long be consid the achilles’ heel 
of tor and other anonym systems, and our work provid 
anoth reason whi that be the case. 

the increas adopt of http on the web diminish 
the strength of an attack by network adversaries, but not by 
third-parti trackers. however, network adversari still see 
the domain of encrypt requests, even if the url be hidden. 
We hypothes that the attack will still work in thi scenario 
but will requir a great number of link per user. user 
can mitig attack by instal tracker-block tool such 
a ghostery, ublock origin, or privaci badger, a well a 

2thi experi be approv by stanford university’ in- 
stitut review board (protocol no. 34095). 

http everywher to increas the use of encryption. Of 
course, not reveal one’ real-world ident on social me- 
dia profil also make it harder for the adversari to identifi 
the user, even if the link be successful. nascent project 
such a contextu ident contain for firefox help user 
more easili manag their ident onlin [5]. none of these 
solut be perfect; ultimately, protect anonym onlin 
requir vigil and awar of potenti attacks. 

2. relat work 
the de-anonym literatur be vast, but linkag at- 

tack (and demonstr of uniqueness) base on behavior 
be especi relev to our work. these includ transac- 
tional record of movi view [28], locat trace [7, 22], 
credit-card metadata [8], and write style [27]. attack on 
anonym commun system such a long-term in- 
tersect attack and statist disclosur attack employ 
similar principl [24]. 

To our knowledge, the onli previou work that studi 
the uniqu of brows histori be by olejnik et al. [31]. 
base on a larg onlin experiment, they report that test 
50 link be su�cient to uniqu fingerprint 42% of user in 
a sampl of about 370,000 users, and that these behavior 
fingerprint be stabl over time. their result be not di- 
rectli compar with ours: the brows histori in their 
experi be obtain via “histori sni�ng” (which us 
a browser bug that have long be fixed). As a result, they 
be onli abl to test for the presenc or absenc of url 
from a select list, rather than analyz the entir brows- 
ing histori of particip users. further, the work leaf 
open the question of whether these behavior fingerprint 
can actual be link to auxiliari information. 

wondracek et al. [38] present an onlin de-anonym 
attack that be conceptu similar to ours, although it again 
involv histori sni�ng. further, it reli on addit pri- 
vaci vulner on social medium sites: specifically, tak- 
ing an action (such a commenting) result in a request to a 
url specif to that comment or other action. from a scien- 
tific perspective, the paper show that group membership 
in social medium site tend to be unique, but do not shed 
light on the uniqu or de-anonymiz of brows 
histori in gener (in the absenc of the now-fix privaci 
vulnerabilities). 

our work also directli relat to third-parti onlin track- 
ing. such track have grown tremend in preval 
and complex over the past two decad [20, 25, 34, 4]. 
today googl can track user across nearli 80% of site 
through it variou third-parti domain [21]. web track 
have expand from simpl http cooki to includ more 
persist track techniques, such a the use of flash cook- 
y to“respawn”or re-instanti http cooki [36], the use 
of cach e-tag and html5 localstorag for the same pur- 
pose [3], and“cooki syncing”between di↵er third parti 
[11, 1]. devic fingerprint attempt to identifi user by 
a combin of the device’ properti [9, 19]. new finger- 
print techniqu be continu discov [26, 30, 13], 
and be subsequ use for track [29, 2, 1, 10]. these 
techniqu allow tracker to more e↵ect compil uniqu 
brows histories, but they do not by themselv link his- 
tori to identity. 

leak of pii from first parti to third parti be rampant, 
and thi be one way in which an ident may be attach to 
pseudonym brows histori [18, 17]. further, the nsa 



be know to piggyback on advertis cooki for surveil- 
lance; englehardt et al. [11] show that thi techniqu can be 
e↵ect and that such a network eavesdropp may also be 
abl to learn users’ ident due to usernam and other 
pii transmit by websit in the clear. our work present 
a new way in which eavesdropp may connect web tra�c 
to identities, and it will work even if the pii leak be fixed. 

3. de-anonym strategi 
our de-anonym strategi proce in three steps. 

first, we posit a simpl model of web brows behavior 
in which a user’ likelihood of visit a url be govern 
by the url’ overal popular and whether the url ap- 
pear in the user’ twitter feed. next, for each user, we 
comput their likelihood (under the model) of gener a 
give anonym brows history. finally, we identifi the 
user most like to have gener that history. A similar 
likelihood-bas approach be use by Ma et al. [22] to 
de-anonym locat traces. 

We construct a styliz model of web brows by first 
assum that a user’ web histori be gener by a se- 
quenc of independent, ident distribut random vari- 
abl h1, . . . , hn, where Ht correspond to the t-th url 
visit by the user. We further assum that each user i have 
a person set of recommend link ri. for example, 
on a social medium site like twitter, we can take thi recom- 
mendat set to be those link that appear in the user’ 
feed (i.e., link post by the user’ friend on the network). 
finally, we assum that a user be more like to visit a link 
if it appear in the user’ recommend set, where there 
be a user-specif multipl factor ri that describ each 
user’ respons to the recommend set. A user’ 
web brows behavior be thu control by two parameters: 
the recommend set Ri (which be a set of links), and the 
recommend factor ri. 

theorem 1 below formal thi gener model of web 
brows behavior. further, give a brows histori and 
a set of candid user with recommend set C = 
{r1, . . . , rk}, it deriv the maximum likelihood estim 
R̂ and r̂. In particular, R̂ be the recommend set (and 
henc user) most like associ with a given, de-identifi 
brows history. 

theorem 1. let ⌦ = {!1, . . . ,!n} be a univers of items, 
and suppos {pj} give a probabl distribut on ⌦ (i.e., 
pj � 0 and 

PN 
j=1 pj = 1). let C = {r1, . . . , rk} be a collec- 

tion of recommend sets, where Ri ✓ ⌦. for ani R 2 C 
and r > 0, defin a random variabl ht(r, r) take valu 
in ⌦ such that 

pr(ht = !j) = 

( 
rpj/z if !j 2 R 
pj/z if !j 62 R 

where z be a normal factor: z = r 
P 

!j2r pj+ 
P 

!j 62r pj . 

then, give i.i.d. draw h1(r, r), . . . , hn(r, r), the maxi- 
mum likelihood estim (r̂, r̂) of the underli paramet 
be 

R̂ = argmax 
r2c 

 
qR log 

✓ 
qR 
pR 

◆ 
+ (1� qr) log 

✓ 
1� qR 
1� pR 

◆� 
(1) 

and 

r̂ = 

✓ 
qr̂ 

1� qr̂ 

◆,✓ 
pr̂ 

1� pr̂ 

◆ 
(2) 

where qR = |{t | Ht 2 r}|/n and pR = 
P 

!j2r pj . 

In the theorem above, qR be the fraction of link in the 
observ brows histori that be in the recommend 
set R (e.g., the fraction of link appear in the associ 
user’ twitter feed). similarly, pR be the gener size of 
the recommend set, where it account both for the total 
number of item in the set and the popular of those items. 
intuitively, R̂ be a recommend set for which qr̂ be larg 
and pr̂ be small; that is, mani of the link in the observ 

histori appear in R̂ and R̂ be not too big. the theorem allow 
for ri < 1, in which case Ri be an “anti-recommendation” set 
(e.g., a list of malwar link one should not visit). however, 
in the case we consid here, ri > 1. 

proof. let xr(!) = 1 if ! 2 R, and xr(!) = 0 oth- 
erwise. furthermore, suppos Ht = !at . then the log- 
likelihood l(r, r) of h1, . . . , Hn be 

l(r, r) = 
nX 

t=1 

h 
xr(!at) log 

⇣rpat 
z 

⌘ 
+ (1�xr(!at)) log 

⇣pat 
z 

⌘i 

= 
nX 

t=1 

[xr(!at) log r + log pat � log z] . 

now, note that 

z = r 
X 

!j2r 

pj + 
X 

!j 62r 

pj 

= (r � 1) 
X 

!j2r 

pj + 
X 

!j2⌦ 

pj 

= (r � 1)pr + 1. 

consequently, 

l(r, r) = 
nX 

t=1 

[xr(!at) log r + log pat � log((r � 1)pr + 1)] 

= nqr log r � n log ((r � 1)pr + 1) + 
nX 

t=1 

log pat . 

di↵erenti L with respect to r, we have 

@ 
@r 

l(r, r) = nqr 
r 

� npr 
(r � 1)pr + 1 

and so @@rl(r, r) = 0 when 

r = 
qR 
pR 

· 1� pR 
1� qR 

. 

At these critic points, 

z = (r � 1)pr + 1 

= 
1� pR 
1� qR 

. 

substitut these valu into the origin expression, we 
find that the valu of R at which l(r, r) attain it maxi- 
mum must also maxim the function 



100 

300 

500 

700 

900 

10% 30% 50% 70% 90% 
fraction of histori link in recommend set 

Si 
ze 

o 
f r 

ec 
om 

m 
en 

da 
tio 

n 
se 

t 

mle intersect size jaccard 

figur 1: contour plot that show how each rank- 

ing method score candidates, a a function of the 

proport of histori link that appear in the candi- 

date’ recommend set and the size of the rec- 

ommend set. contour of the mle method be 

steeper than jaccard but not a steep a intersect 

size. 

qR log r � log z 

= qR log 

 
qR 
pR 

· 1� pR 
1� qR 

� 
� log 

 
1� pR 
1� qR 

� 

= qR log 
qR 
pR 

� (1� qr) log 
 
1� pR 
1� qR 

� 
. 

therefore, we find that 

R̂ = argmax 
r2c 

 
qR log 

✓ 
qR 
pR 

◆ 
+ (1� qr) log 

✓ 
1� qR 
1� pR 

◆� 

and 

r̂ = 

✓ 
qr̂ 

1� qr̂ 

◆,✓ 
pr̂ 

1� pr̂ 

◆ 
. 

To help provid intuit about our mle approach, we 
compar it to two natur altern strategies. In the 
first—which we term the intersect size method [33, 38]— 
one associ a give histori H with the recommend 
set R that contain the most url from the histori (i.e., R 
that maxim |R \ h|). In contrast to the mle, such a 
strategi do not explicitli adjust for the size of the recom- 
mendat set, and one worri be that the intersect size 
method be bia toward larg recommend sets. To 
account for the size of a recommend set, a second al- 
tern be to associ a histori with the recommend 
set that have the great jaccard similar with the history: 
|H \r|/|h [r|. In mani cases, the recommend set R 
be much larg than the histori H (e.g., the number of link 
appear in one’ twitter feed be often much larg than 
the number of link one visits), and so maxim jaccard 
similar approxim amount to find the candid 
set R that maxim |H \r|/|r|. 

figur 1 show that our mle approach penal the size 
of a candid recommend set more than the intersec- 
tion size method and less than jaccard similarity. for each 
of the three de-anonym methods, the line in the con- 
tour plot indic level curves, along which candid rec- 
ommend set receiv equal scores. In comput the 
mle, for simplic we assum each item in the recommen- 
dation set have constant probabl pj = 1/10 

6. becaus the 
intersect size method be independ of the size of the 
recommend set, it level curv be vertical. jaccard, 
in contrast, have linear contour (where we approxim jac- 
card by |H \ r|/|r|, so that we do not need to consid 
depend on histori size). finally, the mle have contour 
that be close to those of intersect size, but not quit 
vertical. 

4. system design 
the mle estim describ abov requir calcul 

qr, the number of histori link appear in a candidate’ 
recommend set, and pr, the gener size of the rec- 
ommend set. furthermore, it requir maxim an 
express of these quantiti across all user in the network. 
for a typic network with hundr of million of users, ac- 
quir and calcul these quantiti be comput 
challenging. here, we outlin a system that address these 
hurdl for the twitter social network and enabl real-tim 
link of web brows histori to user profiles. 

4.1 candid rank 
We begin by express the mle estim concret in 

term of the twitter network: recommend sets, ri, be 
the link post by friend of a particular user i,3 and the 
anonym histori H = {h1, . . . , hn} be a set of link some 
user have click on from twitter.4 In thi formulation, qri 
be the number of link from H post by user i’ friends, and 
pri be a measur of the user’ feed size. 

An immedi simplif be to reduc our candid set 
C to onli feed that have at least one link from the history, 
Ĉ = {ri | Ri \ H 6= ;}, sinc the mle be approxim 
zero outsid of thi set. becaus the complet list of poster 
for a link be obtain through a search query, we can find 
all recommend set in ĉ. specifically, we first search 
twitter to determin all the user who post a link in the 
history. then, for everi poster, we add their followers’ feed 
to our reduc set of candid ĉ. the search result also 
let u calcul qri score for everi candid by count 
the number of distinct link in H post by their friends. 

the score pri be the total background probabl of click- 
ing on link in ri. In practice, it be imposs to deter- 
mine the exact distribut of these probabilities. We ap- 
proxim pri by assum that each of user i’ friend 
tweet link with a fix total probabl and estim p̂ri = 
� · (# of friend of user i), where � = e�15. the parame- 
ter � be loos estim base on the volum of twitter 
links; it be fix prior to ani empir evaluation. 

3twitter defin the friend of a user a the set of peopl the 
user follows. 
4the exact method use to restrict an entir brows his- 
tori to link click on from twitter depend on the mode 
of the attack and be describ late in more detail. 



network data 
realtim 

de-anonym 

network cach 

1. search 

2. crawl 

3. rank 

realtim 
crawler 

background 
crawler 

twitter 

listen 

figur 2: system architectur for real-tim de- 

anonym of web brows histories. 

4.2 system for real-tim de-anonym 
our strategi to gener candid queri twitter data 

sourc for search result and network inform (i.e., fol- 
low lists). there is, however, a limit to how mani queri 
we can make in real-time. To address thi issue, we first ob- 
serv that link appear in a larg number of candid set 
provid littl signal, and so one can calcul the mle on a 
reduc histori Ĥ ✓ H of inform link whose network 
inform be obtain within some set amount of time. 
If ani part of a link’ network be too expens to obtain, 
we disregard the link entirely. thi ensur we calcul qri 
exactli for a give histori ĥ. our approxim Ĥ can be 
thought of a strateg throw away some signal about 
link click by the user in order to exactli and tractabl 
calcul qr. 

To e�cient assembl network information, we use an 
eager cach strategy: in the background, we run a servic 
that listen to the stream of tweet and find user with 
between 10,000 and 100,000 followers; these user be then 
add to a cach and crawl by a di↵er process. our 
de-anonym strategi thu reli on both pre-fetch 
data and inform obtain in real-time. 

figur 2 outlin the system architectur use for real- 
time de-anonymization. our de-anonym servic start 
by receiv an anonym historyh. It then search twit- 
ter for all tweet contain link found in the history. the 
search result be pass on to the crawl system which 
attempt to crawl the follow of everi poster in the search 
results. If a poster be not cach and be too expens to 
crawl in real-time, we omit the link they post from our 
histori set to produc ĥ. At the end of the crawl stage, 
we have a list of recommend set and qri scores. the 
final step of the de-anonym calcul an mle use 
theorem 1 with the approxim ĉ, ĥ, and p̂ri describ 
in thi section. 

5. simul 

5.1 construct synthet histori 
To evalu our de-anonym strategy, we start by 

examin perform on a set of synthet gener 

● 

● 

● 

● 

● 

● 

● 

● 

● 
● 

● 

● 
● 

● 
● 

0% 

20% 

40% 

60% 

80% 

100% 

10 20 30 40 50 
number of link 

Ac 
cu 

ra 
cy 

mle 
intersect size 
jaccard 

figur 3: de-anonym accuraci on synthet 

brows histori for three candid rank meth- 

ods: the mle of theorem 1, the number of histori 

link appear in the candidate’ feed (intersect 

size), and jaccard similarity. 

histories. the simul histori be construct to follow a 
simpl behavior model: a user click on link mostli from 
their own feed and sometim click on link post by a 
friend of a friend. A user might be encourag to visit such 
friend-of-friend link by twitter’ algorithm recommenda- 
tion system [37] or simpli visit these link due to organ 
exploration. In either case, these friend-of-friend url test 
a de-anonym model’ resili to noise. 

base on the behavior model, we construct these histo- 
rie in three steps. first, we monitor the real-tim stream 
of twitter activ and randomli select a user who post 
a tweet, with two caveats: we exclud user with few than 
20 friend or follow and those with more than 300 friends. 
the former restrict ensur that our sampl includ rea- 
sonabl activ users, and the latter limit be chosen so that 
we can e�cient construct histori within rate limits. We 
note that thi sampl of user be not repres of the 
overal popul of twitter users, in part becaus those 
who appear in the real-tim stream of tweet tend to be 
significantli more activ than average. 

next, for each of the select users, we gener friend 
link and friend-of-friend links. friend links—post by a 
friend of the user and thu appear in the user’ feed—ar 
gener by randomli select one of the user’ friend and 
then randomli select a url post by that friend in the 
last 30 days. We sampl link post by friends-of-friend 
by first sampl a friend of the user uniformli at random, 
then sampl a friend of that friend at random, and final 
sampl a link post by that friend-of-friend. 

In total we gener 50 friend url and 10 friend-of-friend 
url for 60 users.5 We blend the friend and friend-of-friend 
url to creat a collect of synthet histori for each 
user with variou size and link compositions. 

5we select 90 user from the stream, but 30 have too littl 
obtain feed activ to simul 50 urls. 



● 

● 
● 

● 
● 

● 

● 

● 

● 

● 

● 

● 

● 

● 

● 

0% 

20% 

40% 

60% 

80% 

100% 

10 20 30 40 50 
number of link 

Ac 
cu 

ra 
cy 

friend−of−friend link 
0% 
10% 
20% 

figur 4: de-anonym accuraci on synthet 

brows histori gener with vari level of 

noise. 

5.2 analysi 
figur 3 compar the accuraci of the mle of theorem 1 

to that of the intersect and jaccard method for pure 
friend histories. the plot illustr two points. first, even 
with a rel small histori of links, the mle method suc- 
cess de-anonym a substanti proport of users. 
for example, give 30 urls, the mle correctli identi- 
fie 52% of user in our sample. second, at each histori 
size, the mle match or outperform the other two de- 
anonym methods. In contrast to the mle’ 52% de- 
anonym rate with 30 urls, the intersect method 
correctli identifi 42% of users, and jaccard identifi just 
13% of users. 

We next examin the robust of our approach to histo- 
rie contain friend-of-friend urls. figur 4 show these 
result for blend histori contain 10% and 20% friend- 
of-friend link at variou histori sizes. As expected, histori 
with friend-of-friend link be harder to de-anonymize. In 
particular, with 30 urls, 20% of which be friend-of-friend 
links, we success identifi 40% of user in our sample, 
compar to 52% for histori of size 30 contain onli 
friend links. nevertheless, de-anonym accuraci be still 
rel high. 

6. real-world evalu 

6.1 collect web brows data 
the abov result on synthet brows histori point to 

the potenti for our de-anonym approach. We next 
evalu thi method on real, user-contribut web brows 
histories, which we collect via an onlin experiment. 

the experi be open to user run the googl 
chrome web browser on a desktop computer. As show in 
figur 5, when user first visit our site, they be pro- 
vide with a brief descript of the experi and then 
ask to instal a chrome extens to send u their re- 
cent web brows history. the extens extract up to 
100 twitter links—mark with domain name t.co—visit 
within the past 30 day to gener the twitter histori H 

for de-anonymization. If few than five link be found 
in their history, we told user that we would not be abl to 
de-anonym them and sent no data to our servers. user 
with at least five t.co link be give an opportun to 
verifi their data and confirm that they want to share it. 

the upload histori be process by the real-tim de- 
anonym system describ in section 4.2. the system 
construct the reduc histori Ĥ of link by defin infor- 
mativ link a those which were: (1) tweet or retweet at 
most 100 times; and (2) have onli be tweet or retweet 
by peopl with at most 100,000 followers. If a user do not 
have at least four inform link (i.e., if |ĥ| < 4), we again 
told the user that we do not have enough inform to suc- 
cess run the de-anonym procedure. overall, 84% 
of user who submit their brows histori pass thi 
filter; among those with at least 10 links, 92% passed; and 
among those with at least 20 links, 97% pass the filter. 

the de-anonym procedur produc a list of can- 
didat rank by mle score. user be show the top 15 
candid and prompt to inform u which, if any, corre- 
spond to their twitter profile. after respond to thi 
question, user be o↵er an option opportun to dis- 
close their ident by sign into twitter, in which case 
we would know their ident even if none of our top 15 
candid be correct. 

We recruit particip by advertis the experi 
on a varieti of websites, includ twitter, facebook, quora, 
hacker news, and freedom to tinker. In total, 649 peopl 
submit web brows histories. In 119 case (18%), our 
applic encount a fatal error (e.g., becaus the twit- 
ter api be temporarili unavailable), and we be unabl to 
run the de-anonym algorithm. Of the 530 remain 
cases, 87 user (16%) have few than four inform links, 
and so we do not attempt to de-anonym them; we thu 
attempt to de-anonym 443 users. Of these, 374 user 
(84%) confirm whether or not our de-anonym at- 
tempt be successful. and of these 374 users, 77 (21%) 
addit disclos their ident by sign into twitter. 

We note that the user who particip in our experi 
be not repres of the twitter population. In partic- 
ular, they be quit active: the user who report their 
ident have a median number of 378 follow and post a 
median number of 2,041 total tweets. 

6.2 analysi 
Of the 374 peopl who confirm the accuraci of our de- 

anonym attempt, 268 (72%) be the top candid 
gener by the mle, and 303 particip (81%) be 
among the top 15 candidates.6 consist with our simu- 
lation results, we be abl to success de-anonym a 
substanti proport of user who contribut their web 
brows histories. 

figur 6 add detail to thi result, show accuraci a a 
function of the size of a participant’ submit history. As 
expected, perform be strongli relat to histori size. We 
correctli identifi 86% of user with 50–75 url wherea 
our accuraci fall to 71% for particip with 25–50 urls. 

We also compar the perform of our de-anonym 
approach to the intersect method and jaccard similarity. 

6in part we achiev thi perform becaus t.co link be 
uniqu gener everi time a link be post to twitter. 
however, even if we consid onli the original, unshorten 
links, we still achiev 49% de-anonym accuracy. 



figur 5: screenshot of the onlin experiment. 

● 

● 

● 
● 

● 

● 

● 

● 

● 

● 

● 

● 
● 

● 

● 

0% 

20% 

40% 

60% 

80% 

100% 

25 50 75 100 
number of link 

Ac 
cu 

ra 
cy 

mle 
intersect size 
jaccard 

figur 6: de-anonym accuraci for three can- 

didat rank method on user-contribut web 

brows histories. accuraci for intersect size 

and jaccard rank be approximate, a ground- 

truth answer be typic onli avail for user 

who be rank in the top 15 by the mle. 

unfortunately, becaus of the experiment’ design, we typi- 
calli onli know ground truth for the individu who rank 
in the top 15 by our approach, and it be possibl in theori 
that the other two method succeed precis where the mle 
fails. To ass thi possibility, we consid the 11 case in 
which an individu do not appear in our list of top 15 can- 
didat but disclos their ident by sign into twitter. 
In all of these 11 cases, both the intersect method and 
jaccard fail to success identifi the user. thus, while 
base on a small sample, it seem reason to assum that 
if a particip be not rank in the top 15 by the mle 
method, then other de-anonym method would also 
have failed. base on thi assumption, figur 6 compar 
the perform of all three de-anonym method on 
the full set of 374 users. As on the simul data, we find 
that our method outperform jaccard similar and inter- 
section size, often by a substanti margin. 

We can further use the mle score to estim the con- 
fidenc of our predictions. given order candid score 
s1 � s2 � · · · � sn for an anonym brows histori H, 
the eccentr [28] of H be (s1�s2)/std-dev({si}). figur 7 

70% 

75% 

80% 

85% 

90% 

95% 

100% 

0% 20% 40% 60% 80% 100% 
coverag 

Ac 
cu 

ra 
cy 

eccentr 
histori length 

figur 7: de-anonym accuraci on the top-k 
histori rank by eccentr and histori length. 

show predict accuraci on the top-k instanc rank by 
eccentricity. the right-most point on the plot correspond 
to accuraci on the full set of 374 histori (72%); if we limit 
to the 50% of histori with the high eccentricity, accu- 
raci increas to 96%. for comparison, the plot also show 
accuraci a a function of histori length, and indic that 
eccentr be the good predictor of accuracy. 

7. threat model 
our de-anonym strategi assum access to an in- 

dividual’ twitter brows history. such data be avail 
to a varieti of organ with commerci or strateg in- 
centiv to de-anonym users. In thi section, we describ 
two such possibl attack and evalu the e�caci of our 
approach on data avail to them. 

third-parti tracker be entiti emb into some web- 
site for the purpos of collect individu user brows 
habits. tracker can determin whether a user arriv from 
twitter to a site where they be emb by examin 
the page’ document.referr property. We estim the 
de-anonym capabl of four common third-parti 
trackers: google, facebook, comscore, and appnexus. for 
each user-contribut history, and for each organization, we 
first determin which url in the histori they be like 
abl to track by check if the organ have a tracker 



● 

● 

● 

● 

● 

● 

● 

● ● 
● 

● 

● 

● 
● 

● 

● 

● 

● 

● 

● 

0% 

20% 

40% 

60% 

80% 

100% 

25 50 75 100 
number of link 

Ac 
cu 

ra 
cy 

● 

● 

● 

● 

googl 
facebook 
appnexu 
comscor 

figur 8: de-anonym accuraci on the subset 

of link visibl to variou organ that track 

onlin behavior, base on user-submit histories. 

instal on the top-level domain of the url [10]. We then 
attempt to de-anonym each histori base onli on the sub- 
set of url visibl to each track organization. figur 8 
show the result of thi analysi and illustr that all four 
organ be pervas enough to success carri out 
de-anonym use our method. 

finally, we examin the de-anonym capabl of a 
network eavesdropper. these be attack capabl of sni↵- 
ing network tra�c (e.g., state actor with access to back- 
bone servers) and monitor server request from anony- 
mou users. due to secur featur of the http protocol, 
such attack can onli determin the full url of request 
make over http. therefore, to simul the data avail 
to them, we run our de-anonym strategi use onli 
http link submit in our real-world experiment. We find 
that network attack can be fairli successful: 31% of par- 
ticip in our experi be identifi use onli their 
http links. 

8. discuss and conclus 
We have show theoret and empir that web 

brows histori can be link to social medium profil us- 
ing onli public auxiliari information. the form of theo- 
rem 1 appli to ani bound set of item from which an 
anonym actor make select influenc by some a�n- 
iti mechanism. for example, paper citat be like se- 
lect from a univers of relev work where author have 
an a�niti for their own work or past citations, a show 
by [14]. with thi framing, our mle may be use to de- 
anonym paper with author name strip for double- 
blind review. similarly, our model be applic to the prob- 
lem of de-anonym a movi rental record base on re- 
view post on the web [28], a well a a long-term inter- 
section attack against an anonym system base on, say, 
the time of a user’ tweet or blog post [24]. all of these 
can be see a behavior fingerprint of a user, and our anal- 
ysi help explain whi such fingerprint tend to be uniqu 
and linkable. explor other problem where our model 
appli be one direct for futur work. 

our statist approach yield a use algorithm that 
we be abl to valid in simul and with real brows- 
ing histories. our quantit estim of accuraci might 
overestim the e↵ect of a real-lif attack in some 
way but underestim it in other ways. for example, 
a third-parti tracker may not alway be abl to learn if 
the current page visit origin from the social medium site 
in question. On the other hand, the adversari may fruit- 
fulli make use of other fingerprint inform avail 
through urls, such a utm codes. thus, the main lesson 
of our paper be qualitative: we present multipl line of evi- 
denc that brows histori may be link to social medium 
profiles, even at a scale of hundr of million of potenti 
users. furthermore, our attack have no univers mitig 
outsid of disabl public access to social medium sites, an 
act that would undermin the valu of these sites. 

there be mani way in which brows histori may be 
de-anonym online. most straightforwardly, both face- 
book and google—exploit the fact that they be promi- 
nent first parti a well a third parties—track user under 
their real identities. however, our attack be signific for it 
broad applicability. the techniqu be avail to all track- 
ers, includ those with whom the user have no first-parti 
relationship. our find be relev in variou other set- 
tings. one exampl be the feder commun com- 
mission’ recent adopt privaci rule for internet servic 
providers: the fcc requir that to store and use custom 
information, isp ensur that the inform be “not rea- 
sonabl linkable” to individuals. our result suggest that 
pseudonym brows histori fail thi test, and call for 
more research into privacy-preserv data mine of brows- 
ing histori [16, 12]. 

acknowledg 
We thank twitter for support thi research by provid 
free access to the gnip search api. We also thank henri 
stern for hi help build the onlin experiment. finally, 
we thank jonathan mayer and the anonym review 
for their help feedback. narayanan be support by nsf 
award cn 1526353. 

9. refer 
[1] G. acar, C. eubank, S. englehardt, M. juarez, 

A. narayanan, and C. diaz. the web never forgets: 
persist track mechan in the wild. In 
proceed of acm ccs, page 674–689. acm, 2014. 

[2] G. acar, M. juarez, N. nikiforakis, C. diaz, S. gürses, 
F. piessens, and B. preneel. fpdetective: dust the 
web for fingerprinters. In proceed of the 2013 acm 
sigsac confer on comput & commun 
security, page 1129–1140. acm, 2013. 

[3] M. D. ayenson, D. J. wambach, A. soltani, N. good, 
and C. J. hoofnagle. flash cooki and privaci ii: 
now with html5 and etag respawning. 2011. 

[4] C. budak, S. goel, J. rao, and G. zervas. 
understand emerg threat to onlin advertising. 
In proceed of the acm confer on econom 
and computation, 2016. 

[5] M. chew and S. stamm. contextu identity: 
freedom to be all your selves. In proceed of the 
workshop on web, volum 2. citeseer, 2013. 



[6] N. christin, S. S. yanagihara, and K. kamataki. 
dissect one click frauds. In proceed of the 17th 
acm confer on comput and commun 
security, page 15–26. acm, 2010. 

[7] y.-a. De montjoye, C. A. hidalgo, M. verleysen, and 
V. D. blondel. uniqu in the crowd: the privaci 
bound of human mobility. scientif reports, 3, 2013. 

[8] y.-a. De montjoye, L. radaelli, V. K. singh, et al. 
uniqu in the shop mall: On the reidentifi 
of credit card metadata. science, 347(6221), 2015. 

[9] P. eckersley. how uniqu be your web browser? In 
intern symposium on privaci enhanc 
technolog symposium, page 1–18. springer, 2010. 

[10] S. englehardt and A. narayanan. onlin tracking: A 
1-million-sit measur and analysis. In acm 
confer on comput and commun 
security, 2016. 

[11] S. englehardt, D. reisman, C. eubank, 
P. zimmerman, J. mayer, A. narayanan, and E. W. 
felten. cooki that give you away: the surveil 
implic of web tracking. In proceed of the 
24th confer on world wide web, 2015. 

[12] ú. erlingsson, V. pihur, and A. korolova. rappor: 
random aggregat privacy-preserv ordin 
response. In proceed of the confer on 
comput and commun security, 2014. 

[13] D. fifield and S. egelman. fingerprint web user 
through font metrics. In intern confer on 
financi cryptographi and data security, 2015. 

[14] S. hill and F. provost. the myth of the double-blind 
review?: author identif use onli citations. 
sigkdd explor. newsl., 5(2):179–184, dec. 2003. 

[15] M. korayem and D. J. crandall. de-anonym 
user across heterogen social comput 
platforms. In icwsm, 2013. 

[16] A. korolova, K. kenthapadi, N. mishra, and 
A. ntoulas. releas search queri and click 
privately. In proceed of the 18th intern 
confer on world wide web. acm, 2009. 

[17] B. krishnamurthy, K. naryshkin, and C. wills. 
privaci leakag vs. protect measures: the grow 
disconnect. In proceed of the web, 2011. 

[18] B. krishnamurthi and C. E. wills. On the leakag of 
person identifi inform via onlin social 
networks. In proceed of the 2nd acm workshop on 
onlin social networks, page 7–12. acm, 2009. 

[19] P. laperdrix, W. rudametkin, and B. baudry. beauti 
and the beast: divert modern web browser to 
build uniqu browser fingerprints. In 37th ieee 
symposium on secur and privacy, 2016. 

[20] A. lerner, A. K. simpson, T. kohno, and F. roesner. 
internet jone and the raider of the lose trackers: An 
archaeolog studi of web track from 1996 to 
2016. In 25th usenix secur symposium, 2016. 

[21] T. libert. expos the invis web: An analysi of 
third-parti http request on 1 million websites. 
intern journal of communication, 9:18, 2015. 

[22] C. Y. ma, D. K. yau, N. K. yip, and N. S. rao. 
privaci vulner of publish anonym mobil 

traces. ieee/acm transact on networking, 
21(3):720–733, 2013. 

[23] A. marthew and C. tucker. govern surveil 
and internet search behavior. avail at ssrn 
2412564, 2015. 

[24] N. mathewson and R. dingledine. practic tra�c 
analysis: extend and resist statist disclosure. 
In intern workshop on privaci enhanc 
technologies, page 17–34. springer, 2004. 

[25] J. R. mayer and J. C. mitchell. third-parti web 
tracking: polici and technology. In 2012 ieee 
symposium on secur and privacy. ieee, 2012. 

[26] K. moweri and H. shacham. pixel perfect: 
fingerprint canva in html5. w2sp, 2012. 

[27] A. narayanan, H. paskov, N. Z. gong, J. bethencourt, 
E. stefanov, E. C. R. shin, and D. song. On the 
feasibl of internet-scal author identification. In 
ieee symposium on secur and privacy, 2012. 

[28] A. narayanan and V. shmatikov. robust 
de-anonym of larg spars datasets. In 2008 
ieee symposium on secur and privaci (sp 2008), 
page 111–125. ieee, 2008. 

[29] N. nikiforakis, A. kapravelos, W. joosen, C. kruegel, 
F. piessens, and G. vigna. cookieless monster: 
explor the ecosystem of web-bas devic 
fingerprinting. In secur and privaci (sp), 2013 
ieee symposium on, page 541–555. ieee, 2013. 

[30] L. olejnik, G. acar, C. castelluccia, and C. diaz. the 
leak batteri A privaci analysi of the html5 
batteri statu api. technic report, 2015. 

[31] L. olejnik, C. castelluccia, and A. janc. whi johnni 
can’t brows in peace: On the uniqu of web 
brows histori patterns. In 5th workshop on hot 
topic in privaci enhanc technologies, 2012. 

[32] J. penney. chill e↵ects: onlin surveil and 
wikipedia use. berkeley technolog law journal, 2016. 

[33] A. ramachandran, Y. kim, and A. chaintreau. “I 
knew they click when I saw them with their 
friends”. In proceed of the 2nd confer on 
onlin social networks, 2014. 

[34] F. roesner, T. kohno, and D. wetherall. detect 
and defend against third-parti track on the web. 
In proceed of the 9th usenix confer on 
network system design and implementation, page 
12–12. usenix association, 2012. 

[35] K. sharad and G. danezis. An autom social graph 
de-anonym technique. In proceed of the 
13th workshop on privaci in the electron society, 
page 47–58. acm, 2014. 

[36] A. soltani, S. canty, Q. mayo, L. thomas, and C. J. 
hoofnagle. flash cooki and privacy. In aaai spring 
symposium: intellig inform privaci 
management, volum 2010, page 158–163, 2010. 

[37] J. su, A. sharma, and S. goel. the e↵ect of 
recommend on network structure. In proceed 
of the 25th confer on world wide web, 2016. 

[38] G. wondracek, T. holz, E. kirda, and C. kruegel. A 
practic attack to de-anonym social network users. 
In ieee symposium on secur and privacy, 2010. 



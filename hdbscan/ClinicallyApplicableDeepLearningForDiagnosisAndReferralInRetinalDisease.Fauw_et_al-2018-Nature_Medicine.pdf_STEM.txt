




































































































































































































clinic applic deep learn for diagnosi and referr in retin diseas 


articl 
https://doi.org/10.1038/s41591-018-0107-6 

1deepmind, london, uk. 2nihr biomed research centr at moorfield eye hospit and ucl institut of ophthalmology, london, uk. 
3present address: univers colleg london, london, uk. 4these author contribut equally: julien cornebise, pears A. keane, olaf ronneberger. 
*e-mail: pearse.keane@moorfields.nhs.uk; olafr@deepmind.com 

medic imag be expand global at an unpreced rate1,2, lead to an ever-expand quantiti of data that requir human expertis and judgement to interpret and 
triage. In mani clinic special there be a rel shortag of thi 
expertis to provid time diagnosi and referral. for example, in 
ophthalmology, the widespread avail of optic coher 
tomographi (oct) have not be match by the avail of 
expert human to interpret scan and refer patient to the appro- 
priat clinic care3. thi problem be exacerb by the mark 
increas in preval of sight-threaten diseas for which oct 
be the gold standard of initi assessment4–7. 

artifici intellig (ai) provid a promis solut for such 
medic imag interpret and triage, but despit recent break- 
through studi in which expert-level perform on two-dimen- 
sional photograph in preclin set have be demonstrated8,9, 
prospect clinic applic of thi technolog remain stymi 
by three key challenges. first, AI (typic train on hundr of 
thousand of exampl from one canon dataset) must gener 
to new popul and devic without a substanti loss of perfor- 
mance, and without prohibit data requir for retraining. 
second, AI tool must be applic to real-world scans, problem 
and pathways, and design for clinic evalu and deployment. 
finally, AI tool must match or exceed the perform of human 
expert in such real-world situations. recent work appli AI to 

oct have show promis in resolv some of these criterion in isola- 
tion, but have not yet show clinic applic by resolv all three. 

result 
clinic applic and AI architecture. We develop our 
architectur in the challeng context of oct imag for oph- 
thalmology. We test thi approach for patient triag in a typi- 
cal ophthalmolog clinic referr pathway, compris more 
than 50 common diagnosi for which oct provid the defini- 
tive imag modal (supplementari tabl 1). oct be a three- 
dimension volumetr medic imag techniqu analog to 
three-dimension ultrasonographi but measur the reflect 
of near-infrar light rather than sound wave at a resolut for 
live human tissu of ~5 µ m10. oct be now one of the most com- 
mon imag procedur with 5.35 million oct scan perform 
in the US medicar popul in 2014 alon (see https://www.cms. 
gov/research-statistics-data-and-systems/statistics-trends-and- 
reports/medicare-provider-charge-data/physician-and-other- 
supplier.html). It have be wide adopt across the UK nation 
health servic (nhs) for comprehens initi assess and tri- 
age of patient requir rapid non-elect assess of acut and 
chronic sight loss. rapid access ‘virtual’ oct clinic have becom 
the standard of care11,12. In such clinics, expert clinician interpret 
the oct and clinic histori to diagnos and triag patient with 

clinic applic deep learn for diagnosi 
and referr in retin diseas 
jeffrey De fauw1, joseph R. ledsam1, bernardino romera-paredes1, stanislav nikolov1, 
nenad tomasev1, sam blackwell1, harri askham1, xavier glorot1, brendan o’donoghue1, 
daniel visentin1, georg van den driessche1, balaji lakshminarayanan1, clemen meyer1, 
faith mackinder1, simon bouton1, kareem ayoub1, reena chopra 2, domin king1, alan 
karthikesalingam1, cían O. hugh 1,3, rosalind raine3, julian hughes2, dawn A. sim2, 
catherin egan2, adnan tufail2, hugh montgomeri 3, demi hassabis1, geraint ree 3, 
trevor back1, peng T. khaw2, mustafa suleyman1, julien cornebise1,3,4, pears A. kean 2,4* 
and olaf ronneberg 1,4* 

the volum and complex of diagnost imag be increas at a pace faster than the avail of human expertis to inter- 
pret it. artifici intellig have show great promis in classifi two-dimension photograph of some common diseas 
and typic reli on databas of million of annot images. until now, the challeng of reach the perform of expert 
clinician in a real-world clinic pathway with three-dimension diagnost scan have remain unsolved. here, we appli a 
novel deep learn architectur to a clinic heterogen set of three-dimension optic coher tomographi scan 
from patient refer to a major eye hospital. We demonstr perform in make a referr recommend that reach 
or exce that of expert on a rang of sight-threaten retin diseas after train on onli 14,884 scans. moreover, we 
demonstr that the tissu segment produc by our architectur act a a device-independ representation; referr 
accuraci be maintain when use tissu segment from a differ type of device. our work remov previou barrier to 
wider clinic use without prohibit train data requir across multipl patholog in a real-world setting. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicine1342 

mailto:pearse.keane@moorfields.nhs.uk 
mailto:olafr@deepmind.com 
https://www.cms.gov/research-statistics-data-and-systems/statistics-trends-and-reports/medicare-provider-charge-data/physician-and-other-supplier.html 
https://www.cms.gov/research-statistics-data-and-systems/statistics-trends-and-reports/medicare-provider-charge-data/physician-and-other-supplier.html 
https://www.cms.gov/research-statistics-data-and-systems/statistics-trends-and-reports/medicare-provider-charge-data/physician-and-other-supplier.html 
https://www.cms.gov/research-statistics-data-and-systems/statistics-trends-and-reports/medicare-provider-charge-data/physician-and-other-supplier.html 
http://orcid.org/0000-0002-4264-8329 
http://orcid.org/0000-0001-6901-0985 
http://orcid.org/0000-0001-8797-5019 
http://orcid.org/0000-0002-9623-7007 
http://orcid.org/0000-0002-9239-745x 
http://orcid.org/0000-0002-4266-1515 
http://www.nature.com/naturemedicin 


articlesnatur medicin 

patholog affect the macula, the central part of the retina that be 
requir for high-resolution, color vision. 

autom diagnosi of a medic image, even for a singl dis- 
ease, face two main challenges: technic variat in the imag 
process (differ devices, noise, age of the compon and so 
on), and patient-to-pati variabl in patholog manifest 
of disease. exist deep learn approaches8,9 tri to deal with all 
combin of these variat use a singl end-to-end black-box 
network, thu typic requir million of label scans. By con- 
trast, our framework decoupl the two problem (technic varia- 
tion in the imag process and patholog variants) and solv them 
independ (see fig. 1). A deep segment network (fig. 1b) 
creat a detail device-independ tissue-segment map. 
subsequently, a deep classif network (fig. 1d) analysi thi 
segment map and provid diagnosi and referr suggestions. 

the segment network (fig. 1b) us a three-dimension 
u-net architecture13,14 to translat the raw oct scan into a tis- 
sue map (fig. 1c) with 15 class includ anatomy, patholog 
and imag artefact (supplementari tabl 2). It be train with 
877 clinic oct scan (topcon 3D oct, topcon) with spars 
manual segment (dataset 1 in supplementari tabl 3, see 
method ‘manual segmentation’ and ‘datasets’ for full breakdown 
of scan dataset). onli approxim three repres slice 
out of the 128 slice of each scan be manual segment (see 
supplementari tabl 4 for imag sizes). thi spars annot pro- 
cedure14 allow u to cover a larg varieti of scan and patholog 
with the same workload a approxim 21 dens manual segmen- 
tations. exampl of the output of our segment network for 
illustr patholog be show in fig. 2. 

the classif network (fig. 1d) analysi the tissue-seg- 
mentat map (fig. 1c) and a the primari outcom provid 
one of four referr suggest current use in clinic practic 
at moorfield eye hospit (pleas see supplementari tabl 1 for a 

list of retin condit associ with these referr suggestions). 
additionally, it report the presenc or absenc of multiple, con- 
comit retin patholog (supplementari tabl 5). To construct 
the train set for thi network, we assembl 14,884 oct scan 
volum obtain from 7,621 patient who be refer to the hos- 
pital with symptom suggest of macular patholog (see method 
‘clinic labeling’). these oct scan be automat segment 
use our segment network. the result segment map 
with the clinic label built the train set for the classif 
network (dataset 3 in supplementari tabl 3, illustr in fig. 1d). 

A central challeng in oct-imag segment be the presenc 
of ambigu regions, where the true tissu type cannot be deduc 
from the image, and thu multipl equal plausibl interpreta- 
tion exist. To address thi issue, we train not one but multipl 
instanc of the segment network. each network instanc cre- 
ate a full segment map for the give scan, result in mul- 
tipl hypothesi (see supplementari fig. 1). analog to multipl 
human experts, these segment map agre in area with clear 
imag structur but may contain differ (but plausible) interpre- 
tation in ambigu low-qual regions. these multipl segmen- 
tation hypothesi from our network can be display a a video, 
in which the ambigu region and the propos interpret 
be clearli visibl (see method ‘visual of result in clinic 
practice’; use of thi viewer across a rang of challeng macular 
diseas be illustr in supplementari video 1–9). 

achiev expert perform on referr decisions. To evalu 
our framework, we first defin a gold standard. thi use infor- 
mation that be not avail at the first patient visit and oct scan, 
by examin the patient clinic record to determin the final 
diagnosi and optim referr pathway in the light of the (subse- 
quentli obtained) information. such a gold standard can onli be 
obtain retrospectively. gold standard label be acquir for 

c 

tissue-segment map 

e 

diagnosi probabl 
and referr suggest 

b 

segment network 

a 

d 

classif network 

877 manual segment 
train imag 

14,884 train tissu map with confirm 
diagnosi and referr decis 

normal 

cnv 

mro 

csr 
full mac. hole 

referr suggest (%) 
98.9 
0.5 
0.4 
0.2 

7.1 
99.0 
5.4 
11.0 
24.2 
15.0 
43.4 
51.9 

0.050 

0.000erm 
drusen 

urgent 
semi-urg 

routin 
observ onli 

diagnosi probabl (%) 

normal 
cnv 
mro 

full mac. hole 
part. mac. hole 

csr 
vmt 

geo. atrophi 

tissu volum (mm3)digit oct scan 

fig. 1 | our propos Ai framework. a, raw retin oct scan (6 × 6 × 2.3 mm³ around the macula). b, deep segment network, train with manual 
segment oct scans. c, result tissu segment map. d, deep classif network, train with tissu map with confirm diagnosi and 
optim referr decisions. e, predict diagnosi probabl and referr suggestions. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicin 1343 

http://www.nature.com/naturemedicin 


articl natur medicin 

997 patient that be not includ in the train dataset (data- 
set 5 in supplementari tabl 5). We then test our framework on 
thi dataset. for each patient, we obtain the referr suggest 
of our framework plu an independ referr suggest from 
eight clinic experts, four of whom be retina specialist and four 
optometrist train in medic retina (see supplementari tabl 
6 for more information). each expert provid two separ deci- 
sions, one (like our framework) from the oct scan alon (dataset 
7 in supplementari tabl 5); and one from the oct plu fundu 
imag and clinic note (dataset 8 in supplementari tabl 5, see 
supplementari fig. 2), in two separ session space at least two 
week apart. We compar each of these perform (framework 
and two expert decisions) against the gold standard. 

our framework achiev and in some case exceed expert per- 
formanc (fig. 3). To illustr this, fig. 3a display perform 
on ‘urgent referrals’, the most import clinic referr decis 
(mainli for patholog that caus choroid neovascularization; 
see supplementari tabl 1) versu all other referr decis a 
a receiv oper characterist (roc) plot (plot for the other 
decis be show in supplementari fig. 3). perform of our 
framework match our two best retina specialist and have a sig- 
nificantli high perform than the other two retin special- 
ist and all four optometrist when they use onli the oct scan 
to make their referr suggest (fig. 3a, fill markers). when 
expert have access to the fundu imag and patient summari note 
to make their decision, their perform improv (fig. 3a, empti 
markers) but our framework remain a good a the five best 
expert and continu to significantli outperform the other three 
(see supplementari information). 

To provid a more complet picture, the overal perform 
of our framework on all four clinic referr suggest (urgent, 
semi-urgent, routin and observ only) compar to the two 
high perform retina specialist be display in fig. 3b. the 
framework perform compar to the two best-perform 
retina specialists, and make no clinically-seri wrong decis 
(top right element of each matrix; that is, refer a patient who 
need an urgent referr to observ only). confus matri- 
ce for the assess of the other human expert be show in 
supplementari fig. 4. the aggreg number of wrong referr 
decis be display a error rate (1 − accuracy) for our framework 
and all expert in fig. 3c. our framework (5.5% error rate) per- 
form compar to the two best retina specialist (6.7% and 6.8% 
error rate) and significantli outperform the other six expert in 
the ‘oct only’ setting. signific threshold (3.9% for high per- 
formanc and 7.3% for low performance) be deriv by a two- 
side exact binomi test, incorpor uncertainti from both the 
expert and the algorithm (see method ‘statist analysis’). when 
expert addit use the fundu imag and the summari note 
of the patient, five approach the perform of our framework 
(three retina specialist and two optometrists), which continu to 
significantli outperform the remain three (one retina specialist 
and two optometrists). 

our framework us an ensembl of five segment and 
five classif model instanc (see supplementari fig. 1) to 
achiev these results. besid the benefit of an uncertainti measure, 
ensembl also significantli improv overal perform com- 
par to a singl model instance. error rate for differ ensembl 
size be show in supplementari fig. 5. with more segment 

oct 

vitreou or subhyaloid space 
posterior hyaloid 
epiretin membran 
neurosensori retina 
intraretin fluid 

subretin fluid 
subretin hyper reflect. mat. 
retin pigment epithelium 
drusenoid ped 
serou ped 

fibrovascular ped 
choroid and outer layer 
pad artefact 
blink artefact 
foldov artefact 

manual segment autom segment 

a 

b 

c 

fig. 2 | result of the segment network. three select two-dimension slice from the n = 224 oct scan in the segment test set (left) 
with manual segment (middle) and autom segment (right; detail color legend in supplementari tabl 2). a, A patient with diabet 
macular edema. b, A patient with choroid neovascular result from age-rel macular degener (amd), demonstr extens 
fibrovascular pigment epithelium detach and associ subretin fluid. c, A patient with neovascular amd with extens subretin hyperreflect 
material. further exampl of the variat of patholog with model segment and diagnost perform can be found in supplementari video 1–9. 
In all exampl the classif network predict the correct diagnosis. scale bars, 0.5 mm. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicine1344 

http://www.nature.com/naturemedicin 


articlesnatur medicin 

retina specialist 1 
(oct + fundu + notes) 

our model 
(oct only) 

retina specialist 2 
(oct + fundu + notes) 

100 

90 

80 

70 

60 

50 

40 

30 

20 

10 

0 
0 10 20 30 40 50 60 70 80 90 100 

urgent referr 

fals alarm rate (%) (n = 745) 

H 
it 

ra 
te 

( 
% 

) 
(n 

= 
2 

52 
) 

H 
it 

ra 
te 

( 
% 

) 
(n 

= 
2 

52 
) 

our model (auc = 99.21) 

our model (balanc performance) 

retina specialist 3 (~13 yr) 

retina specialist 2 (~21 yr) 

retina specialist 1 (~21 yr) 

retina specialist 4 (~12 yr) 

optometrist 1 (~15 yr) 

optometrist 2 (~9 yr) 

optometrist 3 (~6 yr) 

optometrist 4 (~3 yr) 

100 

95 

90 

85 

80 

75 
0 5 

fals alarm rate (%) (n = 745) 

10 15 20 25 

zoom 

R1 

r4r2 

R3 

O3 

O4 

O2 

O1 

urgent routin 

routin 

obser- 
vation 

obser- 
vation 

predict referr predict referr predict referr 
semi- 
urgent 

semi- 
urgent 

urgent 

G 
ol 

d 
st 

an 
da 

rd 
r 

ef 
er 

ra 
l 

urgent routin 

routin 

obser- 
vation 

obser- 
vation 

semi- 
urgent 

semi- 
urgent 

urgent 

G 
ol 

d 
st 

an 
da 

rd 
r 

ef 
er 

ra 
l 

urgent routin 

routin 

obser- 
vation 

obser- 
vation 

semi- 
urgent 

semi- 
urgent 

urgent 

G 
ol 

d 
st 

an 
da 

rd 
r 

ef 
er 

ra 
l 

5 13 

2 

0 

0 

0 0 

031 

111 4 

0 2 20 

8 13 

0 

20 

4 

4 

3 

3 

1 1 10 

2 72 410 

1 1 14 

3 

234 

225 

228 

223 

254 

237 

231 

226 

250 

227 

250 

233 

25 

20 

15 

10 

5 

0 
our 

model 
1 2 3 4 1 2 3 4 

retina specialist optometrist 

E 
rr 

or 
r 

at 
e 

(% 
) 

(lo 
w 

er 
be 

b 
et 

te 
r) 

error on referr decis 
(everi error count equally) 

oct onli 

oct + fundu + note 

significantli bad (>7.3) 

significantli good (<3.9) 

5.5 
6.8 

5.5 
6.7 6.3 

10.9 

13.0 

7.4 
6.6 

10.0 

6.5 

17.0 

8.8 

6.9 

10.7 

13.1 

24.1 

a 

b 

c 

fig. 3 | result on the patient referr decision. perform on an independ test set of n = 997 patient (252 urgent, 230 semi-urgent, 266 routine, 
249 observ only). a, roc diagram for urgent referr (for choroid neovascular (cnv)) versu all other referrals. the blue roc curv be creat 
by sweep a threshold over the predict probabl of a particular clinic diagnosis. point outsid the light blue area correspond to a significantli 
differ perform (95% confid level, use a two-sid exact binomi test). the asterisk denot the perform of our model in the ‘balanc 
performance’ setting. fill marker denot experts’ perform use oct only; empti marker denot their perform use oct, fundu imag and 
summari notes. dash line connect the two perform point of each expert. b, confus matrix with patient number for referr decis for our 
framework and the two best retina specialists. these show the number of patient for each combin of gold standard decis and predict decision. 
the number of correct decis be found on the diagonal. wrong decis due to overdiagnosi be in the bottom-left triangle, and wrong decis 
due to underdiagnosi be in the top-right triangle. c, total error rate (1 − accuracy) on referr decision. valu outsid the light-blu area (3.9–7.3%) be 
significantli differ (95% confid interval, use a two-sid exact binomi test) to the framework perform (5.5%). auc, area under curve. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicin 1345 

http://www.nature.com/naturemedicin 


articl natur medicin 

model instanc and more classif model instances, perfor- 
manc increases. the bottom right cell in that tabl illustr that 
perform differ between 4 × 4 model instanc and 5 × 5 
model instanc be onli marginal, so we do not expect signific 
chang by add more instances. the accumul number of 
diagnost error do not fulli reflect the clinic consequ 
that an incorrect referr decis might have for patients, which 
depend also on the specif diagnosi that be missed. for example, 
fail to diagnos sight-threaten condit could result in 
rapid visual loss3,15,16, which be not the case for mani other diagno- 
ses. for an initi quantit estim of these consequences, 
we weight differ type of diagnost error accord to the 
judgement of our clinic expert of the clinic impact of errone- 
ou classif (express a penalti points; see supplementari 
fig. 6a). We deriv a score for our framework and each expert 
a a weight averag of all wrong diagnoses. thi reveal that 
our framework achiev a low averag penalti score than ani 
of our expert (supplementari fig. 6b). We further optim the 
decis of our framework to minim thi specif score (see 
method ‘optim the ensembl output for sensitivity, speci- 
ficiti and penalti scores’) which further improv perform 
(supplementari fig. 6b). therefore, expert perform of our 
framework be not achiev at the cost of miss clinic impor- 
tant sight-threaten diagnoses. 

To examin how our propos two-stag architectur compar to 
a tradit single-stag architecture, we train an end-to-end clas- 
sific network with the same architectur a our second stage to 
directli map from a raw oct scan to a referr decis (see method 
‘end-to-end classif network’). the error rate achiev with an 
ensembl of five network instanc be 5.5%, which be not signifi- 
cantli differ from the perform of the two-stag architecture. 
thi valid our choic of the two-stag architectur that offer sev- 
eral clinic advantag (see supplementari fig. 7). 

achiev expert perform on retin morphology. the referr 
decis recommend by our framework be determin by the most 
urgent diagnosi detect on each scan (supplementari tabl 1). 
patient may also have multipl concomit retin pathologies. 
these addit patholog do not chang the referr decision, 
but may have implic for further investig and treat- 
ment. our framework be therefor also train to predict the 
probabl of a patient have one or more of sever patholog 
(supplementari tabl 5). 

To evalu perform on diagnos multipl pathologies, 
a ‘silver standard’ for each scan be establish by major vote 
from the eight expert who evalu the oct scan, fundu imag 
and patient summari note (dataset 6 in supplementari tabl 3). 
thi major vote bia the assess against our framework. 

a 

b 

c 

origin 
segment 

network 

origin 
classif 

network 

total error rate: 46.6% 

retrain 
segment 

network 

total error rate: 3.4% 

d 

oct scan from new devic 

oct scan from new devic 

predict referr 

urgent 
semi- 
urgent routin 

obser- 
vation 

G 
ol 

d 
st 

an 
da 

rd 
r 

ef 
er 

ra 
l 10 3 0 

0 

0 

000 

0 2 

81 19 

21 

33 

19 

origin 
classif 

network 

G 
ol 

d 
st 

an 
da 

rd 
r 

ef 
er 

ra 
l 

predict referr 

33 

27 

35 

0 1 0 

0 0 

0 

20 0 

00 

1 

urgent 

semi- 
urgent 

routin 

obser- 
vation 

urgent 

semi- 
urgent 

routin 

obser- 
vation 

urgent 
semi- 
urgent routin 

obser- 
vation 

17 

fig. 4 | gener to a new scan devic type. a, low perform of origin network on oct scan from the new devic type 2. left, the select 
slice show the differ appear of structur in devic type 2. middle, a poor qualiti segment map creat with our origin segment 
network (color legend in supplementari tabl 2). right, result perform on a new test set of n = 116 patients. the confus matrix show patient 
number for the referr suggestion. b, all five segment hypothesi from our origin network. the strong variat show the larg uncertainty. c, high 
perform be attain on the devic type 2 test set (n = 116) after retrain the segment network with oct scan from devic type 1 and devic 
type 2. the classif network be unchanged. d, all five segment hypothesi from the retrain segment network. the network be confid in 
the interpret of most structures, and just highlight the ambigu in the sub-retin pigment epithelium (rpe) space. scale bars: 0.5 mm. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicine1346 

http://www.nature.com/naturemedicin 


articlesnatur medicin 

nevertheless, our framework demonstr an area under the 
roc curv that be over 99% for most of the patholog (and 
over 96% for all of them; supplementari tabl 7), on par with the 
perform of the expert on oct only. As with earli evalu- 
ations, perform of the expert improv when they be 
provid also with the fundu imag and patient summari notes. 
thi improv be most mark in patholog class a ‘rou- 
tine referral’, for exampl geograph atrophi and central serou 
retinopathy. mani of these patholog be condit for which 
the fundu photograph or demograph inform would be 
expect to provid import information, indic that there be 
scope for futur work to improv the model. howev even in the 
bad case our framework still perform on par with at least one 
retin specialist and one optometrist (supplementari tabl 6 and 
supplementari fig. 8). 

gener to a new scan devic type. A key benefit of 
our two-stag framework be the devic independ of the second 
stage. use our framework on a new devic gener thu onli 
requir retrain of the segment stage to learn how each 

tissu type appear in the new scan, wherea the knowledg about 
patient-to-pati variabl in patholog manifest of differ- 
ent diseases, which it have learn from the approxim 15,000 
train cases, can be reused. To demonstr thi generalization, we 
collect an independ test set of clinic scan from 116 patient 
(plu confirm clinic outcomes) record with a differ 
oct scanner type from a differ vendor (spectralis, heidelberg 
engineering,; hereaft ‘devic type 2’). thi dataset be list a 
dataset 11 in supplementari tabl 3 (see method ‘datasets’). We 
select thi devic type for sever reasons. It be the second most 
use devic type at moorfield eye hospit for these examinations, 
give rise to a suffici number of scans. It have a similar worldwid 
market share a devic type 1. but most importantly, thi devic type 
provid a larg differ in scan characterist compar to the 
origin devic type (see supplementari fig. 9). 

To evalu the effect of a differ scan devic type, we ini- 
tialli fed the oct scan from devic type 2 into our framework, 
which be train onli on scan from devic type 1 (fig. 4a). 
the segment network be clearli ‘confused’ by the chang 
appear of these structur and attempt to explain them a 

eye scan 603425 

a b 
diagnosi probabl (%) 

normal 11.1 

epiretin membran posterior hyaloid 

0.1 mm 

1 mm 

0.1 mm 

0 mm 

subretin hyper reflect. materialsubretin fluidintraretin fluidneurosensori retina 

rpe drusenoid ped fibrovascular ped serou ped 

1.2 mm 

0 mm 
1 mm 1 mm 

0.5 mm 

0 mm 

0.5 mm 

0 mm 

0.5 mm 

0 mm 

0.25 mm 

0 mm 
1 mm 

vitreou and subhyaloid 
posterior hyaloid 
epiretin membran 
neurosensori retina 
intraretin fluid 
subretin fluid 
subretin hyper reflect materi 
retin pigment epithelium (rpe) 
drusenoid ped 
serou ped 
fibrovascular ped 
choroid and outer layer 
mirror artefact 
clip artefact 
blink artefact 

1 mm 

0.25 mm 

0 mm 

0.25 mm 

1 mm 

0.1 mm 

0 mm 
1 mm 

1 mm 

1 mm 

raw oct 
slice 80 

pred. segment outlin 
slice 80, segm. model instanc 2 

0 mm 

1 mm 1 mm 

0 mm 
1 mm 

epiretin membran posterior hyaloid 

0.1 mm 

1 mm 

0.1 mm 

0 mm 

subretin hyper reflect. materialsubretin fluidintraretin fluidneurosensori retina 

rpe drusenoid ped fibrovascular ped serou ped 

1.2 mm 

0 mm 
1 mm 1 mm 

0.5 mm 

0 mm 

0.5 mm 

0 mm 

0.5 mm 

0 mm 

0.25 mm 

0 mm 
1 mm1 mm 

0.25 mm 

0 mm 

0.25 mm 

1 mm 

0.1 mm 

0 mm 
1 mm 

1 mm 

1 mm 

raw oct 
slice 80 

pred. segment outlin 
slice 80, segm. model instanc 2 

pred. segment 
slice 80, segm. model instanc 2 

0 mm 

1 mm 1 mm 

0 mm 
1 mm 

99.5 

6.9 

20.0 

23.9 

20.2 

37.8 

26.6 

cnv 

mro 

full mac. hole 

part. mac. hole 

csr 

geo. atrophi 

vmt 

referr suggest (%) 

tissu volum (mm3) 

urgent 

semi-urg 

routin 

observ onli 

drusen 0.008 

erm 0.190 

99.1 

0.4 

0.2 

0.3 

fig. 5 | visual of the segment result a thick maps. a, the averag intens project of the oct scan along a-scan direct (frontal 
view of the eye) be overlaid with a thick map of the fibrovascular pigment epithelium detach (ped, red segment). b, screenshot from our oct 
viewer. first row (left), referr suggestion, tissu volum and diagnosi probabilities. the highlight bar correspond to the select segment model. 
first–third rows, thick map of the 10 relev tissu type from segment model instanc 2. the two healthi tissu type (high level retina and 
rpe) be display in a black–blue–green–brown–whit color map, the patholog tissu (all others) be display a overlay on a project of the raw 
oct scan. the thin white line indic the posit of slice 80. fourth row, slice 80 from the oct scan and the segment map from segment 
model instanc 2. detail tissu legend in supplementari tabl 2. the slice and model instanc can be interact select (see supplementari video 1). 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicin 1347 

http://www.nature.com/naturemedicin 


articl natur medicin 
addit retin layer (fig. 4a, middle). consequently, perfor- 
manc be poor with a total error rate for referr suggest of 46.6% 
(fig. 4a, right). uncertainti of the segment network on these 
(never seen) type of imag result in five strongli differ seg- 
mentat hypothesi (fig. 4b). 

We next collect an addit segment train set with 
152 scan (527 manual segment slice in total) from thi devic 
(dataset 9 in supplementari tabl 3), and retrain the segmenta- 
tion network with both the train scan from the origin devic 
type 1 and the new devic type 2 (see method ‘segment net- 
work’). the classif network be not modified. 

our retrain system (adapt segment network and 
unchang classif network) now achiev a similarli high 
level of perform on devic type 2 a on the origin devic 
(fig. 4c). It suggest incorrect referr decis for 4 out of the 116 
cases, a total error rate of 3.4%. owe to the small number of case 
in the new test set, thi be not significantli differ from the error rate 
of 5.5% on devic type 1 (p(4 out of 116 < 55 out of 997) = 0.774; see 
method ‘statist analysis’). for continu with our previou evalu- 
ation, we also measur perform against retina specialist access- 
ing oct scan plu fundu imag and clinic note (dataset 12 in 
supplementari tabl 3). our expert achiev the follow error 
rate (all with access to imag and clinic notes): retin specialist 
one: 2 error = 1.7% error rate; retin specialist two: 2 error = 1.7% 
error rate; retin specialist three: 4 error = 3.4% error rate; retin 
specialist four: 3 error = 2.6% error rate; retin specialist five: 3 
error = 2.6% error rate. these differ in perform between 
our framework and the best human retina specialist do not reach 
statist signific (p(4 out of 116 > 2 out of 116) = 0.776). 

To verifi that devic type 2 provid the great differ in 
scan characteristics, we perform a feasibl studi on the small 
number of oct scan from cirru hd-oct 5000 with angioplex 
(carl zeiss meditec) devic avail in moorfield eye hospit 
(dataset of 61 scans; not includ here). appli our origin net- 
work to these images, we alreadi obtain an error rate of 16.4%. 
thi rate be much low than that origin obtain with devic 
type 2 (46.6%), consist with the claim that devic type 2 pro- 
vide a larg differ in scan characterist from devic type 1. 
retrain of the segment network with 6 manual segment 
scan reduc the error rate to 9.8%. 

tabl 1 summar our results. for devic type 1, our archi- 
tectur requir 877 train scan with manual segment 
and 14,884 train scan with gold standard referr decis to 
achiev expert perform on referr decis (5.5% error rate). 
for devic type 2, we onli requir 152 addit train scan 
with manual segment and not a singl addit train 
scan with gold standard referr decis to achiev the same per- 
formanc on referr decis on thi devic type (3.4% error rate). 

discuss 
recent work in which AI be use for the autom diagnosi of 
oct scan show encourag results; however, until now such 
studi have reli on select and clinic unrepres oct 
datasets. for example, sever authors17–21 report high perform 
on autom classif of age-rel macular degener 
(amd) from oct scans. however, they test their algorithm on 
small dataset that exclud other pathologies. By contrast, here we 
demonstr expert perform on multipl clinic referr sug- 
gestion for two independ test dataset of 997 and 116 clinic 
oct scan that includ a wide rang of retin pathologies. 

sever recent studi use deep learning-bas architectur 
to deliv success segment of oct scans22–25. thi earli 
work focu on a subset of diagnost relev tissu type 
(for example, intraretin fluid) and appli two-dimension mod- 
el in sampl of between 10 and 42 patients. In the present work, 
we go beyond these earli studi by appli three-dimension 

models, segment a much larg rang of diagnost relev 
tissu types, and connect such segment to clinic relev 
real-world referr recommendations. 

We evalu our framework on a broad rang of real-world 
imag from routin clinic practic at 32 differ moorfield eye 
hospit sites, which cover divers popul within london and 
surround areas, use 37 individu oct devic (28 devic type 
1 and 9 devic type 2). the two devic type that we test be both 
use wide in routin clinic practic at moorfield eye hospital, 
the larg eye hospit in europ and north america, and provid 
a larg differ in scan characteristics. 

our framework have a number of potenti benefits. the deriva- 
tion of device-independ segment of the oct scan creat 
an intermedi represent that be readili viewabl by a clini- 
cal expert and integr into clinic workflow (see fig. 5 for the 
clinic result viewer). moreover, the use of an ensembl of five seg- 
mentat network instanc allow u to present ambigu aris- 
ing from the imag process to the decis network (and could 
potenti be use for autom qualiti control). 

the ‘black box’ problem have be identifi a an impedi 
to the applic of deep learn in healthcare26. here we cre- 
ate a framework with a structur that close match the clini- 
cal decision-mak process, separ judgement about the scan 
itself from the subsequ referr decision. thi allow a clinician 
to inspect and visual an interpret segmentation, rather than 
simpli be present with a diagnosi and referr suggestion. 
such an approach to medic imag AI offer potenti insight 
into the decis process, in a fashion more typic of clinic prac- 
tice. for example, an interpret represent be particularli 
use in difficult and ambigu cases. such case be common in 
medicin and even expert medic practition can find it difficult 
to reach consensu (for example, our eight expert onli agre on 
63.5% of case even when access all information). 

our segment map assign onli one label per pixel, and it 
may not be possibl to use the framework directli in other clinic 
pathway for which the tissue-segment map do not contain 
all requir inform for a diagnosi (for example, in certain 
radiom applications). To keep the advantag of the intermedi- 
ate device-independ represent in such applications, futur 
work can potenti augment the tissue-segment map with 
multipl label per pixel to encod local tissu features, or with 
addit channel that encod continu featur such a an 
inflammatori reaction. thi may be of particular valu for other 
compon of the retina, such a the nerv fibr layer, and may 
be of import for multipl ocular and brain disorders, such a 
glaucoma and dementia. 

although we have demonstr the perform of our frame- 
work in the domain of a clinic treatment pathway, the approach 
have potenti util in clinic train in which the medic pro- 
fession must learn to read medic images. In addition, a wide 

tabl 1 | number of train scan and achiev perform on 
the two devic type 

train scan 
with spars 
manual 
segment 

train 
scan 
with gold 
standard 
referr 
decis 

test 
perform 
on referr 
decis (error 
rate) 

test 
perform 
on urgent 
referr 
(auc) 

devic 
type 1 

877 14,884 55 out of 997 
(5.5%) 

99.21 

devic 
type 2 

152(+ 877 scan 
from devic type 1) 

0 4 out of 116 
(3.4%) 

99.93 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicine1348 

http://www.nature.com/naturemedicin 


articlesnatur medicin 
varieti of non-med qualifi health profession have an 
interest in appropri read and understand medic images. 
our framework produc a visualiz segment and achiev 
expert perform on diagnosi and referr decis for a larg 
number of scan and pathologies. thi therefor rais the intrigu- 
ing possibl that such a framework could be evalu a a tool for 
effect train healthcar profession to expert levels. 

the segment output itself can also be use to quantifi retin 
morpholog and deriv measur of particular patholog (for 
example, the locat and volum of fibrovascular pigment epithe- 
lium detach and macular edema). some of these measur 
(such a retin thick and intraretin fluid) can current be 
deriv automatically27,28, use to investig correl with visual 
outcomes27 and a an end point in clinic trial of therapi for reti- 
nal disease29–32. our framework can be use to defin and valid a 
broader rang of automat deriv quantit measurements. 

our framework can triag scan at first present of a patient 
into a small number of pathway use in routin clinic practic 
with a perform match or exceed both the expert retina 
specialist and optometrist who staff virtual clinic in a UK nh 
setting. futur work can now directli seek evid for the efficaci 
of such a framework in a random control trial. the output 
of our framework can be optim to penal differ diagnost 
errors, and thu for other clinic import metrics. for example, 
the potenti improv to patient qualiti of life of differ diag- 
nostic decisions, or avoid the harm of unnecessari investig 
that might come from a false-posit diagnosis, could all be incor- 
porat into futur work. 

globally, ophthalmolog clinic referr pathway vary, and the 
rang of diseas that can potenti be diagnos by oct includ 
patholog addit to the macular diseas that be studi 
here. We studi a major clinic referr pathway in a global center 
of clinic excel focu on 53 key diagnosi relev to the 
nation (nhs) referr pathways. our work open up the possi- 
biliti of test the clinic applic of thi approach in other 
global set and clinic pathways, such a emerg macular 
assess clinic in the UK nhs, triag and assess in com- 
muniti eye care center and the monitor of diseas dure 
treatment regimes. furthermore, devic such a binocular oct33 
have the potenti to increas access in emerg economies. 
imag produc by such devic will differ in resolution, contrast 
and imag qualiti from the state-of-the-art devic studi here, 
and exist AI model train on current state-of-the-art devic 
may perform poorli on such new devices. our propos two-stag 
model offer excit possibl that enabl the use of model 
more effici in countri where state-of-the-art oct devic 
be too costli for widespread adoption. 

In conclusion, we present a novel framework that analysi clini- 
cal oct scan and make referr suggest to a standard that 
be compar to clinic experts. although we focu on one 
common type of medic imaging, futur work can address a much 
wider rang of medic imag techniques, and incorpor clinic 
diagnosi and tissu type well outsid the immedi applic 
that be demonstr here. 

received: 19 decemb 2017; accepted: 1 june 2018; 
publish online: 13 august 2018 

refer 
1. oecd. comput tomographi (ct) exam (indicator). (2017); https://doi. 

org/10.1787/3c994537-en 
2. oecd. magnet reson imag (mri) exam (indicator). (2017). https:// 

doi.org/10.1787/1d89353f-en 
3. foot, B. & macewen, C. surveil of sight loss due to delay in ophthalm 

treatment or review: frequency, caus and outcome. eye 31, 771–775 (2017). 
4. owen, C. G. et al. the estim preval and incid of late stage age 

relat macular degener in the uk. br. J. ophthalmol. 96, 752–756 (2012). 

5. rudnicka, A. R. et al. incid of late-stag age-rel macular 
degener in american whites: systemat review and meta-analysis. 
am. J. ophthalmol. 160, 85–93 (2015). 

6. bourne, R. R. A. et al. magnitude, tempor trends, and project of the 
global preval of blind and distanc and near vision impairment: a 
systemat review and meta-analysis. lancet glob. health 5, 
e888–e897 (2017). 

7. schmidt-erfurth, u., klimscha, s., waldstein, S. M. & bogunović, H. A view 
of the current and futur role of optic coher tomographi in the 
manag of age-rel macular degeneration. eye 31, 26–44 (2017). 

8. gulshan, V. et al. develop and valid of a deep learn algorithm 
for detect of diabet retinopathi in retin fundu photographs. J. am. 
med. assoc. 316, 2402–2410 (2016). 

9. esteva, A. et al. dermatologist-level classif of skin cancer with deep 
neural networks. natur 542, 115––118 (2017). 

10. huang, D. et al. optic coher tomography. scienc 254, 
1178–1181 (1991). 

11. buchan, J. C. et al. how to defus a demograph time bomb: the way 
forward? eye 31, 1519–1522 (2017). 

12. whited, J. D. et al. A model econom analysi of a digit teleophthalmolog 
system a use by three feder healthcar agenc for detect prolif 
diabet retinopathy. telemed. J. E health 11, 641–651 (2005). 

13. ronneberger, o., fischer, P. & brox, T. u-net: convolut network for 
biomed imag segmentation. in navab n., hornegg j., well w., frangi 
A. (eds.) medic imag comput and computer-assist intervent – 
miccai 2015. miccai 2015. lectur note in comput science, vol. 9351 
(springer, cham, switzerland, 2015). 

14. çiçek, ö., abdulkadir, a., lienkamp, S. s., brox, T. & ronneberger, O. 3D 
u-net: learn dens volumetr segment from spars annotation. in 
ourselin, s., joskowicz, l., sabuncu, m., unal, g., wells, W. (eds.) medic 
imag comput and computer-assist intervent – miccai 2016. 
miccai 2016. lectur note in comput science, vol. 9901 (springer, 
cham, switzerland; 2016). 

15. muether, P. s., hermann, M. m., koch, K. & fauser, S. delay between 
medic indic to anti-vegf treatment in age-rel macular 
degener can result in a loss of visual acuity. graef arch. clin. exp. 
ophthalmol. 249, 633–637 (2011). 

16. arias, L. et al. delay in treat age-rel macular degener in spain be 
associ with progress vision loss. eye 23, 326–333 (2009). 

17. karri, S. P. k., chakraborty, D. & chatterjee, J. transfer learn base 
classif of optic coher tomographi imag with diabet macular 
edema and dri age-rel macular degeneration. biomed. opt. express 8, 
579–592 (2017). 

18. apostolopoulos, s., ciller, c., De zanet, S. i., wolf, S. & sznitman, R. 
retinet: automat amd identif in oct volumetr data. preprint 
at http://arxiv.org/abs/1610.03628v1 (2016). 

19. farsiu, S. et al. quantit classif of eye with and without 
intermedi age-rel macular degener use optic coher 
tomography. ophthalmolog 121, 162–172 (2014). 

20. srinivasan, P. P. et al. fulli autom detect of diabet macular edema 
and dri age-rel macular degener from optic coher 
tomographi images. biomed. opt. express 5, 3568–3577 (2014). 

21. lee, C. s., baughman, D. M. & lee, A. Y. deep learn be effect for 
classifi normal versu age-rel macular degener oct images. 
ophthalmol. retin. 1, 322–327 (2017). 

22. fang, L. et al. automat segment of nine retin layer boundari in 
oct imag of non-exud amd patient use deep learn and graph 
search. biomed. opt. express 8, 2732–2744 (2017). 

23. lee, C. S. et al. deep-learn based, autom segment of 
macular edema in optic coher tomography. biomed. opt. express 8, 
3440–3448 (2017). 

24. lu, D. et al. retin fluid segment and detect in optic coher 
tomographi imag use fulli convolut neural network. preprint at 
http://arxiv.org/abs/1710.04778v1 (2017). 

25. roy, A. G. et al. relaynet: retin layer and fluid segment of macular 
optic coher tomographi use fulli convolut network. biomed. 
opt. express 8, 3627–3642 (2017). 

26. castelvecchi, D. can we open the black box of ai? natur 538, 
20–23 (2016). 

27. schmidt-erfurth, U. et al. machin learn to analyz the prognost valu 
of current imag biomark in neovascular age-rel macular 
degeneration. ophthalmol. retin. 2, 24–30 (2018). 

28. schlegl, T. et al. fulli autom detect and quantif of macular 
fluid in oct use deep learning. ophthalmolog 125, 549–558 (2018). 

29. keane, P. A. & sadda, S. R. predict visual outcom for macular 
diseas use optic coher tomography. saudi J. ophthalmol. 25, 
145–158 (2011). 

30. schaal, K. b., rosenfeld, P. j., gregori, g., yehoshua, Z. & feuer, W. J. 
anatom clinic trial endpoint for nonexud age-rel macular 
degeneration. ophthalmolog 123, 1060–1079 (2016). 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicin 1349 

https://doi.org/10.1787/3c994537-en 
https://doi.org/10.1787/3c994537-en 
https://doi.org/10.1787/1d89353f-en 
https://doi.org/10.1787/1d89353f-en 
http://arxiv.org/abs/1610.03628v1 
http://arxiv.org/abs/1710.04778v1 
http://www.nature.com/naturemedicin 


articl natur medicin 
31. schmidt-erfurth, U. & waldstein, S. M. A paradigm shift in imag 

biomark in neovascular age-rel macular degeneration. prog. retin. 
eye res. 50, 1–24 (2016). 

32. villani, E. et al. decade-long profil of imag biomark use in ophthalm 
clinic trials. invest. ophthalmol. vis. sci. 58, bio76–bio81 (2017). 

33. chopra, r., mulholland, P. j., dubis, A. m., anderson, R. S. & keane, P. A. 
human factor and usabl test of a binocular optic coher 
tomographi system. transl. vis. sci. technol. 6, 16 (2017). 

acknowledg 
We thank K. kavukcuoglu, A. zisserman, M. jaderberg, K. simonyan for discussions, 
A. cain and M. cant for work on the visuals, D. mitchel and M. johnson for 
infrastructur and system administration, J. morgan and openey for provid the 
electron health record records, T. peto, P. blows, A. o’shea and the nihr clinic 
research facil for work on the labeling, T. heeran, M. lukic, K. kortum, K. fasler, 
S. wagner and N. pontiko for work on the labeling, E. steele, V. louw, S. gill and the 
rest of moorfield IT team for work on the data collect and deidentification, 
S. al-ab and N. smith for moorfield technic advic at project initiation, R. 
wood and D. corder at softwir for engin support at moorfields, R. ogb and 
the moorfield inform govern team for support, M. hassard for moorfield 
research and develop support, K. bonstein and the nation institut for health 
research (nihr) for support at the moorfield biomed research centr (brc), 
J. besley for legal assistance, E. manna for patient engag and support, and the 
rest of the deepmind team for their support, idea and encouragement. p.a.k. be 
support by an nihr clinician scientist award (nihr-cs-2014-14-023). d.a.s., 
a.t., c.e. and p.t.k. be support by the nihr biomed research centr at 
moorfield eye hospit nh foundat trust and ucl institut of ophthalmolog 
and the nihr moorfield clinic research facility. the view express be those 
of the author(s) and not necessarili those of the nhs, the nihr or the depart 
of health. r.c. receiv studentship support from the colleg of optometrists, 
unit kingdom. 

author contribut 
p.a.k., m.s., j.c., d.h., p.t.k., t.b. and k.a. initi the project and the collaboration. 
o.r., j.d.f., b.r.-p. and s.n. develop the network architectures, train and test 
setup. p.a.k., j.r.l. and r.c. design the clinic setup. p.a.k., j.r.l., j.c., r.c., d.a.s., 
c.e. and a.t. creat the dataset and defin clinic labels. j.d.f., b.r.-p., s.n., n.t., s.bl., 
h.a., b.o., d.v., g.v.d.d., o.r. and j.c. contribut to the softwar engineering. j.r.l., 
s.bl. and h.a. creat the database. p.a.k., j.r.l., d.k., a.k., c.o.h. and r.r. contribut 
clinic expertise. o.r., p.a.k., j.d.f., j.r.l., b.r.-p., s.n., n.t. and x.g. analys the 
data. t.b., s.bo., j.c., j.h., f.m. and c.m. manag the project. o.r., p.a.k., j.r.l., j.d.f., 
b.r.-p., g.r. and h.m. write the paper. b.l. contribut to the uncertainti estimation. 

compet interest 
p.a.k., g.r., h.m. and r.r. be paid contractor of deepmind. p.a.k. have receiv 
speaker fee from heidelberg engineering, topcon, haag-streit, allergan, novarti and 
bayer. p.a.k. have serv on advisori board for novarti and bayer, and be an extern 
consult for deepmind and optos. a.t. have serv on advisori board for 
the follow companies: allergan, bayer, genentech, glaxosmithkline, novartis, roche. 
c.e. have receiv speaker fee from heidelberg engin and haag-streit uk. p.t.k. 
have serv on advisori board for aerie, allergan, alcon, belkin laser, novarti and 
santen. d.a.s. have receiv speaker fee from novartis, bayer, allergan, haag-streit. 
the author have no other compet interest to disclose. 

addit inform 
supplementari inform be avail for thi paper at https://doi.org/10.1038/ 
s41591-018-0107-6. 

reprint and permiss inform be avail at www.nature.com/reprints. 

correspond and request for materi should be address to p.a.k. or o.r. 

publisher’ note: springer natur remain neutral with regard to jurisdict claim in 
publish map and institut affiliations. 

natur medicin | vol 24 | septemb 2018 | 1342–1350 | www.nature.com/naturemedicine1350 

https://doi.org/10.1038/s41591-018-0107-6 
https://doi.org/10.1038/s41591-018-0107-6 
http://www.nature.com/reprint 
http://www.nature.com/naturemedicin 


articlesnatur medicin 
method 
ethic and inform governance. thi work and the collect of data on 
impli consent receiv nation research ethic committe (rec) approv 
from the cambridg east rec and health research author approv (refer 
16/ee/0253); it compli with all relev ethic regulations. deidentif 
be perform in line with the inform commissioner’ anonymization: 
manag data protect risk code of practic (https://ico.org.uk/media/1061/ 
anonymisation-code.pdf), and valid by the moorfield eye hospit 
inform technolog and inform govern departments, respectively. 
onli deidentifi retrospect data be use for research, without the activ 
involv of patients. 

visual of result in clinic practice. To facilit view of the result in 
routin clinic practice, we display the obtain three-dimension segment 
map a two-dimension thick map overlaid on a project of the raw oct 
scan (fig. 5a). the thick map for all tissu type be display side-by-sid 
in our interact oct viewer (fig. 5b and supplementari video 1). our system 
also provid measur for it degre of certainti on both overal referr decision, 
and each specif retin diseas feature. In most common clinic scenarios, the 
algorithm will both provid the diagnosi with a high degre of certainti and 
highlight classic diseas featur (for example, ‘wet’ amd; supplementari video 2). 
thi visual may be particularli use for difficult and ambigu cases, such 
a the diagnosi of choroid neovascular format in case of chronic central 
serou retinopathi (supplementari video 5, 7) or in advanc geograph atrophi 
due to amd (supplementari video 6). such visual may also allow clinician 
to discard an autom diagnosi or referr suggest in obviou failur cases, such 
a when poor imag qualiti lead to erron segment result (supplementari 
video 8). furthermore, in a screen context the tissu segment map can 
facilit qualiti assur procedures, whether in normal case (supplementari 
video 3) or in diseas case (for example, diabet macular edema in the context of 
diabet retinopathi screening, supplementari video 4). 

dataset and clinic taxonomy. datasets. data be select from a retrospect 
cohort of all patient who attend moorfield eye hospit nh foundat 
trust, a world renown tertiari referr center with 32 clinic site serv an 
urban, mix socioeconom and ethnic popul center around london, 
unit kingdom, between 1 june 2012 and 31 januari 2017, who receiv oct 
imag (topcon 3D oct, topcon; spectralis, heidelberg engineering) a part 
of their routin clinic care. condit with few than ten cases, and data from 
patient who have manual request that their data should not be shared, be 
exclud befor research began. oct scan set contain sever artefact or 
mark reduct in signal strength to the point at which retin interfac could 
not be identifi be also exclud from the studi (supplementari fig. 10), a 
such scan be non-diagnost and in practic would usual be retaken. scan to 
which no diagnost label could be attach (a describ below) be exclud 
from the present study. for oct examin that be label a urgent or semi- 
urgent in the moorfield openey electron health record onli scan take prior 
to treatment begin be included; dure treatment, resolut of patholog 
invalid the databas labels. the dataset select and stratif process be 
display in a consort flow diagram in supplementari fig. 11. 

two oct devic type be select for investigation. 3D oct-2000 (topcon, 
japan) be select a devic type 1, becaus of it routin use in the clinic 
pathway that we studied. for devic type 1, a total of 15,877 oct scan from 7,981 
individu patient (mean age 69.5; 3,686 male, 4,294 female, 1 gender unknown) 
be elig for inclus in the work (dataset 3 and 4 in supplementari tabl 3). 
To creat a test set repres of the real-world clinic application, 997 
addit patient (mean age 63.1; 443 male, 551 female, 3 gender unknown) 
present to moorfield with visual disturb dure the retrospect period 
be select and onli their referr oct examin be select for inclus in 
the test set (dataset 5 in supplementari tabl 3); a sampl size requir of 553 
to detect sensit and specif at 0.05 margin error and 95% confid be 
use to inform the number included. To demonstr the generaliz of our 
approach, spectrali oct (heidelberg engineering) be chosen a ‘devic 
type 2’. for generaliz experiments, a second test set of clinic oct 
scan from 116 patient (mean age 58.2; 59 male, 57 female) present in the 
same manner be select use the same methodolog and select criterion 
(dataset 11 in supplementari tabl 3). exampl of differ between the two 
devic type be show in supplementari fig. 9. supplementari tabl 8 show a 
breakdown of patient and triag categori in the datasets. 

clinic taxonomy. oct examin be map from individu diagnosi 
and treatment inform to specif triag decis (urgent referral, semi-urg 
referral, routin referr and observ only) to a medic retina clinic set 
(supplementari tabl 1). where possible, the presenc or absenc of addit 
patholog be add a a label (supplementari tabl 5). the dataset repres 
the full varieti of medic retina patient present and receiv treatment at 
moorfield eye hospital. although the exact map be chosen to be relev 
to the triag decis at moorfield eye hospit where the research work take 
place, the framework be generaliz to other system at center with differ 

triag requir (for example, optometrist work in a high-street clinic 
set or ophthalmologist without subspecialti retin expertise). scan meet 
the exclus criterion be remov from the databas befor split the data into 
training, valid and test sets. supplementari figur 12 provid an exampl of 
variat within the ‘urgent referral’ label class. 

clinic labeling. clinic label for the 14,884 scan in dataset 3 in supplementari 
tabl 3 be assign through an autom note search with train 
ophthalmologist and optometrist review of the oct scans. the presenc or 
absenc of choroid neovascularization, refer macular edema, normal and 
other patholog visibl on the oct scan be recorded. In addition, patient with 
choroid neovascular or macular edema confirm through treatment be 
label directli from the moorfield openey electron health record. 
A valid subset of 993 scan (993 patients) be grade separ by three 
junior grader (ophthalmologist special in medic retina) with disagr 
in clinic label arbitr by a senior retin specialist with over 10 year of 
experi and imag read center certif for oct segment (dataset 
4 in supplementari tabl 3). the test set be further verifi by full review of 
the note with access to follow up data with both junior and senior grader review. 
junior and senior grader be separ to those particip in the evalu of 
expert performance. 

manual segmentation. A subset of 1,101 scan from devic type 1 and a set of 
264 scan from devic type 2 be manual segment use the segment 
editor plugin for imagej (fiji)34 (dataset 1, 2, 9 and 10 in supplementari tabl 3). 
the segment label be chosen to distinguish all relev diagnosi for the 
referr decision, a well a potenti artefact that may affect the diagnost qualiti 
of the whole or part of the scan. In particular, the current state of art do not 
differenti between the three differ type of pigment epitheli detachment, 
or segment out area of fibrosi scar or blood a hyperreflect material27,28. 
anatom delin and nomenclatur be consist with standard 
grade criterion for the evalu of oct35–37. the segment exampl be 
select and segment by ophthalmologist special in medic retina a 
repres case for patholog features. these be review and edit 
by a senior ophthalmologist with over 10 year of experi and imag read 
center certif for oct segmentation. per oct, 3–5 slice be chosen for 
segmentation, which best repres the patholog featur (supplementari 
tabl 2, 9 and supplementari fig. 13). 

evalu the expert performance. To evalu expert perform on the test set, 
eight clinic expert be recruit for an evalu study. particip includ 
four consult ophthalmologist at moorfield eye hospit with fellowship-level 
subspecialti train in medic retin diseas and extens clinic experi 
(21, 21, 12.5 and 11.5 year of experience) and four optometrist at moorfield eye 
hospit with specialist train in oct interpret and retin diseas (15, 9, 
6 and 2.5 year of experience). these be refer to a retin specialist 1–4 and 
optometrist 1–4 in the rest of the paper (supplementari tabl 10). each expert 
be instruct to provid a triag decis (supplementari tabl 1) and to record 
the presenc or absenc of defin patholog featur (supplementari tabl 5). 

To ass the perform in a realist clinic environment, all scan be 
read in a random order twice with at least a week between readings. dure the 
initi review, onli the oct scan be present (dataset 7 in supplementari tabl 
3). dure the second review, particip be present with all the inform 
avail at the time of triage: oct and fundu scans, age, gender, ethnic and 
where avail inform on visual acuiti and a short clinic vignett (dataset 8 
in supplementari tabl 3). the model onli receiv the oct scan. 

To ass the differ between the test set for devic type 1 and devic type 
2, five clinic expert be recruit for a further evalu studi (dataset 12 
in supplementari tabl 3). particip be five consult ophthalmologist 
at moorfield eye hospit with fellowship-level subspecialti train in 
medic retin diseas (21, 21, 12.5, 11.5 and 11 year of experience). four be 
particip in the devic type 1 evalu study, while the other be a new 
particip for thi studi and be refer to a retina specialist five. 

network architectur and train protocol. segment network. the first 
stage of our framework consist of a segment network that take a input part 
of the oct scan, and output a part of a segment map. that is, it predict for 
each voxel one tissu type out of the 15 class describ in supplementari tabl 2. 
At train time, the input of the network consist of 9 contigu slice of an oct, 
and the goal of the network be to segment the central slice. the input be therefor a 
448 × 512 × 9 voxel image, and the output be an estim probabl over the 15 
classes, for each of the 448 × 512 × 1 output voxels. none of the convolut make 
across the slice (z dimension) add pad to it input. As a result, we can exploit 
share comput at infer time to predict ani number of contigu slice 
in parallel, which be onli limit by the memori capac of the system. 

the structur of the segment convolut neural network model be 
show in supplementari fig. 14. It us a three-dimension u-net architecture14, 
consist of an analysi (downwards) path, a synthesi (upwards) path, and 
shortcut connect between block of the same level and differ paths. 

natur medicin | www.nature.com/naturemedicin 

https://ico.org.uk/media/1061/anonymisation-code.pdf 
https://ico.org.uk/media/1061/anonymisation-code.pdf 
http://www.nature.com/naturemedicin 


articl natur medicin 
We appli four variat over it. first, we use 3 × 3 × 1 convolut with 
pad and 1 × 1 × 3 convolut without pad instead of 3 × 3 × 3 
convolut without padding. second, downsampl and upsampl oper 
be carri out through parameter-fre bilinear interpolation, replac max- 
pool and up-convolution. third, we introduc one extra residu connect 
within each block of layers, so that the output of each block consist of the sum of 
the featur of the last layer, and the first layer of the block in which the featur 
dimens match. finally, the middl block of layer between the analysi and 
synthesi path be compos of a sequenc of fulli connect layers. the first 
variat allow u to control the recept field for z separ and be furthermor 
less comput intensive. the second and third variat aim at improv 
the gradient flow throughout the network, which make the train process 
easier. the last variat extend the recept field such that each pixel in the 
output effect have the whole input contain within it recept field. 

We use per-voxel cross entropi a the loss function, with 0.1 label-smooth 
regularization38. We have neither use dropout nor weight decay a regular 
means, a preliminari experi show that thi do not improv the 
performance. We train the model in tensorflow39 with the adam optimizer40 
for 160,000 iter on 8 graphic process unit (gpus) with dataset 1 in 
supplementari tabl 3. the initi learn rate be 0.0001 and set to 0.0001/2 
after 10% of the total iterations, 0.0001/4 after 20%, 0.0001/8 after 50%, 0.0001/64 
after 70%, 0.0001/256 after 90% and final 0.0001/512 for the final 5% of training. 
all decis and hyperparamet abov be select on the basi of their 
perform on a valid set (dataset 2 in supplementari tabl 3). 

To improv the gener abil of our model, we augment the data 
by appli affin and elast transform jointli over the input and ground- 
truth segmentations13,14. intens transform over the input be also 
applied. 

our segment network for devic type 2, which be show in supplementari 
fig. 15, be train on scan from both devic (dataset 1 and 9 in supplementari 
tabl 3) with the aim of leverag the larg number of label instanc for devic 
type 1. It have three chang compar to the architectur for devic type 1. first, 
we subsampl the input from devic type 1 (128 slices) to match the resolut of 
devic type 2 (49 slices) and appli slight pad in height to the scan of devic 
type 2 to give them of the same shape in height and width a the scan of devic 
type 1. second, the input first go through one of two ‘devic adapt branches’, 
depend on the devic type of the input scan. the architectur of thi branch 
consist of three convolut with padding, with one residu connect a in the 
other blocks, and be ident for both devic type (see supplementari fig. 15). 
the network can then simpli learn to compens for the chang between devic 
type earli on and map them to a common representation. lastly, the number 
of featur map on the first level of the analysi path be halv from 32 to 16 
such that the overal architectur still have few paramet than the architectur 
for devic type 1. dure training, the network be present with a ratio of 
2.5: 1 for train sampl from devic type 2:devic type 1. all decis and 
hyperparamet abov be select on the basi of their perform on a 
valid set (dataset 2 and 10 in supplementari tabl 3). 

classif network. the classif network learn to map a segment 
map to the four referr decis and the ten addit diagnosi (see 
supplementari fig. 16). for devic type 1, it take a input a 300 × 350 × 43 
subsampl of the origin 448 × 512 × 128 segment map creat by the 
segment network describ above. the output be a 14-compon vector. for 
devic type 2, for which the scan origin be 448 × 512 × 49, we first upscal 
the segment map to the same resolut a for devic type 1 and then proceed 
ident a for devic type 1. the architectur us a three-dimension version 
of the dens block describ previously41 use 3 × 3 × 1 and 1 × 1 × 3 convolutions. 
the detail of it structur be show in supplementari fig. 16. We found use 
dens convolut block to be critic for train classif network on larg 
three-dimension volumes. the input be one-hot encod and augment by 
random three-dimension affin and elast transformations14. the loss be the 
sum of the softmax cross entropi loss for the first four compon (multi-class 
referr decision) and the sigmoid cross entropi loss for the remain ten 
compon (addit diagnosi labels). We also use a small amount (0.05) 
of label-smooth regularization38 and add some (1 × 10−5) weight decay. 
We train the model in tensorflow39 with the adam optimiser40 for 160,000 
iter of batch size 8 spread across 8 gpu with 1 sampl per gpu with 
dataset 3 in supplementari tabl 3. the initi learn rate be 0.02 and set to 
0.02/2 after 10% of the total iterations, 0.02/4 after 20%, 0.02/8 after 50%, 0.02/64 
after 70%, 0.02/256 after 90% and final 0.02/512 for the final 5% of training. all 
decis and hyperparamet describ abov be select on the basi of their 
perform on a valid set (dataset 4 in supplementari tabl 3). 

ensembling. for both of these network we train five instances. We train the 
same network with a differ order of the input and differ random weight 
initializations42. previous publish experiments42 suggest that five instanc be 
suffici in most settings, so we also use thi number. for our experiments, we 
appli the five instanc of our segment model to the input scan result in 
five segment maps. the five instanc of our classif model be then 

appli to each of the segment maps, result in a total of 25 classif 
output per scan, a illustr in supplementari fig. 1. the result report be 
obtain after averag the probabl estim by these models. 

optim the ensembl output for sensitivity, specif and penalti scores. 
for differ applications, the prefer compromis between a high hit rate 
(sensitivity) and a low fals alarm rate (1 − specificity) can be different. for 
the binari diagnosi decisions, we comput an optim rescal factor a 
for the pseudo-probabilities, such that a 50% threshold achiev maxim 
(sensit + specificity)/2 on the valid set (dataset 4 in supplementari 
tabl 3). the rescal be do by p = aq/(aq + (1 − a)(1 − q)), where q 
denot the ensembl output and p the reweight probability. We use 
(sensit + specificity)/2 instead of the total accuraci to avoid the bia due to the 
low number of patient with a posit condit in the valid set (and in the 
test set). for a balanc set with equal number of posit and neg sampl 
thi term be exactli the accuracy. 

for the four-way referr decis (where the high probabl wins), we 
optim four scale factor use the valid set to reduc the overal cost 
specifi by the misclassif penalti matrix (supplementari fig. 6). A first 
set of factor be optim for a balanc between high accuraci and low penalti 
point (refer to a "our model (1)" in supplementari figur 6), a second set 
of factor be optim for penalti cost onli (refer to a "our model (2)" in 
supplementari figur 6). the cost matrix for the balanc perform be 
comput by averag the normal cost matrix for accuraci (a matrix with 0 
in the diagon element and 1 in the off-diagon elements) and the normal 
penalti cost matrix. normal be perform by divid the matrix by the 
sum of all elements. the optim of the four factor be do with the adam 
optimis use a softmax layer and a weight cross-entropi loss layer. 

end-to-end classif network. the network architectur for the end-to-end 
classif experi be ident to the architectur of the classif 
network in the two-stag approach (see ‘classif network’ and supplementari 
fig. 16) with a small adaption. To roughli obtain the same number of parameters, 
we add a dens layer (two convolut with seven channel output each) that 
translat the single-channel raw oct to a 14-channel featur map. all select 
hyperparamet and augment strategi be ident to the origin 
classif network. We train five network instanc on the train set with 
14,884 raw oct scan from devic type 1 (dataset 13 in supplementari tabl 3). 
each network instanc be initi with differ random weight and be 
present with the train imag in a differ order. after training, we also 
comput an optim reweight on the valid set (a we do for the two-stag 
model) and test the ensembl on the test set. 

statist analysis. signific differ use a two-sid exact binomi test. 
the comparison of our model’ perform to the expert’ perform be base 
on the assumpt that our model and the expert have an unknown but constant 
performance. that is, everi inspect eye scan be correctli diagnos by our model 
with the probabl pmod, and correctli diagnos by the expert with probabl 
pexp. for N eye scan the number of correct diagnosi k be therefor binomi 
distribut with pr(k) = b(k|p,n). If our model achiev kmod correct diagnosi and 
the expert achiev kexp correct diagnoses, the probabl that the true perform 
of our model pmod be high than the true perform of the expert pexp be 

∫ ∫ 

∫ ∫ 

> ∣ = 

∣ ∣ 

∣ ∣ 

p p k k N 

k p N k p N dp dp 

k p N dp k p N dp 

pr( , , ) 

B( , ) B( , ) 

B( , ) B( , ) 

p 
mod exp mod exp 

0 

1 
mod 1 0 exp 2 2 1 

0 

1 
mod 0 

1 
exp 

1 

the probabl for a low performance, that be pr(pmod < pexp|kmod, kexp, N) be deriv 
analogously. for all comparisons, a confid level of 95% be used. the formula 
be numer integr use in-hous code. 

further detail on the method be describ in a publish protocol describ 
the deepmind collabor with moorfield eye hospital43. 

report summary. further inform on experiment design be avail in 
the natur research report summari link to thi article. 

code availability. the code base for the deep-learn framework make use of 
proprietari compon and we be unabl to publicli releas the full code base. 
however, all experi and implement detail be describ in suffici 
detail in the method and in the supplementari figs. to enabl independ 
replic with non-proprietari libraries. the three-dimension augment 
code (use the caff framework) be avail a part of the three-dimension 
u-net sourc code at https://lmb.informatik.uni-freiburg.de/resources/ 
opensource/unet.en.html. additionally, although we be unabl to make all the 
googl proprietari compon available, we be in the process of make the 
augment oper for tensorflow avail in the offici tensorflow code. 

natur medicin | www.nature.com/naturemedicin 

https://lmb.informatik.uni-freiburg.de/resources/opensource/unet.en.html 
https://lmb.informatik.uni-freiburg.de/resources/opensource/unet.en.html 
http://www.nature.com/naturemedicin 


articlesnatur medicin 
data availability. the clinic data use for the training, valid and test set 
be collect at moorfield eye hospit and transfer to the deepmind data 
center in the UK in deidentifi format. data be use with both local and 
nation permissions. they be not publicli avail and restrict appli to their 
use. the data, or a test subset, may be avail from moorfield eye hospit nh 
foundat trust subject to local and nation ethic approvals. 

refer 
34. schindelin, J. et al. fiji: an open-sourc platform for biological-imag analysis. 

nat. method 9, 676–682 (2012). 
35. keane, P. A. et al. evalu of age-rel macular degener with optic 

coher tomography. surv. ophthalmol. 57, 389–414 (2012). 
36. folgar, F. A. et al. comparison of optic coher tomographi assess 

in the comparison of age-rel macular degener treatment trials. 
ophthalmolog 121, 1956–1965 (2014). 

37. duker, J. s., waheed, N. K. & goldman, D. handbook of retin oct: optic 
coher tomographi e-book (elsevi health sciences, oxford, uk; 2013). 

38. szegedy, c., vanhoucke, v., ioffe, s., shlens, J. & wojna, Z. rethink the 
incept architectur for comput vision. proc. ieee comput. soc. conf. 
comput. vis. pattern recognit. 2818–2826 (2016). 

39. abadi, M. et al. tensorflow: large-scal machin learn on heterogen 
systems. preprint at https://arxiv.org/abs/1603.04467 (2016). 

40. kingma, D. P. & ba, J. adam: a method for stochast optimization. in 
proceed of the 3rd intern confer on learn represent 
(iclr). preprint at http://arxiv.org/abs/1412.6980 (2015). 

41. huang, g., liu, z., weinberger, K. Q. & van der maaten, L. dens 
connect convolut networks. proc. ieee comput. soc. conf. comput. 
vis. pattern recognit. 2261–2269 (2017). 

42. lakshminarayanan, b., pritzel, A. & blundell, C. simpl and scalabl 
predict uncertainti estim use deep ensembles. adv. neural inf. 
process. syst. 6405–6416 (2017). 

43. De fauw, J. et al. autom analysi of retin imag use 
machin learn techniqu for comput vision. f1000re 5, 
1573 (2016). 

natur medicin | www.nature.com/naturemedicin 

https://arxiv.org/abs/1603.04467 
http://arxiv.org/abs/1412.6980 
http://www.nature.com/naturemedicin 


1 

natur research | life scienc report sum 
m 

ari 
june 2017 

correspond author(s): olaf ronneberg 

initi submiss revis version final submiss 

life scienc report summari 
natur research wish to improv the reproduc of the work that we publish. thi form be intend for public with all accept life 
scienc paper and provid structur for consist and transpar in reporting. everi life scienc submiss will use thi form; some list 
item might not appli to an individu manuscript, but all field must be complet for clarity. 

for further inform on the point includ in thi form, see report life scienc research. for further inform on natur research 
policies, includ our data avail policy, see author & refere and the editori polici checklist. 

experiment design 
1. sampl size 

describ how sampl size be determined. A sampl size requir of 553 to detect sensit and specif at 0.05 
margin error and 95% confid be use to inform the number includ in the 
test set. A sampl of 997 patient be select to be part of the gold standard 
test set against which the human expert and the model be compared. 

the total of 15,877 topcon 3D oct 2000 scan from 7981 individu patient be 
elig for inclus in the work. An addit 268 heidelberg spectrali scan 
be select in order to conduct generalis experiments. the total sampl 
size for train and valid set be inform by the exist literatur and by 
deepmind’ previou work in the field of machin learn (mnih et al., 2015; silver 
et al., 2016). today’ most power deep neural network can have million or 
billion of parameters, so larg amount of data be need to automat infer 
those paramet dure learning. most problem in the medic domain be highli 
complex a they aris a an interplay of mani clinical, demographic, behaviour 
and environment factor that be correl in non-trivi ways. thi be even more 
true for state-of-th art deep learn methodolog that be expect to give the 
best result (szegedi et al., 2014). 

2. data exclus 

describ ani data exclusions. oct imag set with no diagnost labels, those contain sever artefacts, or 
signific reduct in signal strength to the point where retin interfac could 
not be identifi be exclud from the present study. condit with few 
than ten cases, and data from patient who have manual request that their data 
should not be shared, be exclud befor research began. for the test set 
patient who have previous be treat in clinic by the evalu studi 
particip be exclud from the test set. for more detail pleas refer to the 
manuscript method section. 

3. replic 

describ whether the experiment find be 
reliabl reproduced. 

all 997 patient in the test set for the first devic type be randomli select and 
be not correl in ani way. the experi can be interpret a 997 
replica of a singl patient diagnosis. without retrain the classif network 
in our framework perform be reproduc on a new test dataset from a 
second devic type of 116 oct scans. the perform in each case be a follows: 
devic type 1 error rate: 55 out of 997 = 5.5%; devic type 2 error rate: 4 out of 
116 = 3.4%. 

4. random 

describ how samples/organisms/particip be 
alloc into experiment groups. 

sampl meet the inclus criterion be randomli alloc to train or 
valid sets. A separ group of patient be randomli select befor 
creation of the train and valid dataset a an independ test set which 
be kept separ dure model development. randomis be on individu 
patient rather than oct images: where there be multipl scan for a singl 
patient these be alloc to onli one of training, valid or test. for more 
detail pleas refer to the manuscript method section. 



2 

natur research | life scienc report sum 
m 

ari 
june 2017 

5. blind 

describ whether the investig be blind to 
group alloc dure data collect and/or analysis. 

particip in the clinic evalu of the model be blind to the ground 
truth and be not involv in dataset collection; patient who have previous 
be treat in clinic by the particip be exclud from the test set. 

note: all studi involv anim and/or human research particip must disclos whether blind and random be used. 

6. statist paramet 
for all figur and tabl that use statist methods, confirm that the follow item be present in relev figur legend (or in the 
method section if addit space be needed). 

n/a confirm 

the exact sampl size (n) for each experiment group/condition, give a a discret number and unit of measur (animals, litters, cultures, etc.) 

A descript of how sampl be collected, note whether measur be take from distinct sampl or whether the same 
sampl be measur repeatedli 

A statement indic how mani time each experi be replic 

the statist test(s) use and whether they be one- or two-sid (note: onli common test should be describ sole by name; more 
complex techniqu should be describ in the method section) 

A descript of ani assumpt or corrections, such a an adjust for multipl comparison 

the test result (e.g. P values) give a exact valu whenev possibl and with confid interv note 

A clear descript of statist includ central tendenc (e.g. median, mean) and variat (e.g. standard deviation, interquartil range) 

clearli defin error bar 

see the web collect on statist for biologist for further resourc and guidance. 

softwar 
polici inform about avail of comput code 

7. softwar 

describ the softwar use to analyz the data in thi 
study. 

the network use the tensorflow librari with custom extens (see method 
section). analysi be perform with custom code write in python. 

for manuscript util custom algorithm or softwar that be central to the paper but not yet describ in the publish literature, softwar must be make 
avail to editor and review upon request. We strongli encourag code deposit in a commun repositori (e.g. github). natur method guidanc for 
provid algorithm and softwar for public provid further inform on thi topic. 

materi and reagent 
polici inform about avail of materi 

8. materi avail 

indic whether there be restrict on avail of 
uniqu materi or if these materi be onli avail 
for distribut by a for-profit company. 

the clinic data use for the training, valid and test set be collect at 
moorfield eye hospit and transfer to deepmind data centr in the UK in de- 
identifi format. data be use with both local and nation permissions. they 
be not publicli avail and restrict appli to their use. the data, or a test 
subset, may be avail from moorfield eye hospit subject to local and nation 
ethic approvals. 

9. antibodi 

describ the antibodi use and how they be valid 
for use in the system under studi (i.e. assay and species). 

No antibodi be used. 

10. eukaryot cell line 
a. state the sourc of each eukaryot cell line used. No eukaryot cell line be used. 

b. describ the method of cell line authent used. No eukaryot cell line be used. 

c. report whether the cell line be test for 
mycoplasma contamination. 

No eukaryot cell line be used. 

d. If ani of the cell line use be list in the databas 
of commonli misidentifi cell line maintain by 
iclac, provid a scientif rational for their use. 

No eukaryot cell line be used. 



3 

natur research | life scienc report sum 
m 

ari 
june 2017 

anim and human research particip 
polici inform about studi involv animals; when report anim research, follow the arriv guidelin 

11. descript of research anim 
provid detail on anim and/or animal-deriv 
materi use in the study. 

No anim be use in the study. 

polici inform about studi involv human research particip 

12. descript of human research particip 
describ the covariate-relev popul 
characterist of the human research participants. 

data be select from a retrospect cohort of all patient attend moorfield 
eye hospit nh foundat trust, a world renown tertiari referr centr with 
multipl clinic site serv an urban, mix socioeconom and ethnic 
popul centr around london, u.k., between 01/06/2012 and 31/01/2017, 
who have oct imag (topcon 3D oct, topcon, japan; spectralis, heidelberg, 
germany) a part of their routin clinic care. for more detail pleas refer to the 
manuscript method section. 

two oct devic type be select for investigation. 3D oct-2000 (topcon, 
japan) be select a “devic type 1” due to it routin use in the clinic pathway 
we studied. for devic type 1, a total of 15,877 oct scan from 7981 individu 
patient (mean age 69.5; 3686 male, 4294 female, 1 gender unknown) be 
elig for inclus in the work (dataset #3 + #4 in supplementari tabl 3). To 
creat a test set repres of the real-world clinic application, 997 addit 
patient (mean age 63.1; 443 male, 551 female, 3 gender unknown) present to 
moorfield with visual disturb dure the retrospect period be select 
and onli their referr oct examin be select for inclus in the test set 
(dataset #5 in supplementari tabl 3); a sampl size requir of 553 to detect 
sensit and specif at 0.05 margin error and 95% confid be use to 
inform the number included. To demonstr the generaliz of our approach, 
spectrali oct (heidelberg engineering, germany) be chosen a “devic type 2”. 
for generalis experiments, a second test set of clinic oct scan from 116 
patient (mean age 58.2; 59 male, 57 female) present in the same manner be 
select use the same methodolog and select criterion (dataset #11 in 
supplementari tabl 3). exampl of differ between the two devic type 
be show in supplementari fig. 9. supplementari tabl 8 show a breakdown of 
patient and triag categori in the datasets. 


clinic applic deep learn for diagnosi and referr in retin diseas 
result 
clinic applic and AI architecture. 
achiev expert perform on referr decisions. 
achiev expert perform on retin morphology. 
gener to a new scan devic type. 

discuss 
acknowledg 
fig. 1 our propos AI framework. 
fig. 2 result of the segment network. 
fig. 3 result on the patient referr decision. 
fig. 4 gener to a new scan devic type. 
fig. 5 visual of the segment result a thick maps. 
tabl 1 number of train scan and achiev perform on the two devic types. 





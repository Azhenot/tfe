


















































model select and hypothesi test for large-scal network model with 
overlap group 

tiago P. peixoto∗ 
institut für theoretisch physik, universität bremen, hochschulr 18, d-28359 bremen, germani 

the effort to understand network system in increas detail have result in a divers of method 
design to extract their large-scal structur from data. unfortunately, mani of these method 
yield diverg descript of the same network, make both the comparison and understand 
of their result a difficult challenge. A possibl solut to thi outstand issu be to shift the 
focu away from ad hoc method and move toward more principl approach base on statist 
infer of gener models. As a result, we face instead the more well-defin task of select 
between compet gener processes, which can be do under a unifi probabilist framework. 
here, we consid the comparison between a varieti of gener model includ featur such a 
degre correction, where node with arbitrari degre can belong to the same group, and commun 
overlap, where node be allow to belong to more than one group. becaus such model variant 
poss an increas number of parameters, they becom prone to overfitting. In thi work, we 
present a method of model select base on the minimum descript length criterion and posterior 
odd ratio that be capabl of fulli account for the increas degre of freedom of the larg 
models, and select the best one accord to the statist evid avail in the data. In 
appli thi method to mani empir unweight network from differ fields, we observ that 
commun overlap be veri often not support by statist evid and be select a a good 
model onli for a minor of them. On the other hand, we find that degre correct tend to be 
almost univers favor by the avail data, impli that intrins node proprieti (a oppos 
to group properties) be often an essenti ingredi of network formation. 

I. introduct 

mani network poss nontrivi large-scal struc- 
ture such a commun [1, 2], core-peripheri [3, 4], 
bipartit [5] and hierarchi [6, 7]. these structur 
presumedli reflect the organiz principl behind 
network formation. furthermore, their detect can be 
use to predict miss link [6, 8] or detect spuriou 
one [8], a well a determin the robust of the system 
to failur or intent damag [9], the outcom of the 
spread of epidem [10] and function classif [11], 
among mani other applications. the detail with which 
such modular featur be both repres and detect 
reflect directli on the qualiti of these tasks. however, 
the method of uncov such structur in empir 
data so far propos be veri differ in their suitabl 
to the aforement tasks. mani author have con- 
struct algorithm which attempt to divid the network 
into group accord to some metric devis specif 
for thi purpose. exampl of thi includ modular- 
iti [12], between [13], link similar [14], cliqu per- 
colat [15], encod of random walk [16], and mani 
more [2]. unfortunately, mani of these method will re- 
sult in diverg descript for the same network. fur- 
thermore, the inform they obtain cannot be easili 
use to gener the data, and make predict [6, 8]. 
alternatively, other author have focu on construct 
gener model that encod the large-scal structur 
a parameters, which can then be infer from empir- 

∗ tiago@itp.uni-bremen.d 

ical data (e.g. [17–20]). these method not onli rep- 
resent a more principl and rigor stance, but they 
can also demonstr overcom inher limit of 
more ad hoc method [7]. furthermore, they can be 
use to gener the data, and make predict [6, 8]. 
both approaches, however, suffer from a common funda- 
mental problem, name the difficulti in decid which 
detect method or gener model provid a more 
appropri descript of a give network. thi issu 
tend to escal a more elabor model and method 
be developed, includ featur such a degre correc- 
tion [19], commun overlap [14, 15, 18, 20], hierarchi- 
cal structur [6, 7, 21], self-similar [22, 23], bipartite- 
ness [5], edg and node correl [24, 25], social tier [26], 
multilay structur [27], tempor inform [28], to 
name onli a few. although such develop be es- 
sential, they should be make with care, sinc increas- 
ing the complex of the network descript may lead 
to artifici result caus by overfitting. while thi be 
a well-understood phenomenon when deal with inde- 
pendent data or time series, open problem remain when 
the empir data be a network, for which mani com- 
mon assumpt no longer hold and the usual method 
perform veri poorli [29]. thi problem be significantli 
exacerb when method be use which make no at- 
tempt to ass the statist signific of the results. 
unfortunately, most method that be not base on gen- 
er model fall into thi class. although for certain 
special construct exampl some direct connect 
between statist infer and ad hoc method can be 
make [30, 31], and in the case of some spectral method 
a much deeper connect seem to exist [32, 33], they 
still inher lack the capac to reliabl distinguish 

ar 
X 

iv 
:1 

40 
9. 

30 
59 

v4 
[ 

ph 
y 

ic 
s. 

da 
ta 

-a 
n] 

2 
6 

M 
ar 

2 
01 

5 

mailto:tiago@itp.uni-bremen.d 


2 

signal from noise. furthermor — what be perhap even 
more import — these differ method cannot easili 
be compar to each other. for example, suppos that 
for the same network a nonoverlap partit be found 
by compress random walks, anoth overlap parti- 
tion be obtain with cliqu percolation, and yet anoth 
with a local method base on link similar (all of which 
be method not base on gener models). most of 
the time, these three partit will be veri different, 
and yet there be no obviou way to decid which one be 
a more faith represent of the network. although 
method such a network benchmark [34–36] and per- 
turbat analysi [37] have be develop in order to 
allevi thi issue, they have onli limit applic to 
the larg problem. namely, network benchmark cannot 
be use when an appropri represent of an empir- 
ical network be not known, and if one want to decide, 
for instance, if the network poss overlap group 
or not. In a similar vein, perturb analysi provid 
inform about the signific of result origin 
from a singl algorithm, which cannot be directli use 
to compar two veri differ ones. 

On the other hand, the situat be differ if one fo- 
cu on gener model alone. sinc in thi context 
the same problem be pose in a probabilist framework, 
comparison between model be possible, even if the mod- 
el be veri different. and sinc model can be design 
to accommod arbitrari topolog features, we lose 
no explanatori power when compar to the ad hoc ap- 
proaches. We show in thi work that thi central issu 
can be tackl in a consist and principl manner by 
perform model select base on statist evidence. 
In particular, we employ the minimum descript length 
principl (mdl) [38, 39], which seek to minim the to- 
tal inform necessari to describ the observ data 
a well a the model parameters. thi can be equiva- 
lentli formul a the maxim of a bayesian pos- 
terior likelihood which includ noninform prior on 
the parameters, from which a posterior odd ratio be- 
tween differ hypothesi can be computed, yield a 
degre of confid for a model to be reject in favor 
of another. We focu on the stochast block model a 
the underli gener model, a well a variant that 
includ degre correct and mix memberships. We 
show that with these model mdl can be use to pro- 
duce a veri effici algorithm that scale well for veri 
larg network and with an arbitrarili larg number of 
groups. furthermore, we employ the method to a wide 
varieti of empir network data sets, and we show that 
commun overlap be seldom select a the most ap- 
propriat model. thi cast doubt on the claim per- 
vasiv of group overlap [14, 15], obtain predom- 
inantli with nonstatist methods, which should per- 
hap be interpret a an artifact of use method with 
more degre of freedom, instead of an underli prop- 
erti of mani system — at least a long a there be a lack 
of corrobor evid support the overlap (such 
as, potentially, edg weight [25, 40] or multilay struc- 

ture [27], which we do not consid here). On the other 
hand, we find that degre correct tend to be select 
for a signific major of systems, impli that indi- 
vidual node “fitness” that be not uniformli inherit by 
group membership be a fundament aspect of network 
formation. 

thi paper be divid a follows. In sec. II we present 
the gener model considered, and in sec. iii we de- 
scribe the model select procedur base on mdl. In 
sec. IV we present the result for a varieti of empir 
networks. In sec. V we analyz the gener identifi 
limit of the overlap models, and in sec. VI we de- 
scribe in detail the infer algorithm used. In sec. vii 
we final with a discussion. 

ii. gener model for network 
structur 

A gener model be one which attribut to each 
possibl graph G a probabl P (g|{θ}) for it to be 
observed, condit on some set of paramet {θ}. 
here we will be restrict to discret uniform models, 
where specif choic of {θ} prohibit some graph from 
occurring, but those which be allow to occur have 
the same probability. for these model we can write 
P (g|{θ}) = 1/ω({θ}) = e−s(g|{θ}), with ω({θ}) be 
the total number of possibl graph compat with a 
give choic of parameters, and s(g|{θ}) = ln ω({θ}) 
be the entropi of thi constrain ensembl [41, 42]. In 
order to infer the paramet {θ} via maximum likeli- 
hood, we need to maxim P (g|{θ}), or equivalently, 
minim s(g|{θ}). thi approach, however, cannot be 
use if the order of the model be unknown, i.e. the num- 
ber of degre of freedom in the paramet set {θ}, sinc 
choic with high order will almost alway increas 
P (g|{θ}), result in overfitting. for the same reason, 
maximum likelihood cannot be use to distinguish be- 
tween model belong to differ classes, sinc mod- 
el with larg degre of freedom will inher lead to 
larg likelihoods. In order to avoid overfitting, one need 
to maxim instead the bayesian posterior probabl 
P ({θ}|g) = P (g|{θ})p ({θ})/p (g), with P (g) be 
a normal constant. the prior probabl P ({θ}), 
which encod our a priori knowledg of the param- 
eter (if any) should inher becom small if the 
number of degre of freedom increases. We will also 
be restrict to discret paramet with uniform prior 
probabilities, so that P ({θ}) = e−l({θ}), with l({θ}) be- 
ing the entropi of the ensembl of possibl paramet 
choices. We can thu write the total posterior likelihood 
a P ({θ}|g) = e−σ/p (g), with Σ = l({θ}) + s(g|{θ}). 
the valu Σ be the descript length of the data [38, 39], 
i.e. the total amount of inform requir to describ 
the observ data condit on a set of paramet a 
well a the paramet set itself [43]. hence, if we maxi- 
mize P ({θ}|g) we be automat find the parame- 
ter choic that compress the data most, sinc it will also 



3 

minim it descript length Σ. becaus of this, there 
be no differ between specifi probabilist model 
for both G and {θ}, or encod scheme that quantifi 
the amount of inform necessari to describ both. 
In the following, we will make use of both terminolog 
interchangeably, whenev most appropriate. 

A. overlap model without degre correct 

the main featur we want to consid in our gener 
model be the exist of well-defin group of nodes, 
which be connect to other group with arbitrari prob- 
abilities, such that node belong to the same group 
play a similar role in the large-scal network structure. 
We also want to includ the possibl of node belong 
to more than one group, and in so do inherit the topo- 
logic properti of all group to which they belong. In 
order to implement this, we consid a simpl variat of 
the stochast block model [17, 44–46] with N node and 
E edges, where the node can belong to differ groups. 
hence, to each node i we attribut a binari mixtur vec- 
tor~bi with B entries, where a give entri bri ∈ {0, 1} spec- 
ifi whether or not the node belong to block r ∈ [1, b]. 
In addit to thi overlap partition, we simpli defin 
the edge-count matrix {ers}, which specifi how mani 
edg be place between node belong to block r 
and s (or twice that number for r = s, for conveni 
of notation), where we have 

∑ 
r er = 2e. thi sim- 

ple definit allow one to gener a broad varieti of 
overlap patterns, which be not confin to pure as- 
sort structures, and the nonoverlap model can 
be recov a a special case, simpli by put each 
node in a singl group. 

the likelihood of observ a give graph with 
the abov constraint be simpli P (g|{~bi}, {ers}) = 
1/ω({~bi}, {ers}), where ω({~bi}, {ers}) be the number of 
possibl graphs, and St = ln ω({~bi}, {ers}) be the associ- 
ate ensembl entropy. In thi construction, the exist 
of multipl edg be allowed. however, the placement of 
multipl edg between node of block r and s should 
occur with a probabl proport to o(ers/nrns), 
where nr be the number of node which belong to block 
r, i.e. nr = 

∑ 
i b 
r 
i (note that 

∑ 
r nr ≥ n). sinc here 

we be predominantli interest in the spars situat 
where er ∼ o(n/b2) and nr ∼ o(n/b), the proba- 
biliti of observ parallel edg will decay a o(1/n), 
and henc can be neglect in the larg network limit. 
make use of thi simplification, we may approxim 
count all possibl graph gener by the paramet 
{~bi}, {ers} a the number of graph where each distinct 
membership of a singl node be consid to be a dif- 
ferent node with a singl membership. thi correspond 
to an augment graph gener via a nonoverlap 
block model with N ′ = 

∑ 
r nr nodes, where N 

′ ≥ N , but 

with the same matrix {ers}, for which the entropi be [42] 

St ' E − 
1 

2 

∑ 
r 

er ln 

( 
er 
nrn 

) 
, (1) 

where nrn � er be assumed. under thi formulation, 
we recov trivial the single-membership case simpli 
by assign each node to a singl group, sinc eq. 1 
remain the same in that special case. It be possibl to 
remov the approxim that no parallel edg occur, 
by defin the model somewhat differently, a in show 
in appendix B 1, in which case the eq. 1 hold exactli 
a long a no parallel edg be observed. 

like it nonoverlap counterpart, the block model 
without degre correct assum that node belong 
to the same group will receiv approxim the same 
number of edg of that type. hence, when appli to 
empir data, the modul discov will also tend to 
have thi property. thi mean that if the graph pos- 
sess larg degre variability, the group infer will 
tend to correspond to differ degre class [19]. On a 
similar vein, if a node belong to more than one group, 
it will also tend to have a total degre that be larg 
than node that belong to either group alone, sinc it 
will receiv edg of each type in an independ fashion. 
In other words, the group intersect be expect to 
be strictli denser than the nonoverlap portion of 
each group. note that, in thi respect, thi model differ 
from other popular ones, such a the mix membership 
stochast block model (mmsbm) [18], where the den- 
siti at the intersect be the weight averag of the 
group (see appendix B 1). 

B. overlap model with degre correct 

In the preced model, node that belong to the same 
group mixtur receive, on average, the same number of 
connections. thi mean that the group membership be 
the onli factor regul the propens of a give node 
to receiv links. An altern possibility, formul 
by karrer et al [19], be to consid that the node have 
individu propens to connect themselves, which be 
not necessarili correl with their group memberships. 
therefore, in thi “degree-corrected” model, node of the 
same group be allow to poss veri differ degrees. 
It have be demonstr in ref. [19] that thi model 
yield more intuit partit for mani empir net- 
works, suggest that these intrins propens may 
be a good model for these systems. In an analog 
manner, a multipl membership version of the stochast 
block model with degre correct can be defined. thi 
can be achiev simpli by specifying, in addit to the 
overlap partit {~bi}, the number of half-edg in- 
cident on a give node i which belong to group r, i.e. 
kri . the combin label degre of a node i be denot 
~ki = {kri }. given thi label degre sequence, one can 
simpli use the same edg count matrix {ers} a befor 



4 

to gener the graph. If we again make the assumpt 
that the occurr of parallel edg can be neglected, the 
total number of graph fulfil these constraint be ap- 
proxim equal to the nonoverlap ensembl where 
each set of half-edg incid on ani give node i that 
belong to the same group r be consid a an individ- 
ual node with degre kri , for which the ensembl entropi 
be [42] 

Sd ' −E − 
1 

2 

∑ 
r 

er ln 

( 
er 
ere 

) 
− 
∑ 
ir 

ln kri !, (2) 

where ers( 
〈 
k2 
〉 
r 
− 〈k〉r)( 

〈 
k2 
〉 
s 
− 〈k〉s)/〈k〉 

2 
r〈k〉 

2 
s � nrn 

have be assumed. similarli to the non-degree-correct 
case, it be possibl to remov the approxim that no 
parallel edg occur, by use a “poisson” version of the 
model, a be show in appendix B 2. under thi formula- 
tion, it can be show that thi model be equival to the 
one propos by ball et al [20], although here we keep 
track of the individu label on the half-edg a latent 
variables, instead of their probabilities. 

sinc we incorpor the label degre sequenc a 
model parameters, node that belong to the same group 
can have arbitrari degrees. furthermore, sinc the same 
appli to node that belong simultan to more 
than one group, the overlap between group be nei- 
ther prefer dens nor sparse; it all depend on the 
paramet {~ki}. 

iii. model select 

As discuss previously, in order to perform model se- 
lection, it be necessari to includ the inform need 
to describ the model parameters, in addit to the data. 
the paramet which need to be describ be the over- 
lap partit {~bi}, the edg count {ers}, and in the 
case of the degree-correct model we also need to the 
describ the label degre sequenc {~ki}. 

when choos an encod for the paramet (via a 
particular gener process) we need to avoid redun- 
dancy, and describ them a parsimoni a possible, 
while at the same time avert bia by be nonin- 
formative. In the following, we systemat employ 
two-level bayesian hierarchies, where discret prior dis- 
tribut be parametr via gener counts, which be 
themselv sampl from uniform nonparametr hyper- 
priors. 

A. overlap partition, {~bi} 

In order to specifi the partit {~bi}, we assum that 
all differ 2B − 1 mixtur be not necessarili equal 
likely, and furthermor the size di = 

∑ 
r b 
r 
i of the mix- 

ture be also not a priori assum to follow ani specif 
distribution. more specifically, we consid the mixtur 

to be the outcom of a gener process with two steps. 
We first gener the local mixtur size {di}, from a non- 
parametr distribution. then, give the mixtur sizes, 
we gener the actual mixtur {~bi} for each correspond- 
ing subset of the nodes, again use a nonparametr dis- 
tribution, condit on the mixtur size size. 

the mixtur size {di} be sampl uniformli from 
the distribut with fix count {nd}, where nd be the 
number of node with a mixtur of size di = d, with a 
likelihood 

P ({di}|{nd}) = 
∏ 
d nd! 

N ! 
. (3) 

for the count {nd} we assum a flat prior P ({nd}) = 
1/ 
(( 
D 
N 

)) 
, where D be the maximum valu of d, and the 

denomin be the total number of differ choic of 
{nd}, with 

(( 
n 
m 

)) 
= 
( 
n+m−1 

m 

) 
be the total number of 

m-combin with repetit from a set of size n. 
then, for all nd node with the same valu of di = d, 

we sampl a sequenc of {~bi}d from a distribut with 
support |~bi|1 ≡ 

∑ 
r b 
r 
i = d and with fix count {n~b}d, 

where n~b be the number of node belong to a specif 
mixtur ~bi = ~b of size d, 

P ({~bi}d|{n~b}d) = 
∏ 
|~b|1=d n~b! 

nd! 
. (4) 

for the count themselves, we again assum a flat prior 
P ({n~b}d|nd) = 1/ 

(( 
(bd) 
nd 

)) 
, where the denomin enu- 

merat the total number of {n~b} count with |~b|1 = d. 
the full posterior for the overlap partit then 

becom 

P ({~bi}) = 

[∏ 
d 

P ({~bi}d|{n~b}d)p ({n~b}d|nd) 

] 
× 

P ({di}|{nd})p ({nd}), (5) 

which correspond to a descript length Lp = 
− lnp ({~bi}), 

Lp = ln 
(( 
D 
N 

)) 
+ 
∑ 
d 

ln 
(( 

(bd) 
nd 

)) 
+ lnn !− 

∑ 
~b 

lnn~b!. (6) 

although it be possibl to encod the partit in dif- 
ferent way (e.g. by sampl the membership to each 
group independ [47]), thi choic make no assump- 
tion regard the type of overlap that be more like 
to occur, either accord to the number of group to 
which a node may belong, or the actual combin of 
group — it be all left to be learn from data. In particu- 
lar, it be not a priori assum that if mani node belong 
to two specif group then the overlap between these 
same group will also contain mani nodes. As desired, 
if the observ partit deviat from thi pattern, thi 
will be use to compress it further. onli if the observ 



5 

partit fall squar into thi pattern will further com- 
pression be impossible, and we would have an overhead 
describ it use eq. 6, when compar to an encod 
that expect it a priori. however, one can also see that 
in the limit n~b � 1, a the first two term in eq. 6 grow 
asymptot onli with lnn and lnnd, respectively, the 
whole descript length becom Lp ' nh({n~b/n}), 
where h({px}) be the entropi of the distribut {px}, 
which be the optim limit. henc if we have a prior 
that good match the observ overlap, the differ 
in descript length compar to eq. 6 will disappear 
asymptot for larg systems. anoth advantag of 
thi encod be that it incur no overhead when there 
be no overlap at all (i.e. D = 1), and in thi case, the 
descript length be ident to the nonoverlap case, 

lp(d = 1) = ln 
(( 
B 
N 

)) 
+ lnn !− 

∑ 
r 

lnnr!, (7) 

a defin in ref. [7]. 

B. label degre sequence, {~ki} 

for the degree-correct model, we need to describ 
the label degre sequenc {~ki}. We need to do so in a 
way which be compat with the partit {~bi} describ 
so far, and with the edg count {ers}, which will restrict 
the averag degre of each type. 

In order to fulli util the partit {~bi}, we describ 
for each distinct valu of ~bi = ~b it individu degre se- 
quenc {~ki}~b = {~ki|~bi = ~b}, via the count n 

~b 
~k 
, i.e. the 

number of node with mixtur ~bi = ~b which poss la- 
bele degre ~ki = ~k. We do so in order to preserv the 
lack of prefer for pattern involv the degre in the 
overlap between groups. sinc the model itself be agnos- 
tic with respect to the densiti of the overlaps, not onli 
do thi choic remain consist with thi indifference, 
but also ani exist pattern in the degre sequenc in 
the overlap will be use to construct a shorter descrip- 
tion. 

In addition, we must also consid the total number of 
half-edg of a give type r incid on a partition~b, er~b =∑ 
~k krn 

~b 
~k 
, where kr be the element of ~k correspond to 

group r, which must be compat with the edg count 
{ers} via er = 

∑ 
s er = 

∑ 
~b e 

r 
~b 
. 

An overview of the gener process be a follows: 
We first consid the er half-edg of each type r and 
the nonempti (n~b > 0) mixtur ~b which contain the 
same group r. We then distribut the label half-edg 
among these mixtures, obtain the total number of la- 
bele edg incid on each mixture, {er~b}. thi place- 
ment constrain the averag degre of each type insid 
each mixture. finally, give {er~b}, we sampl the actual 
label degre sequenc on the node of each mixture. 

We begin by first distribut all er half-edg of type 
r among all mr bin correspond to each nonempti 

mixtur ~b that contain the label r, i.e. mr = 
∑ 
~b br[n~b > 

0]. the total number of such partit be simpli 
(( 
mr 
er 

)) 
, 

and henc the likelihood for {er~b} becom 

P ({er~b}|{ers}, { 
~bi}) = 

(( 
mr 
er 

))−1 
. (8) 

given {er~b}, we need to distribut the label half-edg 
insid each partit to obtain each degre sequence. If 
we sampl uniformli from all possibl degre sequenc 
fulfil all necessari constraints, we have a likelihood 
for the degre sequenc insid a mixtur ~b give by 

P 
(1) 
~b 

({~ki}~b|{ 
r 
~b 
}, {~bi}) = 

∏ 
r 

(( 
n~b 
er~b 

))−1 
, (9) 

where 
(( 
n 
e 

)) 
be the total number of (unlabeled) degre se- 

quenc with a total of e half-edg incid on n nodes. 
the correspond descript length would then be 

l(1)~b = 
∑ 
r 

ln 

(( 
n~b 
er~b 

)) 
. (10) 

however, most degre sequenc sampl thi way will 
result in node with veri similar degrees. sinc we want 
to profit from degre variability, it be good to condit 
the descript on the degre count {n~b~k}, i.e. how mani 
node with mixtur ~bi = ~b poss label degre ~ki = ~k. 
thi altern distribut be give by 

P 
(2) 
~b 

({~ki}~b|{n 
~b 
~k 
}, {~bi}) = 

∏ 
~k n 

~b 
~k 
! 

n~b! 
. (11) 

for the degre count themselves, we choos a uniform 
prior P ({n~b~k}|{e 

r 
~b 
}, {~bi}) = 1/ξ~b, where ξ~b be the enu- 

merat of all possibl {n~b~k} count that fulfil the con- 
straint 

∑ 
~k n 

~b 
~k 

= n~b and 
∑ 
~k krn 

~b 
~k 

= er~b . unfortu- 
nately, thi enumer cannot be do easili in close 
form. however, the maximum entropi ensembl where 
these constraint be enforc on averag be analyt 
tractable, and a we show in appendix C, can be well 
approxim by ξ~b = 

∏ 
r∈~b Ξ 

r 
~b 
, where 

ln ξr~b ' 2 
√ 
ζ(2)er~b 

, (12) 

and ζ(x) be the riemann zeta function. the altern 
descript length becom therefor 

l(2)~b = 
∑ 
r∈~b 

ln ξr~b + lnn~b!− 
∑ 
~k 

lnn 
~b 
~k 
!. (13) 

thi approxim with “soft” constraint should be- 
come asymptot exact a the number of node be- 
come large, but otherwis will deviat from the actual 



6 

entropy. On the other hand, if the number of node be 
veri small, describ the degre sequenc via eq. 13 may 
not provid a shorter description, even if comput ex- 
actly. In thi situation, eq. 10 may actual provid a 
shorter descript of the degre sequence. We therefor 
comput both eq. 10 and eq. 13 and choos whichev 
be shorter. put it all together, the complet posterior 
for the whole label degre sequenc be 

P ({~ki}|{ers}, {~bi}) = 

∏ 
~b 

p~b({~ki}~b|{ 
r 
~b 
}, {~bi}) 

× 
P ({er~b}|{ers}, { 

~bi}), (14) 

with p~b({~ki}~b|{ 
r 
~b 
}, {~bi}) be the larg 

choic between P (1)~b ({ 
~ki}~b|{ 

r 
~b 
}, {~bi}) and 

P 
(2) 
~b 

({~ki}~b|{n 
~b 
~k 
})p ({n~b~k}|{e 

r 
~b 
}, {bi}). therefore, the 

descript length for the label degre sequenc 
Lκ = − lnp ({~ki}|{ers}, {bi}) becom 

Lκ = 
∑ 
r 

ln 
(( 
mr 
er 

)) 
+ 
∑ 
~b 

min 
( 
l(1)~b ,L 

(2) 
~b 

) 
. (15) 

In the limit n~b~k � 1, we have that Lκ '∑ 
~b n~bh({n 

~b 
~k 
/n~b}), and henc the degre sequenc in 

each partit be describ close to the optimum limit. 
for the nonoverlap case with D = 1, the descrip- 

tion length simplifi to 

Lκ = 
∑ 
r 

min 
( 
l(1)r ,l(2)r 

) 
, (16) 

with 

l(1)r = ln 
(( 
nr 
er 

)) 
, (17) 

l(2)r = ln Ξr + lnnr!− 
∑ 
k 

lnnrk!, (18) 

and ln Ξr ' 2 
√ 
ζ(2)er. for nr � 1 we obtain Lκ '∑ 

r nrh({nrk/nr}). thi approxim be use a pri- 
ori in ref. [7], but eq. 16 be a more complet descript 
length of the nonoverlap degre sequence, and it use 
should be preferred. hence, like the descript length of 
the overlap partition, the encod abov offer no 
overhead when the partit be nonoverlapping. 

C. edg counts, {ers} 

the final piec that need to be describ be the ma- 
trix of edg count {ers}. We may view thi set a 
an adjac matrix of a multigraph with B node and 
E = 

∑ 
r ers/2 edges. the total number of such matri- 

ce be ω(b,e) = 
(( 

(b2) 
E 

)) 
, and if we assum that they 

be all equal likely, we have P ({ers}) = 1/ω(b,e) and 
ln ω(b,e) can be use a the descript length [48]. 
there are, however, two problem with thi approach. 
first, thi uniform distribut be unlik to be valid, 
sinc most observ network still poss structur at 
the block level. second, thi assumpt lead to a limit 
in the detect of small groups, with a maximum de- 
tectabl number of group scale a bmax ∼ 

√ 
N [48]. 

similarli to what we do for the node partit and the 
degre sequence, thi can be solv by consid a gen- 
er model for the edg count themselves, with it 
own set of hyperparameters. sinc they correspond to 
a multigraph, a natur choic be the stochast block 
model itself, which have it own set of edg counts, that 
can themselv be model by anoth stochast block 
model with few nodes, and so on, recursively, until one 
have a model onli one node and one group at the top. thi 
nest stochast block model be propos in ref. [7], 
where it have be show to reduc the resolut limit to 
bmax ∼ N/ logn , make it often significantli less rele- 
vant in practice. furthermore, sinc the number of level 
and the topolog at each level be obtain by minim 
the overal descript length, it correspond to a fulli 
nonparametr way of infer the multilevel structur 
of networks. As show in ref. [7], if we denot the ob- 
serv network to be at the level l = 0 of the hierarchy, 
then the total descript length be 

Σ = st/c + 
L∑ 
l=1 

sm({elrs}, {nlr}) + ll−1t , (19) 

with {elrs}, {nlr} describ the block model at level l, 
where 

Sm = 
∑ 
r> 

ln 
(( 
nrn 
er 

)) 
+ 
∑ 
r 

ln 
(( 

((nr2 )) 
err/2 

)) 
(20) 

be the entropi of the correspond multigraph ensembl 
and 

llt = ln 
(( 

Bl 
bl−1 

)) 
+ lnbl−1!− 

∑ 
r 

lnnlr!. (21) 

be the descript length of the node partit at level 
l > 0. for the level l = 0 we have l0t = Lp give by 
eq. 6, or l0t = Lp + Lκ for the degree-correct model. 

note that here we use the single-membership non- 
degree-correct model in the upper layers. thi method 
could be modifi to includ arbitrari mixtur of degre 
correct and multipl membership, but we stick with 
thi formul for simplicity. 

D. signific level 

By minim the descript length Σ, we select the 
model that be most favor give the evid in the data. 
but in some situations, one be not mere interest in a 
binari answer regard which of two model choic be 



7 

best, but instead, one would like to be abl to rule out 
altern model with some degre of confidence. In 
thi case, a level of signific can be obtain by per- 
form a bayesian hypothesi test base on the ratio of 
posterior likelihoods. In thi context, there be differ 
hypothesi which can be tested. for instance, one could 
ask whether the entir class of non-degree-correct over- 
lap model (ndco) be favor in comparison to the 
class of nonoverlap degree-correct model (dc). 
thi can be do by comput the posterior distribu- 
tion for each model class H ∈ {ndco,dc}, 

P (h|g) = 
∑ 
θ P (g|θ,h)p (θ)p (h) 

P (g) 
, (22) 

where θ be shorthand for the entir set of model pa- 
ramet [i.e. θ = ({~bi}, {ers}) for H = ndco, and 
θ = ({bi}, {ers}, {ki}) for H = dc], with P (h) be 
the prior belief we have support a give hypothesis, 
and P (g) be a normal constant. the standard way 
in bayesian statist to evalu the rel evid 
support (or rejecting) hypothesi H1 over H2 be via 
the posterior odd ratio [49] 

Λ = 
P (h1|g) 
P (h2|g) 

= 

∑ 
θ P (g|θ,h1)p (θ)∑ 
θ P (g|θ,h2)p (θ) 

P (h1) 
P (h2) 

. (23) 

however, there be two issu with thi approach. first, 
comput the sum over all paramet choic be in- 
tractabl in thi context, sinc it involv sum over 
all possibl overlap or nonoverlap partitions. 
second, and more importantly, thi might not be the an- 
swer which be more relevant. If one obtain two model 
parametr by minim the descript length 
a describ in the previou section, with the two re- 
sult belong to differ model classes, one would be 
more interest in select or reject between these 
two particular choices, not necessarili the overal class 
to which they belong. although the descript length 
itself alreadi provid a mean to select the best alter- 
native, one would be interest in obtain a confid 
level for thi particular decision. thi be a differ sort 
of hypothesi test than the one above, but which can be 
perform analogously. sinc the result of the minimiza- 
tion of the descript length be the (possibl overlapping) 
partit of the network, our hypothesi be a combin 
of the model class which we be using, and the partic- 
ular partit that be found. the posterior probabl 
attribut to thi hypothesi be therefor 

P ({~bi},h|g) = 
P (g|{~bi},h)p ({~bi}|h)p (h) 

P (g) 
, (24) 

where again P (g) be a normal constant. the 
margin likelihood P (g|{~bi},h) be obtain by sum 
over the remain model parameters. In the case of the 
overlap degree-correct model (H = dco) they be 
the {ers} matrix and the label degre sequenc {~ki} 

(which be omit for the non-degree-correct model, 
H = ndco), 

P (g|{~bi},dc) = 
∑ 

{e′rs},{~k′i} 

P (g|{~bi}, {e′rs}, {~k′i})× 

P ({e′rs})p ({~k′i}) 

= P (g|{~bi}, {ers}, {~ki})p ({ers})p ({~ki}), 
(25) 

where the sum trivial contain onli one term, sinc 
for the same graph G and partit {~bi}, there be onli 
one possibl choic for the {ers} matrix and degre se- 
quenc {~ki} with nonzero probability, which be a conve- 
nient featur of the microcanon model formul 
consid here [the same hold for H = ndc, i.e. 
P (g|{~bi},ndc) = P (g|{~bi}, {ers})p ({ers})]. now if 
we want to compar two compet partit {~bi}a and 
{~bi}b, thi can be do again via the posterior odd ratio 
Λ, 

Λ = 
P ({~bi}a,ha|g) 
P ({~bi}b,hb|g) 

(26) 

= 
P (g|{~bi}a,ha)p ({~bi}a|ha)p (ha) 
P (g|{~bi}b,hb)p ({~bi}b|hb)p (hb) 

(27) 

= exp (−∆σ) , (28) 

with ∆Σ = Σa − Σb be the differ in the de- 
scription length, and in eq. 28 it be assum that 
P (ha) = P (hb) = 1/2, correspond to a lack of a 
priori prefer for either model variant (which, in fact, 
make Λ ident to the bay factor [50]). thi be a 
simpl result, which enabl u to use the differ 
in the descript length directli in the comput 
of confid levels. be a ratio of probabilities, the 
valu of Λ have a straightforward interpretation: for a 
valu of Λ = 1, both model explain the data equal 
well, and for valu of Λ < 1 model a be reject in favor 
of b with a confid increas a Λ diminishes. In 
order to simplifi it interpretation, the valu of Λ be 
usual divid into region correspond to a subjec- 
tive assess of the evid strength. A common 
classif be a follow [50]: valu of Λ in the interv 
{[1, 1/3], [1/3, 1/10], [1/10, 1/30], [1/30, 1/100], [1/100, 0]} 
be consid to be veri weak, substantial, strong, 
veri strong and decis evid support model b, 
respectively. In the following, when compar differ 
models, we will alway put the prefer model in the 
denomin of eq. 27, such that Λ ≤ 1. 

use the posterior odd ratio Λ be more practic than 
some altern model select approaches, such a like- 
lihood ratios. As have be recent show [29], the like- 
lihood distribut for the stochast block model do 
not follow a χ2-distribut asymptot for spars 
networks, and henc the calcul of a p-valu must 
be do via an empir comput of the likelihood 



8 

10−8 
10−4 

100 

Λ 

2 3 4 5 6 7 8 

B 

10−100 
10−75 
10−50 
10−25 

100 

Λ 

dc,d > 1 

dc,d = 1 

ndc,d > 1 

ndc,d = 1 

B = 5, 
non-degree-corrected, 
overlapping, Λ = 1 

B = 4, 
non-degree-corrected, 

overlapping, Λ ' 2× 10−4, 

10−4 
10−2 

100 

Λ 

5 6 7 8 9 10 11 

B 

10−50 
10−37 
10−24 
10−11 

Λ 

dc,d > 1 

dc,d = 1 

ndc,d > 1 

ndc,d = 1 

B = 10, 
non-degree-corrected, 
nonoverlapping, Λ = 1 

B = 9, 
non-degree-corrected, 

nonoverlapping, Λ ' 0.36 

figur 1. left: valu for posterior odd ratio Λ for the network of co-appear of charact in the novel “le misérables”, 
for all model variat (D > 1 indic an overlap model, “dc” a degree-correct model and “ndc” a non-degree- 
correct one). the model with the best and second-best fit be show at the bottom. right: same a in the left, but for 
the american colleg footbal network. 

distribut which be comput costly, and pro- 
hibit so for veri larg networks. In contrast, com- 
put Λ can be do easily, and it properli account for 
the increas complex of model with larg parame- 
ters, and protect against overfitting. however, it should 
be emphas that these differ model select ap- 
proach be design to answer similar, but not iden- 
tical questions. therefor the most appropri method 
should be the one that more close match the ques- 
tion raised. 

iv. empir network 

the method outlin in the previou section allow 
one to determin the best model from the variou avail- 
abl choices. here we analyz some empir examples, 
and determin the most appropri model, and examin 
the consequ of the balanc struck between model 
complex and qualiti of fit. We start with two small 
networks, the co-appear of charact in the victor 
hugo novel “le misérables” [54], and a network of amer- 
ican colleg footbal game [13, 55]. for both networks, 
we obtain the best partit accord all model varia- 

tion and for a differ number of group B, and we com- 
pute the valu of Λ rel to the best model, a show 
in fig. 1. for the “le misérables” network, the best 
fit be a non-degree-correct overlap model that put 
the most central charact in more than one group. all 
other partit for differ valu of B and model type 
result in valu significantli below the plausibl line of 
Λ = 10−2, indic that the overlap model offer a 
good explan for the data with a larg degre of con- 
fidence. In particular, it offer a good descript than 
the nonoverlap model with degre correction. for 
the footbal network, on the other hand, the prefer 
model be nonoverlap and without degre correct 
with B = 10, which match veri well the assum cor- 
rect partit into 10 conferences. the group be rela- 
tive homogeneous, with most node have similar de- 
grees, such that degre correct becom an extra bur- 
den, with veri littl add explanatori power. for thi 
network, however, there be altern fit with valu 
of Λ within the plausibl region, which mean that the 
commun be not veri strongli defined, and they ad- 
mit altern partit with B = 9 and B = 8 group 
which cannot be confid discard give the evid 
in the data. 

degre correct tend to becom a good choic for 



9 

B = 7, overlapping, degree-corrected, Λ = 1 B = 12, nonoverlapping, degree-corrected, log10 Λ ' −747 

figur 2. the network of polit blog by adam et al [51]. the left panel show the best model with an overlap partition, 
and the right show the best nonoverlap one. node with a blue halo belong to the republican faction, a determin in 
ref. [51]. for the visualization, the hierarch edge-bundl algorithm [52] be used. 

larg data sets, which display strong degre variabil- 
ity. one exampl of thi be the network of polit blog 
obtain by adam et al [51]. for thi network, the best 
model be a degree-corrected, overlap partit into 
B = 7 groups, show in fig. 2. compar to thi parti- 
tion, the best altern model without overlap divid 
the network into B = 12 groups1, but have a posterior 
odd ratio significantli below the plausibl region. It 
should be observ that the nonoverlap version cap- 
ture well the segreg into two group (republican 
and democrats) at the topmost level of the hierarchy. 
the overlap version, on the other hand, tend to clas- 
sifi half-edg belong to differ camp into differ 
groups, which be compat with the accept division, 
but the upper layer of the hierarchi do not reflect this, 
and prefer to merg togeth group that belong to dif- 
ferent factions, but that have otherwis similar role in 
the topology. 

overlap partitions, however, do not alway provid 
good descriptions, even in situat where it might be 
consid more intuitive. one of the context where 
overlap commun be often consid to be bet- 
ter explan be in social networks, where differ so- 
cial circl could be repres a differ group (e.g. 

1 In ref. [7] use the same nonoverlap model, a valu of B = 
15 be found. thi be due the differ in the descript length 
for the degre sequence, where here we use a more complet 
estim than in ref. [7], which result in thi slight difference. 

family, co-workers, friends, etc.), and one could belong 
to more than one of these groups. thi be illustr well 
by so-cal “ego networks,” where one examin onli the 
immedi neighbor of a node, and their mutual connec- 
tions. one such network, extract from the facebook 
onlin social network [53], be show in fig. 3. the com- 
mon interpret of network such a these be show on 
the right in fig. 3, and correspond to a partit of the 
central “ego” node so that it belong to all of the differ 
circles. under thi interpretation, the ego node be onli 
special in the sens that it belong to all groups, but in- 
side each group it be just a common member. however, 
among all model variants, the best fit turn out to be 
the one where the ego node be put separ in it own 
group, a show in the left in fig. 3. In thi exampl it be 
easi to see whi thi be the case: If we observ the degre 
distribut insid each group for the network on the left, 
we see that there be no strong degre variation. On the 
right, a the ego be includ in each group, it becom sys- 
temat the most connect node. thi be simpli by 
construction, sinc the ego must connect to everi other 
node. the onli situat where the ego would not stand 
out insid each group, would be if the commun be 
cliques. hence, sinc the ego be not a typic member 
of ani group, it be simpler to classifi it separ in it 
own group, which be select by the method a a be a 
more plausibl hypothesis. note that degre correct 
be not select a the most plausibl solution, sinc it be 
burden with the individu descript of everi degre 
in the network, which be fairli uniform with the excep- 



10 

0 8 16 24 

k 

0 
1 
2 
3 
4 

n 
k 

0 3 6 

k 

0 

2 

4 

n 
k 

0 3 6 9 

k 

0 

1 

2 

3 

n 
k 

4 8 12 

k 

0 

1 

2 

3 

n 
k 

0 8 16 24 

k 

0 
1 
2 
3 
4 

n 
k 

0 5 10 15 20 

k 

0 

2 

4 

6 

n 
k 

3 6 9 

k 

0 

1 

2 

3 

n 
k 

4 8 12 16 

k 

0 

1 

2 

3 

n 
k 

B = 5, overlapping, 
non-degree-corrected, Λ = 1 

B = 4, overlapping, 
non-degree-corrected, 

Λ ' 0.053 

figur 3. ego network of facebook contact [53]. left: the 
best model fit across all model variations, which put the ego 
node in it own group. right: the altern hypothesi 
where the node be split in sever groups. below each network 
be show the degre distribut insid each group. the 
arrow mark the degre of the ego node. 

tion of the ego. one can imagin a differ situat 
where there would be other veri well connect node 
insid each group, so that the ego could be describ a 
a common member of each group, but thi not observ 
in ani other network obtain in ref. [53]. naturally, 
if one consid the complet network, of which the ego 
neighbourhood be onli a small part, the situat may 
change, sinc there may be member of each group to 
which the ego do not have a direct connection. 

when perform model select for larg net- 
works, it be often the case that the overlap mod- 
el be not chosen. In tabl I be show the result 
for mani empir network belong to differ do- 
mains. for the major of cases, the nonoverlap 
degree-correct model be selected. the are, how- 
ever, mani except which includ two social net- 
work (gowalla and brightkit [61]), the global air- 
port network of openflights.com, the neuron net- 
work of C. elegan [62], the polit blog network al- 
readi mentioned, the arxiv co-authorship network [63] 
[in the field of gener rel and quantum cos- 
molog (gr-qc), high-energi physic (hep-th), condens 
matter (cond-mat), and astronomi (astro-ph)], co- 
authorship in network scienc [64], and the network 
of gene implic in diseas [66], for which some 
version of the overlap model be chosen. inter- 
estingly, for the arxiv co-authorship network in high- 
energi physics/phenomenolog (hep-ph) a nonoverlap- 
ping model be select instead. for onli one of the 
remain four arxiv network (astro-ph), the degree- 

no. N 〈k〉 log10 λdco log10 λdc log10 λndco log10 λndc B 〈d〉 σ/e 
1 34 4.6 −2.1 −2.1 — 0 2 1 4 
2 62 5.1 −4.6 −1.4 — 0 2 1 4.8 
3 77 6.6 −17 −7.7 0 −7.3 5 1.1 4 
4 105 8.4 −12 −2.8 −6.6 0 5 1 4.4 
5 115 10.7 −79 −27 — 0 10 1 4.3 
6 297 15.9 0 −61 −2.0× 102 −2.1× 102 5 1.8 5.1 
7 379 4.8 −47 −6.6 0 −8.9 20 1.1 6.2 
8 903 15.0 −3.8× 102 −3.7× 102 0 −3.7× 102 60 1.2 3.1 
9 1, 278 2.8 −8.1 0 −1.5× 102 −89 2 1 7.4 
10 1, 490 25.6 0 −5.2× 102 −2.3× 103 −2.3× 103 7 1.8 4.4 
11 1, 536 3.8 −2.5× 102 0 −65 −62 38 1 6.7 
12 1, 622 11.2 −4.3× 102 0 −12 −82 48 1 3.3 
13 1, 756 4.5 −43 0 −4.0× 102 −2.8× 102 7 1 5.9 
14 2, 018 2.9 −9.2 0 −2.9× 102 −2.1× 102 2 1 8.5 
15 4, 039 43.7 −1.5× 103 0 −8.1× 102 −9.5× 102 158 1 3.2 
16 4, 941 2.7 −2.2× 102 0 −21 −25 25 1 11 
17 7, 663 17.8 0 −1.1× 104 −5.3× 103 −1.6× 104 85 1 3.2 
18 7, 663 5.3 −1.8× 103 0 −9.3× 102 −7.3× 102 63 1 5 
19 8, 298 25.0 −9.1× 103 0 −1.4× 104 −1.4× 104 34 1 5.4 
20 9, 617 7.7 −4.2× 103 0 −2.3× 103 −2.5× 103 34 1 9.3 
21 26, 197 2.2 −2.4× 103 −1.2× 103 0 −2.7× 103 363 1.3 4.5 
22 36, 692 20.0 −4.1× 104 0 −8.5× 104 −2.8× 104 1812 1 5.5 
23 39, 796 15.2 −6.1× 104 0 −8.8× 104 −4.5× 104 1323 1 6.3 
24 52, 104 15.3 −1.5× 105 0 −3.7× 104 −4.0× 104 172 1 6.4 
25 58, 228 14.7 0 −5.8× 104 −1.8× 105 −1.4× 105 1995 3.2 7.3 
26 65, 888 305.2 −4.4× 104 0 −4.6× 105 −4.6× 105 384 1 4.1 
27 68, 746 1.5 −4.8× 103 −1.4× 103 0 −7.0× 103 719 1.4 6.4 
28 75, 888 13.4 −1.1× 105 0 −8.2× 104 −9.0× 104 143 1 8.9 
29 89, 209 5.3 −1.0× 104 0 −9.7× 103 −1.1× 104 848 1 3.2 
30 108, 300 3.5 −3.3× 103 −5.2× 103 0 −2.4× 104 1660 1.8 5.7 
31 133, 280 5.9 0 −4.4× 103 −7.4× 104 −3.8× 104 1944 5.3 4.4 
32 196, 591 19.3 0 −1.9× 105 −7.1× 105 −6.6× 105 6856 3.7 7.8 
33 265, 214 3.2 −1.4× 104 0 −9.2× 104 −8.5× 104 549 1 8.6 
34 273, 957 16.8 −5.4× 105 0 −4.6× 104 −7.2× 104 727 1 5.8 
35 281, 904 16.4 −1.2× 106 0 −2.8× 105 −1.5× 105 6655 1 4.3 
36 317, 080 6.6 −1.7× 105 0 −3.9× 105 −4.2× 105 8766 1 11 
37 325, 729 9.2 −5.8× 105 0 −1.1× 106 −2.3× 105 4293 1 5.8 
38 325, 729 9.2 −5.6× 105 0 −1.2× 106 −2.5× 105 3995 1 5.8 
39 334, 863 5.5 −3.3× 105 0 −3.6× 105 −3.4× 104 9118 1 11 
40 372, 787 9.7 −1.0× 106 0 −1.3× 105 −1.4× 105 965 1 11 
41 463, 347 20.3 −6.4× 105 0 −1.8× 106 −1.5× 106 9276 1 9.3 
42 1, 134, 890 5.3 — 0 −4.5× 105 −4.9× 105 264 1 13 
1 karat club [56] 22 enron email [57, 58] 
2 dolphin [59] 23 pgp [60] (directed) 
3 le misérabl [54] 24 internet AS (caida)a (directed) 
4 polit booksb 25 brightkit social network [61] 
5 american footbal [13, 55] 26 netflix-pruned-smaller-u 
6 C. elegan neuron [62] (directed) 27 arxiv co-author (hep-th) [63] 
7 coauthorship in network scienc [64] 28 epinions.com trust network [65] (directed) 
8 diseas gene [66] 29 arxiv co-author (hep-ph) [63] 
9 yeast protein interact (ccsb-yi11) [67] 30 arxiv co-author (cond-mat) [63] 
10 polit blog [51] (directed) 31 arxiv co-author (astro-ph) [63] 
11 yeast protein interact (lc) [68] 32 gowalla social network [61] 
12 yeast protein interact (combin ap/ms) [69] 33 EU email [63] (directed) 
13 E. coli gene regul [70] (directed) 34 flickr [71] 
14 yeast protein interact (y2h union) [67] 35 web graph of stanford.edu. [72] (directed) 
15 facebook ego [53] 36 dblp collabor [73] 
16 power grid [62] 37 web graph of nd.edu. [72] (directed) 
17 airport rout c (directed) 38 www [74] (directed) 
18 airport rout 39 amazon product network [73] 
19 wikipedia vote [75, 76] (directed) 40 imdb film-actord [48] 
20 human protein interact (hprd r9) [77] 41 ap citations (directed) 
21 arxiv co-author (gr-qc) [63] 42 youtub social network [73] 

a retriev from http://www.caida.org. 
b V. krebs, retriev 
from http://www-personal.umich.edu/~mejn/netdata/ 

c retriev from http://openflights.org/ 
d retriev from http://www.imdb.com/interfaces. 
e retriev from http://publish.aps.org/dataset. 

tabl I. comparison of differ model for mani empiri- 
cal networks. the column at the top tabl correspond to 
the dataset number (with the name give at the bottom 
table), the number of node N , the averag degre 〈k〉 = 
2e/n , the posterior odd ratio rel to the best model 
for the degree-correct overlap (λdco), the degree- 
correct nonoverlap (λdc), non-degree-correct over- 
lap (λndco) and non-degree-correct nonoverlap 
(λndc) models. miss entri correspond to situat 
where the best overlap partit turn out to be nonover- 
lapping. the last three column show some paramet of 
the best model: the number of group B, the averag mix- 
ture size 〈d〉, and the descript length per edg (in bit per 
edge). 

openflights.com 
stanford.edu 
nd.edu 
http://www.caida.org 
http://www-personal.umich.edu/~mejn/netdata/ 
http://openflights.org/ 
http://www.imdb.com/interfac 
http://publish.aps.org/dataset 


11 

correct version of the overlap model be selected, 
wherea for the other three the non-degree-correct ver- 
sion be preferred. hence, for co-authorship network the 
model select procedur seem to correspond to the 
intuit that they be compos predominantli of over- 
lap group [15]. 

We take the arxiv cond-mat network a a representa- 
tive exampl of the differ between the infer mod- 
els. As can be see in fig. 4, although the degre distri- 
bution be veri broad, the infer label degre distribu- 
tion be narrower, mean that mani large-degre node 
can be well explain a have a small degre of ani 
singl type, but belong simultan to mani group 
(in the specif context of thi network, prolif author 
tend to be the one which belong to mani differ type 
of collaborations). the distribut of mixtur size nd 
have almost alway a maximum at d = 1, mean that 
most node belong to one group, but with a tail which be 
compar broad (thi seem to be a gener featur 
which be observ in the major of network analyzed). 
the distribut of group size can be veri different, de- 
pend on which model be used. nonoverlap mod- 
el without degre correct tend to find group which 
be strongli correl with degre [19], and henc lead 
to a broad distribut of group size when the degre 
distribut be also broad. On the other hand, both de- 
gree correct and group overlap tend to chang the dis- 
tribut considerably. In the literatur there be often 
claim of commun size follow power-law distribu- 
tion [21, 78–80] with figur similar to the low left 
panel of fig. 5. regardless to the valid of thi hy- 
pothesi for the variou method use in the literature, 
thi be certainli not the case for the overlap model a 
show in the low right panel of the same figure. indeed, 
for most network analyzed, the model which best fit the 
data (which tend to be degree-correct and nonoverlap- 
ping) show no vestig of group size follow a scale-fre 
distribution. some further exampl of thi be show 
in fig. 5, where characterist size scale can be clearli 
identified. 

V. model identifiability: 
overlap vs. nonoverlap 

A central issu when select between nonoverlap- 
ping and overlap model be to decid when a group 
of node should belong simultan to two or more 
groups, of if these node should be good repres by 
a singl membership to a differ uniqu group. the 
choic be not alway immedi obvious, sinc we can 
alway gener veri similar network with either model. 
If we gener a network with the overlap model, 
but treat it a if it be gener by the nonoverlap 
model, with each distinct mixtur ~b correspond to a 
separ nonoverlap group, the associ entropi 

100 101 102 103 

k 

10−6 
10−5 
10−4 
10−3 
10−2 
10−1 

100 

p 
k 

non-overlap 

overlap 

100 101 

d 

10−4 
10−3 
10−2 
10−1 

100 

n 
d 
/N 

100 101 

nr 

10−4 

10−3 

10−2 

10−1 

p 
n 
r 

100 101 102 

nr 

10−4 

10−3 

10−2 

10−1 

p 
n 
r 

figur 4. statist properti of the best model infer 
for the network of arxiv co-author in the field of condens 
matter (cond-mat). top left: degre distribut of the orig- 
inal network and of the overlap model (where the label 
degre sequenc {~ki} be flatten into a singl histogram for 
all label degre {kri }). top right: distribut of mix- 
ture sizes, nd. bottom left: distribut of group size for 
the best-fit nonoverlapping, non-degree-correct model. 
bottom right: distribut of group size for the best-fit 
overlapping, non-degree-correct model. 

100 101 102 

nr 

10−5 
10−4 
10−3 
10−2 
10−1 

p 
n 
r 

100 101 102 

nr 

10−4 

10−3 

10−2 

p 
n 
r 

100 101 102 

nr 

10−5 
10−4 
10−3 
10−2 
10−1 

p 
n 
r 

100 101 102 

nr 

10−5 
10−4 
10−3 
10−2 

p 
n 
r 

figur 5. distribut of group size for the best fit non- 
degree-correct nonoverlap model (left) and the degree- 
correct nonoverlap model (right), for the pgp [60] 
(top) and dblp collabor [73] (bottom) networks. In 
both case the degree-correct model provid a good fit, 
a show in tabl I. 

will be 

S ′t ' E − 
1 

2 

∑ 
~b1~b2 

e~b1~b2 ln 

( 
e~b1~b2 
n~b1n~b2 

) 
, (29) 

where 

e~b1~b2 = 
∑ 
r 

br1b 
s 
2 

er 
nrn 

n~b1n~b2 (30) 



12 

be the expect number of edg between mixtur ~b1 and 
~b2. By exchang the sum and use jensen’ inequ 
we observ directli that 

S ′t ≤ E − 
1 

2 

∑ 
r 

er ln 

( 
er 
nrn 

) 
, (31) 

with the right-hand side be the entropi of origin 
overlap model st, and with the equal hold onli 
if the origin model happen to be nonoverlap to 
begin with. thus, the nonoverlap model will invari- 
abli poss a low entropy. nevertheless, the overlap- 
ping hypothesi may still be prefer if the number of 
group B be suffici small than the number of indi- 
vidual ~b mixtures, so that the total descript length be 
shorter. It should be observed, however, that sinc one 
model be contain insid the other, the differ in the 
descript length can be interpret simpli a the differ- 
enc in the prior probabl for the model parameters. 
As the amount of avail data increases, the effect of 
the prior should “wash out”, and the descript length 
should be increasingli domin by the model entropi 
alone. In these case one should expect the nonover- 
lap model to be preferred, regardless of the specif 
model which be use to gener the data. however, 
differ from model that gener independ data 
points, the “amount of avail data” for network mod- 
el be a finer issue. In the case of the stochast block 
model it involv the simultan scale of the number 
of edg E, the number of node N and the number of 
group B. 

As a case example, here we consid a simpl over- 
lap assort model, with er = 2e[δrsc/b + (1 − 
δrs)(1 − c)/b(b − 1)], with c ∈ [0, 1] control the de- 
gree of assortativity. the mixtur be parameter 
a n~b = C 

∏ 
r µ 

br , with C be a normal con- 
stant, and µ ∈ [0, 1] control the degre of overlap. 
for µ → 0 we obtain asymptot a nonoverlap 
partit with nr = n/b, and for µ = 1 all mixtur 
~b have the same size. We compar the differ in de- 
scription length between thi model and it equival 
parametr with each mixtur a a separ group. 
As can be see in fig. 6, for ani give valu of c, there 
be a valu of µ abov which the nonoverlap model be 
preferred. In thi paramet region, the group intersec- 
tion be suffici well popul with nodes, so that 
their represent a individu group be chosen. for 
valu of µ below thi value, the intersect be sig- 
nificantli small than the nonoverlap portion. In 
thi case, the data be good explain a larg group 
of almost nonoverlap nodes, with few node at the 
intersections. the boundari separ the two region 
reced upward a the number of group B be increased, 
mean that a larg number of distinct intersect 
can compens for a small number of nonoverlap 
nodes. It should also be point out that the boundari 
move downward a the number of node and edg be 
increased, such that the averag degre in the network 

0.95 0.96 0.97 0.98 0.99 1.00 

c 

0.05 

0.10 

0.15 

0.20 

µ 

(a) 

(b) 
(c) 
(d) 

(e) 

(f) 

(a) B = 2, c = 0.99, 
µ = 0.025 

(c) B = 3, c = 0.98, 
µ = 0.06 

(e) B = 4, c = 0.97, 
µ = 0.12 

(b) B = 3, c = 0.99, 
µ = 0.05 

(d) B = 7, c = 0.98, 
µ = 0.08 

(f) B = 15, c = 0.97, 
µ = 0.15 

figur 6. top: paramet region for the model consid 
in the main text, with N = 103 and 〈k〉 = 2e/n = 20. each 
curv correspond to one valu of B and separ a region 
abov where the nonoverlap model be prefer from a 
region below where the overlap model be chosen. bot- 
tom: network and their prefer partitions, correspond 
to paramet valu indic in the top panel. 

remain the same (not shown), so it be not onli the rela- 
tive size of the intersect that be the relev proper- 
ties, but also their absolut sizes. the same occur if the 
averag degre increas and everyth els remain con- 
stant. hence, in the limit of suffici data, either with 
the number of node insid each group and intersect 
becom suffici large, or with each part becom 
suffici dense, the nonoverlap model be the one 
which will be selected. for empir networks, thi may 
not be the most repres scale scenario, sinc the 
most appropri number of group and degre of over- 
lap may in fact follow ani arbitrari scaling, and henc 
the overlap model may still be selected, even for veri 
larg or veri dens networks. nevertheless, thi exampl 
seem to suggest that the nonoverlap model be gen- 
eral enough to accommod structur gener by the 
overlap model in these limit cases, and may serv 



13 

a a partial explan to whi the overlap model 
be seldom select in the empir system analyz in 
sec. iv. 

vi. infer algorithm 

the infer procedur consist in find the label 
of the half-edg of the graph such that the descript 
length be minimized. such global optim problem 
be often np-hard, and requir heurist to be solvabl in 
practic time. one possibl be to use the markov chain 
mont carlo (mcmc) method, which consist in mod- 
ifi the block membership of each half-edg in a ran- 
dom fashion, and accept or reject each move with 
a probabl give a a function of the descript length 
differ ∆σ. By choos the accept probabl 
in the appropri manner, i.e. by enforc ergod 
and detail balance, one can guarante that the label- 
ing will be sampl with the correct probabl after a 
suffici long equilibr time be reached. however, 
naiv formul of the markov chain will lead to veri 
long equilibr times, which becom unpract for 
larg networks. here we adapt the algorithm develop 
in ref. [81] for the nonoverlap case which implement 
a fast markov chain. It consist in the move propos of 
each half-edg incid on node i of type r to type s with 
a probabl give by 

p(r → s|t) = et + � 
et + �B 

, (32) 

where t be the block label the half-edg oppos a 
randomli chosen half-edg incid to the same node a 
the half-edg be moved, and � ≥ 0 be a free param- 
eter. eq. 32 mean that we attempt to guess the label 
of a give half-edg by inspect the group membership 
the neighbor of the node to which it belongs, and us- 
ing the current infer model paramet to choos 
the most like group to which it should be moved. It 
should be emphas that thi move propos do not 
result in a prefer for either assort or dissorta- 
tive networks, sinc it depend onli on the matrix {ers} 
current inferred. for ani choic of � > 0, thi move pro- 
posal preserv ergodicity, but not detail balance. thi 
last characterist can be enforc via the metropolis- 
hast criterion [82, 83] by accept each move with 
a probabl a give by 

a = min 

{ 
e−β∆σ 

∑ 
t p 
i 
tp(s→ r|t)∑ 

t p 
i 
tp(r → s|t) 

, 1 

} 
, (33) 

where pit be the fraction of oppos half-edg of node i 
which belong to block t, and p( → r|t) be comput af- 
ter the propos r → s move (i.e. with the new valu of 
etr), wherea p(r → s|t) be comput before. the param- 
eter β in eq. 33 be an invers temperature, which can be 
use to sampl partit accord to their descript 
length (β = 1) or to find the ground state (β →∞). As 

B = 2E B = 15 

B = 4 B = 4, plant 

figur 7. typic outcom of the greedi multilevel agglomer- 
ativ algorithm describ in the text, for a network sampl 
from the overlap model with B = 4. the differ panel 
show the progress of the algorithm from B = 2E to B = 4. 
the panel on the low right show the plant partit use 
to gener the network. 

explain in ref. [81], thi move propos a well a the 
comput of a can be do efficiently, with minim 
book-keeping, so that a sweep of the network (where each 
half-edg move be attempt once) be do in time o(e), 
independ of the number of group B. thi be true 
even in the overlap case, sinc updat eqs. 1, 2, 6 
and 15 after each half-edg move can be do in time 
o(1). 

As discuss in ref. [81], although the mcmc method 
abov succeed in equilibr faster than a naiv 
markov chain, it still suffer from a strong depend 
on how close one start from the global minimum. usu- 
ally, start from a random partit of the half-edg 
lead to metast state where the markov chain seem 
to have equilibrated, but in fact the network structur 
have onli be partial discovered, and will move from 
such configur onli after a veri long time. thi 
problem be common to mani infer procedur base 
on local move such a expect maxim [20] and 
belief propag [84, 85]. In ref. [81] a multilevel ag- 
glomer heurist be proposed, which significantli 
allevi thi problem. It consist in equilibr the 
chain for a larg number of groups, and then merg 
the group use the same algorithm use for the block 
membership moves. thi method, however, cannot be 
use unmodifi in the overlap case, sinc the strict 
merg of group will not properli explor the landscap 



14 

of possibl overlap partitions. We therefor modifi 
the approach a follows. befor group be merged, the 
half-edg belong to each one of them be split into 
subgroup correspond to the differ group member- 
ship at the oppos sides. these subgroup be then 
treat a separ groups, and be merg togeth until 
the desir number of group be achieved. all the detail 
of the algorithm beyond thi modif be perform 
exactli a describ in ref. [81]. sinc thi algorithm 
usual do a good job in find a partit veri close to 
the final one, it also tend to perform veri well when the 
algorithm be turn into a greedi heuristic, by start 
with B = 2E and each half-edg in it own group, and by 
make β →∞. An exampl of a typic outcom of the 
greedi algorithm be show in fig. 7. the greedi version 
be veri fast, with an overal complex of o(e ln2e), 
which make it usabl for veri larg networks. note that 
thi complex be independ on the number of groups, 
B. thi be a strong contrast to other method propos 
for the same problem, such a the stochast optimiza- 
tion algorithm of gopalan et al [86], and the expecta- 
tion maxim algorithm of ball et al [20], both of 
which have a complex of o(eb) per sweep, although 
they onli consid strictli assort models, and ap- 
pli the same techniqu to the more gener model 
consid here would lead to an o(eb2) complexity, 
similar to belief propag algorithm for nonoverlap- 
ping model [29, 85]. although these approach can be 
veri effici if the number of group be veri small, they 
quickli becom prohibit if the most appropri num- 
ber of group scale a some function of the system size 
(which seem to be gener the case when model se- 
lection be applied, see tabl I and ref. [7]), which be not 
an issu with the algorithm describ above. It should 
also be note that none of the other algorithm men- 
tion [20, 29, 85, 86] be design to overcom metast 
solutions, like the multilevel approach present here. 

for most network analyz in thi work, the fast 
heurist version of the algorithm be used, togeth with 
the algorithm describ in ref. [7] to infer the upper lay- 
er of the hierarchi (which includ the determin of 
the number of group B at the low level, in addit 
to the entir hierarchy, in a nonparametr fashion)2. 

vii. conclus 

We present a method of infer overlap and 
degree-correct version of the stochast block model 
base on the minimum descript length principl 
(mdl) that avoid overfit and allow for the compar- 
ison between model classes. base on a bayesian inter- 
pretat of mdl, we deriv a posterior odd ratio test 

2 A complet implement of the algorithm be freeli avail 
a part of the graph-tool librari [87] at http://graph-tool. 
skewed.de. 

that yield a degre of confid with which model can 
be select or discarded. In appli thi method to a va- 
rieti of empir networks, we obtain that for the ma- 
joriti of them the nonoverlap degree-correct model 
variant be the one that best fit the data. 

the rel success of the degree-correct model im- 
pli that intrins node propens be an import 
aspect of the network format of mani systems, which 
be not suffici well describ by the sole divis 
into node classes. We note, however, that there be ex- 
ception to this, a there be a few network that do 
not show enough statist evid to justifi the ad- 
dition paramet of the degree-correct model. In 
these networks, the group themselv seem to be the 
lead descriptor of the network structure, with the 
degre sequenc itself provid littl addit explana- 
tori power. 

although overlap structur be often consid 
to be more intuit explan for some networks, we 
show that in mani repres case the nonover- 
lap model can accommod the same structur 
while provid a more parsimoni descript of the 
data. thi contradict result obtain with nonsta- 
tistic method [14, 15], which claim that mani or 
even most network be good describ by overlap 
groups. We believ that thi conclus be most like 
a result of overfitting: sinc there be more overlap 
structur than nonoverlap ones, it be easi to find 
them in the data. We expect thi fact to bear on task 
that requir high-qual fits, such a the predict of 
miss or spuriou link [6, 8], or other gener 
of the data. 

the model consid in thi work gener unlabel 
networks, without ani other properti associ with 
the node or edges. however, it be often the case that 
either the node or edg have weight [25, 40, 88] or 
be of differ type [24, 27], or have tempor informa- 
tion [28]. thi sort of addit data may corrobor 
the evid support the gener via a specif type 
of model (e.g. with overlaps) and tip the scale toward 
it. therefore, the result present in thi paper should 
not be interpret a a statement on the suitabl the 
abstract notion of overlap structur in general, onli 
of the specif formul considered. however, the ap- 
proach present here be generaliz to these other case 
a well, by augment the model to gener covari 
associ with the edg and node [25]. furthermore, 
one should be abl to perform a similar comparison with 
model which belong to veri differ classes, such a 
latent space [89] models, or others. 

appendix A: direct graph 

the same approach of the main text can be carri 
over to direct graph with no difficulties. In thi case 
the edg count be in gener asymmetric, er 6= esr, 
which lead to the entropi for the non-degree-correct 

http://graph-tool.skewed.d 
http://graph-tool.skewed.d 


15 

model [42] 

St ' E − 
∑ 
r 

er ln 

( 
er 
nrn 

) 
. (a1) 

for the degree-correct case, there be two degre se- 
quenc for the label out- and in-degrees, {k+ri } and 
{k−ri }, respectively. appli the same argument a for 
the undirect case, the entropi becom [42] 

Sd ' −e− 
∑ 
r 

er ln 

( 
er 

e+r e 
− 
s 

) 
− 
∑ 
ir 

ln k+ 
r 
i !− 

∑ 
ir 

ln k− 
r 
i !, 

(a2) 
where e+r = 

∑ 
s er and e 

− 
r = 

∑ 
s esr. 

the descript length for the overlap partit be 
ident to the undirect case, with Lp give by eq. 6. 
for the label degre sequence, we have instead 

Lκ = 
∑ 
r 

ln 
(( 
mr 
e+r 

)) 
+ ln 

(( 
mr 
e−r 

)) 
+ 
∑ 
~b 

min 
( 
l(1)~b ,L 

(2) 
~b 

) 
. 

(a3) 
with 

l(1)~b = 
∑ 
r 

ln 

(( 
n~b 
e+r~b 

)) 
+ ln 

(( 
n~b 
e−r~b 

)) 
. (a4) 

and 

l(2)~b = 
∑ 
r 

br 

( 
ln ξr~b 

+ + ln ξr~b 
− 
) 

+ lnn~b!− 
∑ 
~k 

lnn 
~b 
~k+,~k− 

!, 

(a5) 
where ln ξr~b 

+ and ln ξr~b 
− be comput a in eq. 12 

but use e+r~b = 
∑ 
~k+,~k− k 

+ 
r n 

~b 
~k+,~k− 

and er~b 
− =∑ 

~k+,~k− k 
− 
r n 

~b 
~k+,~k− 

, respectively, which give the total 

number of out- and in-edg incid on the mixtur ~b. 
In the previou equat the count n~b~k+,~k− refer to the 
joint distribut of label in- and out-degrees, so that 
each vector ~k+/− describ the in- and out-degre la- 
bele accord to degre membership, i.e. ~k+i = {k+ 

r 
i } 

and ~k−i = {k− 
r 
i }. 

appendix B: poisson model 

1. non-degree-correct 

thi approxim of the formul with “hard” 
constraint of the multipl membership model discuss 
in the main text be close relat to a poisson variant of 
the model with “soft” constraints, where each half-edg 
of the graph be label with a latent variabl specifi 
which group membership be respons for it exis- 
tence, and the number of edg of type (r, s) between 
node i and j, arsij , be independ sampl accord 
to a poisson distribut (similar to refs. [19, 20]), so the 

likelihood becom 

P (g|{~bi}, {prs}) = 
∏ 
i>j 

∏ 
r≥ 

p 
arsij 
r e 

−prsbri bsj/arsij !, (b1) 

where pr be the averag number of edg of type (r, s) 
between node that belong to each group. the log- 
likelihood can be write a 

lnp = 
1 

2 

∑ 
r 

er ln pr − nrnspr − 
∑ 
i>j 

∑ 
r≥ 

lnarsij !. (b2) 

maxim lnp w.r.t. prs, we obtain p̂r = ers/nrns, 
and henc 

ln P̂ = −e+ 1 
2 

∑ 
r 

er ln 

( 
er 
nrn 

) 
− 
∑ 
i>j 

∑ 
r≥ 

lnarsij !. (b3) 

for simpl graph with arsij ∈ {0, 1}, the last term in 
the abov equat be equal to zero, and we have that 
the approxim of the likelihood of the model with 
“hard” constraint in the spars case be ident to the ex- 
act maximum likelihood of the poisson model with “soft” 
constraints. 

thi model be similar to the popular mix membership 
stochast block model (mmsbm) [18]; howev it differ 
in the import aspect that it gener strictli denser 
overlaps. In the mmsbm, the exist of an edg aij 
be sampl from a bernoulli distribut with paramet 
λij = 

∑ 
r θ 

r 
i θ 
s 
jprs, where θri be the probabl that node 

i belong to group r, such that 
∑ 
r θ 

r 
i = 1, and pr ∈ [0, 1] 

be the probabl that two node belong to group r 
and s be connected. although for spars graph the 
differ between poisson and bernoulli model tend 
to disappear, with thi parametr the densiti of 
the overlap be mix with normal weights. more 
specifically, for a node i which belong simultan 
to group r and s, it expect degre be equal to the 
weight averag of the unmix degrees, 〈k〉i = θri 〈k〉r+ 
θsi 〈k〉s, where 〈k〉r = 

∑ 
s pr 

∑ 
i θ 
s 
i be the expect degre 

of a node that belong onli to group r. thus, in the 
mmsbm the node in the mixtur have an intermedi 
densiti between the sparser and the denser groups. In 
contrast, in the model consid in the main text, a well 
a the poisson model above, we have simpli 〈k〉i = 〈k〉r+ 
〈k〉s, and therefor the overlap be alway strictli denser 
than the pure groups. In thi respect, it be equival to 
other formul of the mmsbm, see e.g. refs. [90, 91]. 

2. degree-correct 

A connect to a version of the model with “soft” con- 
straint can also be made. We may consid each la- 
bele entri arsij in the adjac matrix to be poisson 
distribut with an averag give by θri θsjλrs, 

P (g|{~bi}, {λrs}, {θr}) = 
∏ 
i>j 

∏ 
r≥ 

(θri θ 
s 
jλrs) 

arsij e−θ 
r 
i θ 

s 
jλrs/arsij !, 

(b4) 



16 

where arsij be the number of edg of type (r, s) between 
node i and j, and θri be the propens with which a 
node receiv an edg of type r. the log-likelihood can 
be write a 

lnp = 
1 

2 

∑ 
r 

er lnλr + 
∑ 
ir 

kri ln θ 
r 
i − 

∑ 
r≥ 

λr 
∑ 
i>j 

θri θ 
s 
j 

− 
∑ 
i>j 

∑ 
r≥ 

lnarsij !. (b5) 

maxim lnp w.r.t. {λrs} and {θri }, we obtain λ̂r = 
ers/er and θ̂ri = kri , and henc 

ln P̂ = −E + 1 
2 

∑ 
r 

er ln 

( 
er 
ere 

) 
+ 
∑ 
ir 

kri ln k 
r 
i 

− 
∑ 
i>j 

∑ 
r≥ 

lnarsij !. (b6) 

again, for simpl graph with arsij ∈ {0, 1}, the last term 
in the abov equat be equal to zero; howev even in 
that case the likelihood be not ident to the version with 
“hard” constraint consid above, a be the case for the 
singl membership version a well [42]. both likelihood 
onli becom the same in the limit kri � 1 such that 
ln kri ! ' kri ln kri − kri . nevertheless, for the purpos of 
thi paper, the differ between these model can be 
overlooked. 

there be a direct connect between thi model and 
the one propos by ball et al [20]. In the not strictli 
assort version of their model, the number of edg 
aij be distribut accord to a poisson with averag 
λij = 

∑ 
r η 

r 
i η 
s 
jωrs, where ηri be the propens with which 

node i receiv edg of type r and ωr regul the 
number of edg across groups. the total likelihood of 
that model be 

P (g|{~bi}, {ωrs}, {ηr}) = 
∏ 
i>j 

λ 
aij 
ij e 

−λij/aij !. (b7) 

sinc the sum of independ poisson random variabl 
be also distribut accord to a poisson, if we gener- 
ate a graph with the model of eq. B4 and observ onli 
the total unlabel edg count aij = 

∑ 
rsa 

r 
ij , they be 

distribut exactli like eq. b7, for the same choic of 
paramet θri = ηri and λr = ωrs. hence, the model 
of the main text be an equival formul of the one 
in ref. [20] where one keep track of the latent variabl 
specifi the exact type of each half-edge, instead of 
their margin probability. thi have the advantag that 
the maximum likelihood estim for the model param- 
eter λr and θri can be obtain directli by differentia- 
tion, and do not requir iter of an EM algorithm 
a in ref. [20]. On the other hand we be left with the 
determin of label in the half-edges, which be do 
with the method alreadi describ in sec. vi. 

appendix C: maximum-entropi ensembl of count 
with constrain averag 

suppos we want to comput the number of all possi- 
ble non-neg integ count {nk}, subject to a nor- 
maliz constraint 

∑∞ 
k=0 nk = N and a fix average∑∞ 

k=0 knk = E. thi can be obtain approximately, 
by relax the constraint so that they hold onli on 
average. the maximum entropi ensembl give these 
constraint be the one with the probabl P ({nk}) = 
e−h({nk})/z, with h({nk}) = λ 

∑ 
k nk + µ 

∑ 
k knk, 

where λ and µ be the lagrang multipli that keep 
the constraint in place. thi ensembl be mathemati- 
calli analog to a simpl bose ga with energi level 
give by k. the partit function be give by 

Z = 
∑ 
{nk} 

e−λ 
∑ 

k nk−µ 
∑ 

k knk = 
∏ 
k 

zk, (c1) 

with 

Zk = 
[ 
1− e−λ−µk 

]−1 
. (c2) 

the averag count be give by 〈nk〉 = −∂ lnzk/∂λ = 
[exp(λ+ µk)− 1]−1, and the paramet λ and µ be de- 
termin via the impos constraints, 

∞∑ 
k=0 

[exp(λ+ µk)− 1]−1 = N, (c3) 

∞∑ 
k=0 

k [exp(λ+ µk)− 1]−1 = E. (c4) 

further analyt progress can be make by replac the 
sum with integrals, and use the polylogarithm func- 
tion and it connect with the bose–einstein distribu- 
tion, lis(z) = γ(s)−1 

∫∞ 
0 

ts−1 

et/z−1dt,∫ ∞ 
0 

dk [exp(λ+ µk)− 1]−1 = li1( 
−λ) 
µ 

= N, (c5)∫ ∞ 
0 

dkk [exp(λ+ µk)− 1]−1 = li2( 
−λ) 

µ2 
= E. (c6) 

eq. C5 can be invert a e−λ = 1 − exp(−n/µ), but 
eq. C6 cannot be solv for λ in close form. however, 
by assum a suffici “high temperature” regim 
where µ ∼ o(1), we have that the fugac simplifi 
in the thermodynam limit, e−λ → 1 for N � 1, 
and henc we obtain µ ' 

√ 
li2(1)/e. use eqs. C5 

and c6, we can write the entropi of the ensembl ln Ξ = 
− 
∑ 
k [∂ lnzk/∂λ+ ∂ lnzk/∂µ+ lnzk], a 

ln Ξ = λN + 2µe, (c7) 

and for the regim e−λ → 1, we have 

ln Ξ ' 2 
√ 
ζ(2)e, (c8) 



17 

where the ident li2(1) = ζ(2) be used, with ζ(x) 
be the riemann zeta function. although eq. C8 be- 
come asymptot exact in the thermodynam limit 
with E ∼ N and N � 1, the exact solut can also 
be obtain with arbitrari precis simpli by iterat- 
ing eqs. C5 and C6 a λ̂(t + 1) = 1 − exp(−n/µ(t)), 
µ(t+1) = 

√ 
e/li2(λ̂(t)), where λ̂ ≡ e−λ, with the start- 

ing point λ̂(0) = 1, µ(0) = 
√ 

li2(1)/e, until suffici 
converg be reached, and the result be substitut 
in eq. c7. (we actual use thi more precis procedur 
when comput eq. 13 in the main text, throughout the 
analysis.) 

[1] M. E. J. newman, “communities, modul and large- 
scale structur in networks,” nat phi 8, 25–31 (2011). 

[2] santo fortunato, “commun detect in graphs,” 
physic report 486, 75–174 (2010). 

[3] petter holme, “core-peripheri organ of complex 
networks,” physic review E 72, 046111 (2005). 

[4] M. puck rombach, mason A. porter, jame H. fowler, 
and peter J. mucha, “core-peripheri structur in net- 
works,” arxiv:1202.2684 (2012). 

[5] daniel B. larremore, aaron clauset, and abigail Z. ja- 
cobs, “effici infer commun structur in bipar- 
tite networks,” physic review E 90, 012805 (2014). 

[6] aaron clauset, cristoph moore, and M. E. J. new- 
man, “hierarch structur and the predict of miss- 
ing link in networks,” natur 453, 98–101 (2008). 

[7] tiago P. peixoto, “hierarch block structur and 
high-resolut model select in larg networks,” phys- 
ical review X 4, 011047 (2014). 

[8] roger guimerà and marta sales-pardo, “miss and 
spuriou interact and the reconstruct of complex 
networks,” proceed of the nation academi of sci- 
enc 106, 22073 –22078 (2009). 

[9] sergey V. buldyrev, roni parshani, gerald paul, H. eu- 
gene stanley, and shlomo havlin, “catastroph cas- 
cade of failur in interdepend networks,” natur 464, 
1025–1028 (2010). 

[10] andrea apolloni, chiara poletto, josé J. ramasco, pablo 
jensen, and vittoria colizza, “metapopul epidem 
model with heterogen mix and travel behaviour,” 
theoret biolog and medic model 11, 3 (2014). 

[11] roger guimerà and luí A. nune amaral, “function 
cartographi of complex metabol networks,” natur 
433, 895–900 (2005). 

[12] M. E. J. newman, “modular and commun structur 
in networks,” proceed of the nation academi of 
scienc 103, 8577–8582 (2006). 

[13] M. girvan and M. E. J. newman, “commun structur 
in social and biolog networks,” proceed of the na- 
tional academi of scienc 99, 7821 –7826 (2002). 

[14] yong-yeol ahn, jame P. bagrow, and sune lehmann, 
“link commun reveal multiscal complex in net- 
works,” natur 466, 761–764 (2010). 

[15] gerg palla, imr derényi, illé farkas, and tamá 
vicsek, “uncov the overlap commun struc- 
ture of complex network in natur and society,” natur 
435, 814–818 (2005). 

[16] martin rosval and carl T. bergstrom, “map of random 
walk on complex network reveal commun structure,” 
proceed of the nation academi of scienc 105, 
1118–1123 (2008). 

[17] paul W. holland, kathryn blackmond laskey, and 
samuel leinhardt, “stochast blockmodels: first steps,” 
social network 5, 109–137 (1983). 

[18] edoardo M. airoldi, david M. blei, stephen E. fien- 
berg, and eric P. xing, “mix membership stochast 
blockmodels,” J. mach. learn. res. 9, 1981–2014 (2008). 

[19] brian karrer and M. E. J. newman, “stochast block- 
model and commun structur in networks,” physic 
review E 83, 016107 (2011). 

[20] brian ball, brian karrer, and M. E. J. newman, “ef- 
ficient and principl method for detect commun 
in networks,” physic review E 84, 036103 (2011). 

[21] andrea lancichinetti, santo fortunato, and jáno 
kertész, “detect the overlap and hierarch 
commun structur in complex networks,” new jour- 
nal of physic 11, 033015 (2009). 

[22] gerg palla, lászló lovász, and tamá vicsek, “mul- 
tifract network generator,” proceed of the nation 
academi of scienc 107, 7640 –7645 (2010). 

[23] jure leskovec, deepayan chakrabarti, jon kleinberg, 
christo faloutsos, and zoubin ghahramani, “kroneck 
graphs: An approach to model networks,” J. mach. 
learn. res. 11, 985–1042 (2010). 

[24] mahendra mariadassou, stéphane robin, and corinn 
vacher, “uncov latent structur in valu graphs: 
A variat approach,” the annal of appli statis- 
tic 4, 715–742 (2010), mathemat review number 
(mathscinet): mr2758646. 

[25] christoph aicher, abigail Z. jacobs, and aaron 
clauset, “learn latent block structur in weight net- 
works,” journal of complex network , cnu026 (2014). 

[26] brian ball and m.e.j. newman, “friendship network and 
social status,” network scienc 1, 16–30 (2013). 

[27] mikko kivelä, alex arenas, marc barthelemy, jame P. 
gleeson, yamir moreno, and mason A. porter, “multi- 
layer networks,” journal of complex network 2, 203–271 
(2014). 

[28] wenji fu, Le song, and eric P. xing, “dynam mix 
membership blockmodel for evolv networks,” in pro- 
ceed of the 26th annual intern confer on 
machin learn , icml ’09 (acm, new york, ny, 
usa, 2009) pp. 329–336. 

[29] xiaoran yan, cosma shalizi, jacob E. jensen, flo- 
rent krzakala, cristoph moore, lenka zdeborová, pan 
zhang, and yaojia zhu, “model select for degree- 
correct block models,” journal of statist mechan- 
ics: theori and experi 2014, p05007 (2014). 

[30] M. E. J. newman, “commun detect and graph par- 
titioning,” epl (europhys letters) 103, 28003 (2013). 

[31] M. E. J. newman, “spectral method for commun de- 
tection and graph partitioning,” physic review E 88, 

http://dx.doi.org/10.1038/nphys2162 
http://dx.doi.org/16/j.physrep.2009.11.002 
http://dx.doi.org/ 10.1103/physreve.72.046111 
http://arxiv.org/abs/1202.2684 
http://dx.doi.org/10.1103/physreve.90.012805 
http://dx.doi.org/10.1038/nature06830 
http://dx.doi.org/10.1103/physrevx.4.011047 
http://dx.doi.org/10.1103/physrevx.4.011047 
http://dx.doi.org/10.1073/pnas.0908366106 
http://dx.doi.org/10.1073/pnas.0908366106 
http://dx.doi.org/10.1038/nature08932 
http://dx.doi.org/10.1038/nature08932 
http://dx.doi.org/ 10.1186/1742-4682-11-3 
http://dx.doi.org/10.1038/nature03288 
http://dx.doi.org/10.1038/nature03288 
http://dx.doi.org/10.1073/pnas.0601602103 
http://dx.doi.org/10.1073/pnas.0601602103 
http://dx.doi.org/ 10.1073/pnas.122653799 
http://dx.doi.org/ 10.1073/pnas.122653799 
http://dx.doi.org/10.1038/nature09182 
http://dx.doi.org/10.1038/nature03607 
http://dx.doi.org/10.1038/nature03607 
http://dx.doi.org/10.1073/pnas.0706851105 
http://dx.doi.org/10.1073/pnas.0706851105 
http://dx.doi.org/ 16/0378-8733(83)90021-7 
http://dl.acm.org/citation.cfm?id=1390681.1442798 
http://dx.doi.org/ 10.1103/physreve.83.016107 
http://dx.doi.org/ 10.1103/physreve.83.016107 
http://dx.doi.org/ 10.1103/physreve.84.036103 
http://dx.doi.org/ 10.1088/1367-2630/11/3/033015 
http://dx.doi.org/ 10.1088/1367-2630/11/3/033015 
http://dx.doi.org/10.1073/pnas.0912983107 
http://dx.doi.org/10.1073/pnas.0912983107 
http://dl.acm.org/citation.cfm?id=1756006.1756039 
http://dl.acm.org/citation.cfm?id=1756006.1756039 
http://dx.doi.org/10.1214/10-aoas361 
http://dx.doi.org/10.1214/10-aoas361 
http://dx.doi.org/10.1093/comnet/cnu026 
http://dx.doi.org/10.1017/nws.2012.4 
http://dx.doi.org/10.1093/comnet/cnu016 
http://dx.doi.org/10.1093/comnet/cnu016 
http://dx.doi.org/10.1145/1553374.1553416 
http://dx.doi.org/10.1145/1553374.1553416 
http://dx.doi.org/10.1145/1553374.1553416 
http://dx.doi.org/ 10.1088/1742-5468/2014/05/p05007 
http://dx.doi.org/ 10.1088/1742-5468/2014/05/p05007 
http://dx.doi.org/10.1209/0295-5075/103/28003 
http://dx.doi.org/10.1103/physreve.88.042822 


18 

042822 (2013). 
[32] raj rao nadakud and M. E. J. newman, “graph spec- 

tra and the detect of commun structur in net- 
works,” physic review letter 108, 188701 (2012). 

[33] florent krzakala, cristoph moore, elchanan mossel, 
joe neeman, allan sly, lenka zdeborová, and pan 
zhang, “spectral redempt in cluster spars net- 
works,” proceed of the nation academi of scienc 
, 201312486 (2013). 

[34] andrea lancichinetti, santo fortunato, and filippo 
radicchi, “benchmark graph for test commun 
detect algorithms,” physic review E 78, 046110 
(2008). 

[35] andrea lancichinetti and santo fortunato, “benchmark 
for test commun detect algorithm on direct 
and weight graph with overlap communities,” 
physic review E 80, 016118 (2009). 

[36] andrea lancichinetti and santo fortunato, “commun 
detect algorithms: A compar analysis,” physic 
review E 80, 056117 (2009). 

[37] brian karrer, elizaveta levina, and M. E. J new- 
man, “robust of commun structur in networks,” 
0709.2108 (2007). 

[38] peter D. grünwald, the minimum descript length 
principl (the mit press, 2007). 

[39] jorma rissanen, inform and complex in statis- 
tical modeling, 1st ed. (springer, 2010). 

[40] martin rosvall, alcid V. esquivel, andrea lanci- 
chinetti, jevin D. west, and renaud lambiotte, “mem- 
ori in network flow and it effect on spread dynam- 
ic and commun detection,” natur commun 
5 (2014), 10.1038/ncomms5630. 

[41] ginestra bianconi, “entropi of network ensembles,” 
physic review E 79, 036114 (2009). 

[42] tiago P. peixoto, “entropi of stochast blockmodel en- 
sembles,” physic review E 85, 056122 (2012). 

[43] martin rosval and carl T. bergstrom, “an information- 
theoret framework for resolv commun structur 
in complex networks,” proceed of the nation 
academi of scienc 104, 7327–7331 (2007). 

[44] stephen E. fienberg, michael M. meyer, and stanley S. 
wasserman, “statist analysi of multipl sociometr 
relations,” journal of the american statist associa- 
tion 80, 51–67 (1985). 

[45] katherin faust and stanley wasserman, “blockmodels: 
interpret and evaluation,” social network 14, 5–61 
(1992). 

[46] carolyn J. anderson, stanley wasserman, and kather- 
ine faust, “build stochast blockmodels,” social net- 
work 14, 137–161 (1992). 

[47] pierr latouche, etienn birmelé, and christoph am- 
broise, “model select in overlap stochast block 
models,” electron journal of statist 8, 762–794 
(2014). 

[48] tiago P. peixoto, “parsimoni modul infer in 
larg networks,” physic review letter 110, 148701 
(2013). 

[49] E. T. jaynes, probabl theory: the logic of science, 
edit by G. larri bretthorst (cambridg univers 
press, cambridge, UK ; new york, ny, 2003). 

[50] sir harold jeffreys, the theori of probabl (oxford 
univers press, 1998). 

[51] lada A. adam and natali glance, “the polit blo- 
gospher and the 2004 u.s. election: divid they blog,” 

in proceed of the 3rd intern workshop on link 
discoveri , linkkdd ’05 (acm, new york, ny, usa, 
2005) pp. 36–43. 

[52] D. holten, “hierarch edg bundles: visual of 
adjac relat in hierarch data,” ieee transac- 
tion on visual and comput graphic 12, 741– 
748 (2006). 

[53] julian mcauley and jure leskovec, “discov social 
circl in ego networks,” acm trans. knowl. discov. 
data 8, 4:1–4:28 (2014). 

[54] donald E. knuth, the stanford graphbase: A platform 
for combinatori computing, 1st ed. (addison-wesley 
professional, new york, n.y. : reading, mass, 1993). 

[55] T S evans, “american colleg footbal network files,” 
figshar (2012), 10.6084/m9.figshare.93179. 

[56] wayn W. zachary, “an inform flow model for con- 
flict and fission in small groups,” journal of anthropo- 
logic research 33, 452–473 (1977). 

[57] jure leskovec, kevin J. lang, anirban dasgupta, and 
michael W. mahoney, “commun structur in larg 
networks: natur cluster size and the absenc of larg 
well-defin clusters,” arxiv:0810.1355 (2008). 

[58] bryan klimt and yime yang, “introduc the enron 
corpus.” in cea (2004). 

[59] david lusseau, karsten schneider, oliv J. boisseau, 
patti haase, elisabeth slooten, and steve M. dawson, 
“the bottlenos dolphin commun of doubt sound 
featur a larg proport of long-last associations,” 
behavior ecolog and sociobiolog 54, 396–405 (2003). 

[60] oliv richter and tiago P. peixoto, “trust transit 
in social networks,” plo one 6, e18384 (2011). 

[61] eunjoon cho, seth A. myers, and jure leskovec, 
“friendship and mobility: user movement in location- 
base social networks,” in proceed of the 17th acm 
sigkdd intern confer on knowledg discov- 
eri and data mine , kdd ’11 (acm, new york, ny, 
usa, 2011) pp. 1082–1090. 

[62] D. J. watt and S. H. strogatz, “collect dynam of 
’small-world’ networks,” natur 393, 409–10 (1998). 

[63] jure leskovec, jon kleinberg, and christo falout- 
sos, “graph evolution: densif and shrink di- 
ameters,” acm trans. knowl. discov. data 1 (2007), 
10.1145/1217299.1217301. 

[64] M. E. J. newman, “find commun structur in net- 
work use the eigenvector of matrices,” physic re- 
view E 74, 036104 (2006). 

[65] matthew richardson, rakesh agrawal, and pedro 
domingos, “trust manag for the semant web,” in 
the semant web - iswc 2003 , lectur note in com- 
puter scienc no. 2870, edit by dieter fensel, katia 
sycara, and john mylopoulo (springer berlin heidel- 
berg, 2003) pp. 351–368. 

[66] K. I. goh, M. E. cusick, D. valle, B. childs, M. vidal, 
and A. L. barabási, “the human diseas network,” pro- 
ceed of the nation academi of scienc 104, 8685 
(2007). 

[67] haiyuan yu, pascal braun, muham A. yıldırım, 
irma lemmens, kavitha venkatesan, juli sahalie, 
tomoko hirozane-kishikawa, fana gebreab, Na li, nico- 
la simonis, tong hao, jean-françoi rual, améli dri- 
cot, alexei vazquez, ryan R. murray, christoph simon, 
leah tardivo, stanley tam, nenad svrzikapa, changyu 
fan, anne-sophi de smet, adriana motyl, michael E. 
hudson, juyong park, xiaofeng xin, michael E. cusick, 

http://dx.doi.org/10.1103/physreve.88.042822 
http://dx.doi.org/ 10.1103/physrevlett.108.188701 
http://dx.doi.org/10.1073/pnas.1312486110 
http://dx.doi.org/10.1073/pnas.1312486110 
http://dx.doi.org/ 10.1103/physreve.78.046110 
http://dx.doi.org/ 10.1103/physreve.78.046110 
http://dx.doi.org/10.1103/physreve.80.016118 
http://dx.doi.org/ 10.1103/physreve.80.056117 
http://dx.doi.org/ 10.1103/physreve.80.056117 
http://arxiv.org/abs/0709.2108 
http://dx.doi.org/10.1038/ncomms5630 
http://dx.doi.org/10.1038/ncomms5630 
http://dx.doi.org/ 10.1103/physreve.79.036114 
http://dx.doi.org/ 10.1103/physreve.85.056122 
http://dx.doi.org/10.1073/pnas.0611034104 
http://dx.doi.org/10.1073/pnas.0611034104 
http://dx.doi.org/ 10.2307/2288040 
http://dx.doi.org/ 10.2307/2288040 
http://dx.doi.org/ 16/0378-8733(92)90013-w 
http://dx.doi.org/ 16/0378-8733(92)90013-w 
http://dx.doi.org/ 16/0378-8733(92)90017-2 
http://dx.doi.org/ 16/0378-8733(92)90017-2 
http://dx.doi.org/10.1214/14-ejs903 
http://dx.doi.org/10.1214/14-ejs903 
http://dx.doi.org/ 10.1103/physrevlett.110.148701 
http://dx.doi.org/ 10.1103/physrevlett.110.148701 
http://dx.doi.org/10.1145/1134271.1134277 
http://dx.doi.org/10.1145/1134271.1134277 
http://dx.doi.org/10.1109/tvcg.2006.147 
http://dx.doi.org/10.1109/tvcg.2006.147 
http://dx.doi.org/10.1109/tvcg.2006.147 
http://dx.doi.org/10.1145/2556612 
http://dx.doi.org/10.1145/2556612 
http://dx.doi.org/10.6084/m9.figshare.93179 
http://www.jstor.org/stable/3629752 
http://www.jstor.org/stable/3629752 
http://arxiv.org/abs/0810.1355 
http://bklimt.com/papers/2004_klimt_ceas.pdf 
http://dx.doi.org/ 10.1007/s00265-003-0651-i 
http://dx.doi.org/ 10.1371/journal.pone.0018384 
http://dx.doi.org/ 10.1145/2020408.2020579 
http://dx.doi.org/ 10.1145/2020408.2020579 
http://dx.doi.org/ 10.1145/2020408.2020579 
http://dx.doi.org/ 10.1145/1217299.1217301 
http://dx.doi.org/ 10.1145/1217299.1217301 
http://dx.doi.org/10.1103/physreve.74.036104 
http://dx.doi.org/10.1103/physreve.74.036104 
http://link.springer.com/chapter/10.1007/978-3-540-39718-2_23 
http://www.pnas.org/content/104/21/8685.short 
http://www.pnas.org/content/104/21/8685.short 
http://www.pnas.org/content/104/21/8685.short 


19 

troy moore, charli boone, michael snyder, frederick P. 
roth, albert-lászló barabási, jan tavernier, david E. 
hill, and marc vidal, “high-qual binari protein in- 
teract map of the yeast interactom network,” scienc 
322, 104–110 (2008). 

[68] teresa reguly, ashton breitkreutz, lorri boucher, 
bobby-jo breitkreutz, gari C. hon, chad L. myers, 
ainsli parsons, helena friesen, rose oughtred, ami 
tong, chri stark, yuen ho, david botstein, brenda an- 
drews, charl boone, olga G. troyanskya, trey ideker, 
kara dolinski, nizar N. batada, and mike tyers, “com- 
prehens curat and analysi of global interact net- 
work in saccharomyc cerevisiae,” journal of biolog 5, 
11 (2006). 

[69] sean R. collins, patrick kemmeren, xue-chu zhao, 
jack F. greenblatt, forrest spencer, frank C. P. hol- 
stege, jonathan S. weissman, and nevan J. krogan, 
“toward a comprehens atla of the physic interac- 
tome of saccharomyc cerevisiae,” molecular & cellular 
proteomics: mcp 6, 439–450 (2007). 

[70] heladia salgado, martin peralta-gil, socorro gama- 
castro, alberto santos-zavaleta, lui muñiz-rascado, 
jair S. garcía-sotelo, verena weiss, hilda solano-lira, 
irma martínez-flores, alejandra medina-rivera, ger- 
ardo salgado-osorio, shirley alquicira-hernández, kevin 
alquicira-hernández, alejandra lópez-fuentes, liliana 
porrón-sotelo, arac M. huerta, césar bonavides- 
martínez, yalbi I. balderas-martínez, lucia pannier, 
maricela olvera, aurora labastida, verónica jiménez- 
jacinto, leticia vega-alvarado, victor del moral- 
chávez, alfredo hernández-alvarez, enriqu morett, 
and julio collado-vides, “regulondb v8.0: omic 
data sets, evolutionari conservation, regulatori phrases, 
cross-valid gold standard and more,” nucleic acid 
research 41, d203–213 (2013). 

[71] julian mcauley and jure leskovec, “imag label on a 
network: use social-network metadata for imag clas- 
sification,” in comput vision – eccv 2012 , lectur 
note in comput scienc no. 7575, edit by andrew 
fitzgibbon, svetlana lazebnik, pietro perona, yoichi 
sato, and cordelia schmid (springer berlin heidelberg, 
2012) pp. 828–841. 

[72] jure leskovec, kevin J. lang, anirban dasgupta, and 
michael W. mahoney, “commun structur in larg 
networks: natur cluster size and the absenc of larg 
well-defin clusters,” internet mathemat 6, 29–123 
(2009). 

[73] jaewon yang and jure leskovec, “defin and evalu- 
ate network commun base on ground-truth,” in 
proceed of the acm sigkdd workshop on mine 
data semantics, md ’12 (acm, new york, ny, usa, 
2012) pp. 3:1–3:8. 

[74] réka albert, hawoong jeong, and albert-lászló 
barabási, “internet: diamet of the world-wid web,” 
natur 401, 130–131 (1999). 

[75] jure leskovec, daniel huttenlocher, and jon kleinberg, 
“sign network in social media,” in proceed of the 
sigchi confer on human factor in comput 
systems, chi ’10 (acm, new york, ny, usa, 2010) 
pp. 1361–1370. 

[76] jure leskovec, daniel huttenlocher, and jon kleinberg, 
“predict posit and neg link in onlin social 
networks,” in proceed of the 19th intern con- 
ferenc on world wide web, www ’10 (acm, new 

york, ny, usa, 2010) pp. 641–650. 
[77] T. S. keshava prasad, renu goel, kumaran kan- 

dasamy, shivakumar keerthikumar, sameer kumar, 
suresh mathivanan, deepthi telikicherla, rajesh raju, 
beema shafreen, abhilash venugopal, lavanya balakr- 
ishnan, arivusudar marimuthu, sutopa banerjee, devi S. 
somanathan, aimi sebastian, sandhya rani, somak 
ray, C. J. harri kishore, sashi kanth, mukhtar 
ahmed, manoj K. kashyap, riaz mohmood, Y. L. ra- 
machandra, V. krishna, B. abdul rahiman, sujatha mo- 
han, prathibha ranganathan, subhashri ramabadran, 
raghothama chaerkady, and akhilesh pandey, “human 
protein refer database—2009 update,” nucleic acid 
research 37, d767–d772 (2009). 

[78] M. E. J. newman, “fast algorithm for detect com- 
muniti structur in networks,” physic review E 69, 
066133 (2004). 

[79] aaron clauset, M. E. J. newman, and cristoph 
moore, “find commun structur in veri larg net- 
works,” physic review E 70, 066111 (2004). 

[80] A. arenas, L. danon, A. díaz-guilera, P. M. gleiser, and 
R. guimerá, “commun analysi in social networks,” 
the european physic journal B - condens matter 
and complex system 38, 373–380 (2004). 

[81] tiago P. peixoto, “effici mont carlo and greedi 
heurist for the infer of stochast block models,” 
physic review E 89, 012804 (2014). 

[82] nichola metropolis, arianna W. rosenbluth, mar- 
shall N. rosenbluth, augusta H. teller, and edward 
teller, “equat of state calcul by fast comput 
machines,” the journal of chemic physic 21, 1087 
(1953). 

[83] W. K. hastings, “mont carlo sampl method use 
markov chain and their applications,” biometrika 57, 
97 –109 (1970). 

[84] aurelien decelle, florent krzakala, cristoph moore, 
and lenka zdeborová, “infer and phase transit 
in the detect of modul in spars networks,” physic 
review letter 107, 065701 (2011). 

[85] aurelien decelle, florent krzakala, cristoph moore, 
and lenka zdeborová, “asymptot analysi of the 
stochast block model for modular network and it al- 
gorithm applications,” physic review E 84, 066106 
(2011). 

[86] prem K. gopalan and david M. blei, “effici discov- 
eri of overlap commun in massiv networks,” 
proceed of the nation academi of scienc 110, 
14534–14539 (2013). 

[87] tiago P. peixoto, “the graph-tool python library,” 
figshar (2014), 10.6084/m9.figshare.1164194. 

[88] alcid viamont esquivel and martin rosvall, “com- 
pression of flow can reveal overlapping-modul organiza- 
tion in networks,” physic review X 1, 021025 (2011). 

[89] peter D hoff, adrian E raftery, and mark S hand- 
cock, “latent space approach to social network analy- 
sis,” journal of the american statist associ 97, 
1090–1098 (2002). 

[90] juuso parkkinen, jann sinkkonen, adam gyenge, 
and samuel kaski, “A block model suitabl for spars 
graphs,” in proceed of the 7th intern work- 
shop on mine and learn with graph (mlg 2009), 
leuven (2009). 

[91] jaewon yang and J. leskovec, “community-affili 
graph model for overlap network commun detec- 

http://dx.doi.org/10.1126/science.1158684 
http://dx.doi.org/10.1126/science.1158684 
http://dx.doi.org/10.1186/jbiol36 
http://dx.doi.org/10.1186/jbiol36 
http://dx.doi.org/10.1074/mcp.m600381-mcp200 
http://dx.doi.org/10.1074/mcp.m600381-mcp200 
http://dx.doi.org/ 10.1093/nar/gks1201 
http://dx.doi.org/ 10.1093/nar/gks1201 
http://link.springer.com/chapter/10.1007/978-3-642-33765-9_59 
http://www.tandfonline.com/doi/abs/10.1080/15427951.2009.10129177 
http://www.tandfonline.com/doi/abs/10.1080/15427951.2009.10129177 
http://dx.doi.org/ 10.1145/2350190.2350193 
http://dx.doi.org/ 10.1145/2350190.2350193 
http://dx.doi.org/10.1038/43601 
http://dx.doi.org/10.1145/1753326.1753532 
http://dx.doi.org/10.1145/1753326.1753532 
http://dx.doi.org/10.1145/1753326.1753532 
http://dx.doi.org/10.1145/1772690.1772756 
http://dx.doi.org/10.1145/1772690.1772756 
http://dx.doi.org/10.1093/nar/gkn892 
http://dx.doi.org/10.1093/nar/gkn892 
http://dx.doi.org/10.1103/physreve.69.066133 
http://dx.doi.org/10.1103/physreve.69.066133 
http://dx.doi.org/ 10.1103/physreve.70.066111 
http://dx.doi.org/10.1140/epjb/e2004-00130-1 
http://dx.doi.org/10.1140/epjb/e2004-00130-1 
http://dx.doi.org/10.1103/physreve.89.012804 
http://dx.doi.org/10.1063/1.1699114 
http://dx.doi.org/10.1063/1.1699114 
http://dx.doi.org/10.1093/biomet/57.1.97 
http://dx.doi.org/10.1093/biomet/57.1.97 
http://dx.doi.org/10.1103/physrevlett.107.065701 
http://dx.doi.org/10.1103/physrevlett.107.065701 
http://dx.doi.org/10.1103/physreve.84.066106 
http://dx.doi.org/10.1103/physreve.84.066106 
http://dx.doi.org/10.1073/pnas.1221839110 
http://dx.doi.org/10.1073/pnas.1221839110 
http://dx.doi.org/ 10.6084/m9.figshare.1164194 
http://dx.doi.org/10.1103/physrevx.1.021025 
http://dx.doi.org/ 10.1198/016214502388618906 
http://dx.doi.org/ 10.1198/016214502388618906 
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf 
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf 
http://research.ics.aalto.fi/mi/info/online-papers/mlg09sibm.pdf 


20 

tion,” in 2012 ieee 12th intern confer on 
data mine (icdm) (2012) pp. 1170–1175. 

http://dx.doi.org/10.1109/icdm.2012.139 
http://dx.doi.org/10.1109/icdm.2012.139 

model select and hypothesi test for large-scal network model with overlap group 
abstract 
I introduct 
II gener model for network structur 
A overlap model without degre correct 
B overlap model with degre correct 

iii model select 
A overlap partition, {i} 
B label degre sequence, {i} 
C edg counts, {ers} 
D signific level 

IV empir network 
V model identifiability: overlap vs. nonoverlap 
VI infer algorithm 
vii conclus 
A direct graph 
B poisson model 
1 non-degree-correct 
2 degree-correct 

C maximum-entropi ensembl of count with constrain averag 
refer 


